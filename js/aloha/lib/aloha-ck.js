/*
 Rangy, a cross-browser JavaScript range and selection library
 http://code.google.com/p/rangy/

 Copyright 2011, Tim Down
 Licensed under the MIT license.
 Version: 1.2.1
 Build date: 8 October 2011
 MIT License {@link http://creativecommons.org/licenses/MIT/}
 @return {String} outerHtml
 jquery.layout 1.3.0 - Release Candidate 30.51
 $Date: 2012-05-12 08:00:00 (Sat, 12 May 2012) $
 $Rev: 303005 $

 Copyright (c) 2012 
   Fabrizio Balliano (http://www.fabrizioballiano.net)
   Kevin Dalman (http://allpro.net)

 Dual licensed under the GPL (http://www.gnu.org/licenses/gpl.html)
 and MIT (http://www.opensource.org/licenses/mit-license.php) licenses.

 Changelog: http://layout.jquery-dev.net/changelog.cfm#1.3.0.rc30.5

 Docs: http://layout.jquery-dev.net/documentation.html
 Tips: http://layout.jquery-dev.net/tips.html
 Help: http://groups.google.com/group/jquery-ui-layout
 RequireJS i18n 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details
*/(function(){function ya(e,t){var n,r;r=e||{};this.jQuery=t||{};this.config={};this.config.elements=r.elements?r.elements:[];this.config.attributes=r.attributes?r.attributes:{};this.config.attributes[ya.ALL]=this.config.attributes[ya.ALL]?this.config.attributes[ya.ALL]:[];this.config.allow_comments=r.allow_comments?r.allow_comments:!1;this.allowed_elements={};this.config.protocols=r.protocols?r.protocols:{};this.config.add_attributes=r.add_attributes?r.add_attributes:{};this.dom=r.dom?r.dom:document;for(n=0;n<this.config.elements.length;n++)this.allowed_elements[this.config.elements[n]]=!0;this.config.remove_element_contents={};this.config.remove_all_contents=!1;if(r.remove_contents)if(r.remove_contents instanceof Array)for(n=0;n<r.remove_contents.length;n++)this.config.remove_element_contents[r.remove_contents[n]]=!0;else this.config.remove_all_contents=!0;this.transformers=r.transformers?r.transformers:[];this.filters=r.filters?r.filters:[]}var ka;ka||(ka={});(function(){function k(e){return 10>e?"0"+e:e}function f(e){c.lastIndex=0;return c.test(e)?'"'+e.replace(c,function(e){var t=l[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function a(e,t){var n,r,i,s,o=b,u,l=t[e];l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e));"function"==typeof g&&(l=g.call(t,e,l));switch(typeof l){case"string":return f(l);case"number":return isFinite(l)?""+l:"null";case"boolean":case"null":return""+l;case"object":if(!l)return"null";b+=m;u=[];if("[object Array]"===Object.prototype.toString.apply(l)){s=l.length;for(n=0;n<s;n+=1)u[n]=a(n,l)||"null";i=0===u.length?"[]":b?"[\n"+b+u.join(",\n"+b)+"\n"+o+"]":"["+u.join(",")+"]";b=o;return i}if(g&&"object"==typeof g){s=g.length;for(n=0;n<s;n+=1)"string"==typeof g[n]&&(r=g[n],(i=a(r,l))&&u.push(f(r)+(b?": ":":")+i))}else for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(i=a(r,l))&&u.push(f(r)+(b?": ":":")+i);i=0===u.length?"{}":b?"{\n"+b+u.join(",\n"+b)+"\n"+o+"}":"{"+u.join(",")+"}";b=o;return i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+k(this.getUTCMonth()+1)+"-"+k(this.getUTCDate())+"T"+k(this.getUTCHours())+":"+k(this.getUTCMinutes())+":"+k(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,m,l={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g;"function"!=typeof ka.stringify&&(ka.stringify=function(e,t,n){var r;m=b="";if(typeof n=="number")for(r=0;r<n;r+=1)m+=" ";else typeof n=="string"&&(m=n);if(!(g=t)||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return a("",{"":e});throw Error("JSON.stringify")});"function"!=typeof ka.parse&&(ka.parse=function(a,b){function g(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)if(Object.prototype.hasOwnProperty.call(i,n)){r=g(i,n);r!==void 0?i[n]=r:delete i[n]}return b.call(e,t,i)}var c,a=""+a;e.lastIndex=0;e.test(a)&&(a=a.replace(e,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){c=eval("("+a+")");return typeof b=="function"?g({"":c},""):c}throw new SyntaxError("JSON.parse")})})();define("util/json2",[],function(){return ka});define("aloha/rangy-core",[],function(){var e=function(){function e(e,t){var n=typeof e[t];return n==f||n==a&&!!e[t]||"unknown"==n}function t(e,t){return typeof e[t]==a&&!!e[t]}function n(e,t){return typeof e[t]!=l}function r(e){return function(t,n){for(var r=n.length;r--;)if(!e(t,n[r]))return!1;return!0}}function i(e){return e&&v(e,d)&&g(e,p)}function s(e){window.alert("Rangy not supported in your browser. Reason: "+e);y.initialized=!0;y.supported=!1}function o(){if(!y.initialized){var n,r=!1,o=!1;e(document,"createRange")&&(n=document.createRange(),v(n,h)&&g(n,c)&&(r=!0),n.detach());(n=t(document,"body")?document.body:document.getElementsByTagName("body")[0])&&e(n,"createTextRange")&&(n=n.createTextRange(),i(n)&&(o=!0));!r&&!o&&s("Neither Range nor TextRange are implemented");y.initialized=!0;y.features={implementsDomRange:r,implementsTextRange:o};r=w.concat(b);o=0;for(n=r.length;o<n;++o)try{r[o](y)}catch(u){t(window,"console")&&e(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",u)}}}function u(e){this.name=e;this.supported=this.initialized=!1}var a="object",f="function",l="undefined",c="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),h="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),p="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),d="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),v=r(e),m=r(t),g=r(n),y={version:"1.2.1",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:v,areHostObjects:m,areHostProperties:g,isTextRange:i},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!0}};y.fail=s;y.warn=function(e){e="Rangy warning: "+e;y.config.alertOnWarn?window.alert(e):typeof window.console!=l&&typeof window.console.log!=l&&window.console.log(e)};(({})).hasOwnProperty?y.util.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}:s("hasOwnProperty not supported");var b=[],w=[];y.init=o;y.addInitListener=function(e){y.initialized?e(y):b.push(e)};var E=[];y.addCreateMissingNativeApiListener=function(e){E.push(e)};y.createMissingNativeApi=function(e){e=e||window;o();for(var t=0,n=E.length;t<n;++t)E[t](e)};u.prototype.fail=function(e){this.initialized=!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+e)};u.prototype.warn=function(e){y.warn("Module "+this.name+": "+e)};u.prototype.createError=function(e){return Error("Error in Rangy "+this.name+" module: "+e)};y.createModule=function(e,t){var n=new u(e);y.modules[e]=n;w.push(function(e){t(e,n);n.initialized=!0;n.supported=!0})};y.requireModules=function(e){for(var t=0,n=e.length,r,i;t<n;++t){i=e[t];r=y.modules[i];if(!r||!(r instanceof u))throw Error("Module '"+i+"' not found");if(!r.supported)throw Error("Module '"+i+"' not supported")}};var S=!1,m=function(){S||(S=!0,y.initialized||o())};if(typeof window==l)s("No window found");else{if(typeof document!=l)return e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",m,!1),e(window,"addEventListener")?window.addEventListener("load",m,!1):e(window,"attachEvent")?window.attachEvent("onload",m):s("Window does not have required addEventListener or attachEvent method"),y;s("No document found")}}();e.createModule("DomUtil",function(e,t){function n(e){for(var t=0;e=e.previousSibling;)t++;return t}function r(e,t){var n=[],r;for(r=e;r;r=r.parentNode)n.push(r);for(r=t;r;r=r.parentNode)if(m(n,r))return r;return null}function i(e,t,n){for(n=n?e:e.parentNode;n;){e=n.parentNode;if(e===t)return n;n=e}return null}function s(e){e=e.nodeType;return 3==e||4==e||8==e}function o(e,t){var n=t.nextSibling,r=t.parentNode;n?r.insertBefore(e,n):r.appendChild(e);return e}function u(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=p)return e.ownerDocument;if(typeof e.document!=p)return e.document;if(e.parentNode)return u(e.parentNode);throw Error("getDocument: no document found for node")}function a(e){if(e)return e.previousSibling?e.previousSibling.nextSibling:e.nextSibling?e.nextSibling.previousSibling:e.parentNode?e.parentNode.firstChild:e}function f(e){return e?s(e)?'"'+e.data+'"':1==e.nodeType?"<"+e.nodeName+(e.id?' id="'+e.id+'"':"")+">["+e.childNodes.length+"]":e.nodeName:"[No node]"}function l(e){this._next=this.root=e}function c(e,t){this.node=e;this.offset=t}function h(e){this.code=this[e];this.codeName=e;this.message="DOMException: "+this.codeName}var p="undefined",d=e.util;d.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method");d.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var v=document.createElement("div");d.areHostMethods(v,["insertBefore","appendChild","cloneNode"])||t.fail("Incomplete Element implementation");d.isHostProperty(v,"innerHTML")||t.fail("Element is missing innerHTML property");v=document.createTextNode("test");d.areHostMethods(v,["splitText","deleteData","insertData","appendData","cloneNode"])||t.fail("Incomplete Text Node implementation");var m=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};l.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next,t;if(this._current){t=e.firstChild;if(!t)for(t=null;e!==this.root&&!(t=e.nextSibling);)e=e.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}};c.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+f(this.node)+":"+this.offset+")]"}};h.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};h.prototype.toString=function(){return this.message};e.dom={arrayContains:m,isHtmlNamespace:function(e){var t;return typeof e.namespaceURI==p||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t},parentElement:function(e){e=e.parentNode;return 1==e.nodeType?e:null},getNodeIndex:n,getNodeLength:function(e){var t;return s(e)?e.length:(t=e.childNodes)?t.length:0},getCommonAncestor:r,isAncestorOf:function(e,t,n){for(t=n?t:t.parentNode;t;){if(t===e)return!0;t=t.parentNode}return!1},getClosestAncestorIn:i,isCharacterDataNode:s,insertAfter:o,splitDataNode:function(e,t){var n=e.cloneNode(!1);n.deleteData(0,t);e.deleteData(t,e.length-t);o(n,e);return n},getDocument:u,getWindow:function(e){e=u(e);if(typeof e.defaultView!=p)return e.defaultView;if(typeof e.parentWindow!=p)return e.parentWindow;throw Error("Cannot get a window object for node")},getIframeWindow:function(e){if(typeof e.contentWindow!=p)return e.contentWindow;if(typeof e.contentDocument!=p)return e.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element")},getIframeDocument:function(e){if(typeof e.contentDocument!=p)return e.contentDocument;if(typeof e.contentWindow!=p)return e.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element")},getBody:function(e){return d.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]},getRootContainer:function(e){for(var t;t=e.parentNode;)e=t;return e},comparePoints:function(e,t,s,o){var e=a(e),s=a(s),u;if(e==s)return t===o?0:t<o?-1:1;if(u=i(s,e,!0))return t<=n(u)?-1:1;if(u=i(e,s,!0))return n(u)<o?-1:1;t=r(e,s);e=e===t?t:i(e,t,!0);s=s===t?t:i(s,t,!0);if(e===s)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(t=t.firstChild;t;){if(t===e)return-1;if(t===s)return 1;t=t.nextSibling}throw Error("Should not be here!")},inspectNode:f,fragmentFromNodeChildren:function(e){for(var t=u(e).createDocumentFragment(),n;n=e.firstChild;)t.appendChild(n);return t},createIterator:function(e){return new l(e)},DomPosition:c};e.DOMException=h});e.createModule("DomRange",function(e){function t(e,t){return 3!=e.nodeType&&(D.isAncestorOf(e,t.startContainer,!0)||D.isAncestorOf(e,t.endContainer,!0))}function n(e){return D.getDocument(e.startContainer)}function r(e,t,n){if(t=e._listeners[t])for(var r=0,i=t.length;r<i;++r)t[r].call(e,{target:e,args:n})}function i(e){return new P(e.parentNode,D.getNodeIndex(e))}function s(e){return new P(e.parentNode,D.getNodeIndex(e)+1)}function o(e,t,n){var r=11==e.nodeType?e.firstChild:e;D.isCharacterDataNode(t)?n==t.length?D.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:D.splitDataNode(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]);return r}function u(e){for(var t,r,i=n(e.range).createDocumentFragment();r=e.next();){t=e.isPartiallySelectedSubtree();r=r.cloneNode(!t);t&&(t=e.getSubtreeIterator(),r.appendChild(u(t)),t.detach(!0));if(10==r.nodeType)throw new H("HIERARCHY_REQUEST_ERR");i.appendChild(r)}return i}function a(e,t,n){for(var r,i,n=n||{stop:!1};r=e.next();)if(e.isPartiallySelectedSubtree()){if(!1===t(r)){n.stop=!0;break}if(r=e.getSubtreeIterator(),a(r,t,n),r.detach(!0),n.stop)break}else for(r=D.createIterator(r);i=r.next();)if(!1===t(i)){n.stop=!0;return}}function f(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),f(t),t.detach(!0)):e.remove()}function l(e){for(var t,r=n(e.range).createDocumentFragment(),i;t=e.next();){e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),i=e.getSubtreeIterator(),t.appendChild(l(i)),i.detach(!0)):e.remove();if(10==t.nodeType)throw new H("HIERARCHY_REQUEST_ERR");r.appendChild(t)}return r}function c(e,t,n){var r=!!t&&!!t.length,i,s=!!n;r&&(i=RegExp("^("+t.join("|")+")$"));var o=[];a(new p(e,!1),function(e){(!r||i.test(e.nodeType))&&(!s||n(e))&&o.push(e)});return o}function h(e){return"["+("undefined"==typeof e.getName?"Range":e.getName())+"("+D.inspectNode(e.startContainer)+":"+e.startOffset+", "+D.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){this.range=e;this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer;this.so=e.startOffset;this.ec=e.endContainer;this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&D.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===n&&!D.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:D.getClosestAncestorIn(this.sc,n,!0),this._last=this.ec===n&&!D.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:D.getClosestAncestorIn(this.ec,n,!0))}}function d(e){this.code=this[e];this.codeName=e;this.message="RangeException: "+this.codeName}function v(e,t,n){this.nodes=c(e,t,n);this._next=this.nodes[0];this._position=0}function m(e){return function(t,n){for(var r,i=n?t:t.parentNode;i;){r=i.nodeType;if(D.arrayContains(e,r))return i;i=i.parentNode}return null}}function g(e,t){if(z(e,t))throw new d("INVALID_NODE_TYPE_ERR")}function y(e){if(!e.startContainer)throw new H("INVALID_STATE_ERR")}function b(e,t){if(!D.arrayContains(t,e.nodeType))throw new d("INVALID_NODE_TYPE_ERR")}function w(e,t){if(0>t||t>(D.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new H("INDEX_SIZE_ERR")}function E(e,t){if(R(e,!0)!==R(t,!0))throw new H("WRONG_DOCUMENT_ERR")}function S(e){if(U(e,!0))throw new H("NO_MODIFICATION_ALLOWED_ERR")}function x(e,t){if(!e)throw new H(t)}function T(e){y(e);if(!D.arrayContains(j,e.startContainer.nodeType)&&!R(e.startContainer,!0)||!D.arrayContains(j,e.endContainer.nodeType)&&!R(e.endContainer,!0)||!(e.startOffset<=(D.isCharacterDataNode(e.startContainer)?e.startContainer.length:e.startContainer.childNodes.length))||!(e.endOffset<=(D.isCharacterDataNode(e.endContainer)?e.endContainer.length:e.endContainer.childNodes.length)))throw Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function N(){}function C(e){e.START_TO_START=J;e.START_TO_END=K;e.END_TO_END=Q;e.END_TO_START=G;e.NODE_BEFORE=Y;e.NODE_AFTER=Z;e.NODE_BEFORE_AND_AFTER=et;e.NODE_INSIDE=tt}function k(e){C(e);C(e.prototype)}function L(e,t){return function(){T(this);var n=this.startContainer,r=this.startOffset,i=this.commonAncestorContainer,o=new p(this,!0);n!==i&&(n=D.getClosestAncestorIn(n,i,!0),r=s(n),n=r.node,r=r.offset);a(o,S);o.reset();i=e(o);o.detach();t(this,n,r,n,r);return i}}function A(n,r,o){function u(e,t){return function(n){y(this);b(n,B);b(q(n),j);n=(e?i:s)(n);(t?a:c)(this,n.node,n.offset)}}function a(e,t,n){var i=e.endContainer,s=e.endOffset;if(t!==e.startContainer||n!==this.startOffset){if(q(t)!=q(i)||1==D.comparePoints(t,n,i,s))i=t,s=n;r(e,t,n,i,s)}}function c(e,t,n){var i=e.startContainer,s=e.startOffset;if(t!==e.endContainer||n!==this.endOffset){if(q(t)!=q(i)||-1==D.comparePoints(t,n,i,s))i=t,s=n;r(e,i,s,t,n)}}function h(e,t,n){(t!==e.startContainer||n!==this.startOffset||t!==e.endContainer||n!==this.endOffset)&&r(e,t,n,t,n)}n.prototype=new N;e.util.extend(n.prototype,{setStart:function(e,t){y(this);g(e,!0);w(e,t);a(this,e,t)},setEnd:function(e,t){y(this);g(e,!0);w(e,t);c(this,e,t)},setStartBefore:u(!0,!0),setStartAfter:u(!1,!0),setEndBefore:u(!0,!1),setEndAfter:u(!1,!1),collapse:function(e){T(this);e?r(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):r(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){y(this);g(e,!0);r(this,e,0,e,D.getNodeLength(e))},selectNode:function(e){y(this);g(e,!1);b(e,B);var t=i(e),e=s(e);r(this,t.node,t.offset,e.node,e.offset)},extractContents:L(l,r),deleteContents:L(f,r),canSurroundContents:function(){T(this);S(this.startContainer);S(this.endContainer);var e=new p(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);e.detach();return!n},detach:function(){o(this)},splitBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,s=e===n;D.isCharacterDataNode(n)&&0<i&&i<n.length&&D.splitDataNode(n,i);D.isCharacterDataNode(e)&&0<t&&t<e.length&&(e=D.splitDataNode(e,t),s?(i-=t,n=e):n==e.parentNode&&i>=D.getNodeIndex(e)&&i++,t=0);r(this,e,t,n,i)},normalizeBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,s=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,i=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},o=function(r){var s=r.previousSibling;if(s&&s.nodeType==r.nodeType){e=r;var o=r.length;t=s.length;r.insertData(0,s.data);s.parentNode.removeChild(s);e==n?(i+=t,n=e):n==r.parentNode&&(s=D.getNodeIndex(r),i==s?(n=r,i=o):i>s&&i--)}},u=!0;D.isCharacterDataNode(n)?n.length==i&&s(n):(0<i&&(u=n.childNodes[i-1])&&D.isCharacterDataNode(u)&&s(u),u=!this.collapsed);u?D.isCharacterDataNode(e)?0==t&&o(e):t<e.childNodes.length&&(s=e.childNodes[t])&&D.isCharacterDataNode(s)&&o(s):(e=n,t=i);r(this,e,t,n,i)},collapseToPoint:function(e,t){y(this);g(e,!0);w(e,t);h(this,e,t)}});k(n)}function O(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset;e.commonAncestorContainer=e.collapsed?e.startContainer:D.getCommonAncestor(e.startContainer,e.endContainer)}function M(e,t,n,i,s){var o=e.startContainer!==t||e.startOffset!==n,u=e.endContainer!==i||e.endOffset!==s;e.startContainer=t;e.startOffset=n;e.endContainer=i;e.endOffset=s;O(e);r(e,"boundarychange",{startMoved:o,endMoved:u})}function _(e){this.startContainer=e;this.startOffset=0;this.endContainer=e;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};O(this)}e.requireModules(["DomUtil"]);var D=e.dom,P=D.DomPosition,H=e.DOMException;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;e&&(this._next=e!==this._last?e.nextSibling:null,D.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so)));return e},remove:function(){var e=this._current,t,n;!D.isCharacterDataNode(e)||e!==this.sc&&e!==this.ec?e.parentNode&&e.parentNode.removeChild(e):(t=e===this.sc?this.so:0,n=e===this.ec?this.eo:e.length,t!=n&&e.deleteData(t,n-t))},isPartiallySelectedSubtree:function(){return t(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse();else{e=new _(n(this.range));var t=this._current,r=t,i=0,s=t,o=D.getNodeLength(t);D.isAncestorOf(t,this.sc,!0)&&(r=this.sc,i=this.so);D.isAncestorOf(t,this.ec,!0)&&(s=this.ec,o=this.eo);M(e,r,i,s,o)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};d.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};d.prototype.toString=function(){return this.message};v.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var B=[1,3,4,5,7,8,10],j=[2,9,11],F=[1,3,4,5,7,8,10,11],I=[1,3,4,5,7,8],q=D.getRootContainer,R=m([9,11]),U=m([5,6,10,12]),z=m([6,10,12]),W=document.createElement("style"),X=!1;try{W.innerHTML="<b>x</b>",X=3==W.firstChild.nodeType}catch(V){}e.features.htmlParsingConforms=X;var $="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),J=0,K=1,Q=2,G=3,Y=0,Z=1,et=2,tt=3;N.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){T(this);E(this.startContainer,t.startContainer);var n=e==G||e==J?"start":"end",r=e==K||e==J?"start":"end";return D.comparePoints(this[n+"Container"],this[n+"Offset"],t[r+"Container"],t[r+"Offset"])},insertNode:function(e){T(this);b(e,F);S(this.startContainer);if(D.isAncestorOf(e,this.startContainer,!0))throw new H("HIERARCHY_REQUEST_ERR");this.setStartBefore(o(e,this.startContainer,this.startOffset))},cloneContents:function(){T(this);var e,t;if(this.collapsed)return n(this).createDocumentFragment();if(this.startContainer===this.endContainer&&D.isCharacterDataNode(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=n(this).createDocumentFragment(),t.appendChild(e),t;t=new p(this,!0);e=u(t);t.detach();return e},canSurroundContents:function(){T(this);S(this.startContainer);S(this.endContainer);var e=new p(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);e.detach();return!n},surroundContents:function(e){b(e,I);if(!this.canSurroundContents())throw new d("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);o(e,this.startContainer,this.startOffset);e.appendChild(t);this.selectNode(e)},cloneRange:function(){T(this);for(var e=new _(n(this)),t=$.length,r;t--;)r=$[t],e[r]=this[r];return e},toString:function(){T(this);var e=this.startContainer;if(e===this.endContainer&&D.isCharacterDataNode(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],e=new p(this,!0);a(e,function(e){(3==e.nodeType||4==e.nodeType)&&t.push(e.data)});e.detach();return t.join("")},compareNode:function(e){T(this);var t=e.parentNode,n=D.getNodeIndex(e);if(!t)throw new H("NOT_FOUND_ERR");e=this.comparePoint(t,n);t=this.comparePoint(t,n+1);return 0>e?0<t?et:Y:0<t?Z:tt},comparePoint:function(e,t){T(this);x(e,"HIERARCHY_REQUEST_ERR");E(e,this.startContainer);return 0>D.comparePoints(e,t,this.startContainer,this.startOffset)?-1:0<D.comparePoints(e,t,this.endContainer,this.endOffset)?1:0},createContextualFragment:X?function(e){var t=this.startContainer,n=D.getDocument(t);if(!t)throw new H("INVALID_STATE_ERR");var r=null;1==t.nodeType?r=t:D.isCharacterDataNode(t)&&(r=D.parentElement(t));r=null===r||"HTML"==r.nodeName&&D.isHtmlNamespace(D.getDocument(r).documentElement)&&D.isHtmlNamespace(r)?n.createElement("body"):r.cloneNode(!1);r.innerHTML=e;return D.fragmentFromNodeChildren(r)}:function(e){y(this);var t=n(this).createElement("body");t.innerHTML=e;return D.fragmentFromNodeChildren(t)},toHtml:function(){T(this);var e=n(this).createElement("div");e.appendChild(this.cloneContents());return e.innerHTML},intersectsNode:function(e,t){T(this);x(e,"NOT_FOUND_ERR");if(D.getDocument(e)!==n(this))return!1;var r=e.parentNode,i=D.getNodeIndex(e);x(r,"NOT_FOUND_ERR");var s=D.comparePoints(r,i,this.endContainer,this.endOffset),r=D.comparePoints(r,i+1,this.startContainer,this.startOffset);return t?0>=s&&0<=r:0>s&&0<r},isPointInRange:function(e,t){T(this);x(e,"HIERARCHY_REQUEST_ERR");E(e,this.startContainer);return 0<=D.comparePoints(e,t,this.startContainer,this.startOffset)&&0>=D.comparePoints(e,t,this.endContainer,this.endOffset)},intersectsRange:function(e,t){T(this);if(n(e)!=n(this))throw new H("WRONG_DOCUMENT_ERR");var r=D.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),i=D.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?0>=r&&0<=i:0>r&&0<i},intersection:function(e){if(this.intersectsRange(e)){var t=D.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=D.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset),r=this.cloneRange();-1==t&&r.setStart(e.startContainer,e.startOffset);1==n&&r.setEnd(e.endContainer,e.endOffset);return r}return null},union:function(e){if(this.intersectsRange(e,!0)){var t=this.cloneRange();-1==D.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset);1==D.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset);return t}throw new d("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==tt},containsNodeContents:function(e){return 0<=this.comparePoint(e,0)&&0>=this.comparePoint(e,D.getNodeLength(e))},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);return 0<n.length?(t.setStart(n[0],0),e=n.pop(),t.setEnd(e,e.length),e=this.containsRange(t),t.detach(),e):this.containsNodeContents(e)},createNodeIterator:function(e,t){T(this);return new v(this,e,t)},getNodes:function(e,t){T(this);return c(this,e,t)},getDocument:function(){return n(this)},collapseBefore:function(e){y(this);this.setEndBefore(e);this.collapse(!1)},collapseAfter:function(e){y(this);this.setStartAfter(e);this.collapse(!0)},getName:function(){return"DomRange"},equals:function(e){return _.rangesEqual(this,e)},inspect:function(){return h(this)}};A(_,M,function(e){y(e);e.startContainer=e.startOffset=e.endContainer=e.endOffset=null;e.collapsed=e.commonAncestorContainer=null;r(e,"detach",null);e._listeners=null});e.rangePrototype=N.prototype;_.rangeProperties=$;_.RangeIterator=p;_.copyComparisonConstants=k;_.createPrototypeRange=A;_.inspect=h;_.getRangeDocument=n;_.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset};e.DomRange=_;e.RangeException=d});e.createModule("WrappedRange",function(e){function t(e,t,n,r){var o=e.duplicate();o.collapse(n);var u=o.parentElement();i.isAncestorOf(t,u,!0)||(u=t);if(!u.canHaveHTML)return new s(u.parentNode,i.getNodeIndex(u));var t=i.getDocument(u).createElement("span"),a,f=n?"StartToStart":"StartToEnd";do u.insertBefore(t,t.previousSibling),o.moveToElementText(t);while(0<(a=o.compareEndPoints(f,e))&&t.previousSibling);f=t.nextSibling;if(-1==a&&f&&i.isCharacterDataNode(f)){o.setEndPoint(n?"EndToStart":"EndToEnd",e);if(/[\r\n]/.test(f.data)){o=o.duplicate();u=o.text.replace(/\r\n/g,"\r").length;for(u=o.moveStart("character",u);-1==o.compareEndPoints("StartToEnd",o);)u++,o.moveStart("character",1)}else if(u=o.text.replace(/\u00a0/g," "),n=f.data.replace(/\u00a0/g," "),0!==n.indexOf(u)){for(;0<u.length&&0!==n.indexOf(u);)u=u.substr(1);u=u.length}else u=o.text.length;f=new s(f,u)}else f=(r||!n)&&t.previousSibling,f=(o=(r||n)&&t.nextSibling)&&i.isCharacterDataNode(o)?new s(o,0):f&&i.isCharacterDataNode(f)?new s(f,f.length):new s(u,i.getNodeIndex(t));t.parentNode.removeChild(t);return f}function n(e,t){var n,r,s=e.offset,o=i.getDocument(e.node),u=o.body.createTextRange(),a=i.isCharacterDataNode(e.node);a?(n=e.node,r=n.parentNode):(n=e.node.childNodes,n=s<n.length?n[s]:null,r=e.node);o=o.createElement("span");o.innerHTML="&#feff;";n?r.insertBefore(o,n):r.appendChild(o);try{u.moveToElementText(o),u.collapse(!t)}catch(f){}r.removeChild(o);a&&u[t?"moveStart":"moveEnd"]("character",s);return u}e.requireModules(["DomUtil","DomRange"]);var r,i=e.dom,s=i.DomPosition,o=e.DomRange;if(e.features.implementsDomRange&&(!e.features.implementsTextRange||!e.config.preferTextRange))(function(){function t(e){for(var t=s.length,n;t--;)n=s[t],e[n]=e.nativeRange[n]}var n,s=o.rangeProperties,u;r=function(e){if(!e)throw Error("Range must be specified");this.nativeRange=e;t(this)};o.createPrototypeRange(r,function(e,t,n,r,i){var s=e.endContainer!==r||e.endOffset!=i;if(e.startContainer!==t||e.startOffset!=n||s)e.setEnd(r,i),e.setStart(t,n)},function(e){e.nativeRange.detach();e.detached=!0;for(var t=s.length,n;t--;)n=s[t],e[n]=null});n=r.prototype;n.selectNode=function(e){this.nativeRange.selectNode(e);t(this)};n.deleteContents=function(){this.nativeRange.deleteContents();t(this)};n.extractContents=function(){var e=this.nativeRange.extractContents();t(this);return e};n.cloneContents=function(){return this.nativeRange.cloneContents()};n.surroundContents=function(e){this.nativeRange.surroundContents(e);t(this)};n.collapse=function(e){this.nativeRange.collapse(e);t(this)};n.cloneRange=function(){return new r(this.nativeRange.cloneRange())};n.refresh=function(){t(this)};n.toString=function(){return this.nativeRange.toString()};var a=document.createTextNode("test");i.getBody(document).appendChild(a);var h=document.createRange();h.setStart(a,0);h.setEnd(a,0);try{h.setStart(a,1),n.setStart=function(e,n){this.nativeRange.setStart(e,n);t(this)},n.setEnd=function(e,n){this.nativeRange.setEnd(e,n);t(this)},u=function(e){return function(n){this.nativeRange[e](n);t(this)}}}catch(p){n.setStart=function(e,n){try{this.nativeRange.setStart(e,n)}catch(r){this.nativeRange.setEnd(e,n),this.nativeRange.setStart(e,n)}t(this)},n.setEnd=function(e,n){try{this.nativeRange.setEnd(e,n)}catch(r){this.nativeRange.setStart(e,n),this.nativeRange.setEnd(e,n)}t(this)},u=function(e,n){return function(r){try{this.nativeRange[e](r)}catch(i){this.nativeRange[n](r),this.nativeRange[e](r)}t(this)}}}n.setStartBefore=u("setStartBefore","setEndBefore");n.setStartAfter=u("setStartAfter","setEndAfter");n.setEndBefore=u("setEndBefore","setStartBefore");n.setEndAfter=u("setEndAfter","setStartAfter");h.selectNodeContents(a);n.selectNodeContents=h.startContainer==a&&h.endContainer==a&&0==h.startOffset&&h.endOffset==a.length?function(e){this.nativeRange.selectNodeContents(e);t(this)}:function(e){this.setStart(e,0);this.setEnd(e,o.getEndOffset(e))};h.selectNodeContents(a);h.setEnd(a,3);u=document.createRange();u.selectNodeContents(a);u.setEnd(a,4);u.setStart(a,2);n.compareBoundaryPoints=-1==h.compareBoundaryPoints(h.START_TO_END,u)&1==h.compareBoundaryPoints(h.END_TO_START,u)?function(e,t){t=t.nativeRange||t;e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END);return this.nativeRange.compareBoundaryPoints(e,t)}:function(
e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};e.util.isHostMethod(h,"createContextualFragment")&&(n.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)});i.getBody(document).removeChild(a);h.detach();u.detach()})(),e.createNativeRange=function(e){e=e||document;return e.createRange()};else if(e.features.implementsTextRange){r=function(e){this.textRange=e;this.refresh()};r.prototype=new o(document);r.prototype.refresh=function(){var e,n,r=this.textRange;e=r.parentElement();var s=r.duplicate();s.collapse(!0);n=s.parentElement();s=r.duplicate();s.collapse(!1);r=s.parentElement();n=n==r?n:i.getCommonAncestor(n,r);n=n==e?n:i.getCommonAncestor(e,n);0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?n=e=t(this.textRange,n,!0,!0):(e=t(this.textRange,n,!0,!1),n=t(this.textRange,n,!1,!1));this.setStart(e.node,e.offset);this.setEnd(n.node,n.offset)};o.copyComparisonConstants(r);var u=function(){return this}();"undefined"==typeof u.Range&&(u.Range=r);e.createNativeRange=function(e){e=e||document;return e.body.createTextRange()}}e.features.implementsTextRange&&(r.rangeToTextRange=function(e){if(e.collapsed)return n(new s(e.startContainer,e.startOffset),!0);var t=n(new s(e.startContainer,e.startOffset),!0),r=n(new s(e.endContainer,e.endOffset),!1),e=i.getDocument(e.startContainer).body.createTextRange();e.setEndPoint("StartToStart",t);e.setEndPoint("EndToEnd",r);return e});r.prototype.getName=function(){return"WrappedRange"};e.WrappedRange=r;e.createRange=function(t){t=t||document;return new r(e.createNativeRange(t))};e.createRangyRange=function(e){e=e||document;return new o(e)};e.createIframeRange=function(t){return e.createRange(i.getIframeDocument(t))};e.createIframeRangyRange=function(t){return e.createRangyRange(i.getIframeDocument(t))};e.addCreateMissingNativeApiListener(function(t){t=t.document;typeof t.createRange=="undefined"&&(t.createRange=function(){return e.createRange(this)});t=t=null})});e.createModule("WrappedSelection",function(e,t){function n(e){return(e||window).getSelection()}function r(e){return(e||window).document.selection}function i(e,t,n){var r=n?"end":"start",n=n?"start":"end";e.anchorNode=t[r+"Container"];e.anchorOffset=t[r+"Offset"];e.focusNode=t[n+"Container"];e.focusOffset=t[n+"Offset"]}function s(e){e.anchorNode=e.focusNode=null;e.anchorOffset=e.focusOffset=0;e.rangeCount=0;e.isCollapsed=!0;e._ranges.length=0}function o(t){var n;t instanceof g?(n=t._selectionNativeRange,n||(n=e.createNativeRange(v.getDocument(t.startContainer)),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset),t._selectionNativeRange=n,t.attachListener("detach",function(){this._selectionNativeRange=null}))):t instanceof y?n=t.nativeRange:e.features.implementsDomRange&&t instanceof v.getWindow(t.startContainer).Range&&(n=t);return n}function u(e){var t=e.getNodes(),n;e:if(!t.length||1!=t[0].nodeType)n=!1;else{n=1;for(var r=t.length;n<r;++n)if(!v.isAncestorOf(t[0],t[n])){n=!1;break e}n=!0}if(!n)throw Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function a(e,t){var n=new y(t);e._ranges=[n];i(e,n,!1);e.rangeCount=1;e.isCollapsed=n.collapsed}function f(t){t._ranges.length=0;if("None"==t.docSelection.type)s(t);else{var n=t.docSelection.createRange();if(n&&"undefined"!=typeof n.text)a(t,n);else{t.rangeCount=n.length;for(var r,o=v.getDocument(n.item(0)),u=0;u<t.rangeCount;++u)r=e.createRange(o),r.selectNode(n.item(u)),t._ranges.push(r);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed;i(t,t._ranges[t.rangeCount-1],!1)}}}function l(e,t){for(var n=e.docSelection.createRange(),r=u(t),i=v.getDocument(n.item(0)),i=v.getBody(i).createControlRange(),s=0,o=n.length;s<o;++s)i.add(n.item(s));try{i.add(r)}catch(a){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}i.select();f(e)}function c(e,t,n){this.nativeSelection=e;this.docSelection=t;this._ranges=[];this.win=n;this.refresh()}function h(e,t){for(var n=v.getDocument(t[0].startContainer),n=v.getBody(n).createControlRange(),r=0,i;r<rangeCount;++r){i=u(t[r]);try{n.add(i)}catch(s){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}n.select();f(e)}function p(e,t){if(e.anchorNode&&v.getDocument(e.anchorNode)!==v.getDocument(t))throw new b("WRONG_DOCUMENT_ERR")}function d(e){var t=[],n=new w(e.anchorNode,e.anchorOffset),r=new w(e.focusNode,e.focusOffset),i="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var s=0,o=e.rangeCount;s<o;++s)t[s]=g.inspect(e.getRangeAt(s));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]);e.config.checkSelectionRanges=!0;var v=e.dom,m=e.util,g=e.DomRange,y=e.WrappedRange,b=e.DOMException,w=v.DomPosition,E,S,x=e.util.isHostMethod(window,"getSelection"),T=e.util.isHostObject(document,"selection"),N=T&&(!x||e.config.preferTextRange);N?(E=r,e.isSelectionValid=function(e){var e=(e||window).document,t=e.selection;return"None"!=t.type||v.getDocument(t.createRange().parentElement())==e}):x?(E=n,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected.");e.getNativeSelection=E;var x=E(),C=e.createNativeRange(document),k=v.getBody(document),L=m.areHostObjects(x,m.areHostProperties(x,["anchorOffset","focusOffset"]));e.features.selectionHasAnchorAndFocus=L;var A=m.isHostMethod(x,"extend");e.features.selectionHasExtend=A;var O="number"==typeof x.rangeCount;e.features.selectionHasRangeCount=O;var M=!1,_=!0;m.areHostMethods(x,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof x.rangeCount&&e.features.implementsDomRange&&function(){var e=document.createElement("iframe");k.appendChild(e);var t=v.getIframeDocument(e);t.open();t.write("<html><head></head><body>12</body></html>");t.close();var n=v.getIframeWindow(e).getSelection(),r=t.documentElement.lastChild.firstChild,t=t.createRange();t.setStart(r,1);t.collapse(!0);n.addRange(t);_=n.rangeCount==1;n.removeAllRanges();var i=t.cloneRange();t.setStart(r,0);i.setEnd(r,2);n.addRange(t);n.addRange(i);M=n.rangeCount==2;t.detach();i.detach();k.removeChild(e)}();e.features.selectionSupportsMultipleRanges=M;e.features.collapsedNonEditableSelectionsSupported=_;var D=!1,P;k&&m.isHostMethod(k,"createControlRange")&&(P=k.createControlRange(),m.areHostProperties(P,["item","add"])&&(D=!0));e.features.implementsControlRange=D;S=L?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var H;m.isHostMethod(x,"getRangeAt")?H=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:L&&(H=function(t){var n=v.getDocument(t.anchorNode),n=e.createRange(n);n.setStart(t.anchorNode,t.anchorOffset);n.setEnd(t.focusNode,t.focusOffset);if(n.collapsed!==this.isCollapsed){n.setStart(t.focusNode,t.focusOffset);n.setEnd(t.anchorNode,t.anchorOffset)}return n});e.getSelection=function(e){var e=e||window,t=e._rangySelection,n=E(e),i=T?r(e):null;if(t){t.nativeSelection=n;t.docSelection=i;t.refresh(e)}else{t=new c(n,i,e);e._rangySelection=t}return t};e.getIframeSelection=function(t){return e.getSelection(v.getIframeWindow(t))};P=c.prototype;if(!N&&L&&m.areHostMethods(x,["removeAllRanges","addRange"])){P.removeAllRanges=function(){this.nativeSelection.removeAllRanges();s(this)};var B=function(t,n){var r=g.getRangeDocument(n),r=e.createRange(r);r.collapseToPoint(n.endContainer,n.endOffset);t.nativeSelection.addRange(o(r));t.nativeSelection.extend(n.startContainer,n.startOffset);t.refresh()};P.addRange=O?function(t,n){if(D&&T&&this.docSelection.type=="Control")l(this,t);else if(n&&A)B(this,t);else{var r;if(M)r=this.rangeCount;else{this.removeAllRanges();r=0}this.nativeSelection.addRange(o(t));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==r+1){e.config.checkSelectionRanges&&(r=H(this.nativeSelection,this.rangeCount-1))&&!g.rangesEqual(r,t)&&(t=new y(r));this._ranges[this.rangeCount-1]=t;i(this,t,I(this.nativeSelection));this.isCollapsed=S(this)}else this.refresh()}}:function(e,t){if(t&&A)B(this,e);else{this.nativeSelection.addRange(o(e));this.refresh()}};P.setRanges=function(e){if(D&&e.length>1)h(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(m.isHostMethod(x,"empty")&&m.isHostMethod(C,"select")&&D&&N))return t.fail("No means of selecting a Range or TextRange was found"),!1;P.removeAllRanges=function(){try{var e=jQuery.browser.msie&&jQuery.browser.version<8&&typeof document.documentMode=="undefined";e||this.docSelection.empty();if(this.docSelection.type!="None"){e&&this.docSelection.empty();var t;if(this.anchorNode)t=v.getDocument(this.anchorNode);else if(this.docSelection.type=="Control"){var n=this.docSelection.createRange();n.length&&(t=v.getDocument(n.item(0)).body.createTextRange())}if(t){t.body.createTextRange().select();this.docSelection.empty()}}}catch(r){}s(this)},P.addRange=function(e){if(this.docSelection.type=="Control")l(this,e);else try{y.rangeToTextRange(e).select();this._ranges[0]=e;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;i(this,e,!1)}catch(t){}},P.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?h(this,e):t&&this.addRange(e[0])}}P.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new b("INDEX_SIZE_ERR");return this._ranges[e]};var j;if(N)j=function(t){var n;if(e.isSelectionValid(t.win))n=t.docSelection.createRange();else{n=v.getBody(t.win.document).createTextRange();n.collapse(!0)}t.docSelection.type=="Control"?f(t):n&&typeof n.text!="undefined"?a(t,n):s(t)};else if(m.isHostMethod(x,"getRangeAt")&&"number"==typeof x.rangeCount)j=function(t){if(D&&T&&t.docSelection.type=="Control")f(t);else{t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount;if(t.rangeCount){for(var n=0,r=t.rangeCount;n<r;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));i(t,t._ranges[t.rangeCount-1],I(t.nativeSelection));t.isCollapsed=S(t)}else s(t)}};else{if(!L||"boolean"!=typeof x.isCollapsed||"boolean"!=typeof C.collapsed||!e.features.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;j=function(e){var t;t=e.nativeSelection;if(t.anchorNode){t=H(t,0);e._ranges=[t];e.rangeCount=1;t=e.nativeSelection;e.anchorNode=t.anchorNode;e.anchorOffset=t.anchorOffset;e.focusNode=t.focusNode;e.focusOffset=t.focusOffset;e.isCollapsed=S(e)}else s(e)}}P.refresh=function(e){var t=e?this._ranges.slice(0):null;j(this);if(e){e=t.length;if(e!=this._ranges.length)return!1;for(;e--;)if(!g.rangesEqual(t[e],this._ranges[e]))return!1;return!0}};var F=function(e,t){var n=e.getAllRanges(),r=!1;e.removeAllRanges();for(var i=0,o=n.length;i<o;++i)r||t!==n[i]?e.addRange(n[i]):r=!0;e.rangeCount||s(e)};P.removeRange=D?function(e){if(this.docSelection.type=="Control"){for(var t=this.docSelection.createRange(),e=u(e),n=v.getDocument(t.item(0)),n=v.getBody(n).createControlRange(),r,i=!1,s=0,o=t.length;s<o;++s){r=t.item(s);r!==e||i?n.add(t.item(s)):i=!0}n.select();f(this)}else F(this,e)}:function(e){F(this,e)};var I;!N&&L&&e.features.implementsDomRange?(I=function(e){var t=!1;e.anchorNode&&(t=v.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1);return t},P.isBackwards=function(){return I(this)}):I=P.isBackwards=function(){return!1};P.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")};P.collapse=function(t,n){p(this,t);var r=e.createRange(v.getDocument(t));r.collapseToPoint(t,n);this.removeAllRanges();this.addRange(r);this.isCollapsed=!0};P.collapseToStart=function(){if(!this.rangeCount)throw new b("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)};P.collapseToEnd=function(){if(!this.rangeCount)throw new b("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)};P.selectAllChildren=function(t){p(this,t);var n=e.createRange(v.getDocument(t));n.selectNodeContents(t);this.removeAllRanges();this.addRange(n)};P.deleteFromDocument=function(){if(D&&T&&this.docSelection.type=="Control"){for(var e=this.docSelection.createRange(),t;e.length;){t=e.item(0);e.remove(t);t.parentNode.removeChild(t)}this.refresh()}else if(this.rangeCount){e=this.getAllRanges();this.removeAllRanges();t=0;for(var n=e.length;t<n;++t)e[t].deleteContents();this.addRange(e[n-1])}};P.getAllRanges=function(){return this._ranges.slice(0)};P.setSingleRange=function(e){this.setRanges([e])};P.containsNode=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(this._ranges[n].containsNode(e,t))return!0;return!1};P.toHtml=function(){var e="";if(this.rangeCount){for(var e=g.getRangeDocument(this._ranges[0]).createElement("div"),t=0,n=this._ranges.length;t<n;++t)e.appendChild(this._ranges[t].cloneContents());e=e.innerHTML}return e};P.getName=function(){return"WrappedSelection"};P.inspect=function(){return d(this)};P.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};c.inspect=d;e.Selection=c;e.selectionPrototype=P;e.addCreateMissingNativeApiListener(function(t){typeof t.getSelection=="undefined"&&(t.getSelection=function(){return e.getSelection(this)});t=null})});return window.rangy=e});define("util/class",[],function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){function n(){!e&&this._constructor&&this._constructor.apply(this,arguments)}var r=this.prototype;e=!0;var i=new this;e=!1;for(var s=0;s<arguments.length;s++){var o=arguments[s],u;for(u in o)i[u]="function"==typeof o[u]&&"function"==typeof r[u]&&t.test(o[u])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);this._super=n;return i}}(u,o[u]):o[u]}n.prototype=i;n.constructor=n;n.extend=arguments.callee;return n};return this.Class});GENTICS=window.GENTICS||{};GENTICS.Utils=GENTICS.Utils||{};define("util/lang",[],function(){});(function(e){var t=e.GENTICS;t.Utils.applyProperties=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};t.Utils.uniqeString4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};t.Utils.guid=function(){var e=t.Utils.uniqeString4;return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}})(window);define("aloha/ecma5shims",[],function(){function e(e){var t=null;if(e)do t=e;while(e=e.parentNode);return t}function t(e,t){return(e.contains(t)&&16)+(t.contains(e)&&8)+(0<=e.sourceIndex&&0<=t.sourceIndex?(e.sourceIndex<t.sourceIndex&&4)+(e.sourceIndex>t.sourceIndex&&2):1)}function n(e){return"sourceIndex"in e?e:e.parentNode.insertBefore(document.createComment(""),e)}var r={bind:function(e){var t=this.obj||this,n=Function.prototype.bind,r=Array.prototype.slice.call(arguments,1);return n?n.apply(t,arguments):function(){return t.apply(e,0===arguments.length?r:r.concat(Array.prototype.slice.call(arguments)))}},trim:function(){var e=this.obj||this,t=String.prototype.trim;return t?t.call(e):e.replace(/^\s+/,"").replace(/\s+$/,"")},indexOf:function(e,t){var n=this.obj||this,r=Array.prototype.indexOf;if(r)return r.call(n,e,t);void 0===t&&(t=0);0>t&&(t+=n.length);0>t&&(t=0);for(r=n.length;t<r;t++)if(t in n&&n[t]===e)return t;return-1},forEach:function(e,t){var n=this.obj||this,r=Array.prototype.forEach;if(r)return r.call(n,e,t);for(var r=0,i=n.length;r<i;r++)r in n&&e.call(t,n[r],r,n)},map:function(e,t,n){var r=this.obj||this,s=Array.prototype.map,o="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,u=[];if(s)u=s.call(r,e,t);else{for(var s=Array(r.length),u=0,a=r.length;u<a;u++)u in r&&(s[u]=e.call(t,r[u],u,r));u=s}return o?i(u):u},filter:function(e,t,n){var r=this.obj||this,s=Array.prototype.filter,o="boolean"==typeof arguments[arguments.length-1]?Array.prototype.pop.call(arguments):!1,u=[];if(s)u=s.call(r,e,t);else{for(var s=[],a,u=0,f=r.length;u<f;u++)u in r&&e.call(t,a=r[u],u,r)&&s.push(a);u=s}return o?i(u):u},every:function(e,t){var n=this.obj||this,r=Array.prototype.every;if(r)return r.call(n,e,t);for(var r=0,i=n.length;r<i;r++)if(r in n&&!e.call(t,n[r],r,n))return!1;return!0},some:function(e,t){var n=this.obj||this,r=Array.prototype.some;if(r)return r.call(n,e,t);for(var r=0,i=n.length;r<i;r++)if(r in n&&e.call(t,n[r],r,n))return!0;return!1},hasAttribute:function(e){var t=this.obj||this;return t.hasAttribute?t.hasAttribute(e):!!t.getAttribute(e)}},i=function(e){var t=function(){};t.prototype=r;t=new t;t.obj=e;return t},s;for(s in r)i[s]=r[s];i.Node="undefined"!=typeof Node?Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32};i.compareDocumentPosition=function(r,i){if("compareDocumentPosition"in document.documentElement)return r.compareDocumentPosition(i);if("contains"in document.documentElement){if(r==i)return 0;if(e(r)!=e(i))return 1;if("sourceIndex"in r&&"sourceIndex"in i)return t(r,i);if(r==document)return 20;if(i==document)return 10;var s=n(r),o=n(i),u=t(s,o);r!=s&&s.parentNode.removeChild(s);i!=o&&o.parentNode.removeChild(o);return u}throw"neither compareDocumentPosition nor contains is supported by this browser."};i.getComputedStyle=function(e,t){return"getComputedStyle"in window?window.getComputedStyle(e,t):e.currentStyle?e.currentStyle:null};return i});GENTICS=window.GENTICS||{};GENTICS.Utils=GENTICS.Utils||{};define("util/dom",["jquery","util/class","aloha/ecma5shims"],function(e,t,n){var r=window.GENTICS,i={P:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,LI:!0},t=t.extend({wordRegex:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,nonWordRegex:/[^\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,mergeableTags:"b code del em i ins strong sub sup #text".split(" "),nonWordBoundaryTags:"a b code del em i ins span strong sub sup #text".split(" "),nonEmptyTags:["br"],tags:{flow:"a abbr address area article aside audio b bdi bdo blockquote br button canvas cite code command datalist del details dfn div dl em embed fieldset figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr i iframe img input ins kbd keygen label map mark math menu meter nav noscript object ol output p pre progress q ruby s samp script section select small span strong style sub sup svg table textarea time u ul var video wbr #text".split(" "),phrasing:"a abbr area audio b bdi bdo br button canvas cite code command datalist del dfn em embed i iframe img input ins kbd keygen label map mark math meter noscript object output progress q ruby samp script select small span strong sub sup svg textarea time u var video wbr #text".split(" ")},children:{a:"phrasing",abbr:"phrasing",address:"flow",area:"empty",article:"flow",aside:"flow",audio:"source",b:"phrasing",base:"empty",bdo:"phrasing",blockquote:"phrasing",body:"flow",br:"empty",button:"phrasing",canvas:"phrasing",caption:"flow",cite:"phrasing",code:"phrasing",col:"empty",colgroup:"col",command:"empty",datalist:["phrasing","option"],dd:"flow",del:"phrasing",div:"flow",details:["summary","flow"],dfn:"flow",dl:["dt","dd"],dt:"phrasing",em:"phrasing",embed:"empty",fieldset:["legend","flow"],figcaption:"flow",figure:["figcaption","flow"],footer:"flow",form:"flow",h1:"phrasing",h2:"phrasing",h3:"phrasing",h4:"phrasing",h5:"phrasing",h6:"phrasing",header:"flow",hgroup:"h1 h2 h3 h4 h5 h6".split(" "),hr:"empty",i:"phrasing",iframe:"#text",img:"empty",input:"empty",ins:"phrasing",kbd:"phrasing",keygen:"empty",label:"phrasing",legend:"phrasing",li:"flow",link:"empty",map:"area",mark:"phrasing",menu:["li","flow"],meta:"empty",meter:"phrasing",nav:"flow",noscript:"phrasing",object:"param",ol:"li",optgroup:"option",option:"#text",output:"phrasing",p:"phrasing",param:"empty",pre:"phrasing",progress:"phrasing",q:"phrasing",rp:"phrasing",rt:"phrasing",ruby:["phrasing","rt","rp"],s:"phrasing",samp:"pharsing",script:"#script",section:"flow",select:["option","optgroup"],small:"phrasing",source:"empty",span:"phrasing",strong:"phrasing",style:"phrasing",sub:"phrasing",summary:"phrasing",sup:"phrasing",table:"caption colgroup thead tbody tfoot tr".split(" "),tbody:"tr",td:"flow",textarea:"#text",tfoot:"tr",th:"phrasing",thead:"tr",time:"phrasing",title:"#text",tr:["th","td"],track:"empty",u:"phrasing",ul:"li","var":"phrasing",video:"source",wbr:"empty"},blockLevelElements:"p h1 h2 h3 h4 h5 h6 blockquote div pre".split(" "),listElements:["li","ol","ul"],split:function(t,n,r){var i=e(t.startContainer),s=t.startOffset,o,u,a,f,l,c,h,p,d;r&&(i=e(t.endContainer),s=t.endOffset);1>n.length&&(n=e(document.body));r=!t.isCollapsed()&&!r;u=i.parents().get();u.unshift(i.get(0));e.each(u,function(e,t){if(n.filter(function(){return this==t}).length){e>0&&(o=u.slice(0,e));return!1}});if(!o)return!0;o=o.reverse();i=0;for(c=o.length;i<c;++i)if(h=o[i],i===c-1)3===h.nodeType?(l=document.createTextNode(h.data.substring(s,h.data.length)),h.data=h.data.substring(0,s)):(p=e(h),l=p.contents(),p=p.clone(!1).empty(),l=p.append(l.slice(s,l.length)).get(0)),r&&t.endContainer===h&&(t.endContainer=l,t.endOffset-=s,t.clearCaches()),f?f.prepend(l):e(h).after(l);else{p=e(h).clone(!1).empty();a?f.prepend(p):a=p;for(f=p;;){d=o[i+1].nextSibling;if(!d)break;f.append(d)}if(r&&t.endContainer===h){t.endContainer=p.get(0);h=o[i+1];for(p=0;;){h=h.previousSibling;if(!h)break;p++}t.endOffset-=p;t.clearCaches()}}e(o[0]).after(a);return e([o[0],a?a.get(0):l])},allowsNesting:function(t,n){if(!t||!t.nodeName||!n||!n.nodeName)return!1;var r=t.nodeName.toLowerCase(),i=n.nodeName.toLowerCase();return this.children[r]?this.children[r]==i||e.isArray(this.children[r])&&0<=e.inArray(i,this.children[r])||e.isArray(this.tags[this.children[r]])&&0<=e.inArray(i,this.tags[this.children[r]])?!0:!1:!1},addMarkup:function(t,n,r){3===t.startContainer.nodeType&&0<t.startOffset&&t.startOffset<t.startContainer.data.length&&this.split(t,e(t.startContainer).parent(),!1);3===t.endContainer.nodeType&&0<t.endOffset&&t.endOffset<t.endContainer.data.length&&this.split(t,e(t.endContainer).parent(),!0);this.recursiveAddMarkup(t.getRangeTree(),n,t,r);this.doCleanup({merge:!0,removeempty:!0},t)},recursiveAddMarkup:function(t,n,i,s){var o,u,i=0;for(u=t.length;i<u;++i)"full"==t[i].type&&this.allowsNesting(n.get(0),t[i].domobj)?(s||t[i].domobj.nodeName!=n.get(0).nodeName)&&(3!==t[i].domobj.nodeType||0!==e.trim(t[i].domobj.data).length)&&(e(t[i].domobj).wrap(n),!s&&3!==t[i].domobj.nodeType&&(o=new r.Utils.RangeObject,o.startContainer=o.endContainer=t[i].domobj.parentNode,o.startOffset=0,o.endOffset=o.endContainer.childNodes.length,this.removeMarkup(o,n,e(t[i].domobj.parentNode)))):(s||t[i].domobj&&t[i].domobj.nodeName!==n.get(0).nodeName)&&t[i].children&&0<t[i].children.length&&this.recursiveAddMarkup(t[i].children,n)},findHighestElement:function(e,t,n){for(var t=t.toLowerCase(),r,i=e,e=n?function(){return n.filter(function(){return i==this}).length}:function(){return!1};!e()&&i;)i.nodeName.toLowerCase()===t&&(r=i),i=i.parentNode;return r},removeMarkup:function(t,n,r){var i=n.get(0).nodeName,s=this.findHighestElement(t.startContainer,i,r),o=this.findHighestElement(t.endContainer,i,r),u=!1;s&&0<t.startOffset&&(this.split(t,e(s).parent(),!1),u=!0);o&&(3===t.endContainer.nodeType&&t.endOffset<t.endContainer.data.length&&(this.split(t,e(o).parent(),!0),u=!0),1===t.endContainer.nodeType&&t.endOffset<t.endContainer.childNodes.length)&&(this.split(t,e(o).parent(),!0),u=!0);u&&t.correctRange();if(r=(r=this.findHighestElement(t.getCommonAncestorContainer(),i,r))?r.parentNode:t.getCommonAncestorContainer())i=t.getRangeTree(r),this.recursiveRemoveMarkup(i,n),this.doCleanup({merge:!0,removeempty:!0},t,r)},recursiveRemoveMarkup:function(t,n){var r,i,s;r=0;for(i=t.length;r<i;++r)"full"==t[r].type&&t[r].domobj.nodeName==n.get(0).nodeName&&(s=e(t[r].domobj).contents(),0<s.length?s.first().unwrap():e(t[r].domobj).remove()),t[r].children&&this.recursiveRemoveMarkup(t[r].children,n)},doCleanup:function(t,n,i){var s=this,o,u,a,f,l;"undefined"==typeof t&&(t={});"undefined"==typeof t.merge&&(t.merge=!1);"undefined"==typeof t.removeempty&&(t.removeempty=!1);"undefined"==typeof i&&n&&(i=n.getCommonAncestorContainer());u=o=!1;a=e(i);f=n.startOffset;l=n.endOffset;a.contents().each(function(){var i,h;try{h=this.nodeType;i=s.getIndexInParent(this)}catch(p){return}switch(h){case 1:if(
o&&o.nodeName==this.nodeName){if(n.startContainer===a&&f>i){n.startOffset=n.startOffset-1;u=!0}if(n.endContainer===a&&l>i){n.endOffset=n.endOffset-1;u=!0}e(o).append(e(this).contents());u|=s.doCleanup(t,n,o);e(this).remove()}else{u|=s.doCleanup(t,n,this);h=!1;if(t.removeempty){r.Utils.Dom.isBlockLevelElement(this)&&this.childNodes.length===0&&(h=!0);e.inArray(this.nodeName.toLowerCase(),s.mergeableTags)>=0&&e(this).text().length===0&&this.childNodes.length===0&&(h=!0)}if(h){if(n.startContainer===this.parentNode&&f>i){n.startOffset=n.startOffset-1;u=!0}if(n.endContainer===this.parentNode&&l>i){n.endOffset=n.endOffset-1;u=!0}e(this).remove()}else o=e.inArray(this.nodeName.toLowerCase(),s.mergeableTags)>=0?this:!1}break;case 3:if(o&&o.nodeType===3&&t.merge){if(n.startContainer===this){n.startContainer=o;n.startOffset=n.startOffset+o.nodeValue.length;u=!0}else if(n.startContainer===o.parentNode&&n.startOffset===s.getIndexInParent(o)+1){n.startContainer=o;n.startOffset=o.nodeValue.length;u=!0}if(n.endContainer===this){n.endContainer=o;n.endOffset=n.endOffset+o.nodeValue.length;u=!0}else if(n.endContainer===o.parentNode&&n.endOffset===s.getIndexInParent(o)+1){n.endContainer=o;n.endOffset=o.nodeValue.length;u=!0}o.data=o.data+this.data}else if((this.nodeValue!==""||!t.removeempty)&&(this.nodeValue!==""||!t.removeempty)){o=this;break}if(n.startContainer===this.parentNode&&n.startOffset>i){n.startOffset=n.startOffset-1;u=!0}if(n.endContainer===this.parentNode&&n.endOffset>i){n.endOffset=n.endOffset-1;u=!0}e(this).remove();if(o&&(!o.nextSibling||o.nextSibling.nodeType!==3))for(i=o.data.length-1;i>=0&&o.data.length>1;i--)if(o.data.charAt(i)==="​"){o.deleteData(i,1);if(n.startContainer===o&&n.startOffset>i){n.startOffset--;u=!0}if(n.endContainer===o&&n.endOffset>i){n.endOffset--;u=!0}}}});u&&n.clearCaches();return u},getIndexInParent:function(e){if(!e)return!1;for(var t=0,e=e.previousSibling;e;)t++,e=e.previousSibling;return t},isBlockLevelElement:function(t){return t?1===t.nodeType&&0<=e.inArray(t.nodeName.toLowerCase(),this.blockLevelElements)?!0:!1:!1},isLineBreakElement:function(e){return e?1===e.nodeType&&"br"==e.nodeName.toLowerCase():!1},isListElement:function(t){return t?1===t.nodeType&&0<=e.inArray(t.nodeName.toLowerCase(),this.listElements):!1},isSplitObject:function(e){return 1===e.nodeType&&i.hasOwnProperty(e.nodeName)},searchAdjacentTextNode:function(t,n,r,i){if(!t||1!==t.nodeType||0>n||n>t.childNodes.length)return!1;"undefined"==typeof i&&(i={blocklevel:!0,list:!0,linebreak:!0});"undefined"==typeof i.blocklevel&&(i.blocklevel=!0);"undefined"==typeof i.list&&(i.list=!0);"undefined"==typeof i.linebreak&&(i.linebreak=!0);"undefined"==typeof r&&(r=!0);var s,o=t;r&&0<n&&(s=t.childNodes[n-1]);for(!r&&n<t.childNodes.length&&(s=t.childNodes[n]);o;)if(s){if(3===s.nodeType&&0<e.trim(s.data).length)return s;if(i.blocklevel&&this.isBlockLevelElement(s)||i.linebreak&&this.isLineBreakElement(s)||i.list&&this.isListElement(s))return!1;3===s.nodeType?s=r?s.previousSibling:s.nextSibling:(o=s,s=r?s.lastChild:s.firstChild)}else{if(i.blocklevel&&this.isBlockLevelElement(o)||i.list&&this.isListElement(o))return!1;s=r?o.previousSibling:o.nextSibling;o=o.parentNode}},insertIntoDOM:function(t,n,r,i,s){var o=n.getContainerParents(r,i),u=this,a;r||(r=e(document.body));0===o.length?a=r.get(0):e.each(o,function(e,n){if(u.allowsNesting(n,t.get(0)))return a=n,!1});"undefined"==typeof a&&0<r.length&&(a=r.get(0));if((this.allowsNesting(a,t.get(0))||s)&&"undefined"!=typeof a){r=this.split(n,e(a),i);if(!0===r)return r=n.startContainer,s=n.startOffset,i&&(r=n.endContainer,s=n.endOffset),0===s?(n=e(r).contents(),0<n.length?n.eq(0).before(t):e(r).append(t)):e(r).contents().eq(s-1).after(t),!0;if(r)return r.eq(0).after(t),!0}return!1},removeFromDOM:function(t,n,r){if(r){var r=this.getIndexInParent(t),i=e(t).contents().length,s=t.parentNode;n.startContainer==s&&n.startOffset>r?n.startOffset+=i-1:n.startContainer==t&&(n.startContainer=s,n.startOffset=r+n.startOffset);n.endContainer==s&&n.endOffset>r?n.endOffset+=i-1:n.endContainer==t&&(n.endContainer=s,n.endOffset=r+n.endOffset);e(t).contents().unwrap();this.doCleanup({merge:!0},n,s)}},removeRange:function(t){if(!t||t.isCollapsed())return!1;3==t.startContainer.nodeType&&0<t.startOffset&&t.startOffset<t.startContainer.data.length&&this.split(t,e(t.startContainer).parent(),!1);3==t.endContainer.nodeType&&0<t.endOffset&&t.endOffset<t.endContainer.data.length&&this.split(t,e(t.endContainer).parent(),!0);var n=t.getRangeTree();t.endContainer=t.startContainer;t.endOffset=t.startOffset;this.recursiveRemoveRange(n,t);this.doCleanup({merge:!0},t);t.clearCaches()},recursiveRemoveRange:function(t,n){for(var r=0;r<t.length;++r)"full"==t[r].type?(0<e(n.startContainer).parents().andSelf().filter(t[r].domobj).length&&(n.startContainer=n.endContainer=t[r].domobj.parentNode,n.startOffset=n.endOffset=this.getIndexInParent(t[r].domobj)),e(t[r].domobj).remove()):"partial"==t[r].type&&t[r].children&&this.recursiveRemoveRange(t[r].children,n)},extendToWord:function(e,t){var n=this.searchWordBoundary(e.startContainer,e.startOffset,!0),r=this.searchWordBoundary(e.endContainer,e.endOffset,!1);if(t||!(e.startContainer==n.container&&e.startOffset==n.offset||e.endContainer==r.container&&e.endOffset==r.offset))e.startContainer=n.container,e.startOffset=n.offset,e.endContainer=r.container,e.endOffset=r.offset,e.correctRange(),e.clearCaches()},isWordBoundaryElement:function(t){return!t||!t.nodeName?!1:-1==e.inArray(t.nodeName.toLowerCase(),this.nonWordBoundaryTags)},searchWordBoundary:function(e,t,n){"undefined"==typeof n&&(n=!0);for(var r=!1,i,s;!r;)if(3===e.nodeType)if(n){for(s=i=e.data.substring(0,t).search(this.nonWordRegex);-1!=s;)i=s,s=e.data.substring(i+1,t).search(this.nonWordRegex),-1!=s&&(s=s+i+1);-1!=i?(t=i+1,r=!0):(t=this.getIndexInParent(e),e=e.parentNode)}else i=e.data.substring(t).search(this.nonWordRegex),-1!=i?(t+=i,r=!0):(t=this.getIndexInParent(e)+1,e=e.parentNode);else 1===e.nodeType&&(n?0<t?this.isWordBoundaryElement(e.childNodes[t-1])?r=!0:(e=e.childNodes[t-1],t=3===e.nodeType?e.data.length:e.childNodes.length):this.isWordBoundaryElement(e)?r=!0:(t=this.getIndexInParent(e),e=e.parentNode):t<e.childNodes.length?this.isWordBoundaryElement(e.childNodes[t])?r=!0:(e=e.childNodes[t],t=0):this.isWordBoundaryElement(e)?r=!0:(t=this.getIndexInParent(e)+1,e=e.parentNode));3!==e.nodeType&&(r=this.searchAdjacentTextNode(e,t,!n))&&(e=r,t=n?0:e.data.length);return{container:e,offset:t}},isEmpty:function(t){if(!t)return!0;if(-1!=e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags))return!1;if(3===t.nodeType)return-1==t.data.search(/\S/);for(var n=0,r=t.childNodes.length;n<r;++n)if(!this.isEmpty(t.childNodes[n]))return!1;return!0},setCursorAfter:function(e){var t=new r.Utils.RangeObject;this.getIndexInParent(e);var n;3==e.nodeType?(n=e,e=n.nodeValue.length):e.nextSibling&&3==e.nextSibling.nodeType?(n=e.nextSibling,e=0):(n=e.parentNode,e=this.getIndexInParent(e)+1);t.startContainer=t.endContainer=n;t.startOffset=t.endOffset=e;t.select();return t},selectDomNode:function(e){var t=new r.Utils.RangeObject;t.startContainer=t.endContainer=e.parentNode;t.startOffset=this.getIndexInParent(e);t.endOffset=t.startOffset+1;t.select()},setCursorInto:function(e){var t=new r.Utils.RangeObject;t.startContainer=t.endContainer=e;t.startOffset=t.endOffset=0;t.select()},isEditingHost:function(e){return e&&1==e.nodeType&&("true"==e.contentEditable||e.parentNode&&9==e.parentNode.nodeType&&"on"==e.parentNode.designMode)},isEditable:function(e){return e&&!this.isEditingHost(e)&&(1!=e.nodeType||"false"!=e.contentEditable)&&(this.isEditingHost(e.parentNode)||this.isEditable(e.parentNode))},getEditingHostOf:function(e){if(this.isEditingHost(e))return e;if(this.isEditable(e)){for(e=e.parentNode;!this.isEditingHost(e);)e=e.parentNode;return e}return null},inSameEditingHost:function(e,t){return this.getEditingHostOf(e)&&this.getEditingHostOf(e)==this.getEditingHostOf(t)},isBlockNode:function(e){return e&&(e.nodeType==n.Node.ELEMENT_NODE&&-1==n(["inline","inline-block","inline-table","none"]).indexOf(n.getComputedStyle(e).display)||e.nodeType==n.Node.DOCUMENT_NODE||e.nodeType==n.Node.DOCUMENT_FRAGMENT_NODE)},getFirstVisibleChild:function(t,r){if(!t||t.nodeType==n.Node.TEXT_NODE&&this.isEmpty(t)||t.nodeType==n.Node.ELEMENT_NODE&&0==t.offsetHeight&&-1===e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(t.nodeType==n.Node.TEXT_NODE||t.nodeType==n.Node.ELEMENT_NODE&&0==t.childNodes.length||!e(t).contentEditable())return r?t:null;for(var i=0;i<t.childNodes.length;++i){var s=this.getFirstVisibleChild(t.childNodes[i],!0);if(null!=s)return s}return null},getLastVisibleChild:function(t,r){if(!t||t.nodeType==n.Node.TEXT_NODE&&this.isEmpty(t)||t.nodeType==n.Node.ELEMENT_NODE&&0==t.offsetHeight&&-1===e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags))return null;if(t.nodeType==n.Node.TEXT_NODE||t.nodeType==n.Node.ELEMENT_NODE&&0==t.childNodes.length||!e(t).contentEditable())return r?t:null;for(var i=t.childNodes.length-1;0<=i;--i){var s=this.getLastVisibleChild(t.childNodes[i],!0);if(null!=s)return s}return null}});r.Utils.Dom=new t;return r.Utils.Dom});define("aloha/pluginmanager",["jquery","util/class"],function(e,t){return new(t.extend({plugins:{},init:function(e,t){var n=Aloha&&Aloha.settings?Aloha.settings.plugins||{}:{},r,i;for(i in n)n.hasOwnProperty(i)&&(r=this.plugins[i]||!1)&&(r.settings=n[i]||{});if(!t.length)for(i in this.plugins)this.plugins.hasOwnProperty(i)&&t.push(i);for(n=0;n<t.length;++n)if(i=t[n],r=this.plugins[i]||!1)r.settings=r.settings||{},"undefined"==typeof r.settings.enabled&&(r.settings.enabled=!0),r.settings.enabled&&r.checkDependencies()&&r.init();e()},register:function(e){if(!e.name)throw Error("Plugin does not have an name.");if(this.plugins[e.name])throw Error('Already registered the plugin "'+e.name+'"!');this.plugins[e.name]=e},makeClean:function(e){for(var t in this.plugins)this.plugins.hasOwnProperty(t)&&(Aloha.Log.isDebugEnabled()&&Aloha.Log.debug(this,"Passing contents of HTML Element with id { "+e.attr("id")+" } for cleaning to plugin { "+t+" }"),this.plugins[t].makeClean(e))},toString:function(){return"pluginmanager"}}))});define("aloha/core",["jquery","aloha/pluginmanager"],function(e,t){e.extend(!0,Aloha,{version:"0.22.0",editables:[],activeEditable:null,settings:{},defaults:{},ui:{},OSName:"Unknown",stage:"loadingAloha",loadedPlugins:[],_pluginBaseUrlByName:{},init:function(){Aloha.stage="initAloha";Aloha.initAloha(function(){Aloha.stage="initPlugins";Aloha.initPlugins(function(){Aloha.stage="initGui";Aloha.initGui(function(){Aloha.stage="alohaReady";Aloha.trigger("aloha-ready")})})})},getLoadedPlugins:function(){return this.loadedPlugins},isPluginLoaded:function(t){var n=!1;e.each(this.loadedPlugins,function(){t.toString()===this.toString()&&(n=!0)});return n},initAloha:function(t){var n=e("html");(e.browser.webkit&&parseFloat(e.browser.version)<532.5||e.browser.mozilla&&parseFloat(e.browser.version)<1.9||e.browser.msie&&e.browser.version<7||e.browser.opera&&e.browser.version<11)&&window.console&&window.console.log&&window.console.log("Your browser is not supported.");e("html").mousedown(function(){if(Aloha.activeEditable&&!e(".aloha-dialog").is(":visible")&&!Aloha.eventHandled){Aloha.activeEditable.blur();Aloha.activeEditable=null}}).mouseup(function(){Aloha.eventHandled=!1});e.browser.webkit?n.addClass("aloha-webkit"):e.browser.opera?n.addClass("aloha-opera"):e.browser.msie?n.addClass("aloha-ie"+parseInt(e.browser.version,10)):e.browser.mozilla&&n.addClass("aloha-mozilla");Aloha.settings.base=Aloha.getAlohaUrl();Aloha.Log.init();Aloha.settings.errorhandling&&(window.onerror=function(e,t,n){Aloha.Log.error(Aloha,"Error message: "+e+"\nURL: "+t+"\nLine Number: "+n);return!0});navigator.appVersion.indexOf("Win")!=-1&&(Aloha.OSName="Win");navigator.appVersion.indexOf("Mac")!=-1&&(Aloha.OSName="Mac");navigator.appVersion.indexOf("X11")!=-1&&(Aloha.OSName="Unix");navigator.appVersion.indexOf("Linux")!=-1&&(Aloha.OSName="Linux");try{var r;try{r=document.queryCommandSupported("enableObjectResizing")}catch(i){r=!1;Aloha.Log.log("enableObjectResizing is not supported.")}if(r){document.execCommand("enableObjectResizing",!1,!1);Aloha.Log.log("enableObjectResizing disabled.")}}catch(s){Aloha.Log.error(s,"Could not disable enableObjectResizing")}t()},initPlugins:function(e){t.init(e,this.getLoadedPlugins())},initGui:function(e){Aloha.RepositoryManager.init();for(var t=0,n=Aloha.editables.length;t<n;t++)Aloha.editables[t].ready||Aloha.editables[t].init();e()},activateEditable:function(e){for(var t=0,n=Aloha.editables.length;t<n;t++)Aloha.editables[t]!=e&&Aloha.editables[t].isActive&&Aloha.editables[t].blur();Aloha.activeEditable=e},getActiveEditable:function(){return Aloha.activeEditable},deactivateEditable:function(){if(typeof Aloha.activeEditable!="undefined"&&Aloha.activeEditable!==null){Aloha.activeEditable.blur();Aloha.activeEditable=null}},getEditableById:function(t){e("#"+t).get(0).nodeName.toLowerCase()==="textarea"&&(t+="-aloha");for(var n=0,r=Aloha.editables.length;n<r;n++)if(Aloha.editables[n].getId()==t)return Aloha.editables[n];return null},isEditable:function(e){for(var t=0,n=Aloha.editables.length;t<n;t++)if(Aloha.editables[t].originalObj.get(0)===e)return!0;return!1},log:function(e,t,n){typeof Aloha.Log!="undefined"&&Aloha.Log.log(e,t,n)},registerEditable:function(e){Aloha.editables.push(e)},unregisterEditable:function(t){t=e.inArray(t,Aloha.editables);t!=-1&&Aloha.editables.splice(t,1)},toString:function(){return"Aloha"},isModified:function(){for(var e=0;e<Aloha.editables.length;e++)if(Aloha.editables[e].isModified&&Aloha.editables[e].isModified())return!0;return!1},getAlohaUrl:function(){return Aloha.settings.baseUrl},getPluginUrl:function(e){var t;e&&(t=Aloha.settings._pluginBaseUrlByName[e])&&(t.match("^(/|http[s]?:).*")||(t=Aloha.getAlohaUrl()+"/"+t));return t}});return Aloha});define("aloha/console",["aloha/core","util/class","jquery"],function(e,t){var n=window.console,r=t.extend({init:function(){if("undefined"==typeof e.settings.logLevels||!e.settings.logLevels)e.settings.logLevels={error:!0,warn:!0};if("undefined"==typeof e.settings.logHistory||!e.settings.logHistory)e.settings.logHistory={};e.settings.logHistory.maxEntries||(e.settings.logHistory.maxEntries=100);e.settings.logHistory.highWaterMark||(e.settings.logHistory.highWaterMark=90);e.settings.logHistory.levels||(e.settings.logHistory.levels={error:!0,warn:!0});this.flushLogHistory();e.trigger("aloha-logger-ready")},logHistory:[],highWaterMarkReached:!1,log:function(t,r,i){"undefined"==typeof r&&(i=t);"string"!=typeof r&&r&&r.toString&&(r=r.toString());"undefined"==typeof i&&(i=r,r=void 0);if("undefined"==typeof t||!t)t="log";t=t.toLowerCase();if("undefined"!=typeof e.settings.logLevels&&e.settings.logLevels[t])switch(r=r||"Unkown Aloha Component",this.addToLogHistory({level:t,component:r,message:i,date:new Date}),t){case"error":window.console&&n.error&&(!r&&!i?n.error("Error occured without message and component"):n.error(r+": "+i));break;case"warn":window.console&&n.warn&&n.warn(r+": "+i);break;case"info":window.console&&n.info&&n.info(r+": "+i);break;case"debug":window.console&&n.log&&n.log(r+" ["+t+"]: "+i);break;default:window.console&&n.log&&n.log(r+" ["+t+"]: "+i)}},error:function(e,t){this.log("error",e,t)},warn:function(e,t){this.log("warn",e,t)},info:function(e,t){this.log("info",e,t)},debug:function(e,t){this.log("debug",e,t)},deprecated:function(t,n){this.log("warn",t,n);if(e.settings.logLevels.deprecated)throw Error(n)},isLogLevelEnabled:function(t){return e.settings&&e.settings.logLevels&&e.settings.logLevels[t]},isErrorEnabled:function(){return this.isLogLevelEnabled("error")},isWarnEnabled:function(){return this.isLogLevelEnabled("warn")},isInfoEnabled:function(){return this.isLogLevelEnabled("info")},isDebugEnabled:function(){return this.isLogLevelEnabled("debug")},addToLogHistory:function(t){e.settings.logHistory||this.init();if(!(0>=e.settings.logHistory.maxEntries)&&e.settings.logHistory.levels[t.level]){this.logHistory.push(t);!this.highWaterMarkReached&&this.logHistory.length>=e.settings.logHistory.maxEntries*e.settings.logHistory.highWaterMark/100&&(e.trigger("aloha-log-full"),this.highWaterMarkReached=!0);for(;this.logHistory.length>e.settings.logHistory.maxEntries;)this.logHistory.shift()}},getLogHistory:function(){return this.logHistory},flushLogHistory:function(){this.logHistory=[];this.highWaterMarkReached=!1}}),r=new r;return e.Log=e.Console=r});GENTICS=window.GENTICS||{};GENTICS.Utils=GENTICS.Utils||{};define("util/range",["jquery","util/dom","util/class","aloha/console","aloha/rangy-core"],function(e,t,n,r,i){function s(e,t){var n=[],r;for(r=1===e.nodeType?e:e.parentNode;r&&r!==t&&9!==r.nodeType;)1===r.nodeType&&n.push(r),r=r.parentNode;return n}function s(e,t){var n=[],r;for(r=1===e.nodeType?e:e.parentNode;r&&r!==t&&9!==r.nodeType;)1===r.nodeType&&n.push(r),r=r.parentNode;return n}var o=window.GENTICS;o.Utils.RangeObject=n.extend({_constructor:function(e){if("object"==typeof e){if("undefined"!=typeof e.startContainer&&(this.startContainer=e.startContainer),"undefined"!=typeof e.startOffset&&(this.startOffset=e.startOffset),"undefined"!=typeof e.endContainer&&(this.endContainer=e.endContainer),"undefined"!=typeof e.endOffset)this.endOffset=e.endOffset}else!0===e&&this.initializeFromUserSelection()},startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0,deleteContents:function(){t.removeRange(this)},log:function(e){r.deprecated("Utils.RangeObject",'log() is deprecated. use console.log() from module "aloha/console" instead: '+e)},isCollapsed:function(){return!this.endContainer||this.startContainer===this.endContainer&&this.startOffset===this.endOffset},getCommonAncestorContainer:function(){if(this.commonAncestorContainer)return this.commonAncestorContainer;this.updateCommonAncestorContainer();return this.commonAncestorContainer},getContainerParents:function(t,n){var r=n?this.endContainer:this.startContainer;return r?e(s(r,t?t[0]:null)):!1},getStartContainerParents:function(e){return this.getContainerParents(e,!1)},getEndContainerParents:function(e){return this.getContainerParents(e,!0)},updateCommonAncestorContainer:function(e){if(e)this.commonAncestorContainer=e;else{var t=this.getStartContainerParents(),n=this.getEndContainerParents(),i;if(!(0<t.length&&0<n.length))return r.warn("aloha/range","could not find commonAncestorContainer"),!1;for(i=0;i<t.length;i++)if(-1!=n.index(t[i])){this.commonAncestorContainer=t[i];break}}r.debug(e?"commonAncestorContainer was set successfully":"commonAncestorContainer was calculated successfully");return!0},getCollapsedIERange:function(e,t){var n=document.body.createTextRange(),r,i,s;s=this.searchElementToLeft(e,t);s.element?(r=document.body.createTextRange(),r.moveToElementText(s.element),n.setEndPoint("StartToEnd",r),0!==s.characters?n.moveStart("character",s.characters):(n.moveStart("character",1),n.moveStart("character",-1))):(this.searchElementToRight(e,t),i=3==e.nodeType?e.parentNode:e,r=document.body.createTextRange(),r.moveToElementText(i),n.setEndPoint("StartToStart",r),0!==s.characters&&n.moveStart("character",s.characters));n.collapse();return n},select:function(){var e;if("undefined"==typeof this.startContainer||"undefined"==typeof this.endContainer)return r.warn("can not select an empty range"),!1;e=i.createRange();e.setStart(this.startContainer,this.startOffset);e.setEnd(this.endContainer,this.endOffset);i.getSelection().setSingleRange(e)},searchElementToLeft:function(e,t){var n,r=0;3===e.nodeType?(r=t,n=e.previousSibling):0<t&&(n=e.childNodes[t-1]);for(;n&&3===n.nodeType;)r+=n.data.length,n=n.previousSibling;return{element:n,characters:r}},searchElementToRight:function(e,t){var n,r=0;3===e.nodeType?(r=e.data.length-t,n=e.nextSibling):t<e.childNodes.length&&(n=e.childNodes[t]);for(;n&&3===n.nodeType;)r+=n.data.length,n=n.nextSibling;return{element:n,characters:r}},update:function(e){r.debug("now updating rangeObject");this.initializeFromUserSelection(e);this.updateCommonAncestorContainer()},initializeFromUserSelection:function(){var e=i.getSelection();if(!e||!e.rangeCount)return!1;e=e.getRangeAt(0);if(!e)return!1;this.startContainer=e.startContainer;this.endContainer=e.endContainer;this.startOffset=e.startOffset;this.endOffset=e.endOffset;this.correctRange()},correctRange:function(){var e,t;this.clearCaches();if(this.isCollapsed()){if(1===this.startContainer.nodeType){if(0<this.startOffset&&3===this.startContainer.childNodes[this.startOffset-1].nodeType){this.startContainer=this.startContainer.childNodes[this.startOffset-1];this.startOffset=this.startContainer.data.length;this.endContainer=this.startContainer;this.endOffset=this.startOffset;return}if(0<this.startOffset&&1===this.startContainer.childNodes[this.startOffset-1].nodeType){if(e=o.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!0)){this.startContainer=this.endContainer=e;this.startOffset=this.endOffset=e.data.length;return}if(e=o.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!1)){this.startContainer=this.endContainer=e;this.startOffset=this.endOffset=0;return}}if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType){this.startContainer=this.startContainer.childNodes[this.startOffset];this.startOffset=0;this.endContainer=this.startContainer;this.endOffset=0;return}}3===this.startContainer.nodeType&&0===this.startOffset&&(e=o.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,o.Utils.Dom.getIndexInParent(this.startContainer),!0))&&(this.startContainer=this.endContainer=e,this.startOffset=this.endOffset=e.data.length)}else{if(1===this.startContainer.nodeType)if(this.startOffset<this.startContainer.childNodes.length&&3===this.startContainer.childNodes[this.startOffset].nodeType)this.startContainer=this.startContainer.childNodes[this.startOffset],this.startOffset=0;else if(this.startOffset<this.startContainer.childNodes.length&&1===this.startContainer.childNodes[this.startOffset].nodeType){e=!1;for(t=this.startContainer.childNodes[this.startOffset];!1===e&&t.childNodes&&0<t.childNodes.length;)t=t.childNodes[0],3===t.nodeType&&(e=t);!1!==e&&(this.startContainer=e,this.startOffset=0)}3===this.startContainer.nodeType&&this.startOffset===this.startContainer.data.length&&(e=o.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,o.Utils.Dom.getIndexInParent(this.startContainer)+1,!1))&&(this.startContainer=e,this.startOffset=0);if(3===this.endContainer.nodeType&&0===this.endOffset)if(this.endContainer.previousSibling&&3===this.endContainer.previousSibling.nodeType)this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length;else if(this.endContainer.previousSibling&&1===this.endContainer.previousSibling.nodeType&&this.endContainer.parentNode){e=this.endContainer.parentNode;for(t=0;t<e.childNodes.length;++t)if(e.childNodes[t]==this.endContainer){this.endOffset=t;break}this.endContainer=e}1==this.endContainer.nodeType&&0===this.endOffset&&this.endContainer.previousSibling&&(3===this.endContainer.previousSibling.nodeType?(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length):1===this.endContainer.previousSibling.nodeType&&this.endContainer.previousSibling.childNodes&&0<this.endContainer.previousSibling.childNodes.length&&(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.childNodes.length));if(1==this.endContainer.nodeType)if(0<this.endOffset&&3===this.endContainer.childNodes[this.endOffset-1].nodeType)this.endContainer=this.endContainer.childNodes[this.endOffset-1],this.endOffset=this.endContainer.data.length;else if(0<this.endOffset&&1===this.endContainer.childNodes[this.endOffset-1].nodeType){e=!1;for(t=this.endContainer.childNodes[this.endOffset-1];!1===e&&t.childNodes&&0<t.childNodes.length;)t=t.childNodes[t.childNodes.length-1],3===t.nodeType&&(e=t);!1!==e&&(this.endContainer=e,this.endOffset=this.endContainer.data.length)}}},clearCaches:function(){this.commonAncestorContainer=void 0},getRangeTree:function(e){"undefined"==typeof e&&(e=this.getCommonAncestorContainer());this.inselection=!1;return this.recursiveGetRangeTree(e)},recursiveGetRangeTree:function(t){var n=0,r=this,i=[];e(t).contents().each(function(e){var s="none",u=!1,f=!1,l=!1,h=!1,p=!1,v=!1;r.isCollapsed()&&t===r.startContainer&&r.startOffset===e&&(i[n]=new o.Utils.RangeTree,i[n].type="collapsed",i[n].domobj=void 0,r.inselection=!1,l=!0,n++);if(!r.inselection&&!l)switch(this.nodeType){case 3:this===r.startContainer&&(r.inselection=!0,s=0<r.startOffset?"partial":"full",u=r.startOffset,f=this.length);break;case 1:if(this===r.startContainer&&0===r.startOffset&&(r.inselection=!0,s="full"),t===r.startContainer&&r.startOffset===e)r.inselection=!0,s="full"}if(r.inselection&&!l){"none"==s&&(s="full");switch(this.nodeType){case 3:this===r.endContainer&&(r.inselection=!1,r.endOffset<this.length&&(s="partial"),!1===u&&(u=0),f=r.endOffset);break;case 1:this===r.endContainer&&0===r.endOffset&&(r.inselection=!1)}t===r.endContainer&&r.endOffset<=e&&(r.inselection=!1,s="none")}i[n]=new o.Utils.RangeTree;i[n].domobj=this;i[n].type=s;"partial"==s&&(i[n].startOffset=u,i[n].endOffset=f);i[n].children=r.recursiveGetRangeTree(this);if(0<i[n].children.length){for(e=0;e<i[n].children.length;++e)switch(i[n].children[e].type){case"none":h=!0;break;case"full":v=!0;break;case"partial":p=!0}p||v&&h?i[n].type="partial":v&&!p&&!h&&(i[n].type="full")}n++});this.isCollapsed()&&t===this.startContainer&&this.startOffset==t.childNodes.length&&(i[n]=new o.Utils.RangeTree,i[n].type="collapsed",i[n].domobj=void 0);return i},findMarkup:function(e,t,n){var n=n?this.endContainer:this.startContainer,t=t?t[0]:null,r;if(n){t=s(n,t);n=0;for(r=t.length;n<r;n++)if(e.apply(t[n]))return t[n];return!1}},getText:function(){return this.isCollapsed()?"":this.recursiveGetText(this.getRangeTree())},recursiveGetText:function(t){if(t){var n=this,r="";e.each(t,function(){"full"==this.type?r+=e(this.domobj).text():"partial"==this.type&&3===this.domobj.nodeType?r+=e(this.domobj).text().substring(this.startOffset,this.endOffset):"partial"==this.type&&1===this.domobj.nodeType&&this.children&&(r+=n.recursiveGetText(this.children))});return r}return""}});o.Utils.RangeTree=n.extend({domobj:{},type:null,children:[]});return o.Utils.RangeObject});define("util/arrays",[],function(){function e(e,t){var n,r,i=[];n=0;for(r=e.length;n<r;n++)i.push(t(e[n]));return i}function t(e,t){return e.map(t)}return{sortUnique:function(e,t){var n;if(t){e.sort(t);for(n=1;n<e.length;n++)0===t(e[n],e[n-1])&&e.splice(n--,1)}else{e.sort();for(n=1;n<e.length;n++)e[n]==e[n-1]&&e.splice(n--,1)}return e},equal:function(e,t,n){var r=0,i=e.length;if(i!==t.length)return!1;if(n){for(;r<i;r++)if(!n(e[r],t[r]))return!1}else for(;r<i;r++)if(e[r]!==t[r])return!1;return!0},map:Array.prototype.map?t:e}});define("util/strings",["jquery"],function(e){return{words:function(t){t=e.trim(t).split(/[\r\n\t\s]+/);return t.length&&""===t[0]?[]:t},dashesToCamelCase:function(e){return e.replace(/[-]([a-z])/gi,function(e,t){return t.toUpperCase()})},camelCaseToDashes:function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}}});define("PubSub",[],function(){var e={},t={},n=0;return{sub:function(r,i){if("function"!=typeof i)return-1;var s=e[r];s||(s=e[r]=[]);s.push(++n);t[n]={channel:r,callback:i};return n},unsub:function(n){if(-1===n||!t[n])return!1;var r=t[n]&&e[t[n].channel];delete t[n];for(var i=r.length;i;)if(r[--i]===n)return r.splice(i,1),!0;return!1},pub:function(n,r){var i=n.split("."),s,o=i.length,u="",a=0;for(s=0;s<o;++s){var u=u+((0===s?"":".")+i[s]),l,c=u;l=r;if(e[c]){l?"object"!=typeof l&&(l={data:l}):l={};l.channel=c;for(var c=e[c].slice(),h=void 0,h=0;h<c.length;++h)t[c[h]].callback(l);l=h}else l=0;a+=l}return a}}});define("aloha/engine",["aloha/ecma5shims","jquery"],function(e,t){function n(e,t){return e.hasAttribute?e.hasAttribute(t):"undefined"!=typeof e.attributes[t]}function r(e){if(!e)return 0;if(!e.style)return 0;if("undefined"!=typeof e.style.length)return e.style.length;var t=0,n;for(n in e.style)e.style[n]&&0!==e.style[n]&&"false"!==e.style[n]&&t++;return t}function i(e){if(!e)return null;var t=[],n;for(n=e.length>>>0;n--;)t[n]=e[n];return t}function s(e){return e.hasChildNodes()?e.firstChild:u(e)}function o(t){if(t.previousSibling){for(t=t.previousSibling;t.hasChildNodes();)t=t.lastChild;return t}return t.parentNode&&t.parentNode.nodeType==e.Node.ELEMENT_NODE?t.parentNode:null}function u(e){for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null}function a(t,n){return t&&n&&Boolean(e.compareDocumentPosition(t,n)&e.Node.DOCUMENT_POSITION_CONTAINED_BY)}function f(t,n){return n&&t&&Boolean(e.compareDocumentPosition(n,t)&e.Node.DOCUMENT_POSITION_CONTAINED_BY)}function l(t,n){return Boolean(e.compareDocumentPosition(t,n)&e.Node.DOCUMENT_POSITION_FOLLOWING)}function c(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t}function h(e){for(var t=[],n=u(e);(e=s(e))&&e!=n;)t.push(e);return t}function p(e){return{"xx-small":1,small:2,medium:3,large:4,"x-large":5,"xx-large":6,"xxx-large":7}[e]}function d(e){return null===e||!e||e===en}function v(e){return"ltr"==e.dir?"ltr":"rtl"==e.dir?"rtl":M(e.parentNode)?v(e.parentNode):"ltr"}function m(e){for(var t=0;e.previousSibling;)t++,e=e.previousSibling;return t}function g(t){switch(t.nodeType){case e.Node.PROCESSING_INSTRUCTION_NODE:case e.Node.DOCUMENT_TYPE_NODE:return 0;case e.Node.TEXT_NODE:case e.Node.COMMENT_NODE:return t.length;default:return t.childNodes.length}}function y(t,n,r,i){if(t==r){if(n==i)return"equal";if(n<i)return"before";if(n>i)return"after"}var s=e.compareDocumentPosition(r,t);if(s&e.Node.DOCUMENT_POSITION_FOLLOWING){i=y(r,i,t,n);if("before"==i)return"after";if("after"==i)return"before"}if(s&e.Node.DOCUMENT_POSITION_CONTAINS){for(;r.parentNode!=t;)r=r.parentNode;if(m(r)<n)return"after"}return"before"}function b(e){for(;null!=e.parentNode;)e=e.parentNode;return e}function w(e,t){return"after"!==y(e,0,t.startContainer,t.startOffset)||"before"!==y(e,g(e),t.endContainer,t.endOffset)?!1:b(e)==b(t.startContainer)}function E(e,t){"undefined"==typeof t&&(t=function(){return!0});for(var n=e.startContainer,n=n.hasChildNodes()&&e.startOffset<n.childNodes.length?n.childNodes[e.startOffset]:e.startOffset==g(n)?u(n):s(n),r=e.endContainer,r=r.hasChildNodes()&&e.endOffset<r.childNodes.length?r.childNodes[e.endOffset]:u(r),i=[];l(n,r);)w(n,e)&&t(n)?(i.push(n),n=u(n)):n=s(n);return i}function S(e,t){"undefined"==typeof t&&(t=function(){return!0});for(var n=e.startContainer,n=n.hasChildNodes()&&e.startOffset<n.childNodes.length?n.childNodes[e.startOffset]:e.startOffset==g(n)?u(n):s(n),r=e.endContainer,r=r.hasChildNodes()&&e.endOffset<r.childNodes.length?r.childNodes[e.endOffset]:u(r),i=[];l(n,r);)w(n,e)&&t(n)&&i.push(n),n=s(n);return i}function x(t){if("currentcolor"==t.toLowerCase())return null;var n=document.createElement("span");document.body.appendChild(n);n.style.color="black";var r=document.createElement("span");n.appendChild(r);r.style.color=t;t=e.getComputedStyle(r).color;if("rgb(0, 0, 0)"==t&&(n.color="white",t=e.getComputedStyle(r).color,"rgb(0, 0, 0)"!=t))return null;document.body.removeChild(n);return/^rgba\([0-9]+, [0-9]+, [0-9]+, 1\)$/.test(t)?t.replace("rgba","rgb").replace(", 1)",")"):"transparent"==t?"rgba(0, 0, 0, 0)":t}function T(t){t=t.toLowerCase();if(-1!=e("aliceblue antiquewhite aqua aquamarine azure beige bisque black blanchedalmond blue blueviolet brown burlywood cadetblue chartreuse chocolate coral cornflowerblue cornsilk crimson cyan darkblue darkcyan darkgoldenrod darkgray darkgreen darkgrey darkkhaki darkmagenta darkolivegreen darkorange darkorchid darkred darksalmon darkseagreen darkslateblue darkslategray darkslategrey darkturquoise darkviolet deeppink deepskyblue dimgray dimgrey dodgerblue firebrick floralwhite forestgreen fuchsia gainsboro ghostwhite gold goldenrod gray green greenyellow grey honeydew hotpink indianred indigo ivory khaki lavender lavenderblush lawngreen lemonchiffon lightblue lightcoral lightcyan lightgoldenrodyellow lightgray lightgreen lightgrey lightpink lightsalmon lightseagreen lightskyblue lightslategray lightslategrey lightsteelblue lightyellow lime limegreen linen magenta maroon mediumaquamarine mediumblue mediumorchid mediumpurple mediumseagreen mediumslateblue mediumspringgreen mediumturquoise mediumvioletred midnightblue mintcream mistyrose moccasin navajowhite navy oldlace olive olivedrab orange orangered orchid palegoldenrod palegreen paleturquoise palevioletred papayawhip peachpuff peru pink plum powderblue purple red rosybrown royalblue saddlebrown salmon sandybrown seagreen seashell sienna silver skyblue slateblue slategray slategrey snow springgreen steelblue tan teal thistle tomato turquoise violet wheat white whitesmoke yellow yellowgreen"
.split(" ")).indexOf(t))return t;t=x(t);return(t=/^rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)$/.exec(t))?"#"+parseInt(t[1]).toString(16).replace(/^.$/,"0$&")+parseInt(t[2]).toString(16).replace(/^.$/,"0$&")+parseInt(t[3]).toString(16).replace(/^.$/,"0$&"):null}function N(e,t,n,r){0==sn&&"undefined"!=typeof n?nn=n:0==sn&&(nn=null,nn=n);if(e in rn){if("enabled"==t||t in rn[e]){sn++;try{var i=r()}catch(s){throw sn--,s}sn--;return i}throw"INVALID_ACCESS_ERR"}throw"NOT_SUPPORTED_ERR"}function C(e,t,n,r){e=e.toLowerCase();if(1==arguments.length||4<=arguments.length&&"undefined"==typeof t)t=!1;if(2>=arguments.length||4<=arguments.length&&"undefined"==typeof n)n="";return N(e,"action",r,function(e,t,n){return function(){if(!k(e))return!1;rn[e].action(n,r);K(r);return!0}}(e,t,n))}function k(e,n){e=e.toLowerCase();return N(e,"action",n,function(e){return function(){return-1!=t.inArray(e,"copy cut paste selectall stylewithcss usecss".split(" "))||null!==n}}(e))}function L(e,t){e=e.toLowerCase();return N(e,"state",t,function(e){return function(){return k(e,t)?"undefined"!=typeof an(e,t)?an(e,t):rn[e].state(t):!1}}(e))}function A(e,t){e=e.toLowerCase();return N(e,"value",t,function(){return k(e,t)?"fontsize"==e&&void 0!==cn("fontsize",t)?xt(cn("fontsize",t)):"undefined"!=typeof cn(e,t)?cn(e,t):rn[e].value(t):""})}function O(t,n){"string"==typeof n&&(n=[n]);"object"==typeof n&&(n=e(n).map(function(e){return e.toUpperCase()}));return t&&1==t.nodeType&&d(t.namespaceURI)&&("undefined"==typeof n||-1!=e(n).indexOf(t.tagName))}function M(e){return e&&1==e.nodeType&&d(e.namespaceURI)}function _(e,t){return e&&1==e.nodeType&&d(e.namespaceURI)&&t.toUpperCase()===e.nodeName}function D(e,t){var n;if(n=e)if(n=1==e.nodeType)if(n=d(e.namespaceURI))e:{n=e.nodeName;var r,i;n=n.toUpperCase();r=0;for(i=t.length;r<i;r++)if(t[r].toUpperCase()===n){n=!0;break e}n=!1}return n}function P(e){return e&&1==e.nodeType&&d(e.namespaceURI)&&on[e.nodeName]}function H(t){return t&&(t.nodeType==e.Node.ELEMENT_NODE&&!un[e.getComputedStyle(t).display]||t.nodeType==e.Node.DOCUMENT_NODE||t.nodeType==e.Node.DOCUMENT_FRAGMENT_NODE)}function B(e){return e&&!H(e)}function j(t){return t&&t.nodeType==e.Node.ELEMENT_NODE&&("true"==t.contentEditable||t.parentNode&&t.parentNode.nodeType==e.Node.DOCUMENT_NODE&&"on"==t.parentNode.designMode)}function F(n){return n&&!j(n)&&(n.nodeType!=e.Node.ELEMENT_NODE||"false"!=n.contentEditable||t(n).hasClass("aloha-table-wrapper"))&&(j(n.parentNode)||F(n.parentNode))}function I(e){for(var t=0;t<e.childNodes.length;t++)if(F(e.childNodes[t])||I(e.childNodes[t]))return!0;return!1}function q(e){if(j(e))return e;if(F(e)){for(e=e.parentNode;!j(e);)e=e.parentNode;return e}return null}function R(e,t){return q(e)&&q(e)==q(t)}function U(n){if(!_(n,"br"))return!1;for(var r=n.parentNode;"inline"==e.getComputedStyle(r).display;)r=r.parentNode;var i=r.style.height,s=r.style.maxHeight,o=r.style.minHeight;r.style.height="auto";r.style.maxHeight="none";t.browser.msie&&8>t.browser.version||(r.style.minHeight="0");var u=document.createTextNode("​"),a=r.offsetHeight;if(0==a)throw"isCollapsedLineBreak: original height is zero, bug?";n.parentNode.insertBefore(u,n.nextSibling);n=r.offsetHeight;u.parentNode.removeChild(u);r.style.height=i;r.style.maxHeight=s;t.browser.msie&&8>t.browser.version||(r.style.minHeight=o);return a<n-5}function z(n){if(!_(n,"br")||_(n.parentNode,"li")&&1==n.parentNode.childNodes.length)return!1;for(var r=n.parentNode;"inline"==e.getComputedStyle(r).display;)r=r.parentNode;var i=r.style.height,s=r.style.maxHeight,o=r.style.minHeight,u=r.contentEditable;r.style.height="auto";r.style.maxHeight="none";r.style.minHeight="0";t.browser.msie&&7>=t.browser.version&&(r.contentEditable="false");var a=r.offsetHeight;if(0==a)throw"isExtraneousLineBreak: original height is zero, bug?";var f=n.style.display;n.style.display="none";var l=r.offsetHeight;r.style.height=i;r.style.maxHeight=s;r.style.minHeight=o;t.browser.msie&&7>=t.browser.version&&(r.contentEditable=u);n.style.display=f;return a==l}function W(n){return n&&n.nodeType==e.Node.TEXT_NODE&&(""==n.data||/^[\t\n\r ]+$/.test(n.data)&&n.parentNode&&n.parentNode.nodeType==e.Node.ELEMENT_NODE&&-1!=t.inArray(e.getComputedStyle(n.parentNode).whiteSpace,["normal","nowrap"])||/^[\t\r ]+$/.test(n.data)&&n.parentNode&&n.parentNode.nodeType==e.Node.ELEMENT_NODE&&"pre-line"==e.getComputedStyle(n.parentNode).whiteSpace||/^[\t\n\r ]+$/.test(n.data)&&n.parentNode&&n.parentNode.nodeType==e.Node.DOCUMENT_FRAGMENT_NODE)}function X(t){if(!W(t))return!1;if(""==t.data)return!0;var n=t.parentNode;if(!n||e(c(t)).some(function(t){return t.nodeType==e.Node.ELEMENT_NODE&&"none"==e.getComputedStyle(t).display}))return!0;for(;!H(n)&&n.parentNode;)n=n.parentNode;for(var r=t;r!=n;){r=o(r);if(H(r)||_(r,"br"))return!0;if(r.nodeType==e.Node.TEXT_NODE&&!W(r)||_(r,"img"))break}r=t;for(t=u(n);r!=t;){r=s(r);if(H(r)||_(r,"br"))return!0;if(r&&r.nodeType==e.Node.TEXT_NODE&&!W(r)||_(r,"img"))break}return!1}function V(t){if(!t||e(c(t).concat(t)).filter(function(t){return t.nodeType==e.Node.ELEMENT_NODE},!0).some(function(t){return"none"==e.getComputedStyle(t).display}))return!1;if(H(t)||t.nodeType==e.Node.TEXT_NODE&&!X(t)||_(t,"img")||_(t,"br")&&!z(t))return!0;for(var n=0;n<t.childNodes.length;n++)if(V(t.childNodes[n]))return!0;return!1}function $(e){return e&&!V(e)}function J(t){if(U(t)&&!z(t))return!0;if(!B(t)||t.nodeType!=e.Node.ELEMENT_NODE)return!1;for(var n=!1,r=0;r<t.childNodes.length;r++){if(!$(t.childNodes[r])&&!J(t.childNodes[r]))return!1;J(t.childNodes[r])&&(n=!0)}return n}function K(e){var t=new window.GENTICS.Utils.RangeObject;t.startContainer=e.startContainer;t.startOffset=e.startOffset;t.endContainer=e.endContainer;t.endOffset=e.endOffset;t.select()}function Q(){var n;if(nn)n=nn;else{if(!Aloha.getSelection().rangeCount)return null;n=Aloha.getSelection().getRangeAt(0)}if(-1==t.inArray(n.startContainer.nodeType,[e.Node.TEXT_NODE,e.Node.ELEMENT_NODE])||-1==t.inArray(n.endContainer.nodeType,[e.Node.TEXT_NODE,e.Node.ELEMENT_NODE])||!n.startContainer.ownerDocument||!n.endContainer.ownerDocument||!f(n.startContainer,n.startContainer.ownerDocument)||!f(n.endContainer,n.endContainer.ownerDocument))throw"Invalid active range; test bug?";return n}function G(t,n,r,i){-1==r&&(r=n.childNodes.length);for(var s=t.parentNode,o=m(t),u=[i],a=0;a<Aloha.getSelection().rangeCount;a++)u.push(Aloha.getSelection().getRangeAt(a));var f=[];e(u).forEach(function(e){f.push([e.startContainer,e.startOffset]);f.push([e.endContainer,e.endOffset])});e(f).forEach(function(e){e[0]==n&&e[1]>r&&e[1]++;if(e[0]==s&&(e[1]==o||e[1]==o+1)){e[0]=n;e[1]=e[1]+(r-o)}e[0]==s&&e[1]>o+1&&e[1]--});n.childNodes.length==r?n.appendChild(t):n.insertBefore(t,n.childNodes[r]);if(f[0][1]>f[0][0].childNodes.length&&f[1][1]>f[1][0].childNodes.length)i.setStart(t,0),i.setEnd(t,0);else{i.setStart(f[0][0],f[0][1]);i.setEnd(f[1][0],f[1][1]);Aloha.getSelection().removeAllRanges();for(a=1;a<u.length;a++){var l=Aloha.createRange();l.setStart(f[2*a][0],f[2*a][1]);l.setEnd(f[2*a+1][0],f[2*a+1][1]);Aloha.getSelection().addRange(l)}l&&(i=l)}}function Y(e,n){t.browser.msie&&7<=t.browser.version&&"undefined"!=typeof e.attributes[t.expando]&&t(e).removeAttr(t.expando);for(var r=e.attributes,i=0;i<r.length;i++){var s=r[i];if("undefined"==typeof s.specified||s.specified)"function"==typeof n.setAttributeNS?n.setAttributeNS(s.namespaceURI,s.name,s.value):n.setAttribute(s.name,s.value)}}function Z(e,t,n){if(_(e,t)||!e.parentNode)return e;t=e.ownerDocument.createElement(t);e.parentNode.insertBefore(t,e);for(Y(e,t);e.childNodes.length;)G(e.firstChild,t,t.childNodes.length,n);e.parentNode.removeChild(e);n.startContainer===e&&(n.startContainer=t);n.endContainer===e&&(n.endContainer=t);return t}function et(e){var t=e.previousSibling;if(t){for(;t.hasChildNodes();)t=t.lastChild;for(;$(t)&&!z(t)&&t!=e.parentNode;)t=o(t);F(t)&&z(t)&&t.parentNode.removeChild(t)}}function tt(e){for(var t=e;t.hasChildNodes();)t=t.lastChild;for(;$(t)&&!z(t)&&t!=e;)t=o(t);F(t)&&z(t)&&t.parentNode.removeChild(t)}function nt(e){et(e);tt(e)}function rt(e,t,n,r){"undefined"==typeof t&&(t=function(){return!1});"undefined"==typeof n&&(n=function(){return null});if(!e.length||!F(e[0]))return null;B(e[e.length-1])&&!_(e[e.length-1],"br")&&_(e[e.length-1].nextSibling,"br")&&e.push(e[e.length-1].nextSibling);n=F(e[0].previousSibling)&&t(e[0].previousSibling)?e[0].previousSibling:F(e[e.length-1].nextSibling)&&t(e[e.length-1].nextSibling)?e[e.length-1].nextSibling:n();if(!n)return null;if(!n.parentNode){e[0].parentNode.insertBefore(n,e[0]);var i=r.startContainer,s=r.startOffset,o=r.endContainer,u=r.endOffset;i==n.parentNode&&s>=m(n)&&r.setStart(i,s+1);o==n.parentNode&&u>=m(n)&&r.setEnd(o,u+1);nn&&nn!==r&&(i=nn.startContainer,s=nn.startOffset,o=nn.endContainer,u=nn.endOffset,i==n.parentNode&&s>=m(n)&&nn.setStart(i,s+1),o==n.parentNode&&u>=m(n)&&nn.setEnd(o,u+1))}i=e[0].parentNode;if(l(n,e[0])){!B(n)&&B(n.lastChild)&&B(e[0])&&!_(n.lastChild,"BR")&&n.appendChild(n.ownerDocument.createElement("br"));for(s=0;s<e.length;s++)G(e[s],n,-1,r)}else{!B(n)&&B(n.firstChild)&&B(e[e.length-1])&&!_(e[e.length-1],"BR")&&n.insertBefore(n.ownerDocument.createElement("br"),n.firstChild);for(s=e.length-1;0<=s;s--)G(e[s],n,0,r)}F(i)&&!i.hasChildNodes()&&i.parentNode.removeChild(i);if(F(n.nextSibling)&&t(n.nextSibling)){for(!B(n)&&B(n.lastChild)&&B(n.nextSibling.firstChild)&&!_(n.lastChild,"BR")&&n.appendChild(n.ownerDocument.createElement("br"));n.nextSibling.hasChildNodes();)G(n.nextSibling.firstChild,n,-1,r);n.parentNode.removeChild(n.nextSibling)}nt(n);return n}function it(n,r){if((vn[r]||D(r,"colgroup table tbody tfoot thead tr".split(" ")))&&"object"==typeof n&&n.nodeType==e.Node.TEXT_NODE&&!/^[ \t\n\f\r]*$/.test(n.data)||(mn[r]||D(r,["script","style","plaintext","xmp"]))&&("object"!=typeof n||n.nodeType!=e.Node.TEXT_NODE)||"object"==typeof n&&(n.nodeType==e.Node.DOCUMENT_NODE||n.nodeType==e.Node.DOCUMENT_FRAGMENT_NODE||n.nodeType==e.Node.DOCUMENT_TYPE_NODE))return!1;M(n)&&(n=n.tagName.toLowerCase());if("string"!=typeof n)return!0;if(M(r)){for(var i=r;i;){if("a"==n&&_(i,"a")||on[n.toUpperCase()]&&i&&1==i.nodeType&&d(i.namespaceURI)&&dn[i.nodeName]||/^h[1-6]$/.test(n)&&M(i)&&/^H[1-6]$/.test(i.tagName))return!1;i=i.parentNode}r=r.tagName.toLowerCase()}if("object"!=typeof r||r.nodeType!=e.Node.ELEMENT_NODE&&r.nodeType!=e.Node.DOCUMENT_FRAGMENT_NODE){if("string"!=typeof r)return!1;switch(r){case"colgroup":return"col"==n;case"table":return-1!=t.inArray(n,"caption col colgroup tbody td tfoot th thead tr".split(" "));case"tbody":case"thead":case"tfoot":return-1!=t.inArray(n,["td","th","tr"]);case"tr":return-1!=t.inArray(n,["td","th"]);case"dl":return-1!=t.inArray(n,["dt","dd"]);case"dir":case"ol":case"ul":return-1!=t.inArray(n,["dir","li","ol","ul"]);case"hgroup":return/^h[1-6]$/.test(n)}return-1!=t.inArray(n,"body caption col colgroup frame frameset head html tbody td tfoot th thead tr".split(" "))||-1!=t.inArray(n,["dd","dt"])&&"dl"!=r||"li"==n&&"ol"!=r&&"ul"!=r?!1:(i=wn[r.toUpperCase()])&&i[n.toUpperCase()]?!1:!0}return!0}function st(t,n){return n.collapsed?!1:w(t,n)||t==n.startContainer&&t.nodeType==e.Node.TEXT_NODE&&g(t)!=n.startOffset||t==n.endContainer&&t.nodeType==e.Node.TEXT_NODE&&0!=n.endOffset||t.hasChildNodes()&&e(t.childNodes).every(function(e){return st(e,n)})&&(!f(n.startContainer,t)||n.startContainer.nodeType!=e.Node.TEXT_NODE||0==n.startOffset)&&(!f(n.endContainer,t)||n.endContainer.nodeType!=e.Node.TEXT_NODE||n.endOffset==g(n.endContainer))?!0:!1}function ot(e,t){"undefined"==typeof t&&(t=function(){return!0});for(var n=e.startContainer;st(n.parentNode,e);)n=n.parentNode;for(var r=u(e.endContainer),i=[];l(n,r);)st(n,e)&&t(n)&&i.push(n),n=s(n);return i}function ut(e){if(!M(e))return!1;if(-1!=t.inArray(e.tagName,"B EM I S SPAN STRIKE STRONG SUB SUP U".split(" "))&&(0==e.attributes.length||1==e.attributes.length&&n(e,"style")))return!0;if("FONT"==e.tagName||"A"==e.tagName){var r=e.attributes.length;n(e,"style")&&r--;"FONT"==e.tagName&&(n(e,"color")&&r--,n(e,"face")&&r--,n(e,"size")&&r--);"A"==e.tagName&&n(e,"href")&&r--;if(0==r)return!0}return!1}function at(e){return!M(e)||-1==t.inArray(e.tagName,"A B EM FONT I S SPAN STRIKE STRONG SUB SUP U".split(" "))?!1:0==e.attributes.length?!0:1<e.attributes.length?!1:n(e,"style")&&0==r(e)||"A"==e.tagName&&n(e,"href")||"FONT"==e.tagName&&(n(e,"color")||n(e,"face")||n(e,"size"))||("B"==e.tagName||"STRONG"==e.tagName)&&n(e,"style")&&1==r(e)&&""!=e.style.fontWeight||("I"==e.tagName||"EM"==e.tagName)&&n(e,"style")&&1==r(e)&&""!=e.style.fontStyle||("A"==e.tagName||"FONT"==e.tagName||"SPAN"==e.tagName)&&n(e,"style")&&1==r(e)&&""==e.style.textDecoration||-1!=t.inArray(e.tagName,"A FONT S SPAN STRIKE U".split(" "))&&n(e,"style")&&1==r(e)&&("line-through"==e.style.textDecoration||"underline"==e.style.textDecoration||"overline"==e.style.textDecoration||"none"==e.style.textDecoration)?!0:!1}function ft(e,t,n){return null===t&&null===n||"string"==typeof t&&"string"==typeof n&&t==n&&!("equivalentValues"in rn[e])||"string"==typeof t&&"string"==typeof n&&"equivalentValues"in rn[e]&&rn[e].equivalentValues(t,n)?!0:!1}function lt(t,n,r){if(ft(t,n,r))return!0;if("fontsize"!=t||"string"!=typeof n||"string"!=typeof r)return!1;var i=lt;if(void 0===i.sizeMap){i.sizeMap={};var s=document.createElement("font");document.body.appendChild(s);e("xx-small small medium large x-large xx-large xxx-large".split(" ")).forEach(function(t){s.size=p(t);i.sizeMap[t]=e.getComputedStyle(s).fontSize});document.body.removeChild(s)}return n===i.sizeMap[r]||r===i.sizeMap[n]}function ct(t,r){if(t.nodeType==e.Node.ELEMENT_NODE||!!t.parentNode&&t.parentNode.nodeType==e.Node.ELEMENT_NODE){if(t.nodeType!=e.Node.ELEMENT_NODE)return ct(t.parentNode,r);if("createlink"==r||"unlink"==r){for(;t&&(!M(t)||"A"!=t.tagName||!n(t,"href"));)t=t.parentNode;return t?t.getAttribute("href"):null}if("backcolor"==r||"hilitecolor"==r){for(;("rgba(0, 0, 0, 0)"==e.getComputedStyle(t).backgroundColor||""===e.getComputedStyle(t).backgroundColor||"transparent"==e.getComputedStyle(t).backgroundColor)&&t.parentNode&&t.parentNode.nodeType==e.Node.ELEMENT_NODE;)t=t.parentNode;return"rgba(0, 0, 0, 0)"==e.getComputedStyle(t).backgroundColor||""===e.getComputedStyle(t).backgroundColor||"transparent"==e.getComputedStyle(t).backgroundColor?"rgb(255, 255, 255)":e.getComputedStyle(t).backgroundColor}if("subscript"==r||"superscript"==r){for(var i=!1,s=!1;B(t);)e.getComputedStyle(t),_(t,"sub")?i=!0:_(t,"sup")&&(s=!0),t=t.parentNode;return i&&s?"mixed":i?"subscript":s?"superscript":null}if("strikethrough"==r){do{if(-1!=e.getComputedStyle(t).textDecoration.indexOf("line-through"))return"line-through";t=t.parentNode}while(t&&t.nodeType==e.Node.ELEMENT_NODE);return null}if("underline"==r){do{if(-1!=e.getComputedStyle(t).textDecoration.indexOf("underline"))return"underline";t=t.parentNode}while(t&&t.nodeType==e.Node.ELEMENT_NODE);return null}if("relevantCssProperty"in rn[r])return e.getComputedStyle(t)[rn[r].relevantCssProperty].toString();throw"Bug: no relevantCssProperty for "+r+" in getEffectiveCommandValue"}return null}function ht(t,r){if("backcolor"!=r&&"hilitecolor"!=r||"inline"==e.getComputedStyle(t).display){if("createlink"==r||"unlink"==r)return M(t)&&"A"==t.tagName&&n(t,"href")?t.getAttribute("href"):null;if("subscript"==r||"superscript"==r)return _(t,"sup")?"superscript":_(t,"sub")?"subscript":null;if("strikethrough"==r&&""!=t.style.textDecoration)return-1!=t.style.textDecoration.indexOf("line-through")?"line-through":null;if("strikethrough"==r&&D(t,["S","STRIKE"]))return"line-through";if("underline"==r&&""!=t.style.textDecoration)return-1!=t.style.textDecoration.indexOf("underline")?"underline":null;if("underline"==r&&_(t,"U"))return"underline";var i=rn[r].relevantCssProperty;if(null===i)return null;if(""!=t.style[i])return t.style[i];if(d(t.namespaceURI)&&"FONT"==t.tagName){if("color"==i&&n(t,"color"))return t.color;if("fontFamily"==i&&n(t,"face"))return t.face;if("fontSize"==i&&n(t,"size"))return i=parseInt(t.size),1>i&&(i=1),7<i&&(i=7),{1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[i]}return"fontWeight"!=i||"B"!=t.tagName&&"STRONG"!=t.tagName?"fontStyle"!=i||"I"!=t.tagName&&"EM"!=t.tagName?null:"italic":"bold"}return null}function pt(e,t,n,r){for(var i=e;ut(i)&&1==i.childNodes.length&&ut(i.firstChild)&&(!at(i)||!ft(t,ht(i,t),n));)i=i.firstChild;if(!(i==e||!at(i)||!ft(t,ht(i,t),n)||!lt(t,ct(i,t),n))){for(;i.hasChildNodes();)G(i.firstChild,i.parentNode,m(i),r);e.parentNode.insertBefore(i,e.nextSibling);G(e,i,-1,r)}}function dt(e){for(var n=[],e=t.makeArray(e),r=0;r<e.length;r++)for(var i=e[r],s=0;s<En.length;s++){var o=En[s],u=i;1!=u.nodeType&&(u=u.parentNode);for(var a=null;u&&1==u.nodeType&&null===(a=ht(u,o));)u=u.parentNode;n.push([i,o,a])}return n}function vt(t,n){e(t).forEach(function(t){var r=t[0],i=t[1],t=t[2],s=r;if(!s||s.nodeType!=e.Node.ELEMENT_NODE)s=s.parentNode;for(;s&&s.nodeType==e.Node.ELEMENT_NODE&&null===ht(s,i);)s=s.parentNode;null===t&&s&&s.nodeType==e.Node.ELEMENT_NODE?gt(r,i,null,n):(s&&s.nodeType==e.Node.ELEMENT_NODE&&!ft(i,ht(s,i),t)||(!s||s.nodeType!=e.Node.ELEMENT_NODE)&&null!==t)&&yt(r,i,t,n)})}function mt(e,t,n){if(!F(e)||null===ht(e,t))return[];if(at(e)){for(var t=Array.prototype.slice.call(i(e.childNodes)),r=0;r<t.length;r++)G(t[r],e.parentNode,m(e),n);e.parentNode.removeChild(e);return t}"strikethrough"==t&&-1!=e.style.textDecoration.indexOf("line-through")&&(e.style.textDecoration="line-through"==e.style.textDecoration?"":e.style.textDecoration.replace("line-through",""),""==e.getAttribute("style")&&e.removeAttribute("style"));"underline"==t&&-1!=e.style.textDecoration.indexOf("underline")&&(e.style.textDecoration="underline"==e.style.textDecoration?"":e.style.textDecoration.replace("underline",""),""==e.getAttribute("style")&&e.removeAttribute("style"));null!==rn[t].relevantCssProperty&&(e.style[rn[t].relevantCssProperty]="",""==e.getAttribute("style")&&e.removeAttribute("style"));d(e.namespaceURI)&&"FONT"==e.tagName&&("forecolor"==t&&e.removeAttribute("color"),"fontname"==t&&e.removeAttribute("face"),"fontsize"==t&&e.removeAttribute("size"));_(e,"A")&&("createlink"==t||"unlink"==t)&&e.removeAttribute("href");return null===ht(e,t)?[]:[Z(e,"span",n)]}function gt(t,n,r,s){if(t.parentNode&&t.parentNode.nodeType==e.Node.ELEMENT_NODE&&!lt(n,ct(t,n),r)){for(var o=t.parentNode,u=[];F(o)&&o.nodeType==e.Node.ELEMENT_NODE&&!lt(n,ct(o,n),r);)u.push(o),o=o.parentNode;if(u.length){var a=ht(u[u.length-1],n);if((null!==a||a==r)&&(null===r||lt(n,ct(u[u.length-1].parentNode,n),r)))for(;u.length;){o=u.pop();null!==ht(o,n)&&(a=ht(o,n));r=Array.prototype.slice.call(i(o.childNodes));null!==ht(o,n)&&mt(o,n,s);for(o=0;o<r.length;o++){var f=r[o];f!=t&&(f.nodeType!=e.Node.ELEMENT_NODE||null===ht(f,n)||!!ft(n,a,ht(f,n)))&&f!=u[u.length-1]&&yt(f,n,a,s)}}}}}function yt(n,r,i,s){if(n.parentNode&&null!==i&&(it(n,"span")&&(pt(n.previousSibling,r,i,s),pt(n.nextSibling,r,i,s),rt([n],function(e){return at(e)&&ft(r,ht(e,r),i)&&lt(r,ct(e,r),i)},function(){return null},s)),!lt(r,ct(n,r),i)))if(it(n,"span")){if(!lt(r,ct(n,r),i)){var o=null;if(!tn){"bold"==r&&("bold"==i||"700"==i)&&(o=n.ownerDocument.createElement("b"));"italic"==r&&"italic"==i&&(o=n.ownerDocument.createElement("i"));"strikethrough"==r&&"line-through"==i&&(o=n.ownerDocument.createElement("s"));"underline"==r&&"underline"==i&&(o=n.ownerDocument.createElement("u"));"forecolor"==r&&T(i)&&(o=n.ownerDocument.createElement("span"),t(o).css("color",T(i)));"fontname"==r&&(o=n.ownerDocument.createElement("font"),o.face=i)}if("createlink"==r||"unlink"==r){o=n.ownerDocument.createElement("a");o.setAttribute("href",i);for(var u=n.parentNode;u;)_(u,"A")&&(u=Z(u,"span",s)),u=u.parentNode}"fontsize"==r&&-1!=t.inArray(i,"xx-small small medium large x-large xx-large xxx-large".split(" "))&&(!tn||"xxx-large"==i)&&(o=n.ownerDocument.createElement("font"),o.size=p(i));("subscript"==r||"superscript"==r)&&"subscript"==i&&(o=n.ownerDocument.createElement("sub"));("subscript"==r||"superscript"==r)&&"superscript"==i&&(o=n.ownerDocument.createElement("sup"));o||(o=n.ownerDocument.createElement("span"));n.parentNode.insertBefore(o,n);u=rn[r].relevantCssProperty;null!==u&&!lt(r,ct(o,r),i)&&(o.style[u]=i);"strikethrough"==r&&"line-through"==i&&"line-through"!=ct(o,"strikethrough")&&(o.style.textDecoration="line-through");"underline"==r&&"underline"==i&&"underline"!=ct(o,"underline")&&(o.style.textDecoration="underline");G(n,o,o.childNodes.length,s);if(n.nodeType==e.Node.ELEMENT_NODE&&!ft(r,ct(n,r),i)){G(n,o.parentNode,m(o),s);o.parentNode.removeChild(o);o=[];for(u=0;u<n.childNodes.length;u++){if(n.childNodes[u].nodeType==e.Node.ELEMENT_NODE&&(a=ht(n.childNodes[u],r),null!==a&&!ft(r,i,a)))continue;o.push(n.childNodes[u])}for(u=0;u<o.length;u++)yt(o[u],r,i,s)}}}else{o=[];for(u=0;u<n.childNodes.length;u++){if(n.childNodes[u].nodeType==e.Node.ELEMENT_NODE){var a=ht(n.childNodes[u],r);if(null!==a&&!ft(r,i,a))continue}o.push(n.childNodes[u])}for(u=0;u<o.length;u++)yt(o[u],r,i,s)}}function bt(t,n,r){r=r||Q();if(e(ot(r)).filter(function(t){return t.nodeType==e.Node.TEXT_NODE},!0).some(F)){if(F(r.startContainer)&&r.startContainer.nodeType==e.Node.TEXT_NODE&&0!=r.startOffset&&r.startOffset!=g(r.startContainer)){var i=r.startContainer.splitText(r.startOffset),s=Aloha.createRange();if(r.startContainer==r.endContainer){var o=r.endOffset-r.startOffset;s.setEnd(i,o);r.setEnd(i,o)}s.setStart(i,0);Aloha.getSelection().removeAllRanges();Aloha.getSelection().addRange(s);r.setStart(i,0)}F(r.endContainer)&&r.endContainer.nodeType==e.Node.TEXT_NODE&&0!=r.endOffset&&r.endOffset!=g(r.endContainer)&&(i=r,s=[i.startContainer,i.startOffset],o=[i.endContainer,i.endOffset],i.endContainer.splitText(i.endOffset),i.setStart(s[0],s[1]),i.setEnd(o[0],o[1]),Aloha.getSelection().removeAllRanges(),Aloha.getSelection().addRange(i));e(ot(Q(),function(t){return F(t)&&t.nodeType==e.Node.ELEMENT_NODE})).forEach(function(e){mt(e,t,r)});e(ot(r,F)).forEach(function(e){gt(e,t,n,r);yt(e,t,n,r)})}else"inlineCommandActivatedValues"in rn[t]&&fn(t,-1!=e(rn[t].inlineCommandActivatedValues).indexOf(n),r),"subscript"==t&&ln("superscript",r),"superscript"==t&&ln("subscript",r),null===n?pn(t,r):"value"in rn[t]&&hn(t,n,r)}function wt(t,n){if(t.nodeType===e.Node.TEXT_NODE&&n<t.length)for(var r=n;r<t.length;r++)if("	"!==t.data.charAt(r)&&"\r"!==t.data.charAt(r)&&"\n"!==t.data.charAt(r)||160===t.data.charCodeAt(r))return!1;if(t.nextSibling&&t.nextSibling.className&&0<=t.nextSibling.className.indexOf("aloha-table-wrapper"))return t.nextSibling;if(t.parentNode&&t.parentNode.nextSibling&&t.parentNode.nextSibling.className&&0<=t.parentNode.nextSibling.className.indexOf("aloha-table-wrapper"))return t.parentNode.nextSibling;if(t.parentNode&&t.parentNode.nextSibling&&W(t.parentNode.nextSibling)&&t.parentNode.nextSibling.nextSibling&&t.parentNode.nextSibling.nextSibling.className&&0<=t.parentNode.nextSibling.nextSibling.className.indexOf("aloha-table-wrapper"))return t.parentNode.nextSibling.nextSibling}function Et(t,n){if(t.nodeType===e.Node.TEXT_NODE&&0<n)for(var r=n-1;0<=r;r--)if("	"!==t.data.charAt(r)&&"\r"!==t.data.charAt(r)&&"\n"!==t.data.charAt(r)||160===t.data.charCodeAt(r))return!1;return t.previousSibling&&t.previousSibling.className&&0<=t.previousSibling.className.indexOf("aloha-table-wrapper")?t.previousSibling:t.parentNode&&t.parentNode.previousSibling&&t.parentNode.previousSibling.className&&0<=t.parentNode.previousSibling.className.indexOf("aloha-table-wrapper")?t.parentNode.previousSibling:t.parentNode&&t.parentNode.previousSibling&&W(t.parentNode.previousSibling)&&t.parentNode.previousSibling.previousSibling&&t.parentNode.previousSibling.previousSibling.className&&0<=t.parentNode.previousSibling.previousSibling.className.indexOf("aloha-table-wrapper")?t.parentNode.previousSibling.previousSibling:!1}function St(t){t=e(t).trim();if(/^[-+]?[0-9]+(\.[0-9]+)?([eE][-+]?[0-9]+)?$/.test(t)){var n;"+"==t[0]?(t=t.slice(1),n="relative-plus"):"-"==t[0]?(t=t.slice(1),n="relative-minus"):n="absolute";t=parseInt(t);"relative-plus"==n&&(t+=3);"relative-minus"==n&&(t=3-t);1>t&&(t=1);7<t&&(t=7);t={1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[t]}return t}function xt(n){n=St(n);if(-1==t.inArray(n,"xx-small x-small small medium large x-large xx-large xxx-large".split(" "))&&!/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc|px)$/.test(n))return null;var r=document.createElement("font");document.body.appendChild(r);"xxx-large"==n?r.size=7:r.style.fontSize=n;n=parseInt(e.getComputedStyle(r).fontSize);document.body.removeChild(r);for(var i=1;7>i;){r=document.createElement("font");r.size=i;document.body.appendChild(r);var s=parseInt(e.getComputedStyle(r).fontSize);r.size=1+i;var o=parseInt(e.getComputedStyle(r).fontSize);document.body.removeChild(r);if(n<(o+s)/2)return""+i;i++}return"7"}function Tt(e){if(!M(e))return!1;if("BLOCKQUOTE"==e.tagName)return!0;if("DIV"!=e.tagName)return!1;if("undefined"!=typeof e.style.length){for(var t=0;t<e.style.length;t++)if(/^(-[a-z]+-)?margin/.test(e.style[t]))return!0}else for(t in e.style)if(/^(-[a-z]+-)?margin/.test(t)&&e.style[t]&&0!==e.style[t])return!0;return!1}function Nt(e){if(!Tt(e)||"BLOCKQUOTE"!=e.tagName&&"DIV"!=e.tagName)return!1;for(var n=0;n<e.attributes.length;n++)if(!d(e.attributes[n].namespaceURI)||-1==t.inArray(e.attributes[n].name,["style","class","dir"]))return!1;if("undefined"!=typeof e.style.length){for(n=0;n<e.style.length;n++)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(e.style[n]))return!1}else for(var r in e.style)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(r)&&e.style[r]&&0!==e.style[r]&&"false"!==e.style[r])return!1;return!0}function Ct(e){return D(e,"address div h1 h2 h3 h4 h5 h6 listing p pre xmp".split(" "))}function kt(e){return Ct(e)||D(e,["li","dt","dd"])}function Lt(n,r){if(F(n))if(e(c(n)).every(function(e){return!R(n,e)||!it(n,e)})&&!O(n,Sn)){if(D(n,["dd","dt"]))rt([n],function(e){return _(e,"dl")&&!e.attributes.length},function(){return document.createElement("dl")},r);else if(P(n)){n=Z(n,Sn,r);Yt(n);Lt(n,r);for(var i=h(n),s=0;s<i.length;s++)Lt(i[s],r)}}else{for(i=dt([n]);!it(n,n.parentNode);){for(s=n.parentNode.childNodes.length-1;0<=s;--s)3==n.parentNode.childNodes[s].nodeType&&0==n.parentNode.childNodes[s].data.length&&(n.parentNode.removeChild(n.parentNode.childNodes[s]),r.startContainer==n.parentNode&&r.startOffset>s&&r.startOffset--,r.endContainer==n.parentNode&&r.endOffset>s&&r.endOffset--);if(1==n.parentNode.childNodes.length){var s=r.startOffset,o=r.endOffset;r.startContainer===n.parentNode&&r.startOffset>m(n)&&(s=r.startOffset+(t(n).contents().length-1));r.endContainer===n.parentNode&&r.endOffset>m(n)&&(o=r.endOffset+(t(n).contents().length-1));t(n).contents().unwrap();r.startOffset=s;r.endOffset=o;break}if(s=n.parentNode,Ut([n],r),s===n.parentNode){s=r.startOffset;o=r.endOffset;r.startContainer===n.parentNode&&r.startOffset>m(n)&&(s=r.startOffset+(t(n).contents().length-1));r.endContainer===n.parentNode&&r.endOffset>m(n)&&(o=r.endOffset+(t(n).contents().length-1));t(n).contents().unwrap();r.startOffset=s;r.endOffset=o;break}}vt(i,r)}}function At(t,n){if(_(t,"LI")&&F(t)&&F(t.parentNode))for(var r=null;e(t.childNodes).some(function(e){return D(e,["OL","UL"])});){var i=t.lastChild;D(i,["OL","UL"])||!r&&i.nodeType==e.Node.TEXT_NODE&&/^[ \t\n\f\r]*$/.test(i.data)?(r=null,G(i,t.parentNode,1+m(t),n)):(r||(r=t.ownerDocument.createElement("li"),t.parentNode.insertBefore(r,t.nextSibling)),G(i,r,0,n))}}function Ot(e,n){D(e,["OL","UL"])&&F(e)&&t(e).children("ol,ul").each(function(e,t){_(t.previousSibling,"LI")&&G(t,t.previousSibling,t.previousSibling.childNodes.length,n)})}function Mt(){var t=Ht(Q()),n=E(t,function(e){return F(e)&&!Tt(e)&&(D(e,["ol","ul"])||D(e.parentNode,["ol","ul"])||it(e,"li"))});if(!n.length)return"none";if(e(n).every(function(e){return _(e,"ol")||_(e.parentNode,"ol")||_(e.parentNode,"li")&&_(e.parentNode.parentNode,"ol")})&&!e(n).some(function(e){return _(e,"ul")||"querySelector"in e&&e.querySelector("ul")}))return"ol";if(e(n).every(function(e){return _(e,"ul")||_(e.parentNode,"ul")||_(e.parentNode,"li")&&_(e.parentNode.parentNode,"ul")})&&!e(n).some(function(e){return _(e,"ol")||"querySelector"in e&&e.querySelector("ol")}))return"ul";t=e(n).some(function(e){return _(e,"ol")||_(e.parentNode,"ol")||"querySelector"in e&&e.querySelector("ol")||_(e.parentNode,"li")&&_(e.parentNode.parentNode,"ol")});n=e(n).some(function(e){return _(e,"ul")||_(e.parentNode,"ul")||"querySelector"in e&&e.querySelector("ul")||_(e.parentNode,"li")&&_(e.parentNode.parentNode,"ul")});return t&&n?"mixed":t?"mixed ol":n?"mixed ul":"none"}function _t(n){for(;n&&n.nodeType!=e.Node.ELEMENT_NODE||n.nodeType==e.Node.ELEMENT_NODE&&-1!=t.inArray(e.getComputedStyle(n).display,["inline","none"]);)n=n.parentNode;if(!n||n.nodeType!=e.Node.ELEMENT_NODE)return"left";var r=e.getComputedStyle(n).textAlign.replace(/^-(moz|webkit)-/,"").replace(/^auto$/,"start");return"start"==r?"ltr"==v(n)?"left":"right":"end"==r?"ltr"==v(n)?"right":"left":-1!=t.inArray(r,["center","justify","left","right"])?r:"left"}function Dt(e,t){return!e.parentNode&&0==t||0<=t-1&&t-1<e.childNodes.length&&V(e.childNodes[t-1])&&(H(e.childNodes[t-1])||_(e.childNodes[t-1],"br"))}function Pt(e,t){return!e.parentNode&&t==g(e)||t<e.childNodes.length&&V(e.childNodes[t])&&H(e.childNodes[t])}function Ht(t){var n=t.startContainer,r=t.startOffset,i=t.endContainer,t=t.endOffset,s=e(c(n).concat(n)).filter(function(e){return _(e,"li")}).slice(-1);s.length&&(r=m(s[0]),n=s[0].parentNode);if(!Dt(n,r))do 0==r?(r=m(n),n=n.parentNode):r--;while(!Dt(n,r)&&!Pt(n,r));for(;0==r&&n.parentNode;)r=m(n),n=n.parentNode;s=e(c(i).concat(i)).filter(function(e){return _(e,"li")}).slice(-1);s.length&&(t=1+m(s[0]),i=s[0].parentNode);if(!Pt(i,t))do t==g(i)?(t=1+m(i),i=i.parentNode):t++;while(!Dt(i,t)&&!Pt(i,t));for(;t==g(i)&&i.parentNode;)t=1+m(i),i=i.parentNode;s=Aloha.createRange();s.setStart(n,r);s.setEnd(i,t);return s}function Bt(e){for(var t=0;!Dt(e,t)&&!Pt(e,t);){if(0<=t-1&&t-1<e.childNodes.length&&V(e.childNodes[t-1]))return!1;0==t||!e.hasChildNodes()?(t=m(e),e=e.parentNode):(e=e.childNodes[t-1],t=g(e))}return!0}function jt(e){for(var t=g(e);!Dt(e,t)&&!Pt(e,t);){if(t<e.childNodes.length&&V(e.childNodes[t]))return!1;t==g(e)||!e.hasChildNodes()?(t=1+m(e),e=e.parentNode):(e=e.childNodes[t],t=0)}return!0}function Ft(t){var n=[];void 0!==cn("createlink",t)&&n.push(["createlink",cn("createlink",t)]);e("bold italic strikethrough subscript superscript underline".split(" ")).forEach(function(e){void 0!==an(e,t)&&n.push([e,an(e,t)])});e(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(e){void 0!==cn(e,t)&&n.push([e,cn(e,t)])});return n}function It(t){var n=[],r=e(ot(t)).filter(function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE})[0];if(!r)return n;n.push(["createlink",rn.createlink.value(t)]);e("bold italic strikethrough subscript superscript underline".split(" ")).forEach(function(t){-1!=e(rn[t].inlineCommandActivatedValues).indexOf(ct(r,t))?n.push([t,!0]):n.push([t,!1])});e(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(e){n.push([e,rn[e].value(t)])});n.push(["fontsize",ct(r,"fontsize")]);return n}function qt(t,n){var r=e(ot(n)).filter(function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE})[0];if(r)for(var i=0;i<t.length;i++){var s=t[i][0],o=t[i][1];if("boolean"==typeof o&&L(s,n)!=o)C(s);else if("string"==typeof o&&"fontsize"!=s&&!ft(s,A(s,n),o))C(s,!1,o,n);else{if("string"!=typeof o||"fontsize"!=s||!(void 0!==cn("fontsize",n)&&cn("fontsize",n)!==o||void 0===cn("fontsize",n)&&!lt(s,ct(r,"fontsize"),o)))continue;C("fontsize",!1,o,n)}r=e(ot(n)).filter(function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE})[0]||r}else for(i=0;i<t.length;i++)s=t[i][0],o=t[i][1],"boolean"==typeof o&&fn(s,o,n),"string"==typeof o&&hn(s,o,n)}function Rt(){var t,n={};3>arguments.length?t=arguments[0]:(t=Aloha.createRange(),t.setStart(arguments[0],arguments[1]),t.setEnd(arguments[2],arguments[3]));2==arguments.length&&(n=arguments[1]);5==arguments.length&&(n=arguments[4]);var r="blockMerging"in n?!!n.blockMerging:!0,s="stripWrappers"in n?!!n.stripWrappers:!0;if(t){for(var o=t.startContainer,u=t.startOffset,l=t.endContainer,c=t.endOffset;o.hasChildNodes();)if(u==g(o)&&R(o,o.parentNode)&&B(o))u=1+m(o),o=o.parentNode;else{if(u==g(o))break;var h=o.childNodes[u];if(H(h)||h.nodeType==e.Node.ELEMENT_NODE&&!h.hasChildNodes()||h.nodeType!=e.Node.ELEMENT_NODE&&h.nodeType!=e.Node.TEXT_NODE)break;o=h;u=0}for(;l.hasChildNodes();)if(0==c&&R(l,l.parentNode)&&B(l))c=m(l),l=l.parentNode;else{if(0==c)break;h=l.childNodes[c-1];if(H(h)||h.nodeType==e.Node.ELEMENT_NODE&&!h.hasChildNodes()||h.nodeType!=e.Node.ELEMENT_NODE&&
h.nodeType!=e.Node.TEXT_NODE)break;l=h;c=g(h)}if("after"!==y(l,c,o,u))t.setEnd(t.startContainer,t.startOffset);else{l.nodeType==e.Node.TEXT_NODE&&c==g(l)&&o!=l&&(c=1+m(l),l=l.parentNode);t.setStart(o,u);t.setEnd(l,c);for(var p=t.startContainer;R(p,p.parentNode)&&B(p);)p=p.parentNode;if(!H(p)&&!j(p)||!it("span",p)||D(p,["td","th"]))p=null;for(var d=t.endContainer;R(d,d.parentNode)&&B(d);)d=d.parentNode;if(!H(d)&&!j(d)||!it("span",d)||D(d,["td","th"]))d=null;n=It(t);if(o==l&&F(o)&&o.nodeType==e.Node.TEXT_NODE)h=o.parentNode,o.deleteData(u,c-u),0<u&&" "===o.data.substr(u-1,1)&&u<o.data.length&&" "===o.data.substr(u,1)&&o.replaceData(u-1,1," "),Xt(o,u),t.setStart(t.startContainer,t.startOffset),t.setEnd(t.startContainer,t.startOffset),qt(n,t),(F(h)||j(h))&&!B(h)&&Yt(h);else{F(o)&&o.nodeType==e.Node.TEXT_NODE&&o.deleteData(u,g(o)-u);for(var u=E(t,function(e){return F(e)&&!D(e,["thead","tbody","tfoot","tr","th","td"])}),v=0;v<u.length;v++){var b=u[v],h=b.parentNode;h.removeChild(b);if(s||!a(h,o)&&h!=o)for(;F(h)&&B(h)&&0==g(h);)b=h.parentNode,b.removeChild(h),h=b;(F(h)||j(h))&&!B(h)&&Yt(h)}F(l)&&l.nodeType==e.Node.TEXT_NODE&&l.deleteData(0,c);Xt(t.startContainer,t.startOffset);Xt(t.endContainer,t.endOffset);if(!r||!p||!d||!R(p,d)||p==d)t.setEnd(t.startContainer,t.startOffset);else{1==p.children.length&&J(p.firstChild)&&p.removeChild(p.firstChild);1==d.children.length&&J(d.firstChild)&&d.removeChild(d.firstChild);if(a(p,d)){for(h=d;h.parentNode!=p;)h=h.parentNode;t.setStart(p,m(h));t.setEnd(p,m(h));if(!d.hasChildNodes()){for(;F(d)&&1==d.parentNode.childNodes.length&&d.parentNode!=p;)h=d,h.removeChild(d),d=h;F(d)&&!B(d)&&B(d.previousSibling)&&B(d.nextSibling)&&d.parentNode.insertBefore(document.createElement("br"),d.nextSibling);F(d)&&d.parentNode.removeChild(d);qt(n,t);return}if(!B(d.firstChild)){qt(n,t);return}s=[];for(s.push(d.firstChild);!_(s[s.length-1],"br")&&B(s[s.length-1].nextSibling);)s.push(s[s.length-1].nextSibling);for(r=dt(s);s[0].parentNode!=p;)Ut(s,t);F(s[0].previousSibling)&&_(s[0].previousSibling,"br")&&s[0].parentNode.removeChild(s[0].previousSibling)}else if(f(p,d)){t.setStart(p,g(p));t.setEnd(p,g(p));for(h=p;h.parentNode!=d;)h=h.parentNode;B(h.nextSibling)&&_(p.lastChild,"br")&&p.removeChild(p.lastChild);d=[];h.nextSibling&&!_(h.nextSibling,"br")&&!H(h.nextSibling)&&d.push(h.nextSibling);d.length&&d[d.length-1].nextSibling&&!_(d[d.length-1].nextSibling,"br")&&!H(d[d.length-1].nextSibling)&&d.push(d[d.length-1].nextSibling);r=dt(d);e(d).forEach(function(e){G(e,p,-1,t)});_(h.nextSibling,"br")&&h.parentNode.removeChild(h.nextSibling)}else{t.setStart(p,g(p));t.setEnd(p,g(p));B(d.firstChild)&&_(p.lastChild,"br")&&p.removeChild(p.lastChild);for(r=dt([].slice.call(i(d.childNodes)));d.hasChildNodes();)G(d.firstChild,p,-1,t);for(;!d.hasChildNodes();)h=d.parentNode,h.removeChild(d),d=h}vt(r,t);Yt(p)}qt(n,t)}}}}function Ut(e,n){var r=e[0].parentNode;if(F(r)&&r.parentNode){-1!=t.inArray(r.firstChild,e)&&et(r);var i=-1!=t.inArray(r.firstChild,e),s=-1!=t.inArray(r.lastChild,e),o=i&&Bt(r),u=s&&jt(r);if(!i&&s){for(i=e.length-1;0<=i;i--)G(e[i],r.parentNode,1+m(r),n);u&&!jt(e[e.length-1])&&e[e.length-1].parentNode.insertBefore(document.createElement("br"),e[e.length-1].nextSibling);tt(r)}else{if(!i){i=r.cloneNode(!1);r.removeAttribute("id");for(r.parentNode.insertBefore(i,r);e[0].previousSibling;)G(r.firstChild,i,i.childNodes.length,n)}for(i=0;i<e.length;i++)G(e[i],r.parentNode,m(r),n);o&&!Bt(e[0])&&e[0].parentNode.insertBefore(document.createElement("br"),e[0]);B(e[e.length-1])&&!_(e[e.length-1],"br")&&_(r.firstChild,"br")&&!B(r)&&r.removeChild(r.firstChild);r.hasChildNodes()?et(r):(r.parentNode===n.startContainer&&r.parentNode===n.endContainer&&n.startContainer===n.endContainer&&n.startOffset===n.endOffset&&r.parentNode.childNodes.length===n.startOffset&&(n.startOffset=r.parentNode.childNodes.length-1,n.endOffset=n.startOffset),r.parentNode.removeChild(r),u&&!jt(e[e.length-1])&&e[e.length-1].parentNode.insertBefore(document.createElement("br"),e[e.length-1].nextSibling));!e[e.length-1].nextSibling&&e[e.length-1].parentNode&&tt(e[e.length-1].parentNode)}}}function zt(e,t){e.hasChildNodes()?Ut([].slice.call(i(e.childNodes)),t):e.parentNode.removeChild(e)}function Wt(e,t,n){if(0==e)return"";if(1==e&&!t&&!n)return" ";if(1==e)return" ";var r="",i;for(i=t?"  ":"  ";3<e;)r+=i,e-=2;return 3==e?r+(!t&&!n?"   ":t&&!n?"   ":!t&&n?"   ":t&&n?"   ":"impossible"):r+(!t&&!n?"  ":t&&!n?"  ":!t&&n?"  ":t&&n?"  ":"impossible")}function Xt(n,r){if(F(n)||j(n)){for(var i=n,s=r;;)if(0<=s-1&&R(i,i.childNodes[s-1]))i=i.childNodes[s-1],s=g(i);else if(0==s&&!Bt(i)&&R(i,i.parentNode))s=m(i),i=i.parentNode;else{if(i.nodeType!=e.Node.TEXT_NODE||-1!=t.inArray(e.getComputedStyle(i.parentNode).whiteSpace,["pre","pre-wrap"])||0==s||!/[ \xa0]/.test(i.data[s-1]))break;s--}for(var o=i,u=s,a=0,f=!1;;)if(u<o.childNodes.length&&R(o,o.childNodes[u]))o=o.childNodes[u],u=0;else if(u==g(o)&&!jt(o)&&R(o,o.parentNode))u=1+m(o),o=o.parentNode;else{if(o.nodeType!=e.Node.TEXT_NODE||-1!=t.inArray(e.getComputedStyle(o.parentNode).whiteSpace,["pre","pre-wrap"])||u==g(o)||!/[ \xa0]/.test(o.data[u]))break;f&&" "==o.data[u]?o.deleteData(u,1):(f=" "==o.data[u],u++,a++)}for(a=Wt(a,0==s&&Bt(i),u==g(o)&&jt(o));"before"==y(i,s,o,u);)s<i.childNodes.length?(i=i.childNodes[s],s=0):i.nodeType!=e.Node.TEXT_NODE||s==g(i)?(s=1+m(i),i=i.parentNode):(f=a[0],a=a.slice(1),f!=i.data[s]&&(i.insertData(s,f),i.deleteData(s+1,1)),s++)}}function Vt(e,n){e&&t(e).find("ul,ol,li").each(function(){t(this).contents().each(function(){if(W(this)){var e=m(this);n.startContainer===this.parentNode&&n.startOffset>e?n.startOffset--:n.startContainer===this&&(n.startContainer=this.parentNode,n.startOffset=e);n.endContainer===this.parentNode&&n.endOffset>e?n.endOffset--:n.endContainer===this&&(n.endContainer=this.parentNode,n.endOffset=e);t(this).remove()}})})}function $t(e,t){if(e.length){var n=e[0];if(D(n.parentNode,["OL","UL"])){var r=n.parentNode.tagName;rt(e,function(e){return O(e,r)},function(){return n.ownerDocument.createElement(r)},t)}else{var i=rt(e,function(e){return Nt(e)},function(){return n.ownerDocument.createElement("blockquote")},t);Lt(i,t)}}}function Jt(t,n){if(F(t))if(Nt(t))zt(t,n);else if(Tt(t))t.removeAttribute("class"),t.removeAttribute("dir"),t.style.margin="",t.style.padding="",t.style.border="",""==t.getAttribute("style")&&t.removeAttribute("style"),Z(t,"div",n);else{for(var r=t.parentNode,s=[];F(r)&&r.nodeType==e.Node.ELEMENT_NODE&&!Nt(r)&&!D(r,["ol","ul"]);)s.push(r),r=r.parentNode;if(!F(r)||!Nt(r)){r=t.parentNode;for(s=[];F(r)&&r.nodeType==e.Node.ELEMENT_NODE&&!Tt(r)&&!D(r,["ol","ul"]);)s.push(r),r=r.parentNode}if(D(t,["OL","UL"])&&(!F(r)||!Tt(r))){t.removeAttribute("reversed");t.removeAttribute("start");t.removeAttribute("type");s=[].slice.call(i(t.childNodes));if(t.attributes.length&&!D(t.parentNode,["OL","UL"]))Z(t,"div",n);else{var o=dt([].slice.call(i(t.childNodes)));zt(t,n);vt(o,n)}for(o=0;o<s.length;o++)Lt(s[o],n)}else if(F(r)&&Tt(r)){s.push(r);for(o=r;s.length;){var r=s.pop(),u=t.parentNode==r?t:s[s.length-1];B(u)&&!_(u,"BR")&&_(u.nextSibling,"BR")&&u.parentNode.removeChild(u.nextSibling);var a=[].slice.call(i(r.childNodes),0,m(u)),r=[].slice.call(i(r.childNodes),1+m(u));$t(a,n);$t(r,n)}Jt(o,n)}}}function Kt(t,n){var r=Mt()==t?"disable":"enable",t=t.toUpperCase(),s="OL"==t?"UL":"OL",o=[];(function(){for(var e=n.endContainer;e!=n.commonAncestorContainer;e=e.parentNode)_(e,"li")&&o.unshift(e);for(e=n.startContainer;e;e=e.parentNode)_(e,"li")&&o.unshift(e)})();e(o).forEach(function(e){At(e,n)});var u=Ht(n);"enable"==r&&e(S(u,function(e){return F(e)&&O(e,s)})).forEach(function(e){if(F(e.previousSibling)&&O(e.previousSibling,t)||F(e.nextSibling)&&O(e.nextSibling,t)){var e=[].slice.call(i(e.childNodes)),r=dt(e);Ut(e,n);rt(e,function(e){return O(e,t)},function(){return null},n);vt(r,n)}else Z(e,t,n)});u=E(u,function(e){return F(e)&&!Tt(e)&&(D(e,["OL","UL"])||D(e.parentNode,["OL","UL"])||it(e,"li"))});"enable"==r&&(u=e(u).filter(function(e){return!D(e,["ol","ul"])||D(e.parentNode,["ol","ul"])}));if("disable"==r)for(;u.length;){var a=[];a.push(u.shift());if(O(a[0],t))Jt(a[0],n);else{for(;u.length&&u[0]==a[a.length-1].nextSibling&&!O(u[0],t);)a.push(u.shift());r=dt(a);Ut(a,n);for(var f=0;f<a.length;f++)Lt(a[f],n);vt(r,n)}}else for(;u.length;){for(a=[];!a.length||u.length&&u[0]==a[a.length-1].nextSibling;)if(D(u[0],["p","div"]))a.push(Z(u[0],"li",n)),u.shift();else if(D(u[0],["li","ol","ul"]))a.push(u.shift());else{for(r=[];!r.length||u.length&&u[0]==r[r.length-1].nextSibling&&B(u[0])&&B(r[r.length-1])&&!_(r[r.length-1],"br");)r.push(u.shift());a.push(rt(r,void 0,function(){return document.createElement("li")},n))}!O(a[0].parentNode,t)&&!e(a).every(function(e){return D(e,["ol","ul"])})&&(O(a[0].parentNode,s)?(r=dt(a),Ut(a,n),rt(a,function(e){return O(e,t)},function(){return document.createElement(t)},n),vt(r,n)):Lt(rt(a,function(e){return O(e,t)},function(){if(!F(a[0].parentNode)||!Nt(a[0].parentNode)||!F(a[0].parentNode.previousSibling)||!O(a[0].parentNode.previousSibling,t))return document.createElement(t);var e=a[0].parentNode.previousSibling;At(e.lastChild,n);(!F(e.lastChild)||!O(e.lastChild,t))&&e.appendChild(document.createElement(t));return e.lastChild},n),n))}}function Qt(t,i){for(var s=Ht(i),o=S(s,function(t){return t.nodeType==e.Node.ELEMENT_NODE&&F(t)&&(n(t,"align")||""!=t.style.textAlign||_(t,"center"))}),s=0;s<o.length;s++){var u=o[s];u.removeAttribute("align");u.style.textAlign="";""==u.getAttribute("style")&&u.removeAttribute("style");D(u,["div","span","center"])&&!u.attributes.length&&zt(u,i);_(u,"center")&&u.attributes.length&&Z(u,"div",i)}s=Ht(nn);o=[];for(o=E(s,function(e){return F(e)&&it(e,"div")&&_t(e)!=t});o.length;){s=[];for(s.push(o.shift());o.length&&o[0]==s[s.length-1].nextSibling;)s.push(o.shift());rt(s,function(n){return _(n,"div")&&e(n.attributes).every(function(e){return"align"==e.name&&e.value.toLowerCase()==t||"style"==e.name&&1==r(n)&&n.style.textAlign==t})},function(){var e=document.createElement("div");e.setAttribute("style","text-align: "+t);return e},i)}}function Gt(){var e=document.createElement("br");e.setAttribute("class","aloha-end-br");return e}function Yt(n){n&&(_(n.lastChild,"br")||e(n.childNodes).some(V)||(t.browser.msie?t.browser.msie&&7>=t.browser.version&&D(n,"p h1 h2 h3 h4 h5 h6 pre blockquote".split(" "))&&(n.firstChild||n.appendChild(document.createTextNode("​"))):n.appendChild(Gt())))}function Zt(t,n){var r;if(t.collapsed){r=t.startOffset;if(n){if(t.startContainer&&t.startContainer.nodeType===e.Node.TEXT_NODE)for(;r<t.startContainer.data.length&&"​"===t.startContainer.data.charAt(r);)r++}else if(t.startContainer&&t.startContainer.nodeType===e.Node.TEXT_NODE)for(;0<r&&"​"===t.startContainer.data.charAt(r-1);)r--;r!==t.startOffset&&(t.setStart(t.startContainer,r),t.setEnd(t.startContainer,r))}}var en="http://www.w3.org/1999/xhtml",tn=!1,nn=null,rn={},sn=0,on={ADDRESS:!0,ARTICLE:!0,ASIDE:!0,BLOCKQUOTE:!0,CAPTION:!0,CENTER:!0,COL:!0,COLGROUP:!0,DD:!0,DETAILS:!0,DIR:!0,DIV:!0,DL:!0,DT:!0,FIELDSET:!0,FIGCAPTION:!0,FIGURE:!0,FOOTER:!0,FORM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,HEADER:!0,HGROUP:!0,HR:!0,LI:!0,LISTING:!0,MENU:!0,NAV:!0,OL:!0,P:!0,PLAINTEXT:!0,PRE:!0,SECTION:!0,SUMMARY:!0,TABLE:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0,UL:!0,XMP:!0},un={inline:!0,"inline-block":!0,"inline-table":!0,none:!0},an,fn,ln,cn,hn,pn;(function(){function e(e){if(!r||r.startContainer!=e.startContainer||r.endContainer!=e.endContainer||r.startOffset!=e.startOffset||r.endOffset!=e.endOffset)t={},n={},r=e.cloneRange()}var t={},n={},r=null;an=function(n,r){e(r);return t[n]};fn=function(n,r,i){e(i);t[n]=r};ln=function(n,r){e(r);delete t[n]};cn=function(t,r){e(r);return n[t]};hn=function(t,r,i){e(i);n[t]=r;"backcolor"==t?n.hilitecolor=r:"hilitecolor"==t&&(n.backcolor=r)};pn=function(t,r){e(r);delete n[t];"backcolor"==t?delete n.hilitecolor:"hilitecolor"==t&&delete n.backcolor}})();var dn={A:!0,ABBR:!0,B:!0,BDI:!0,BDO:!0,CITE:!0,CODE:!0,DFN:!0,EM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,I:!0,KBD:!0,MARK:!0,P:!0,PRE:!0,Q:!0,RP:!0,RT:!0,RUBY:!0,S:!0,SAMP:!0,SMALL:!0,SPAN:!0,STRONG:!0,SUB:!0,SUP:!0,U:!0,VAR:!0,ACRONYM:!0,LISTING:!0,STRIKE:!0,XMP:!0,BIG:!0,BLINK:!0,FONT:!0,MARQUEE:!0,NOBR:!0,TT:!0},vn={colgroup:!0,table:!0,tbody:!0,tfoot:!0,thead:!0,tr:!0},mn={script:!0,style:!0,plaintext:!0,xmp:!0},gn=t.extend({H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0},on),yn={CAPTION:!0,COL:!0,COLGROUP:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0},bn={DD:!0,DT:!0},wn={A:t.extend({A:!0},on),DD:bn,DT:bn,LI:{LI:!0},NOBR:t.extend({NOBR:!0},on),H1:gn,H2:gn,H3:gn,H4:gn,H5:gn,H6:gn,TD:yn,TH:yn,ABBR:on,B:on,BDI:on,BDO:on,CITE:on,CODE:on,DFN:on,EM:on,I:on,KBD:on,MARK:on,P:on,PRE:on,Q:on,RP:on,RT:on,RUBY:on,S:on,SAMP:on,SMALL:on,SPAN:on,STRONG:on,SUB:on,SUP:on,U:on,VAR:on,ACRONYM:on,LISTING:on,STRIKE:on,XMP:on,BIG:on,BLINK:on,FONT:on,MARQUEE:on,TT:on},En="subscript bold fontname fontsize forecolor hilitecolor italic strikethrough underline".split(" ");rn.backcolor={action:function(e){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e);(/^(rgba?|hsla?)\(.*\)$/.test(e)||T(e)||"transparent"==e.toLowerCase())&&bt("backcolor",e)},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(e,t){return x(e)===x(t)}};rn.bold={action:function(e,t){L("bold",t)?bt("bold","normal",t):bt("bold","bold",t)},inlineCommandActivatedValues:["bold","600","700","800","900"],relevantCssProperty:"fontWeight",equivalentValues:function(e,t){return e==t||"bold"==e&&"700"==t||"700"==e&&"bold"==t||"normal"==e&&"400"==t||"400"==e&&"normal"==t}};rn.createlink={action:function(t){""!==t&&(e(ot(Q())).forEach(function(r){e(c(r)).forEach(function(e){F(e)&&_(e,"a")&&n(e,"href")&&e.setAttribute("href",t)})}),bt("createlink",t))},standardInlineValueCommand:!0};rn.fontname={action:function(e){bt("fontname",e)},standardInlineValueCommand:!0,relevantCssProperty:"fontFamily"};rn.fontsize={action:function(e){""!==e&&(e=St(e),(-1!=t.inArray(e,"xx-small x-small small medium large x-large xx-large xxx-large".split(" "))||/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc)$/.test(e))&&bt("fontsize",e))},indeterm:function(){return 2<=e(ot(Q(),function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE})).map(function(e){return ct(e,"fontsize")},!0).filter(function(t,n,r){return-1==e(r.slice(0,n)).indexOf(t)}).length},value:function(t){var n=ot(t,function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE})[0];void 0===n&&(n=t.startContainer);t=ct(n,"fontsize");return xt(t)},relevantCssProperty:"fontSize"};rn.forecolor={action:function(e){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e);(/^(rgba?|hsla?)\(.*\)$/.test(e)||T(e)||"transparent"==e.toLowerCase())&&bt("forecolor",e)},standardInlineValueCommand:!0,relevantCssProperty:"color",equivalentValues:function(e,t){return x(e)===x(t)}};rn.hilitecolor={action:function(e){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e);(/^(rgba?|hsla?)\(.*\)$/.test(e)||T(e)||"transparent"==e.toLowerCase())&&bt("hilitecolor",e)},indeterm:function(){return 2<=e(ot(Q(),function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE})).map(function(e){return ct(e,"hilitecolor")},!0).filter(function(t,n,r){return-1==e(r.slice(0,n)).indexOf(t)}).length},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(e,t){return x(e)===x(t)}};rn.italic={action:function(e,t){L("italic",t)?bt("italic","normal",t):bt("italic","italic",t)},inlineCommandActivatedValues:["italic","oblique"],relevantCssProperty:"fontStyle"};rn.removeformat={action:function(){function t(e){return F(e)&&D(e,"abbr acronym b bdi bdo big blink cite code dfn em font i ins kbd mark nobr q s samp small span strike strong sub sup tt u var".split(" "))}var n=ot(Q(),t);e(n).forEach(function(e){for(;e.hasChildNodes();)G(e.firstChild,e.parentNode,m(e),range);e.parentNode.removeChild(e)});if(F(Q().startContainer)&&Q().startContainer.nodeType==e.Node.TEXT_NODE&&0!=Q().startOffset&&Q().startOffset!=g(Q().startContainer))if(Q().startContainer==Q().endContainer){var n=Q().endOffset-Q().startOffset,r=Q().startContainer.splitText(Q().startOffset);Q().setStart(r,0);Q().setEnd(r,n)}else Q().setStart(Q().startContainer.splitText(Q().startOffset),0);F(Q().endContainer)&&Q().endContainer.nodeType==e.Node.TEXT_NODE&&0!=Q().endOffset&&Q().endOffset!=g(Q().endContainer)&&(r=[Q().startContainer,Q().startOffset],n=[Q().endContainer,Q().endOffset],Q().setEnd(document.documentElement,0),n[0].splitText(n[1]),Q().setStart(r[0],r[1]),Q().setEnd(n[0],n[1]));e(ot(Q(),F)).forEach(function(e){for(;t(e.parentNode)&&R(e.parentNode,e);)Ut([e],range)});e("subscript bold fontname fontsize forecolor hilitecolor italic strikethrough underline".split(" ")).forEach(function(e){bt(e,null)})}};rn.strikethrough={action:function(){L("strikethrough")?bt("strikethrough",null):bt("strikethrough","line-through")},inlineCommandActivatedValues:["line-through"]};rn.subscript={action:function(){var e=L("subscript");bt("subscript",null);e||bt("subscript","subscript")},indeterm:function(){var t=ot(Q(),function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE});return e(t).some(function(e){return"subscript"==ct(e,"subscript")})&&e(t).some(function(e){return"subscript"!=ct(e,"subscript")})||e(t).some(function(e){return"mixed"==ct(e,"subscript")})},inlineCommandActivatedValues:["subscript"]};rn.superscript={action:function(){var e=L("superscript");bt("superscript",null);e||bt("superscript","superscript")},indeterm:function(){var t=ot(Q(),function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE});return e(t).some(function(e){return"superscript"==ct(e,"superscript")})&&e(t).some(function(e){return"superscript"!=ct(e,"superscript")})||e(t).some(function(e){return"mixed"==ct(e,"superscript")})},inlineCommandActivatedValues:["superscript"]};rn.underline={action:function(){L("underline")?bt("underline",null):bt("underline","underline")},inlineCommandActivatedValues:["underline"]};rn.unlink={action:function(){for(var e=Q(),t=[],r=e.startContainer;r;r=r.parentNode)_(r,"A")&&n(r,"href")&&t.unshift(r);for(r=e.startContainer;r!=u(e.endContainer);r=s(r))_(r,"A")&&n(r,"href")&&(w(r,e)||a(r,e.endContainer)||r==e.endContainer)&&t.push(r);for(r=0;r<t.length;r++)mt(t[r],"unlink",e)},standardInlineValueCommand:!0};var Sn="p";rn["delete"]={action:function(n,r){t.browser.msie&&7>=t.browser.version&&Zt(r,!1);if(r.collapsed){Xt(r.startContainer,r.startOffset);for(var i=r.startContainer,s=r.startOffset,o=!1,u=!1;;)if(0<s&&(o=_(i.childNodes[s-1],"br")||!1,u=_(i.childNodes[s-1],"hr")||!1),0==s&&F(i.previousSibling)&&$(i.previousSibling))i.parentNode.removeChild(i.previousSibling);else if(0<=s-1&&s-1<i.childNodes.length&&F(i.childNodes[s-1])&&($(i.childNodes[s-1])||o||u)){if(i.removeChild(i.childNodes[s-1]),s--,o||u){r.setStart(i,s);r.setEnd(i,s);return}}else if(0==s&&B(i)||$(i))s=m(i),i=i.parentNode;else{if(0<=s-1&&s-1<i.childNodes.length&&F(i.childNodes[s-1])&&_(i.childNodes[s-1],"a")){zt(i.childNodes[s-1],r);return}if(!(0<=s-1&&s-1<i.childNodes.length&&!H(i.childNodes[s-1])&&!D(i.childNodes[s-1],["br","img"])))break;i=i.childNodes[s-1],s=g(i)}if(o=Et(i,s))o.parentNode.removeChild(o);else if(i.nodeType==e.Node.TEXT_NODE&&0!=s)r.setStart(i,s-1),r.setEnd(i,s-1),Rt(i,s-1,i,s);else if(i.nodeType==e.Node.TEXT_NODE&&0==s&&t.browser.msie)s=1,r.setStart(i,s),r.setEnd(i,s),r.startOffset=0,Rt(r);else if(!B(i))if(0<=s-1&&s-1<i.childNodes.length&&D(i.childNodes[s-1],["br","hr","img"]))r.setStart(i,s),r.setEnd(i,s),Rt(r);else if(D(i,["li","dt","dd"])&&i==i.parentNode.firstChild&&0==s){s=[];for(o=i.parentNode;o;o=o.parentNode)_(o,"li")&&s.unshift(o);for(o=0;o<s.length;o++)At(s[o],r);o=dt([i]);Ut([i],r);vt(o,r);D(i,["dd","dt"])&&e(c(i)).every(function(e){return!R(i,e)||!it(i,e)})&&(i=Z(i,Sn,r));Lt(i,r);for(o=0;o<s.length;o++)Ot(s[o].parentNode,r)}else{o=i;for(u=s;;)if(0==u)u=m(o),o=o.parentNode;else{if(!(0<=u-1&&u-1<o.childNodes.length&&F(o.childNodes[u-1])&&$(o.childNodes[u-1])))break;o.removeChild(o.childNodes[u-1]),u--}if(0==s&&e(c(i).concat(i)).filter(function(e){return F(e)&&R(e,i)&&Tt(e)}).length){s=Aloha.createRange();s.setStart(i,0);s.setEnd(i,0);s=Ht(s);s=E(s,function(e){return F(e)&&!I(e)});for(o=0;o<s.length;o++)Jt(s[o],r)}else if(!_(o.childNodes[u],"table"))if(0<=u-1&&u-1<o.childNodes.length&&_(o.childNodes[u-1],"table"))r.setStart(o,u-1),r.setEnd(o,u);else if(0==s&&(_(o.childNodes[u-1],"hr")||_(o.childNodes[u-1],"br")&&(_(o.childNodes[u-1].previousSibling,"br")||!B(o.childNodes[u-1].previousSibling))))r.setStart(i,s),r.setEnd(i,s),Rt(o,u-1,o,u);else{if(D(o.childNodes[u],["li","dt","dd"])&&B(o.childNodes[u].firstChild)&&0!=u){var f=o.childNodes[u-1];B(f.lastChild)&&!_(f.lastChild,"br")&&f.appendChild(document.createElement("br"));B(f.lastChild)&&f.appendChild(document.createElement("br"))}if(D(o.childNodes[u],["li","dt","dd"])&&D(o.childNodes[u-1],["li","dt","dd"]))o=o.childNodes[u-1],u=g(o),i=o.nextSibling,s=0;else for(;0<=u-1&&u-1<o.childNodes.length;)F(o.childNodes[u-1])&&$(o.childNodes[u-1])?(o.removeChild(o.childNodes[u-1]),u--):(o=o.childNodes[u-1],u=g(o));f=Aloha.createRange();f.setStart(o,u);f.setEnd(i,s);Rt(f);if(!document.body&&!r.startContainer||document.body!=r.startContainer&&!a(document.body,r.startContainer))f.startContainer.hasChildNodes()||f.startContainer.nodeType==e.Node.TEXT_NODE?(r.setStart(f.startContainer,f.startOffset),r.setEnd(f.startContainer,f.startOffset)):(r.setStart(f.startContainer.parentNode,m(f.startContainer)),r.setEnd(f.startContainer.parentNode,m(f.startContainer)))}}}else Rt(r)}};var xn="address dd div dt h1 h2 h3 h4 h5 h6 p pre".split(" ");rn.formatblock={action:function(n){/^<.*>$/.test(n)&&(n=n.slice(1,-1));n=n.toLowerCase();if(-1!=e(xn).indexOf(n)){for(var r=Ht(Q()),r=E(r,function(t){return F(t)&&(Ct(t)||it(t,"p")||D(t,["dd","dt"]))&&!e(h(t)).some(P)}),s=dt(r),o=0;o<r.length;o++)for(var u=r[o];e(c(u)).some(function(t){return F(t)&&R(t,u)&&O(t,xn)&&!e(h(t)).some(P)});)Ut([u],range);for(vt(s,range);r.length;){if(kt(r[0]))o=[].slice.call(i(r[0].childNodes)),s=dt(o),zt(r[0],range),vt(s,range),r.shift();else{o=[];for(o.push(r.shift());r.length&&r[0]==o[o.length-1].nextSibling&&!kt(r[0])&&!_(o[o.length-1],"BR");)o.push(r.shift())}Lt(rt(o,-1==t.inArray(n,["div","p"])?function(e){return O(e,n)&&!e.attributes.length}:function(){return!1},function(){return document.createElement(n)},range),range)}}},indeterm:function(){var t=Ht(Q()),t=S(t,function(e){return V(e)&&F(e)&&!e.hasChildNodes()});if(!t.length)return!1;for(var n=null,r=0;r<t.length;r++){for(var i=t[r];F(i.parentNode)&&R(i,i.parentNode)&&!O(i,xn);)i=i.parentNode;var s="";F(i)&&O(i,xn)&&!e(h(i)).some(P)&&(s=i.tagName);if(null===n)n=s;else if(n!=s)return!0}return!1},value:function(){var t=Ht(Q()),t=S(t,function(e){return V(e)&&F(e)&&!e.hasChildNodes()});if(!t.length)return"";for(t=t[0];F(t.parentNode)&&R(t,t.parentNode)&&!O(t,xn);)t=t.parentNode;return F(t)&&O(t,xn)&&!e(h(t)).some(P)?t.tagName.toLowerCase():""}};rn.forwarddelete={action:function(n,r){t.browser.msie&&7>=t.browser.version&&Zt(r,!0);if(r.collapsed){Xt(r.startContainer,r.startOffset);for(var i=r.startContainer,s=r.startOffset;;)if(s==g(i)&&F(i.nextSibling)&&$(i.nextSibling))i.parentNode.removeChild(i.nextSibling);else if(s<i.childNodes.length&&F(i.childNodes[s])&&$(i.childNodes[s]))i.removeChild(i.childNodes[s]);else if(s<i.childNodes.length&&J(i.childNodes[s]))s++;else if(s==g(i)&&B(i)||$(i))s=1+m(i),i=i.parentNode;else{if(!(s<i.childNodes.length&&!H(i.childNodes[s])&&!D(i.childNodes[s],["br","img"])))break;i=i.childNodes[s],s=0}Xt(r.startContainer,r.startOffset);var o;if(o=wt(i,s))o.parentNode.removeChild(o);else if(i.nodeType==e.Node.TEXT_NODE&&s!=g(i)){r.setStart(i,s);r.setEnd(i,s);for(o=s+1;o!=i.length&&/^[\u0300-\u036f\u0591-\u05bd\u05c1\u05c2]$/.test(i.data[o]);)o++;Rt(i,s,i,o)}else if(!B(i))if(s<i.childNodes.length&&D(i.childNodes[s],["br","hr","img"]))r.setStart(i,s),r.setEnd(i,s),Rt(i,s,i,s+1);else{var u=i;for(o=s;;)if(o==g(u))o=1+m(u),u=u.parentNode;else{if(!(o<u.childNodes.length&&F(u.childNodes[o])&&$(u.childNodes[o])))break;u.removeChild(u.childNodes[o])}if(!_(u.childNodes[o-1],"table"))if(_(u.childNodes[o],"table"))r.setStart(u,o),r.setEnd(u,o+1);else if(s==g(i)&&D(u.childNodes[o],["br","hr"]))r.setStart(i,s),r.setEnd(i,s),Rt(u,o,u,o+1);else{for(;o<u.childNodes.length;)F(u.childNodes[o])&&$(u.childNodes[o])?u.removeChild(u.childNodes[o]):(u=u.childNodes[o],o=0);Rt(i,s,u,o)}}}else Rt(r)}};rn.indent={action:function(){for(var e=[],t=Q().endContainer;t!=Q().commonAncestorContainer;t=t.parentNode)_(t,"LI")&&e.unshift(t);for(t=Q().startContainer;t!=Q().commonAncestorContainer;t=t.parentNode)_(t,"LI")&&e.unshift(t);for(t=Q().commonAncestorContainer;t;t=t.parentNode)_(t,"LI")&&e.unshift(t);for(t=0;t<e.length;t++)At(e[t,range]);t=Ht(Q());e=[];e=E(t,function(e){return F(e)&&(it(e,"div")||it(e,"ol"))});for(e.length&&_(e[0],"LI")&&D(e[0].parentNode,["OL","UL"])&&_(e[0].previousSibling,"LI")&&At(e[0].previousSibling,range);e.length;){t=[];for(t.push(e.shift());e.length&&e[0]==t[t.length-1].nextSibling;)t.push(e.shift());$t(t,range)}}};rn.inserthorizontalrule={action:function(t,n){for(;0==n.startOffset&&n.startContainer.parentNode;)n.setStart(n.startContainer.parentNode,m(n.startContainer));for(;n.endOffset==g(n.endContainer)&&n.endContainer.parentNode;)n.setEnd(n.endContainer.parentNode,1+m(n.endContainer));Rt(n,{blockMerging:!1});if(F(Q().startContainer)||j(Q().startContainer)){Q().startContainer.nodeType==e.Node.TEXT_NODE&&0==Q().startOffset&&(Q().setStart(Q().startContainer.parentNode,m(Q().startContainer)),Q().collapse(!0));Q().startContainer.nodeType==e.Node.TEXT_NODE&&Q().startOffset==g(Q().startContainer)&&(Q().setStart(Q().startContainer.parentNode,1+m(Q().startContainer)),Q().collapse(!0));var r=document.createElement("hr");n.insertNode(r);Lt(r,n);n.setStart(r.parentNode,1+m(r));n.setEnd(r.parentNode,1+m(r));Aloha.getSelection().removeAllRanges();Aloha.getSelection().addRange(n)}}};rn.inserthtml={action:function(t,n){Rt(n);if(F(n.startContainer)||j(n.startContainer)){var r=n.createContextualFragment(t),i=r.lastChild;if(i){var s=h(r);H(n.startContainer)&&e(n.startContainer.childNodes).filter(function(e,t){return F(e)&&J(e)&&m(e)>=t.startOffset},!0).forEach(function(e){e.parentNode.removeChild(e)});n.insertNode(r);H(n.startContainer)&&Yt(n.startContainer);n.setStart(i.parentNode,1+m(i));n.setEnd(i.parentNode,1+m(i));for(r=0;r<s.length;r++)Lt(s[r],n);K(n)}}}};rn.insertimage={action:function(e){if(""!==e){var t=Q();Rt(t,{stripWrappers:!1});if(F(Q().startContainer)||j(Q().startContainer)){H(t.startContainer)&&1==t.startContainer.childNodes.length&&_(t.startContainer.firstChild,"br")&&0==t.startOffset&&t.startContainer.removeChild(t.startContainer.firstChild);var n=document.createElement("img");n.setAttribute("src",e);t.insertNode(n);t.setStart(n.parentNode,1+m(n));t.setEnd(n.parentNode,1+m(n));Aloha.getSelection().removeAllRanges();Aloha.getSelection().addRange(t);n.removeAttribute("width");n.removeAttribute("height")}}}};rn.insertlinebreak={action:function(n,r){Rt(r,{stripWrappers:!1});if(F(r.startContainer)||j(r.startContainer))if(r.startContainer.nodeType!=e.Node.ELEMENT_NODE||it("br",r.startContainer))if(r.startContainer.nodeType==e.Node.ELEMENT_NODE||it("br",r.startContainer.parentNode)){if(r.startContainer.nodeType==e.Node.TEXT_NODE&&0==r.startOffset){var i=r.startContainer.parentNode,s=m(r.startContainer);Aloha.getSelection().collapse(i,s);r.setStart(i,s);r.setEnd(i,s)}r.startContainer.nodeType==e.Node.TEXT_NODE&&r.startOffset==g(r.startContainer)&&(i=r.startContainer.parentNode,s=1+m(r.startContainer),Aloha.getSelection().collapse(i,s),r.setStart(i,s),r.setEnd(i,s));i=document.createElement("br");r.insertNode(i);Aloha.getSelection().collapse(i.parentNode,1+m(i));r.setStart(i.parentNode,1+m(i));r.setEnd(i.parentNode,1+m(i));U(i)&&(r.insertNode(Gt()),Aloha.getSelection().collapse(i.parentNode,1+m(i)),r.setStart(i.parentNode,1+m(i)),r.setEnd(i.parentNode,1+m(i)));t.browser.msie&&8>t.browser.version&&i.parentNode.removeAttribute("style")}}};rn.insertorderedlist={action:function(){Kt("ol")},indeterm:function(){return/^mixed( ol)?$/.test(Mt())},state:function(){return"ol"==Mt()}};var Tn={LI:!0,DT:!0,DD:!0};rn.insertparagraph={action:function(t,n){Rt(n);Vt(q(n.startContainer),n);if(F(n.startContainer)||j(n.startContainer)){var r=n.startContainer,i=n.startOffset;r.nodeType==e.Node.TEXT_NODE&&0!=i&&i!=g(r)&&r.splitText(i);r.nodeType==e.Node.TEXT_NODE&&i==g(r)&&(i=1+m(r),r=r.parentNode);if(r.nodeType==e.Node.TEXT_NODE||r.nodeType==e.Node.COMMENT_NODE)i=m(r),r=r.parentNode;Aloha.getSelection().collapse(r,i);n.setStart(r,i);n.setEnd(r,i);for(var o=r;!kt(o)&&F(o.parentNode)&&R(r,o.parentNode);)o=o.parentNode;if(!F(o)||!R(o,r)||!kt(o)){var u=Sn,a=Ht(n),a=E(a,function(e){return it(e,"p")}).slice(0,1);if(!a.length){if(!it(u,n.startContainer))return;o=document.createElement(u);n.insertNode(o);o.appendChild(Gt());Aloha.getSelection().collapse(o,0);n.setStart(o,0);n.setEnd(o,0);return}for(;a[a.length-1].nextSibling&&it(a[a.length-1].nextSibling,"p");)a.push(a[a.length-1].nextSibling);o=rt(a,function(){return!1},function(){return document.createElement(u)},n)}if("ADDRESS"==o.tagName||"LISTING"==o.tagName||"PRE"==o.tagName){var l=document.createElement("br"),a=o.offsetHeight;n.insertNode(l);var p=o.offsetHeight;Aloha.getSelection().collapse(r,i+1);n.setStart(r,i+1);n.setEnd(r,i+1);a==p&&!f(s(l),o)&&(n.insertNode(Gt()),Aloha.getSelection().collapse(r,i+1),n.setEnd(r,i+1))}else if(Tn[o.tagName]&&(!o.hasChildNodes()||1==o.childNodes.length&&_(o.firstChild,"br"))){if(Ut([o],n),D(o,["dd","dt"])&&e(c(o)).every(function(e){return!R(o,e)||!it(o,e)})&&(o=Z(o,Sn,n)),Lt(o,n),_(o,"li")&&_(o.nextSibling,"li")&&D(o.nextSibling.firstChild,["ol","ul"])){r=o.nextSibling;i=o.nextSibling.childNodes.length;for(a=0;a<i;a++)o.appendChild(r.childNodes[0]);r.parentNode.removeChild(r)}}else{i=Aloha.createRange();i.setStart(n.startContainer,n.startOffset);for(i.setEnd(o,g(o));0==i.startOffset&&i.startContainer!=o;)i.setStart(i.startContainer.parentNode,m(i.startContainer));for(;i.startOffset==g(i.startContainer)&&i.startContainer!=o;)i.setStart(i.startContainer.parentNode,1+m(i.startContainer));r=E(i);r=!r.length||1==r.length&&_(r[0],"br");r=/^H[1-6]$/.test(o.tagName)&&r?Sn:"DT"==o.tagName&&r?"dd":"DD"==o.tagName&&r?"dt":o.tagName.toLowerCase();r=document.createElement(r);Y(o,r);r.removeAttribute("id");o.parentNode.insertBefore(r,o.nextSibling);p=S(i);i=i.extractContents();l=h(i);for(a=0;a<l.length;a++)l[a].nodeType==e.Node.ELEMENT_NODE&&-1==e(p).indexOf(l[a])&&l[a].removeAttribute("id");a=[];if(p=i.firstChild)do W(p)||a.push(p);while(p=p.nextSibling);_(r,"li")&&a.length&&D(a[0],["ul","ol"])&&(a=r.offsetHeight,l=Gt(),r.appendChild(l),p=r.offsetHeight,a!==p&&r.removeChild(l));r.appendChild(i);Yt(o);Yt(r);Aloha.getSelection().collapse(r,0);n.setStart(r,0);n.setEnd(r,0)}}}};rn.inserttext={action:function(n,r){Rt(r,{stripWrappers:!1});if(F(r.startContainer)||j(r.startContainer))if(1<n.length)for(var i=0;i<n.length;i++)rn.inserttext.action(n[i],r);else if(""!=n)if("\n"==n)rn.insertparagraph.action("",r);else{var i=r.startContainer,s=r.startOffset;0<=s-1&&s-1<i.childNodes.length&&i.childNodes[s-1].nodeType==e.Node.TEXT_NODE&&(i=i.childNodes[s-1],s=g(i));0<=s&&s<i.childNodes.length&&i.childNodes[s].nodeType==e.Node.TEXT_NODE&&(i=i.childNodes[s],s=0);var o=i.nodeType==e.Node.ELEMENT_NODE?i:i.parentNode;" "==n&&o.nodeType==e.Node.ELEMENT_NODE&&-1==t.inArray(e.getComputedStyle(o).whiteSpace,["pre","pre-wrap"])&&(n=" ");o=Ft(r);i.nodeType==e.Node.TEXT_NODE?(i.insertData(s,n),Aloha.getSelection().collapse(i,s),r.setStart(i,s),Aloha.getSelection().extend(i,s+1),r.setEnd(i,s+1)):(1==i.childNodes.length&&U(i.firstChild)&&i.removeChild(i.firstChild),i=document.createTextNode(n),r.insertNode(i),Aloha.getSelection().collapse(i,0),r.setStart(i,0),Aloha.getSelection().extend(i,1),r.setEnd(i,1));qt(o);Xt(r.startContainer,r.startOffset);Xt(r.endContainer,r.endOffset);Aloha.getSelection().collapseToEnd();r.collapse(!1)}}};rn.insertunorderedlist={action:function(){Kt("ul")},indeterm:function(){return/^mixed( ul)?$/.test(Mt())},state:function(){return"ul"==Mt()}};rn.justifycenter={action:function(e,t){Qt("center",t)},indeterm:function(){var t=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return e(t).some(function(e){return"center"==_t(e)})&&e(t).some(function(e){return"center"!=_t(e)})},state:function(){var t=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return t.length&&e(t).every(function(e){return"center"==_t(e)})},value:function(){var e=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return e.length?_t(e[0]):"left"}};rn.justifyfull={action:function(e,t){Qt("justify",t)},indeterm:function(){var t=
S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return e(t).some(function(e){return"justify"==_t(e)})&&e(t).some(function(e){return"justify"!=_t(e)})},state:function(){var t=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return t.length&&e(t).every(function(e){return"justify"==_t(e)})},value:function(){var e=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return e.length?_t(e[0]):"left"}};rn.justifyleft={action:function(e,t){Qt("left",t)},indeterm:function(){var t=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return e(t).some(function(e){return"left"==_t(e)})&&e(t).some(function(e){return"left"!=_t(e)})},state:function(){var t=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return t.length&&e(t).every(function(e){return"left"==_t(e)})},value:function(){var e=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return e.length?_t(e[0]):"left"}};rn.justifyright={action:function(e,t){Qt("right",t)},indeterm:function(){var t=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return e(t).some(function(e){return"right"==_t(e)})&&e(t).some(function(e){return"right"!=_t(e)})},state:function(){var t=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return t.length&&e(t).every(function(e){return"right"==_t(e)})},value:function(){var e=S(Ht(Q()),function(e){return F(e)&&V(e)&&!e.hasChildNodes()});return e.length?_t(e[0]):"left"}};rn.outdent={action:function(){var t=[];(function(){for(var e=Q().endContainer;e!=Q().commonAncestorContainer;e=e.parentNode)_(e,"li")&&t.unshift(e);for(e=Q().startContainer;e;e=e.parentNode)_(e,"li")&&t.unshift(e)})();e(t).forEach(function(e){At(e,range)});for(var n=Ht(Q()),n=E(n,function(t){return F(t)&&(!e(h(t)).some(F)||D(t,["ol","ul"])||_(t,"li")&&D(t.parentNode,["ol","ul"]))});n.length;){for(;n.length&&(D(n[0],["OL","UL"])||!D(n[0].parentNode,["OL","UL"]));)Jt(n.shift(),range);if(!n.length)break;var r=[];for(r.push(n.shift());n.length&&n[0]==r[r.length-1].nextSibling&&!D(n[0],["OL","UL"]);)r.push(n.shift());var i=dt(r);Ut(r,range);e(r).forEach(Lt);vt(i,range)}}};rn.selectall={action:function(){var e=document.body;e||(e=document.documentElement);e?Aloha.getSelection().selectAllChildren(e):Aloha.getSelection().removeAllRanges()}};rn.stylewithcss={action:function(e){tn="false"!=(""+e).toLowerCase()},state:function(){return tn}};rn.usecss={action:function(e){tn="false"==(""+e).toLowerCase()}};(function(){var t=[],n;for(n in rn)t.push(n);e(t).forEach(function(t){"relevantCssProperty"in rn[t]||(rn[t].relevantCssProperty=null);"inlineCommandActivatedValues"in rn[t]&&!("indeterm"in rn[t])&&(rn[t].indeterm=function(n){var n=e(ot(n,function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE})).map(function(e){return ct(e,t)}),r=e(n).filter(function(n){return e(rn[t].inlineCommandActivatedValues).indexOf(n)!=-1});return r.length>=1&&n.length-r.length>=1});"inlineCommandActivatedValues"in rn[t]&&(rn[t].state=function(n){var r=ot(n,function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE});return r.length==0?e(rn[t].inlineCommandActivatedValues).indexOf(ct(n.startContainer,t))!=-1:e(r).every(function(n){return e(rn[t].inlineCommandActivatedValues).indexOf(ct(n,t))!=-1})});"standardInlineValueCommand"in rn[t]&&(rn[t].indeterm=function(){for(var n=e(ot(Q())).filter(function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE},!0).map(function(e){return ct(e,t)}),r=1;r<n.length;r++)if(n[r]!=n[r-1])return!0;return!1},rn[t].value=function(n){var r=ot(n,function(t){return F(t)&&t.nodeType==e.Node.TEXT_NODE})[0];typeof r=="undefined"&&(r=n.startContainer);return ct(r,t)})})})();return{commands:rn,execCommand:C,queryCommandIndeterm:function(e,t){e=e.toLowerCase();return N(e,"indeterm",t,function(e){return function(){return k(e,t)?rn[e].indeterm(t):!1}}(e))},queryCommandState:L,queryCommandValue:A,queryCommandEnabled:k,queryCommandSupported:function(e){e=e.toLowerCase();return e in rn},copyAttributes:Y,createEndBreak:Gt,isEndBreak:function(e){return _(e,"br")?t(e).hasClass("aloha-end-br"):!1},ensureContainerEditable:Yt,isEditingHost:j,isEditable:F}});define("aloha/selection","aloha/core jquery util/class util/range util/arrays util/strings aloha/console PubSub aloha/engine aloha/ecma5shims aloha/rangy-core".split(" "),function(e,t,n,r,i,s,o,u,a,f){function l(e){var n;if(t.browser.msie&&e.startContainer===e.endContainer&&e.startOffset===e.endOffset&&e.startContainer.nodeType==3&&e.startOffset==e.startContainer.data.length&&e.startContainer.nextSibling){n=e.startContainer.nextSibling;if("OL"===n.nodeName||"UL"===n.nodeName)e.startContainer.data[e.startContainer.data.length-1]==" "?e.startOffset=e.endOffset=e.startOffset-1:e.startContainer.data=e.startContainer.data+" "}}function c(n,r){var s=e.activeEditable?e.activeEditable.obj.parent()[0]:null,s=t(n).parentsUntil(s).get(),o;o=[];var u,a,f;1===n.nodeType&&n.nodeName!=="BODY"&&n.nodeName!=="HTML"?o.push(n.cloneNode(!1).outerHTML):o.push("#"+n.nodeType);f=0;for(a=s.length;f<a;f++){u=s[f];if(u.nodeName==="BODY"||u.nodeName==="HTML")break;o.push(u.cloneNode(!1).outerHTML)}o=o.join("");return r&&n===r.node&&i.equal(r.parents,s)&&o===r.html?null:{node:n,parents:s,html:o}}var h=window.GENTICS,r=n.extend({_constructor:function(){this.rangeObject={};this.preventSelectionChangedFlag=!1;this.tagHierarchy={textNode:{},abbr:{textNode:!0},b:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0,strong:!0},pre:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0},blockquote:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0,p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0},ins:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,u:!0,p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0},ul:{li:!0},ol:{li:!0},li:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,a:!0},tr:{td:!0,th:!0},table:{tr:!0},div:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,table:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,p:!0,div:!0,pre:!0,blockquote:!0,a:!0},h1:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0}};this.tagHierarchy={textNode:this.tagHierarchy.textNode,abbr:this.tagHierarchy.abbr,br:this.tagHierarchy.textNode,img:this.tagHierarchy.textNode,b:this.tagHierarchy.b,strong:this.tagHierarchy.b,code:this.tagHierarchy.b,q:this.tagHierarchy.b,blockquote:this.tagHierarchy.blockquote,cite:this.tagHierarchy.b,i:this.tagHierarchy.b,em:this.tagHierarchy.b,sup:this.tagHierarchy.b,sub:this.tagHierarchy.b,span:this.tagHierarchy.b,del:this.tagHierarchy.del,ins:this.tagHierarchy.ins,u:this.tagHierarchy.b,p:this.tagHierarchy.b,pre:this.tagHierarchy.pre,a:this.tagHierarchy.b,ul:this.tagHierarchy.ul,ol:this.tagHierarchy.ol,li:this.tagHierarchy.li,td:this.tagHierarchy.li,div:this.tagHierarchy.div,h1:this.tagHierarchy.h1,h2:this.tagHierarchy.h1,h3:this.tagHierarchy.h1,h4:this.tagHierarchy.h1,h5:this.tagHierarchy.h1,h6:this.tagHierarchy.h1,table:this.tagHierarchy.table};this.replacingElements={h1:{p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,pre:!0,blockquote:!0}};this.replacingElements={h1:this.replacingElements.h1,h2:this.replacingElements.h1,h3:this.replacingElements.h1,h4:this.replacingElements.h1,h5:this.replacingElements.h1,h6:this.replacingElements.h1,pre:this.replacingElements.h1,p:this.replacingElements.h1,blockquote:this.replacingElements.h1};this.allowedToStealElements={h1:{textNode:!0}};this.allowedToStealElements={h1:this.allowedToStealElements.h1,h2:this.allowedToStealElements.h1,h3:this.allowedToStealElements.h1,h4:this.allowedToStealElements.h1,h5:this.allowedToStealElements.h1,h6:this.allowedToStealElements.h1,p:this.tagHierarchy.b}},SelectionTree:function(){this.domobj={};this.selection=void 0;this.children=[]},onChange:function(t,n,r){this.updateSelectionTimeout&&window.clearTimeout(this.updateSelectionTimeout);var i=this;this.updateSelectionTimeout=window.setTimeout(function(){var s=new e.Selection.SelectionRange(!0);!s.startContainer||"HTML"===s.startContainer.nodeName||"BODY"===s.startContainer.nodeName?this.updateSelectionTimeout||i.onChange(t,n,10+(r||5)*2):e.Selection._updateSelection(n,s)},r||5)},preventSelectionChanged:function(){this.preventSelectionChangedFlag=!0},isSelectionChangedPrevented:function(){var e=this.preventSelectionChangedFlag;this.preventSelectionChangedFlag=!1;return e},isSelectionEditable:function(){return this.rangeObject.commonAncestorContainer&&t(this.rangeObject.commonAncestorContainer).contentEditable()},isFloatingMenuVisible:function(){var n=t(e.Selection.rangeObject.commonAncestorContainer).attr("data-aloha-floatingmenu-visible");return n!=="undefined"&&n==="true"?!0:!1},updateSelection:function(e){return this._updateSelection(e,null)},_updateSelection:function(n,r){if(n&&n.originalEvent&&n.originalEvent.stopSelectionUpdate===!0||typeof r=="undefined")return!1;this.rangeObject=r||new e.Selection.SelectionRange(!0);if(typeof this.rangeObject!="undefined"&&typeof this.rangeObject.startContainer!="undefined"&&this.rangeObject.endContainer!=="undefined"&&(this.rangeObject.startContainer.nodeType===3&&!t(this.rangeObject.startContainer.parentNode).contentEditable()||this.rangeObject.endContainer.nodeType===3&&!t(this.rangeObject.endContainer.parentNode).contentEditable())){e.getSelection().removeAllRanges();return!0}this.rangeObject.update();if(this.isSelectionChangedPrevented())return!0;e.trigger("aloha-selection-changed-before",[this.rangeObject,n]);e.trigger("aloha-selection-changed",[this.rangeObject,n]);var i=this.rangeObject,s=i.startContainer,a=i.endContainer;if(!s||!a)o.warn("aloha/selection","encountered range object without start or end container");else{s=c(s,d);a=c(a,v);if(s||a){d=s;v=a;u.pub("aloha.selection.context-change",{range:i,event:n})}}e.trigger("aloha-selection-changed-after",[this.rangeObject,n]);return!0},getSelectionTree:function(t){if(!t)return this.rangeObject.getSelectionTree();if(!t.commonAncestorContainer){e.Log.error(this,"the rangeObject is missing the commonAncestorContainer");return!1}this.inselection=!1;if(h.Utils.Dom.doCleanup({merge:!0},t)){t.update();t.select()}return this.recursiveGetSelectionTree(t,t.commonAncestorContainer)},recursiveGetSelectionTree:function(n,r){var i=0,s=this,o=[];t(r).contents().each(function(t){var u="none",a=!1,f=!1,l=!1,c=!1,h=!1,p=!1;if(n.isCollapsed()&&r===n.startContainer&&n.startOffset==t){o[i]=new e.Selection.SelectionTree;o[i].selection="collapsed";o[i].domobj=void 0;s.inselection=!1;l=!0;i++}if(!s.inselection&&!l){var d;try{d=this.nodeType}catch(v){return}switch(d){case 3:if(this===n.startContainer){s.inselection=!0;u=n.startOffset>0?"partial":"full";a=n.startOffset;f=this.length}break;case 1:if(this===n.startContainer&&n.startOffset===0){s.inselection=!0;u="full"}if(r===n.startContainer&&n.startOffset===t){s.inselection=!0;u="full"}}}if(s.inselection&&!l){u=="none"&&(u="full");switch(this.nodeType){case 3:if(this===n.endContainer){s.inselection=!1;n.endOffset<this.length&&(u="partial");a===!1&&(a=0);f=n.endOffset}break;case 1:this===n.endContainer&&n.endOffset===0&&(s.inselection=!1)}if(r===n.endContainer&&n.endOffset<=t){s.inselection=!1;u="none"}}o[i]=new e.Selection.SelectionTree;o[i].domobj=this;o[i].selection=u;if(u=="partial"){o[i].startOffset=a;o[i].endOffset=f}o[i].children=s.recursiveGetSelectionTree(n,this);u=o[i].children.length;if(u>0){for(t=0;t<u;++t)switch(o[i].children[t].selection){case"none":c=!0;break;case"full":p=!0;break;case"partial":h=!0}h||p&&c?o[i].selection="partial":p&&!h&&!c&&(o[i].selection="full")}i++});if(n.isCollapsed()&&r===n.startContainer&&n.startOffset==r.childNodes.length){o[i]=new e.Selection.SelectionTree;o[i].selection="collapsed";o[i].domobj=void 0}return o},getRangeObject:function(){return this.rangeObject},isRangeObjectWithinMarkup:function(n,r,i,s,o){var u=this,n=t(r?n.endContainer:n.startContainer).parents(),a=!1,f=-1;typeof s!="undefined"&&typeof s!="function"&&e.Log.error(this,"parameter tagComparator is not a function");typeof s=="undefined"&&(s=function(e,t){return u.standardTextLevelSemanticsComparator(e,t)});n.length>0&&n.each(function(){if(this===o){e.Log.debug(u,"reached limit dom obj");return!1}if(s(this,i)){a===!1&&(a=[]);e.Log.debug(u,"reached object equal to markup");f++;a[f]=this;return!0}});return a},standardSectionsAndGroupingContentComparator:function(t,n){if(t.nodeType!==1){e.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return!1}if(!n[0].nodeName)return!1;var r=e.Selection.replacingElements[t.nodeName.toLowerCase()];return r&&r[n[0].nodeName.toLowerCase()]},standardTagNameComparator:function(t,n){if(t.nodeType===1)return t.nodeName!=n[0].nodeName?!1:!0;e.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return!1},standardTextLevelSemanticsComparator:function(t,n){if(t.nodeType===1)return t.nodeName!=n[0].nodeName||!this.standardAttributesComparator(t,n)?!1:!0;e.Log.debug(this,"only element nodes (nodeType == 1) can be compared");return!1},standardAttributesComparator:function(e,t){var n=s.words(e&&e.className||""),r=s.words(t.length&&t[0].className||"");i.sortUnique(n);i.sortUnique(r);return i.equal(n,r)},changeMarkup:function(n,r,i){var s=r[0].tagName.toLowerCase(),o,u,l=this.isRangeObjectWithinMarkup(n,!1,r,i,o),c=this.isRangeObjectWithinMarkup(n,!0,r,i,o),h,p,d,v;if(this.replacingElements[s]){u=n;n=new this.SelectionRange(n);s=e.activeEditable?e.activeEditable.obj.get(0):t("body");n.update(s);r.isReplacingElement=!0}else if(n.isCollapsed()){e.Log.debug(this,"early returning from applying markup because nothing is currently selected");return!1}o=e.activeEditable?e.activeEditable.obj[0]:t("body");!r.isReplacingElement&&n.startOffset===0&&(d=this.getTextNodeSibling(!1,n.commonAncestorContainer.parentNode,n.startContainer))&&(v=this.isRangeObjectWithinMarkup({startContainer:d,startOffset:0},!1,r,i,o));!r.isReplacingElement&&n.endOffset===n.endContainer.length&&(h=this.getTextNodeSibling(!0,n.commonAncestorContainer.parentNode,n.endContainer))&&(p=this.isRangeObjectWithinMarkup({startContainer:h,startOffset:0},!1,r,i,o));if(!r.isReplacingElement&&l&&!c){e.Log.info(this,"markup 2 non-markup");this.prepareForRemoval(n.getSelectionTree(),r,i);t(l).addClass("preparedForRemoval");this.insertCroppedMarkups(l,n,!1,i)}else if(!r.isReplacingElement&&l&&c){e.Log.info(this,"markup 2 markup");this.prepareForRemoval(n.getSelectionTree(),r,i);this.splitRelevantMarkupObject(l,c,n,i)}else if(!r.isReplacingElement&&(!l&&c||p||v)){e.Log.info(this,"non-markup 2 markup OR with next2markup");if(v&&p){l=new e.Selection.SelectionRange(n);l.startContainer=t(v[v.length-1]).textNodes()[0];l.startOffset=0;l.endContainer=t(p[p.length-1]).textNodes().last()[0];l.endOffset=l.endContainer.length;l.update();this.applyMarkup(l.getSelectionTree(),n,r,i);e.Log.info(this,"double extending previous markup(previous and after selection), actually wrapping it ...")}else if(v&&!p&&!c){this.extendExistingMarkupWithSelection(v,n,!1,i);e.Log.info(this,"extending previous markup")}else if(v&&!p&&c){l=new e.Selection.SelectionRange(n);l.startContainer=t(v[v.length-1]).textNodes()[0];l.startOffset=0;l.endContainer=t(c[c.length-1]).textNodes().last()[0];l.endOffset=l.endContainer.length;l.update();this.applyMarkup(l.getSelectionTree(),n,r,i);e.Log.info(this,"double extending previous markup(previous and relevant at the end), actually wrapping it ...")}else if(!v&&p){this.extendExistingMarkupWithSelection(p,n,!0,i);e.Log.info(this,"extending following markup backwards")}else this.extendExistingMarkupWithSelection(c,n,!0,i)}else if(r.isReplacingElement||!l&&!c&&!v&&!p){e.Log.info(this,"non-markup 2 non-markup");if(n.startContainer!==n.endContainer)c=!1;else if(n.startContainer.nodeType!=1)c=!1;else{c=n.startContainer.firstChild;c=!c||!c.nextSibling&&c.nodeName=="BR"}if(c){r=r.clone();i=n.startContainer!==n.endContainer?!1:n.startContainer.nodeType!=1?!1:a.isEndBreak(n.startContainer);i&&r[0].appendChild(a.createEndBreak());e.activeEditable&&t.browser.mozilla&&e.activeEditable.obj.focus();if(a.isEditable(n.startContainer)){a.copyAttributes(n.startContainer,r[0]);t(n.startContainer).after(r[0]).remove()}else if(a.isEditingHost(n.startContainer)){t(n.startContainer).append(r[0]);a.ensureContainerEditable(r[0])}u.startContainer=r[0];u.endContainer=r[0];u.startOffset=0;u.endOffset=0;return}this.applyMarkup(n.getSelectionTree(),n,r,i,{setRangeObject2NewMarkup:!0});u.startContainer=n.startContainer;u.endContainer=n.endContainer;u.startOffset=n.startOffset;u.endOffset=n.endOffset}if(r.isReplacingElement){if(u&&u.startContainer.className&&u.startContainer.className.indexOf("preparedForRemoval")>-1){i=t(u.startContainer).parents(r[0].tagName).get(0);u.startContainer=i;n.startContainer=i}if(u&&u.endContainer.className&&u.endContainer.className.indexOf("preparedForRemoval")>-1){i=t(u.endContainer).parents(r[0].tagName).get(0);u.endContainer=i;n.endContainer=i}}t(".preparedForRemoval").zap();if(r.isReplacingElement){if(f.Node.ELEMENT_NODE===u.startContainer.nodeType&&u.startContainer.childNodes&&u.startContainer.childNodes.length<u.startOffset){u.startOffset=u.startContainer.childNodes.length;n.startOffset=u.startContainer.childNodes.length}if(f.Node.ELEMENT_NODE===u.endContainer.nodeType&&u.endContainer.childNodes&&u.endContainer.childNodes.length<u.endOffset){u.endOffset=u.endContainer.childNodes.length;n.endOffset=u.endContainer.childNodes.length}n.endContainer=u.endContainer;n.endOffset=u.endOffset;n.startContainer=u.startContainer;n.startOffset=u.startOffset;u.update();u.select()}else{n.update();n.select()}},areMarkupObjectsAsLongAsRangeObject:function(e,n,r){var i,s,o;if(r.startOffset!==0)return!1;i=0;for(o=e.length;i<o;i++){s=t(e[i]);if(s.textNodes().first()[0]!==r.startContainer)return!1}i=0;for(e=n.length;i<e;i++){s=t(n[i]);s=s.textNodes().last()[0];if(s!==r.endContainer||s.length!=r.endOffset)return!1}return!0},splitRelevantMarkupObject:function(e,n,r,i){t(e).addClass("preparedForRemoval");t(n).addClass("preparedForRemoval");if(this.areMarkupObjectsAsLongAsRangeObject(e,n,r))return!0;var s=this.intersectRelevantMarkupObjects(e,n);if(s){this.insertCroppedMarkups([s],r,!1,i);this.insertCroppedMarkups([s],r,!0,i)}else{this.insertCroppedMarkups(e,r,!1,i);this.insertCroppedMarkups(n,r,!0,i)}return!0},intersectRelevantMarkupObjects:function(e,t){var n=!1,r,i,s,o,u,a;if(!e||!t)return n;u=e.length;a=t.length;for(r=0;r<u;r++){i=e[r];for(s=0;s<a;s++){o=t[s];i===o&&(n=i)}}return n},extendExistingMarkupWithSelection:function(e,n,r,i){var s,o,u,a,f,l,c;r||(s=!0);r&&(o=!0);r=[];u=0;for(a=e.length;u<a;u++){r[u]=new this.SelectionRange;f=e[u];if(o&&!s){r[u].startContainer=n.startContainer;r[u].startOffset=n.startOffset;l=t(f).textNodes(!0);c=l.length-1;r[u].endContainer=l[c];r[u].endOffset=l[c].length;r[u].update();this.applyMarkup(r[u].getSelectionTree(),n,this.getClonedMarkup4Wrapping(f),i,{setRangeObject2NewMarkup:!0})}if(!o&&s){l=t(f).textNodes(!0);r[u].startContainer=l[0];r[u].startOffset=0;r[u].endContainer=n.endContainer;r[u].endOffset=n.endOffset;r[u].update();this.applyMarkup(r[u].getSelectionTree(),n,this.getClonedMarkup4Wrapping(f),i,{setRangeObject2NewMarkup:!0})}}return!0},getClonedMarkup4Wrapping:function(e){e=t(e.outerHTML).removeClass("preparedForRemoval").empty();e.attr("class").length===0&&e.removeAttr("class");return e},insertCroppedMarkups:function(e,n,r,i){var s,o,u,a,f;r?o=!0:s=!0;r=[];for(a=0;a<e.length;a++){r[a]=new this.SelectionRange;f=e[a];if(s&&!o){u=t(f).textNodes(!0);r[a].startContainer=u[0];r[a].startOffset=0;if(r[a].startContainer===n.startContainer&&r[a].startOffset===n.startOffset)continue;if(n.startOffset===0){r[a].endContainer=this.getTextNodeSibling(!1,f,n.startContainer);r[a].endOffset=r[a].endContainer.length}else{r[a].endContainer=n.startContainer;r[a].endOffset=n.startOffset}r[a].update();this.applyMarkup(r[a].getSelectionTree(),n,this.getClonedMarkup4Wrapping(f),i,{setRangeObject2NextSibling:!0})}if(!s&&o){r[a].startContainer=n.endContainer;r[a].startOffset=n.endOffset;u=t(f).textNodes(!0);r[a].endContainer=u[u.length-1];r[a].endOffset=u[u.length-1].length;r[a].update();this.applyMarkup(r[a].getSelectionTree(),n,this.getClonedMarkup4Wrapping(f),i,{setRangeObject2PreviousSibling:!0})}}return!0},changeMarkupOnSelection:function(e){var t=this.getRangeObject();this.changeMarkup(t,e,this.getStandardTagComparator(e));h.Utils.Dom.doCleanup({merge:!0},t);t.update();t.select();this.rangeObject=t},applyMarkup:function(t,n,r,i,s){var o,u,s=s?s:{};this.prepareForRemoval(t,r,i);t=this.optimizeSelectionTree4Markup(t,r,i);for(o=0;o<t.length;o++){u=t[o];if(u.wrappable)this.wrapMarkupAroundSelectionTree(u.elements,n,r,i,s);else{e.Log.debug(this,"dive further into non-wrappable object");this.applyMarkup(u.element.children,n,r,i,s)}}},getMarkupType:function(n){var r=t(n)[0].nodeName.toLowerCase();n.outerHtml&&e.Log.debug(this,"Node name detected: "+r+" for: "+n.outerHtml());if(r=="#text")return"textNode";if(this.replacingElements[r])return"sectionOrGroupingContent";if(this.tagHierarchy[r])return"textLevelSemantics";e.Log.warn(this,"unknown markup passed to this.getMarkupType(...): "+n.outerHtml())},getStandardTagComparator:function(e){var t=this;switch(this.getMarkupType(e)){case"textNode":e=function(){return!1};break;case"sectionOrGroupingContent":e=function(e,n){return t.standardSectionsAndGroupingContentComparator(e,n)};break;default:e=function(e,n){return t.standardTextLevelSemanticsComparator(e,n)}}return e},prepareForRemoval:function(n,r,i){var s,o;typeof i!="undefined"&&typeof i!="function"&&e.Log.error(this,"parameter tagComparator is not a function");typeof i=="undefined"&&(i=this.getStandardTagComparator(r));for(s=0;s<n.length;s++){o=n[s];if(o.domobj&&(o.selection=="full"||o.selection=="partial"&&r.isReplacingElement)&&o.domobj.nodeType===1&&i(o.domobj,r)){e.Log.debug(this,"Marking for removal: "+o.domobj.nodeName);t(o.domobj).addClass("preparedForRemoval")}o.selection!="none"&&o.children.length>0&&this.prepareForRemoval(o.children,r,i)}},wrapMarkupAroundSelectionTree:function(n,r,i,s,o){var u=[],a=-1,f="",l="",c,h,p;e.Log.debug(this,"The formatting <"+i[0].tagName+"> will be wrapped around the selection");for(c=0;c<n.length;c++){h=n[c];if(h.domobj&&!this.canTag1WrapTag2(h.domobj.parentNode.tagName.toLowerCase(),i[0].tagName.toLowerCase()))e.Log.info(this,"Skipping the wrapping of <"+i[0].tagName.toLowerCase()+"> because this tag is not allowed inside <"+h.domobj.parentNode.tagName.toLowerCase()+">");else if(!h.domobj||h.domobj.nodeType!==3||t.trim(h.domobj.nodeValue).length!==0){if(h.domobj&&h.selection=="partial"&&!i.isReplacingElement)if(h.startOffset!==void 0&&h.endOffset===void 0){a++;f+=h.domobj.data.substr(0,h.startOffset);h.domobj.data=h.domobj.data.substr(h.startOffset,h.domobj.data.length-h.startOffset);u[a]=h.domobj}else if(h.endOffset!==void 0&&h.startOffset===void 0){a++;l+=h.domobj.data.substr(h.endOffset,h.domobj.data.length-h.endOffset);h.domobj.data=h.domobj.data.substr(0,h.endOffset);u[a]=h.domobj}else if(h.endOffset!==void 0&&h.startOffset!==void 0){if(h.startOffset==h.endOffset){e.Log.debug(this,"skipping empty selection");continue}a++;f+=h.domobj.data.substr(0,h.startOffset);p=h.domobj.data.substr(h.startOffset,h.endOffset-h.startOffset);l+=h.domobj.data.substr(h.endOffset,h.domobj.data.length-h.endOffset);h.domobj.data=p;u[a]=h.domobj}else{e.Log.debug(this,"diving into object");this.applyMarkup(h.children,r,i,s,o)}if(h.domobj&&(h.selection=="full"||h.selection=="partial"&&i.isReplacingElement)){a++;u[a]=h.domobj}}}if(u.length>0){u=t(u);t.each(u,function(e,n){t.browser.msie&&n.nodeType==3&&!n.nextSibling&&!n.previousSibling&&n.parentNode&&n.parentNode.nodeName.toLowerCase()=="li"&&(n.data=t.trim(n.data))});n=u.wrapAll(i).parent();n.before(f).after(l);if(o.setRangeObject2NewMarkup){f=u.textNodes();f.index(r.startContainer)!=-1&&(r.startOffset=0);f.index(r.endContainer)!=-1&&(r.endOffset=r.endContainer.length)}if(o.setRangeObject2NextSibling){f=!0;l=n.textNodes(!0).last()[0];if(u.index(r.startContainer)!=-1){r.startContainer=this.getTextNodeSibling(f,n.parent(),l);r.startOffset=0}if(u.index(r.endContainer)!=-1){r.endContainer=this.getTextNodeSibling(f,n.parent(),l);r.endOffset=r.endOffset-l.length}}if(o.setRangeObject2PreviousSibling){f=!1;l=n.textNodes(!0).first()[0];if(u.index(r.startContainer)!=-1){r.startContainer=this.getTextNodeSibling(f,n.parent(),l);r.startOffset=0}if(u.index(r.endContainer)!=-1){r.endContainer=this.getTextNodeSibling(f,n.parent(),l);r.endOffset=r.endContainer.length}}}},getTextNodeSibling:function(e,n,r){n=t(n).textNodes(!0);r=n.index(r);if(r==-1)return!1;e=r+(e?1:-1);return n[e]?n[e]:!1},optimizeSelectionTree4Markup:function(e,n,r){var i=[],s=0,o=0,u=this,a,f,l,c;typeof r=="undefined"&&(r=function(e,t){return u.standardTextLevelSemanticsComparator(t)});for(a=0;a<e.length;a++)if(e[a].domobj&&e[a].selection!="none")if(n.isReplacingElement&&r(n[0],t(e[a].domobj))){i[s]!==void 0&&s++;i[s]={};i[s].wrappable=!0;i[s].elements=[];i[s].elements[o]=e[a];s++}else if(this.canMarkupBeApplied2ElementAsWhole([e[a]],n)){if(i[s]===void 0){i[s]={};i[s].wrappable=!0;i[s].elements=[]}if(n.isReplacingElement){c=a;for(f=a-1;f>=0;f--){if(!this.canMarkupBeApplied2ElementAsWhole([e[f]],n)||!this.isMarkupAllowedToStealSelectionTreeElement(e[f],n))break;c=f}l=a;for(f=a+1;f<e.length;f++){if(!this.canMarkupBeApplied2ElementAsWhole([e[f]],n)||!this.isMarkupAllowedToStealSelectionTreeElement(e[f],n))break;l=f}o=0;for(f=c;f<=l;f++){i[s].elements[o]=e[f];i[s].elements[o].selection="full";o++}o=0}else{i[s].elements[o]=e[a];o++}}else{i[s]!==void 0&&s++;i[s]={};i[s].wrappable=!1;i[s].element=e[a];o=0;s++}return i},isMarkupAllowedToStealSelectionTreeElement:function(e,t){if(!e.domobj)return!1;var n=e.domobj.nodeName.toLowerCase(),n=n=="#text"?"textNode":n,r=this.allowedToStealElements[t[0].nodeName.toLowerCase()];return r&&r[n]},canMarkupBeApplied2ElementAsWhole:function(e,t){var n,r,i;t.jquery&&(n=t[0].tagName);t.tagName&&(n=t.tagName);for(r=0;r<e.length;r++){i=e[r];if(i.domobj&&(i.selection!="none"||t.isReplacingElement))if(!this.canTag1WrapTag2(n,i.domobj.nodeName)||i.children.length>0&&!this.canMarkupBeApplied2ElementAsWhole(i.children,t))return!1}return!0},canTag1WrapTag2:function(e,t){var e=e=="#text"?"textNode":e.toLowerCase(),t=t=="#text"?"textNode":t.toLowerCase(),n=this.tagHierarchy[e];return!n||!this.tagHierarchy[t]?!0:n[t]},mayInsertTag:function(t){if(typeof this.rangeObject.unmodifiableMarkupAtStart=="object"){for(var n=0;n<this.rangeObject.unmodifiableMarkupAtStart.length;++n)if(!this.canTag1WrapTag2(this.rangeObject.unmodifiableMarkupAtStart[n].nodeName,t))return!1}else e.Log.warn(this,"Unable to determine whether tag "+t+" may be inserted");return!0},toString:function(){return"Aloha.Selection"},SelectionRange:h.Utils.RangeObject.extend({_constructor:function(e){this._super(e);if(e){e.commonAncestorContainer&&(this.commonAncestorContainer=e.commonAncestorContainer);e.selectionTree&&(this.selectionTree=e.selectionTree);e.limitObject&&(this.limitObject=e.limitObject);e.markupEffectiveAtStart&&(this.markupEffectiveAtStart=e.markupEffectiveAtStart);e.unmodifiableMarkupAtStart&&(this.unmodifiableMarkupAtStart=e.unmodifiableMarkupAtStart);e.splitObject&&(this.splitObject=e.splitObject)}},commonAncestorContainer:void 0,selectionTree:void 0,markupEffectiveAtStart:[],unmodifiableMarkupAtStart:[],limitObject:void 0,splitObject:void 0,select:function(){this._super();e.Selection.updateSelection()},update:function(e){this.updatelimitObject();this.updateMarkupEffectiveAtStart();this.updateCommonAncestorContainer(e);this.selectionTree=void 0},getSelectionTree:function(){this.selectionTree||(this.selectionTree=e.Selection.getSelectionTree(this));return this.selectionTree},getSelectedSiblings:function(e){var t=this.getSelectionTree();return this.recursionGetSelectedSiblings(e,t)},recursionGetSelectedSiblings:function(e,t){var n=!1,r=!1,i;for(i=0;i<t.length;++i)if(t[i].domobj===e){r=!0;n=[]}else if(!r&&t[i].children){n=this.recursionGetSelectedSiblings(e,t[i].children);if(n!==!1)break}else if(r&&t[i].domobj&&t[i].selection!="collapsed"&&t[i].selection!="none")n.push(t[i].domobj);else if(r&&t[i].selection=="none")break;return n},updateMarkupEffectiveAtStart:function(){this.markupEffectiveAtStart=[];this.unmodifiableMarkupAtStart=[];var e=this.getStartContainerParents(),t=!1,n,r,i;for(r=0;r<e.length;r++){i=e[r];if(!t&&i!==this.limitObject){this.markupEffectiveAtStart[r]=i;if(!n&&h.Utils.Dom.isSplitObject(i)){n=!0;this.splitObject=i}}else{t=!0;this.unmodifiableMarkupAtStart.push(i)}}n||(this.splitObject=!1)},updatelimitObject:function(){if(e.editables&&e.editables.length>0){var n=this.getStartContainerParents(),r=e.editables,i,s,o,u;for(i=0;i<n.length;i++){s=n[i];for(o=0;o<r.length;o++){u=r[o].obj[0];if(s===u){this.limitObject=s;return!0}}}}this.limitObject=t("body");return!0},toString:function(e){return e?"Aloha.Selection.SelectionRange {start ["+this.startContainer.nodeValue+"] offset "+this.startOffset+", end ["+this.endContainer.nodeValue+"] offset "+this.endOffset+"}":"Aloha.Selection.SelectionRange"}})}),p=n.extend({_constructor:function(e){this._nativeSelection=e;this.ranges=[];this.preventChange=!1},anchorNode:null,anchorOffset:0,focusNode:null,focusOffset:0,isCollapsed:!1,rangeCount:0,collapse:function(e,t){this._nativeSelection.collapse(e,t)},collapseToStart:function(){throw"NOT_IMPLEMENTED"},extend:function(){},modify:function(){},collapseToEnd:function(){throw"NOT_IMPLEMENTED"},selectAllChildren:function(){throw"NOT_IMPLEMENTED"},deleteFromDocument:function(){throw"NOT_IMPLEMENTED"},getRangeAt:function(e){e=this._nativeSelection.getRangeAt(e);l(e);return e},addRange:function(t){this._nativeSelection.addRange(t);var n=this._nativeSelection._ranges;l(t);n[0]=t;e.Selection.updateSelection()},removeRange:function(){this._nativeSelection.removeRange()},removeAllRanges:function(){this._nativeSelection.removeAllRanges()},refresh:function(){},toString:function(){return"Aloha.Selection"},getRangeCount:function(){return this._nativeSelection.rangeCount}});e.getSelection=function(e){e=e!==document||e!==window?window:e;return new p(window.rangy.getSelection(e))};e.createRange=function(e){return window.rangy.createRange(e)};n=new r;e.Selection=n;var d=null,v=null;return n});define("aloha/block-jump",["aloha/core","jquery"],function(e,t){function n(){if(i){var e=i.nodeValue.replace(/\u200b/,"");e===i.nodeValue&&console.warn("Expected to remove the zero width text node fix, but couldn't find it");r(i,e);i=null}}function r(e,n){e.deleteData(0,e.length);""!==n&&(e.nextSibling&&3===e.nextSibling.nodeType?e.nextSibling.insertData(0,n):e.previousSibling&&3===e.previousSibling.nodeType?e.previousSibling.insertData(e.previousSibling.length,n):e.insertData(0,n));setTimeout(function(){0===e.length&&t(e).remove()},0)}var i=null;return{removeZeroWidthTextNodeFix:n,insertZeroWidthTextNodeFix:function(r,s){n();i=document.createTextNode("​");s?t(r).after(i):t(r).before(i);e.bind("aloha-selection-changed",function(t){n();e.unbind(t)});return i}}});define("aloha/markup","aloha/core util/class jquery aloha/ecma5shims aloha/console aloha/block-jump".split(" "),function(e,t,n,r,i,s){function o(e){return"false"===n(e).attr("contenteditable")}function u(e){return e&&3===e.nodeType}function a(e){return e?u(e)?e.length:e.childNodes.length:0}function f(e){return e?e.nextSibling?u(e.nextSibling)&&!(0<e.nextSibling.data.replace(/\s+/g,"").length)||"BR"===e.nextSibling.nodeName&&e.nextSibling===e.parentNode.lastChild||""===e.nextSibling.innerHTML&&!o(e.nextSibling)?f(e.nextSibling):e.nextSibling:e.parentNode?f(e.parentNode):null:null}function l(e){return e?e.previousSibling?!u(e.previousSibling)||0<e.previousSibling.data.replace(/\s+/g,"").length?""===e.previousSibling.innerHTML&&!o(e.previousSibling)?l(e.previouSibling):e.previousSibling:l(e.previousSibling):e.parentNode?l(e.parentNode):null:null}function c(e){var t;if(t=window.$_alohaPlaceholder){t=e.startContainer;var e=e.endContainer,i=window.$_alohaPlaceholder;t=!(i.is(t)||i.is(e)||(p?r.compareDocumentPosition(i[0],t)&16:0<n(i[0]).find(t).length)||(p?r.compareDocumentPosition(i[0],e)&16:0<n(i[0]).find(e).length))}if(t){0===window.$_alohaPlaceholder.html().replace(/^(&nbsp;)*$/,"").length&&window.$_alohaPlaceholder.remove();window.$_alohaPlaceholder=null}}var h=window.GENTICS,p=!!(n.browser.msie&&9>parseInt(n.browser.version,10));e.Markup=t.extend({keyHandlers:{},addKeyHandler:function(e,t){this.keyHandlers
[e]||(this.keyHandlers[e]=[]);this.keyHandlers[e].push(t)},removeKeyHandler:function(e){this.keyHandlers[e]&&(this.keyHandlers[e]=null)},insertBreak:function(){var t=e.Selection.rangeObject,r,i;t.isCollapsed()||this.removeSelectedMarkup();i=n("<br/>");h.Utils.Dom.insertIntoDOM(i,t,e.activeEditable.obj);if(r=h.Utils.Dom.searchAdjacentTextNode(i.parent().get(0),h.Utils.Dom.getIndexInParent(i.get(0))+1,!1)){nonWSIndex=r.data.search(/\S/);nonWSIndex>0&&(r.data=r.data.substring(nonWSIndex))}t.startContainer=t.endContainer=i.get(0).parentNode;t.startOffset=t.endOffset=h.Utils.Dom.getIndexInParent(i.get(0))+1;t.correctRange();t.clearCaches();t.select()},preProcessKeyStrokes:function(t){if(t.type!=="keydown")return!1;var n,r;if(this.keyHandlers[t.keyCode]){n=this.keyHandlers[t.keyCode];for(r=0;r<n.length;++r)if(!n[r](t))return!1}if(t.keyCode===37||t.keyCode===39){if(e.getSelection().getRangeCount()){n=e.getSelection().getRangeAt(0);if(this.processCursor(n,t.keyCode)){c(e.Selection.rangeObject);return!0}}return!1}if(t.keyCode===8){t.preventDefault();e.execCommand("delete",!1);return!1}if(t.keyCode===46){e.execCommand("forwarddelete",!1);return!1}if(t.keyCode===13){t.shiftKey?e.execCommand("insertlinebreak",!1):e.execCommand("insertparagraph",!1);return!1}return!0},processCursor:function(t,r){if(!t.collapsed)return!0;s.removeZeroWidthTextNodeFix();var i=t.startContainer,v=e.getSelection();if(!i)return!0;var y;if(n.browser.msie&&parseInt(n.browser.version,10)<=7&&u(i))if(r==37){for(var w=t.startOffset;w>0&&i.data.charAt(w-1)==="​";)w--;if(w!=t.startOffset){t.setStart(t.startContainer,w);t.setEnd(t.startContainer,w);v=e.getSelection();v.removeAllRanges();v.addRange(t)}}else if(r==39){for(w=t.startOffset;w<i.data.length&&i.data.charAt(w)==="​";)w++;if(w!=t.startOffset){t.setStart(t.startContainer,w);t.setEnd(t.startContainer,w);v.removeAllRanges();v.addRange(t)}}if(p&&!n(i).contentEditable()){w=n(i).parents("[contenteditable=false]");if(w.length>0){if(!w.parent().hasClass("aloha-editable"))return!0;y=w[0]}}if(!y){var E=37===r||38===r,w=t.startOffset;if(u(i))if(E){if(1!==w&&!(0===w||w<=i.data.length-i.data.replace(/^\s+/,"").length))return!0}else{y=i;v=a(y);if(v===w)y=!0;else{var S=u(y);y=S&&y.data.replace(/\s+$/,"").length===w?!0:1===v&&!S?"BR"===y.childNodes[0].nodeName:!1}if(!y)return!0}else i=i.childNodes[w===a(i)?w-1:w];y=E?l(i):f(i)}if(o(y)){i=y;y=new h.Utils.RangeObject;w=E?l(i):f(i);if(!w||o(w)){w=n("<div>&nbsp;</div>");E?n(i).before(w):n(i).after(w);y.startContainer=y.endContainer=w[0];y.startOffset=y.endOffset=0;c(y);window.$_alohaPlaceholder=w}else{if(t.startContainer.nodeType===3&&t.startContainer===t.endContainer&&t.startContainer.nodeValue!==""&&(E?t.startOffset===1:t.endOffset+1===t.endContainer.length)||t.startContainer.nodeType===1&&(!t.startOffset||t.startContainer.childNodes[t.startOffset]&&t.startContainer.childNodes[t.startOffset].nodeType===1)){w=s.insertZeroWidthTextNodeFix(i,E);y.startContainer=y.endContainer=w;y.startOffset=y.endOffset=E?1:0}else{y.startContainer=y.endContainer=w;y.startOffset=y.endOffset=E?a(w):0;E||s.insertZeroWidthTextNodeFix(i,!0)}c(y)}y.select();e.trigger("aloha-block-selected",i);e.Selection.preventSelectionChanged();return!1}return!0},processShiftEnter:function(e){this.insertHTMLBreak(e.getSelectionTree(),e)},processEnter:function(e){e.splitObject?this.splitRangeObject(e):this.insertHTMLBreak(e.getSelectionTree(),e)},insertHTMLCode:function(t){var r=e.Selection.rangeObject;this.insertHTMLBreak(r.getSelectionTree(),r,n(t))},insertHTMLBreak:function(t,r,i){var s,o,u,a,f,i=i?i:n("<br/>");s=0;for(o=t.length;s<o;++s){u=t[s];a=u.domobj?n(u.domobj):void 0;if(u.selection!=="none")if(u.selection=="collapsed"){if(s>0){u=n(t[s-1].domobj);u.after(i)}else{u=n(t[1].domobj);u.before(i)}r.startContainer=r.endContainer=i[0].parentNode;r.startOffset=r.endOffset=h.Utils.Dom.getIndexInParent(i[0])+1;r.correctRange()}else if(u.domobj&&u.domobj.nodeType===3){u.domobj.nextSibling&&u.domobj.nextSibling.nodeType==1&&e.Selection.replacingElements[u.domobj.nextSibling.nodeName.toLowerCase()]&&a.after("<br/>");if(this.needEndingBreak()){for(f=u.domobj;f;)if(f.nextSibling)f=!1;else{f=f.parentNode;if(h.Utils.Dom.isBlockLevelElement(f)||h.Utils.Dom.isListElement(f))break;f===r.limitObject&&(f=!1)}f&&n(f).append('<br class="aloha-cleanme" />')}a.between(i,u.startOffset);a=0;for(u=i[0];u;){u=u.previousSibling;++a}r.startContainer=i[0].parentNode;r.endContainer=i[0].parentNode;r.startOffset=a;r.endOffset=a;r.correctRange()}else if(u.domobj&&u.domobj.nodeType===1){if(a.parent().find("br.aloha-ephemera").length===0){n(r.limitObject).find("br.aloha-ephemera").remove();n(r.commonAncestorContainer).append(this.getFillUpElement(r.splitObject))}a.after(i);r.startContainer=r.commonAncestorContainer;r.endContainer=r.startContainer;r.startOffset=s+2;r.endOffset=s+2;r.update()}}r.select()},needEndingBreak:function(){return!n.browser.msie},getSelectedText:function(){var t=e.Selection.rangeObject;return t.isCollapsed()?!1:this.getFromSelectionTree(t.getSelectionTree(),!0)},getFromSelectionTree:function(e,t){var r="",i,s,o,u;i=0;for(s=e.length;i<s;i++){o=e[i];if(o.selection=="partial"){if(o.domobj.nodeType===3)r+=o.domobj.data.substring(o.startOffset,o.endOffset);else if(o.domobj.nodeType===1&&o.children)if(t)r+=this.getFromSelectionTree(o.children,t);else{u=n(o.domobj.outerHTML).empty();u.html(this.getFromSelectionTree(o.children,t));r+=u.outerHTML()}}else o.selection=="full"&&(o.domobj.nodeType===3?r+=n(o.domobj).text():o.domobj.nodeType===1&&o.children&&(r+=t?n(o.domobj).text():n(o.domobj).outerHTML()))}return r},getSelectedMarkup:function(){var t=e.Selection.rangeObject;return t.isCollapsed()?null:this.getFromSelectionTree(t.getSelectionTree(),!1)},removeSelectedMarkup:function(){var t=e.Selection.rangeObject,n;if(!t.isCollapsed()){n=new e.Selection.SelectionRange;this.removeFromSelectionTree(t.getSelectionTree(),n);n.update();h.Utils.Dom.doCleanup({merge:!0,removeempty:!0},e.Selection.rangeObject);e.Selection.rangeObject=n;n.correctRange();n.update();n.select();e.Selection.updateSelection()}},removeFromSelectionTree:function(e,t){var r,i,s,o,u;s=0;for(u=e.length;s<u;s++){o=e[s];if(o.selection=="partial"){if(o.domobj.nodeType===3){i="";o.startOffset>0&&(i+=o.domobj.data.substring(0,o.startOffset));o.endOffset<o.domobj.data.length&&(i+=o.domobj.data.substring(o.endOffset,o.domobj.data.length));o.domobj.data=i;if(!t.startContainer){t.startContainer=t.endContainer=o.domobj;t.startOffset=t.endOffset=o.startOffset}}else if(o.domobj.nodeType===1&&o.children){this.removeFromSelectionTree(o.children,t);if(r){if(r.nodeName==o.domobj.nodeName){n(r).append(n(o.domobj).contents());n(o.domobj).remove()}}else r=o.domobj}}else if(o.selection=="full"){if(!t.startContainer)if(i=h.Utils.Dom.searchAdjacentTextNode(o.domobj.parentNode,h.Utils.Dom.getIndexInParent(o.domobj)+1,!1,{blocklevel:!1})){t.startContainer=t.endContainer=i;t.startOffset=t.endOffset=0}else{t.startContainer=t.endContainer=o.domobj.parentNode;t.startOffset=t.endOffset=h.Utils.Dom.getIndexInParent(o.domobj)+1}n(o.domobj).remove()}}},splitRangeObject:function(t){n(t.splitObject);var r,i;t.update(t.splitObject);r=t.getSelectionTree();i=this.getSplitFollowUpContainer(t);this.splitRangeObjectHelper(r,t,i);i.hasClass("preparedForRemoval")&&i.removeClass("preparedForRemoval");r=this.getInsertAfterObject(t,i);n(i).insertAfter(r);t.splitObject.nodeName.toLowerCase()==="li"&&!e.Selection.standardTextLevelSemanticsComparator(t.splitObject,i)&&n(t.splitObject).remove();t.startContainer=null;r=i.contents();r.length>0&&r.get(0).nodeType==1&&r.get(0).nodeName.toLowerCase()==="br"&&(t.startContainer=i.get(0));t.startContainer||(t.startContainer=i.textNodes(!0,!0).first().get(0));t.startContainer||(t.startContainer=i.textNodes(!1).first().parent().get(0));if(t.startContainer){t.endContainer=t.startContainer;t.startOffset=0;t.endOffset=0}else{t.startContainer=t.endContainer=i.parent().get(0);t.startOffset=t.endOffset=h.Utils.Dom.getIndexInParent(i.get(0))}t.update();t.select()},getInsertAfterObject:function(t,r){var i,s,o;for(s=0;s<t.markupEffectiveAtStart.length;s++){o=t.markupEffectiveAtStart[s];o===t.splitObject&&(i=!0);if(i&&e.Selection.canTag1WrapTag2(n(o).parent()[0].nodeName,r[0].nodeName))return o}return!1},getFillUpElement:function(){return n.browser.msie?!1:n('<br class="aloha-cleanme"/>')},removeElementContentWhitespaceObj:function(e){var t=0,n=[],r,i;for(r=0;r<e.length;++r){i=e[r];i.isElementContentWhitespace&&(n[n.length]=r)}for(r=0;r<n.length;++r){i=n[r];e.splice(i-t,1);++t}},splitRangeObjectHelper:function(t,r,i,s){i||e.Log.warn(this,"no followUpContainer, no inBetweenMarkup, nothing to do...");var o=this.getFillUpElement(r.splitObject),u=n(r.splitObject),a=!1,f,l,c,p,d;if(t.length>0){c=i.contents();c.length!==t.length&&this.removeElementContentWhitespaceObj(c);l=0;for(d=t.length;l<d;++l){f=t[l];if(f.selection==="none"&&a===!1||f.domobj&&f.domobj.nodeType===3&&f===t[t.length-1]&&f.startOffset===f.domobj.data.length)if(i.textNodes().length>1||f.domobj.nodeType===1&&f.children.length===0)c.eq(l).remove();else if(h.Utils.Dom.isSplitObject(i[0]))o?i.html(o):i.empty();else{i.empty();i.addClass("preparedForRemoval")}else if(f.selection!=="none"){if(f.domobj&&f.domobj.nodeType===3&&f.startOffset!==void 0){a=f.domobj.data;if(f.startOffset>0)f.domobj.data=a.substr(0,f.startOffset);else if(t.length>1)n(f.domobj).remove();else{p=n(f.domobj).parent();h.Utils.Dom.isSplitObject(p[0])?o?p.html(o):p.empty():p.remove()}if(a.length-f.startOffset>0)c[l].data=a.substr(f.startOffset,a.length);else if(c.length>1)c.eq(l).remove();else if(h.Utils.Dom.isBlockLevelElement(i[0]))o?i.html(o):i.empty();else{i.empty();i.addClass("preparedForRemoval")}}a=!0;f.children.length>0&&this.splitRangeObjectHelper(f.children,r,c.eq(l),s)}else f.selection==="none"&&a===!0&&n(f.domobj).remove()}}else e.Log.error(this,"can not split splitObject due to an empty selection tree");u.find("br.aloha-ephemera:gt(0)").remove();i.find("br.aloha-ephemera:gt(0)").remove();u.find(".preparedForRemoval").remove();i.find(".preparedForRemoval").remove();u.contents().length===0&&h.Utils.Dom.isSplitObject(u[0])&&o&&u.html(o);i.contents().length===0&&h.Utils.Dom.isSplitObject(i[0])&&o&&i.html(o)},getSplitFollowUpContainer:function(e){var t;switch(e.splitObject.nodeName.toLowerCase()){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":if((t=n(e.splitObject).textNodes(":not(.aloha-cleanme)").last()[0])&&e.startContainer===t&&e.startOffset===t.length){t=n("<p></p>");e=n(e.splitObject.outerHTML).contents();t.append(e);return t}break;case"li":if(e.startContainer.nodeName.toLowerCase()==="br"&&n(e.startContainer).hasClass("aloha-ephemera")){t=n("<p></p>");e=n(e.splitObject.outerHTML).contents();t.append(e);return t}if(!e.splitObject.nextSibling&&n.trim(n(e.splitObject).text()).length===0)return t=n("<p></p>")}return n(e.splitObject.outerHTML)},transformDomObject:function(e,t,r){var i=n(e),t=n("<"+t+">"),s,o=i[0].cloneNode(!1).attributes;if(o)for(s=0;s<o.length;++s)(typeof o[s].specified=="undefined"||o[s].specified)&&t.attr(o[s].nodeName,o[s].nodeValue);i[0].style&&i[0].style.cssText&&(t[0].style.cssText=i[0].style.cssText);i.contents().appendTo(t);i.replaceWith(t);if(r){r.startContainer==e&&(r.startContainer=t.get(0));r.endContainer==e&&(r.endContainer=t.get(0))}return t},toString:function(){return"Aloha.Markup"}});e.Markup=new e.Markup;return e.Markup});define("aloha/observable",["jquery"],function(e){return{_eventHandlers:null,bind:function(e,t,n){this._eventHandlers=this._eventHandlers||{};this._eventHandlers[e]||(this._eventHandlers[e]=[]);this._eventHandlers[e].push({handler:t,scope:n?n:window})},unbind:function(t,n){this._eventHandlers=this._eventHandlers||{};this._eventHandlers[t]&&(this._eventHandlers[t]=n?e.grep(this._eventHandlers[t],function(e){return e.handler===n?!1:!0}):[])},trigger:function(t){this._eventHandlers=this._eventHandlers||{};if(this._eventHandlers[t]){var n=[];e.each(arguments,function(e,t){0<e&&n.push(t)});e.each(this._eventHandlers[t],function(e,t){t.handler.apply(t.scope,n)})}},unbindAll:function(){this._eventHandlers=null}}});define("aloha/registry",["jquery","aloha/observable","util/class"],function(e,t,n){return n.extend(t,{_entries:null,_ids:null,_constructor:function(){this._entries={};this._ids=[]},register:function(e,t){this._entries[e]=t;this._ids.push(e);this.trigger("register",t,e)},unregister:function(e){var t,n=this._entries[e];delete this._entries[e];for(t in this._ids)if(this._ids.hasOwnProperty(t)&&this._ids[t]===e){this._ids.splice(t,1);break}this.trigger("unregister",n,e)},get:function(e){return this._entries[e]},has:function(e){return this._entries[e]?!0:!1},getEntries:function(){return e.extend({},this._entries)},getIds:function(){return e.extend([],this._ids)}})});define("aloha/contenthandlermanager",["jquery","aloha/registry","util/class","aloha/console"],function(e,t,n,r){return new(t.extend({createHandler:function(e){if("function"!=typeof e.handleContent)throw"ContentHandler has no function handleContent().";return new(n.extend({handleContent:function(){}},e))},handleContent:function(e,t){var n,i;n=this.getIds();if("undefined"==typeof t.contenthandler)for(i in t.contenthandler=[],n)n.hasOwnProperty(i)&&t.contenthandler.push(n[i]);for(i in t.contenthandler)if(t.contenthandler.hasOwnProperty(i)&&((n=this.get(t.contenthandler[i]))&&("function"==typeof n.handleContent?e=n.handleContent(e,t):r.error("A valid content handler needs the method handleContent.")),null===e))break;return e}}))});define("aloha/editable","aloha/core util/class jquery aloha/pluginmanager aloha/selection aloha/markup aloha/contenthandlermanager aloha/console aloha/block-jump".split(" "),function(e,t,n,r,i,s,o,u,a){function f(e){if(n.browser.msie&&n.browser.version<8){e=n(e);e.find("[hidefocus]").each(function(){n(this).removeAttr("hidefocus")});e.find("[hideFocus]").each(function(){n(this).removeAttr("hideFocus")});e.find("[tabindex]").each(function(){n(this).removeAttr("tabindex")});e.find("[tabIndex]").each(function(){n(this).removeAttr("tabIndex")})}}var l=window.unescape,c=window.GENTICS,h=!1,p={};e.defaults.contentHandler={};e.defaults.contentHandler.initEditable=["blockelement","sanitize"];e.defaults.contentHandler.getContents=["blockelement","sanitize","basic"];typeof e.settings.contentHandler=="undefined"&&(e.settings.contentHandler={});var d=function(e){return n(e).html()},v=o.createHandler({handleContent:function(e){n.browser.msie&&n.browser.version<8&&(e=e.replace(/(<table\s+[^>]*?)contenteditable=['\"\w]+/gi,"$1"));return e=this.stringFizzleSizzle(e)},stringFizzleSizzle:function(e){for(var t=e;e!==(t=e.replace(/(<[^>]*?)(nodeIndex|sizcache|sizset|jquery)[\w\d]*="[^"]*"/gi,"$1"));)e=t;return e}});o.register("basic",v);e.Editable=t.extend({_constructor:function(t){t.attr("id")||t.attr("id",c.Utils.guid());this.originalObj=this.obj=t;this.ready=!1;this.sccDelimiters=[":",";",".","!","?",",",l("%u0009"),l("%u0020"),l("%u0008"),l("%u007F"),"Enter"];this.sccIdle=5e3;this.sccDelay=500;this.sccTimerDelay=this.sccTimerIdle=!1;this.keyCodeMap={93:"Apps",18:"Alt",20:"CapsLock",17:"Control",40:"Down",35:"End",13:"Enter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",36:"Home",45:"Insert",37:"Left",224:"Meta",34:"PageDown",33:"PageUp",19:"Pause",44:"PrintScreen",39:"Right",145:"Scroll",16:"Shift",38:"Up",91:"Win",92:"Win"};this.placeholderClass="aloha-placeholder";e.registerEditable(this);this.init()},init:function(){var t=this;if((this.settings=e.settings)&&e.settings.smartContentChange){e.settings.smartContentChange.delimiters&&(this.sccDelimiters=e.settings.smartContentChange.delimiters);e.settings.smartContentChange.idle&&(this.sccIdle=e.settings.smartContentChange.idle);e.settings.smartContentChange.delay&&(this.sccDelay=e.settings.smartContentChange.delay)}if(this.check(this.obj)){typeof e.settings.contentHandler.getContents=="undefined"&&(e.settings.contentHandler.getContents=e.defaults.contentHandler.getContents);typeof e.settings.contentHandler.initEditable=="undefined"&&(e.settings.contentHandler.initEditable=e.defaults.contentHandler.initEditable);var r=t.obj.html(),r=o.handleContent(r,{contenthandler:e.settings.contentHandler.initEditable,command:"initEditable"});t.obj.html(r);e.bind("aloha-ready",function(){t.obj.addClass("aloha-editable").contentEditable(!0);t.obj.mousedown(function(n){if(!e.eventHandled){e.eventHandled=!0;return t.activate(n)}});t.obj.mouseup(function(){e.eventHandled=!1});t.obj.focus(function(e){return t.activate(e)});t.obj.add(".aloha-block",t.obj).keydown(function(e){var n=s.preProcessKeyStrokes(e);t.keyCode=e.which;n||t.smartContentChange(e);return n});t.obj.keypress(function(t){e.activeEditable.smartContentChange(t)});t.obj.keyup(function(t){if(t.keyCode===27){e.deactivateEditable();return!1}});t.obj.contentEditableSelectionChange(function(e){i.onChange(t.obj,e);return t.obj});t.setUnmodified();t.snapshotContent=t.getContents();n.browser.mozilla&&t.initEmptyEditable();t.initPlaceholder();t.ready=!0;e.trigger("aloha-editable-created",[t])})}else this.destroy()},isActive:!1,originalContent:null,range:void 0,check:function(){var e=this,t=this.obj,r=t.get(0).nodeName.toLowerCase(),i=["a","abbr","address","article","aside","b","bdo","blockquote","cite","code","command","del","details","dfn","div","dl","em","footer","h1","h2","h3","h4","h5","h6","header","i","ins","menu","nav","p","pre","q","ruby","section","small","span","strong","sub","sup","var"],s;for(s=0;s<i.length;++s)if(r===i[s])return!0;switch(r){case"textarea":case"input":r=n('<div id="'+this.getId()+'-aloha" class="aloha-'+r+'" />').insertAfter(t);r.height(t.height()).width(t.width()).html(t.val());t.hide();t.parents("form:first").submit(function(){t.val(e.getContents())});this.obj=r;return!0}return!1},initPlaceholder:function(){e.settings.placeholder&&this.isEmpty()&&this.addPlaceholder()},isEmpty:function(){var e=n.trim(this.getContents());return e.length===0||(e==="<br>"?!0:!1)},initEmptyEditable:function(){var e=this.obj;this.empty(this.getContents())&&n(e).prepend('<br class="aloha-cleanme" />')},addPlaceholder:function(){var t=n("<div>"),r=n("<span>"),i,s=this.obj;i=c.Utils.Dom.allowsNesting(s[0],t[0])?t:r;if(n("."+this.placeholderClass,s).length===0){n(s).append(i.addClass(this.placeholderClass));n.each(e.settings.placeholder,function(e,t){s.is(e)&&i.html(t)});n("br",s).remove()}},removePlaceholder:function(e,t){var r=this.placeholderClass,s;n("."+this.placeholderClass,e).length!==0&&(t===!0?window.setTimeout(function(){s=new i.SelectionRange;s.startContainer=s.endContainer=e.get(0);s.startOffset=s.endOffset=0;n("."+r,e).remove();s.select()},100):n("."+r,e).remove())},destroy:function(){this===e.getActiveEditable()&&this.blur();switch(this.originalObj.get(0).nodeName.toLowerCase()){case"textarea":case"input":this.originalObj.val(this.getContents());this.obj.remove();this.originalObj.show()}this.ready=!1;this.removePlaceholder(this.obj);this.obj.removeClass("aloha-editable").contentEditable(!1).unbind("mousedown click dblclick focus keydown keypress keyup");e.trigger("aloha-editable-destroyed",[this]);e.unregisterEditable(this)},setUnmodified:function(){this.originalContent=this.getContents()},isModified:function(){return this.originalContent!==this.getContents()},toString:function(){return"Aloha.Editable"},isDisabled:function(){return!this.obj.contentEditable()||this.obj.contentEditable()==="false"},disable:function(){return this.isDisabled()||this.obj.contentEditable(!1)},enable:function(){return this.isDisabled()&&this.obj.contentEditable(!0)},activate:function(t){var n=e.getActiveEditable();if(h)h=!1;else if((!t||t.type!=="focus"||n===null||n.obj.parent().get(0)!==t.currentTarget)&&!this.isActive&&!this.isDisabled()){this.obj.addClass("aloha-editable-active");e.activateEditable(this);h=!0;this.removePlaceholder(this.obj,!0);h=!1;this.isActive=!0;e.trigger("aloha-editable-activated",{oldActive:n,editable:this})}},blur:function(){this.obj.blur();this.isActive=!1;this.initPlaceholder();this.obj.removeClass("aloha-editable-active");e.trigger("aloha-editable-deactivated",{editable:this});e.activeEditable.smartContentChange({type:"blur"},null)},empty:function(e){return null===e||n.trim(e)===""||e==="<br/>"},getContents:function(t){var i=this.obj.html(),s=p[this.getId()];if(!s||i!==s.raw){a.removeZeroWidthTextNodeFix();var u=this.obj.clone(!1);u.find(".aloha-cleanme").remove();this.removePlaceholder(u);r.makeClean(u);f(u);u=n("<div>"+o.handleContent(u.html(),{contenthandler:e.settings.contentHandler.getContents,command:"getContents"})+"</div>");s=p[this.getId()]={};s.raw=i;s.element=u}if(t)return s.element.clone().contents();null==s.serialized&&(s.serialized=d(s.element[0]));return s.serialized},setContents:function(t,n){var r=null;if(e.getActiveEditable()===this){e.deactivateEditable();r=this}this.obj.html(t);null!==r&&r.activate();this.smartContentChange({type:"set-contents"});return n?this.obj.contents():d(this.obj[0])},getId:function(){return this.obj.attr("id")},smartContentChange:function(t){function r(){null==a&&(a=i.getSnapshotContent());return a}var i=this,s=null,o;if(t&&(t.metaKey||t.crtlKey||t.altKey))return!1;if(t&&t.originalEvent){o=/U\+(\w{4})/;o.exec(t.originalEvent.keyIdentifier);s=this.keyCodeMap[this.keyCode]||String.fromCharCode(t.which)||"unknown"}var a=null;if(n.inArray(s,this.sccDelimiters)>=0){clearTimeout(this.sccTimerIdle);clearTimeout(this.sccTimerDelay);this.sccTimerDelay=window.setTimeout(function(){e.trigger("aloha-smart-content-changed",{editable:i,keyIdentifier:t.originalEvent.keyIdentifier,keyCode:t.keyCode,"char":s,triggerType:"keypress",getSnapshotContent:r});u.debug("Aloha.Editable","smartContentChanged: event type keypress triggered")},this.sccDelay)}else if(t&&t.type==="paste")e.trigger("aloha-smart-content-changed",{editable:i,keyIdentifier:null,keyCode:null,"char":null,triggerType:"paste",getSnapshotContent:r});else if(t&&t.type==="blur")e.trigger("aloha-smart-content-changed",{editable:i,keyIdentifier:null,keyCode:null,"char":null,triggerType:"blur",getSnapshotContent:r});else if(s!==null){clearTimeout(this.sccTimerDelay);clearTimeout(this.sccTimerIdle);this.sccTimerIdle=window.setTimeout(function(){e.trigger("aloha-smart-content-changed",{editable:i,keyIdentifier:null,keyCode:null,"char":null,triggerType:"idle",getSnapshotContent:r})},this.sccIdle)}},getSnapshotContent:function(){var e=this.snapshotContent;this.snapshotContent=this.getContents();return e}});e.Editable.setContentSerializer=function(e){d=e};e.Editable.getContentSerializer=function(){return d}});define("aloha/plugin",["aloha/core","jquery","util/class","aloha/pluginmanager","aloha/console"],function(e,t,n,r,i){var s=n.extend({name:null,defaults:{},settings:{},dependencies:[],_constructor:function(e){"string"!=typeof e?i.error("Cannot initialise unnamed plugin, skipping"):this.name=e},checkDependencies:function(){var n=!0,r=this;t.each(this.dependencies,function(){e.isPluginLoaded(this)||(n=!1,i.error("plugin."+r.name,'Required plugin "'+this+'" not found.'))});return n},init:function(){},getEditableConfig:function(e){var n=null,r=!1,i=this;this.settings.editables&&t.each(this.settings.editables,function(s,o){if(e.is(s))if(r=!0,o instanceof Array)n=[],n=t.merge(n,o);else if("object"==typeof o){n={};n["aloha-editable-selector"]=s;for(var u in o)o.hasOwnProperty(u)&&(o[u]instanceof Array?n[u]=o[u]:"object"==typeof o[u]?(n[u]={},n[u]=t.extend(!0,n[u],i.config[u],o[u])):n[u]=o[u])}else n=o});r||(n="undefined"==typeof this.settings.config||!this.settings.config?this.config:this.settings.config);return n},makeClean:function(){},getUID:function(){i.deprecated("plugin","getUID() is deprecated. Use plugin.name instead.");return this.name},toString:function(){return this.name},log:function(e,t){i.deprecated("plugin","log() is deprecated. Use Aloha.console instead.");i.log(e,this,t)}});s.create=function(n,i){var o=new(s.extend(i))(n);o.settings=t.extendObjects(!0,o.defaults,e.settings[n]);r.register(o);return o};return s});define("aloha/command",["aloha/core","aloha/registry","aloha/engine","util/dom","aloha/contenthandlermanager"],function(e,t,n,r,i){var s={execCommand:function(t,s,o,u){var f={commandId:t,preventDefault:!1};e.trigger("aloha-command-will-execute",f);if(!0!==f.preventDefault){if(!u){if(!e.getSelection().getRangeCount())return;u=e.getSelection().getRangeAt(0)}"inserthtml"===t.toLowerCase()&&(o=i.handleContent(o,{contenthandler:e.settings.contentHandler.insertHtml,command:"insertHtml"}));n.execCommand(t,s,o,u);e.getSelection().getRangeCount()&&(u=e.getSelection().getRangeAt(0),s=u.commonAncestorContainer,s.parentNode&&(s=s.parentNode),o=new window.GENTICS.Utils.RangeObject,o.startContainer=u.startContainer,o.startOffset=u.startOffset,o.endContainer=u.endContainer,o.endOffset=u.endOffset,r.doCleanup({merge:!0,removeempty:!1},o,s),o.select());e.trigger("aloha-command-executed",t)}},queryCommandEnabled:function(t,r){if(!r){if(!e.getSelection().getRangeCount())return;r=e.getSelection().getRangeAt(0)}return n.queryCommandEnabled(t,r)},queryCommandIndeterm:function(t,r){if(!r){if(!e.getSelection().getRangeCount())return;r=e.getSelection().getRangeAt(0)}return n.queryCommandIndeterm(t,r)},queryCommandState:function(t,r){if(!r){if(!e.getSelection().getRangeCount())return;r=e.getSelection().getRangeAt(0)}return n.queryCommandState(t,r)},queryCommandSupported:function(e){return n.queryCommandSupported(e)},queryCommandValue:function(t,r){if(!r){if(!e.getSelection().getRangeCount())return;r=e.getSelection().getRangeAt(0)}return n.queryCommandValue(t,r)},querySupportedCommands:function(){var e=[],t;for(t in n.commands)e.push(t);return e}},s=new(t.extend(s));e.execCommand=s.execCommand;e.queryCommandEnabled=s.queryCommandEnabled;e.queryCommandIndeterm=s.queryCommandIndeterm;e.queryCommandState=s.queryCommandState;e.queryCommandSupported=s.queryCommandSupported;e.queryCommandValue=s.queryCommandValue;e.querySupportedCommands=s.querySupportedCommands;return s});define("aloha/jquery.aloha",["aloha/core","aloha/selection","jquery","aloha/console"],function(e,t,n,r){function i(e,t,n,r){if(t===r.target||!/textarea|input|select/i.test(r.target.nodeName)&&"text"!==r.target.type)return e.apply(t,n)}function s(e){if("string"==typeof e.data){for(var t=e.handler,r=e.data.toLowerCase().split(" "),s={},o=0;o<r.length;o++)s[r[o]]=!0;e.handler=function(e){if(this===e.target){var r="keypress"!==e.type&&n.hotkeys.specialKeys[e.which],o="";e.altKey&&"alt"!==r&&(o+="alt+");e.ctrlKey&&"ctrl"!==r&&(o+="ctrl+");e.metaKey&&!e.ctrlKey&&"meta"!==r&&(o+="meta+");e.shiftKey&&"shift"!==r&&(o+="shift+");if(r){if(s[o+r])return i(t,this,arguments,e)}else if(r=String.fromCharCode(e.which).toLowerCase(),s[o+r]||s[o+n.hotkeys.shiftNums[r]]||"shift+"===o&&s[n.hotkeys.shiftNums[r]])return i(t,this,arguments,e)}}}}var o=window.XMLSerializer;n.fn.between=function(e,t){var n;3!==this[0].nodeType?(n=this.children().size(),t>n&&(t=n),0>=t?this.prepend(e):this.children().eq(t-1).after(e)):0>=t?this.before(e):(t>=this[0].length||(n=this[0].data,this[0].data=n.substring(0,t),this.after(n.substring(t,n.length))),this.after(e))};n.fn.contentEditable=function(e){var t=n(this),i="contenteditable";n.browser.msie&&7==parseInt(n.browser.version,10)&&(i="contentEditable");if("undefined"==typeof e){if("undefined"==typeof t[0]){r.warn("The jquery object did not contain any valid elements.");return}return"undefined"==typeof t[0].isContentEditable?(r.warn("Could not determine whether the is editable or not. I assume it is."),!0):t[0].isContentEditable}""===e?t.removeAttr(i):t.attr(i,e&&"false"!==e?"true":"false");return t};n.fn.aloha=function(){var t=n(this);e.bind("aloha-ready",function(){t.each(function(){e.isEditable(this)||new e.Editable(n(this))})});return t};n.fn.mahalo=function(){return this.each(function(){e.isEditable(this)&&e.getEditableById(n(this).attr("id")).destroy()})};n.fn.contentEditableSelectionChange=function(e){var r=this;this.keyup(function(n){t.getRangeObject();e(n)});this.dblclick(function(t){e(t)});this.mousedown(function(){r.selectionStarted=!0});n(document).mouseup(function(n){t.eventOriginalTarget=r;r.selectionStarted&&e(n);t.eventOriginalTarget=!1;r.selectionStarted=!1});return this};n.fn.outerHtml=n.fn.outerHtml||function(){var e=n(this).get(0);if("undefined"!=typeof e.outerHTML)return e.outerHTML;try{return(new o).serializeToString(e)}catch(t){try{return e.xml}catch(r){}}};n.fn.zap=function(){return this.each(function(){n(this.childNodes).insertBefore(this)}).remove()};n.fn.textNodes=function(e,t){var r=[],i=function(s){if(3===s.nodeType&&n.trim(s.data)&&!t||3===s.nodeType&&t||"BR"==s.nodeName&&!e)r.push(s);else for(var o=0,u=s.childNodes.length;o<u;++o)i(s.childNodes[o])};i(this[0]);return n(r)};n.extendObjects=n.fn.extendObjects=function(){var e,t,r,i,s,o=arguments[0]||{},u=1,f=arguments.length,l=!1;"boolean"==typeof o&&(l=o,o=arguments[1]||{},u=2);"object"!=typeof o&&!n.isFunction(o)&&(o={});f===u&&(o=this,--u);for(;u<f;u++)if(null!=(e=arguments[u]))for(t in e)r=o[t],i=e[t],o!==i&&(l&&i&&(n.isPlainObject(i)||(s=n.isArray(i)))?(s?(s=!1,r=r&&n.isArray(r)?r:[]):r=r&&n.isPlainObject(r)?r:{},o[t]=n.isArray(i)?i:n.extendObjects(l,r,i)):void 0!==i&&(o[t]=i));return o};n.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};n.each(["keydown","keyup","keypress"],function(){n.event.special[this]={add:s}})});define("aloha/sidebar",["aloha/core","jquery","aloha/selection","PubSub"],function(e,t,n,r){var i=+(new Date);t.easing.easeOutExpo||t.extend(t.easing,{easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeOutElastic:function(e,t,n,r,i){var e=Math,s=1.70158,o=0,u=r;if(!t)return n;if(1==(t/=i))return n+r;o||(o=.3*i);u<e.abs(r)?(u=r,s=o/4):s=o/(2*e.PI)*e.asin(r/u);return u*e.pow(2,-10*t)*e.sin((t*i-s)*2*e.PI/o)+r+n}});var s=function(e){this.id=null;this.folds={};this.button=null;this.title=t('<div class="aloha-sidebar-panel-title"><span class="aloha-sidebar-panel-title-arrow"></span><span class="aloha-sidebar-panel-title-text">Untitled</span></div>');this.content=t('<div class="aloha-sidebar-panel-content"><div class="aloha-sidebar-panel-content-inner"><div class="aloha-sidebar-panel-content-inner-text"></div></div></div>');this.effectiveElement=this.element=null;this.expanded=!1;this.isActive=!0;this.init(e)},o=function(n){var r=this;this.id="aloha-sidebar-"+ ++i;this.panels={};this.container=t('<div class="aloha-ui aloha-sidebar-bar"><div class="aloha-sidebar-handle"><span class="aloha-sidebar-handle-icon"></span></div><div class="aloha-sidebar-inner"><ul class="aloha-sidebar-panels"></ul></div></div>');this.width=300;this.isCompletelyOpen=this.isOpen=this.opened=!1;this.settings={rotateIcons:!t.browser.msie,overlayPage:!0};t(function(){"undefined"!=typeof e.settings.sidebar&&e.settings.sidebar.disabled||r.init(n)})},u=null,a=null;t.extend(o.prototype,{init:function(e){var n=this,r;"object"==typeof e&&(r=e.panels,delete e.panels);t.extend(this,e);"object"==typeof r&&t.each(r,function(){n.addPanel(this,!0)});e=this.container;"right"===this.position&&e.addClass("aloha-sidebar-right");e.hide().appendTo(t("body")).click(function(){n.barClicked.apply(n,arguments)}).find(".aloha-sidebar-panels").width(this.width);e.width(this.width);this.width=e.width();this.updateHeight();this.initToggler();this.container.css("right"===this.position?"marginRight":"marginLeft",-this.width);this.opened&&this.open(0);this.toggleHandleIcon(this.isOpen);this.subscribeToEvents();t(window).resize(function(){n.updateHeight();n.correctHeight()});this.correctHeight()},show:function(){this.container.css("display","block");return this},hide:function(){this.container.css("display","none");return this},checkActivePanels:function(e){var n=[];if("undefined"!=typeof e&&"undefined"!=typeof e.markupEffectiveAtStart){var r=e.markupEffectiveAtStart.length,i;for(i=0;i<r;++i)n.push(t(e.markupEffectiveAtStart[i]))}var s=this;t.each(this.panels,function(){s.showActivePanel(this,n)});this.correctHeight()},subscribeToEvents:function(){var t=
this;r.sub("aloha.selection.context-change",function(e){t.isOpen&&t.checkActivePanels(e.range);t.lastRange=e.range});e.bind("aloha-editable-deactivated",function(){t.isOpen&&t.checkActivePanels();t.lastRange=null});this.container.mousedown(function(t){t.originalEvent.stopSelectionUpdate=!0;e.eventHandled=!0});this.container.mouseup(function(t){t.originalEvent.stopSelectionUpdate=!0;e.eventHandled=!1})},correctHeight:function(){if(this.isOpen)if(this.isCompletelyOpen){var e=t(window).height(),n=[],r=[],i;for(i in this.panels)this.panels.hasOwnProperty(i)&&this.panels[i].isActive&&(r.push(this.panels[i]),n.push(i));if(0!==r.length&&(n=n.sort().join(","),a!==n||u!==e)){u=e;a=n;for(var e=this.container.find(".aloha-sidebar-inner").height()-(r[0].title.outerHeight()+10)*r.length,s,o,f,c=0,h=Math,p;0<r.length&&0<e;){e+=c;c=0;f=[];for(p=r.length-1;0<=p;--p)n=r[p],s=n.content.find(".aloha-sidebar-panel-content-inner"),i=h.min(s.height("auto").height(),h.floor(e/(p+1))),s.height(i),e-=i,o=s.find(".aloha-sidebar-panel-content-inner-text"),o.height()>i?(f.push(n),c+=i,s.css({"overflow-x":"hidden","overflow-y":"scroll"})):s.css("overflow-y","hidden"),n.expanded&&n.expand();r=f}}}else this.correctHeightWhenCompletelyOpen=!0},showActivePanel:function(e,n){n.push(null);e.content.parent("li");var r=e.activeOn,i=t(),s=0,o=n.length,u;for(u=0;u<o;++u)r(n[u])&&(++s,n[u]&&t.merge(i,n[u]));s?e.activate(i):e.deactivate()},initToggler:function(){var n=this,r=this.container,i=r.find(".aloha-sidebar-handle-icon"),s,o="right"===this.position;this.opened&&this.rotateHandleArrow(o?0:180,0);t(function(){"undefined"!=typeof e.settings.sidebar&&e.settings.sidebar.handle&&e.settings.sidebar.handle.top&&(t(r.find(".aloha-sidebar-handle"))[0].style.top=e.settings.sidebar.handle.top)});r.find(".aloha-sidebar-handle").click(function(){s&&clearInterval(s);i.stop().css("marginLeft",4);n.isOpen?(t(this).removeClass("aloha-sidebar-toggled"),n.close(),n.isOpen=!1):(t(this).addClass("aloha-sidebar-toggled"),n.open(),n.isOpen=!0)}).hover(function(){var e=n.isOpen?-1:1;s&&clearInterval(s);i.stop();t(this).stop().animate(o?{marginLeft:"-="+5*e}:{marginRight:"-="+5*e},200);s=setInterval(function(){e*=-1;i.animate(o?{left:"-="+4*e}:{right:"-="+4*e},300)},300)},function(){s&&clearInterval(s);i.stop().css(o?"left":"right",5);t(this).stop().animate(o?{marginLeft:0}:{marginRight:0},600,"easeOutElastic")})},roundCorners:function(){var e=this.container,t=e.find(".aloha-sidebar-panels>li:not(.aloha-sidebar-deactivated)");e.find(".aloha-sidebar-panel-top, .aloha-sidebar-panel-bottom").removeClass("aloha-sidebar-panel-top").removeClass("aloha-sidebar-panel-bottom");t.first().find(".aloha-sidebar-panel-title").addClass("aloha-sidebar-panel-top");t.last().find(".aloha-sidebar-panel-content").addClass("aloha-sidebar-panel-bottom")},updateHeight:function(){var e=t(window).height();this.container.height(e).find(".aloha-sidebar-inner").height(e)},barClicked:function(e){this.handleBarclick(t(e.target))},handleBarclick:function(e){e.hasClass("aloha-sidebar-panel-title")?this.togglePanel(e):!e.hasClass("aloha-sidebar-panel-content")&&!e.hasClass("aloha-sidebar-handle")&&!e.hasClass("aloha-sidebar-bar")&&this.handleBarclick(e.parent())},getPanelById:function(e){return this.panels[e]},getPanelByElement:function(e){return this.getPanelById(("LI"===e[0].tagName?e:e.parent("li"))[0].id)},togglePanel:function(e){this.getPanelByElement(e).toggle()},rotateHandleIcon:function(e,t){var n=this.container.find(".aloha-sidebar-handle-icon");n.animate({angle:e},{duration:"number"==typeof t||"string"==typeof t?t:500,easing:"easeOutExpo",step:function(e){n.css({"-o-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)","-ms-transform":"rotate("+e+"deg)"})}})},toggleHandleIcon:function(e){e^="right"===this.position;if(this.settings.rotateIcons)this.rotateHandleIcon(e?180:0,0);else{var t=this.container.find(".aloha-sidebar-handle-icon");e?t.addClass("aloha-sidebar-handle-icon-left"):t.removeClass("aloha-sidebar-handle-icon-left")}},open:function(e){if(this.isOpen)return this;var n="right"===this.position,r=n?{marginRight:0}:{marginLeft:0},i=this;this.toggleHandleIcon(!0);this.container.animate(r,"number"==typeof e||"string"==typeof e?e:500,"easeOutExpo");this.settings.overlayPage||t("body").animate(n?{marginRight:"+="+this.width}:{marginLeft:"+="+this.width},500,"easeOutExpo",function(){i.isCompletelyOpen=!0;i.correctHeightWhenCompletelyOpen&&i.correctHeight()});this.isOpen=!0;this.correctHeight();this.lastRange&&this.checkActivePanels(this.lastRange);t("body").trigger("aloha-sidebar-opened",this);return this},close:function(e){if(!this.isOpen)return this;var n="right"===this.position,r=n?{marginRight:-this.width}:{marginLeft:-this.width};this.toggleHandleIcon(!1);this.container.animate(r,"number"==typeof e||"string"==typeof e?e:500,"easeOutExpo");this.settings.overlayPage||t("body").animate(n?{marginRight:"-="+this.width}:{marginLeft:"-="+this.width},500,"easeOutExpo");this.isCompletelyOpen=this.isOpen=!1;return this},activatePanel:function(e,t){"string"==typeof e&&(e=this.getPanelById(e));e&&e.activate(t);this.roundCorners();return this},expandPanel:function(e,t){"string"==typeof e&&(e=this.getPanelById(e));e&&e.expand(t);return this},collapsePanel:function(e,t){"string"==typeof e&&(e=this.getPanelById(e));e&&e.collapse(t);return this},addPanel:function(e){e instanceof s||(e.width||(e.width=this.width),e.sidebar=this,e=new s(e));this.panels[e.id]=e;this.container.find(".aloha-sidebar-panels").append(e.element);this.checkActivePanels(n.getRangeObject());return e}});t.extend(s.prototype,{init:function(e){this.setTitle(e.title).setContent(e.content);delete e.title;delete e.content;t.extend(this,e);this.id||(this.id="aloha-sidebar-"+ ++i);this.element=t('<li id="'+this.id+'">').append(this.title,this.content);this.expanded&&this.content.height("auto");this.toggleTitleIcon(this.expanded);this.coerceActiveOn();this.title.attr("unselectable","on").css("-moz-user-select","none").each(function(){this.onselectstart=function(){return!1}});"function"==typeof this.onInit&&this.onInit.apply(this)},toggleTitleIcon:function(e){if(this.sidebar.settings.rotateIcons)this.rotateTitleIcon(e?90:0);else{var t=this.title.find(".aloha-sidebar-panel-title-arrow");e?t.addClass("aloha-sidebar-panel-title-arrow-down"):t.removeClass("aloha-sidebar-panel-title-arrow-down")}},coerceActiveOn:function(){if("function"!=typeof this.activeOn){var e=this.activeOn;this.activeOn=function(){var t=typeof e;return"boolean"===t?function(){return e}:"undefined"===t?function(){return!0}:"string"===t?function(t){return t?t.is(e):!1}:function(){return!1}}()}},activate:function(e){this.isActive=!0;this.content.parent("li").show().removeClass("aloha-sidebar-deactivated");this.effectiveElement=e;"function"==typeof this.onActivate&&this.onActivate.call(this,e)},deactivate:function(){this.isActive&&(this.isActive=!1,this.content.parent("li").hide().addClass("aloha-sidebar-deactivated"),this.effectiveElement=null)},toggle:function(){this.expanded?this.collapse():this.expand()},expand:function(e){var t=this,n=this.content,r=n.height(),i=n.height("auto").height();n.height(r).stop().animate({height:i},500,"easeOutExpo",function(){"function"==typeof e&&e.call(t)});this.element.removeClass("collapsed");this.toggleTitleIcon(!0);this.expanded=!0;return this},collapse:function(e,t){var n=this;this.element.addClass("collapsed");this.content.stop().animate({height:5},250,"easeOutExpo",function(){"function"==typeof t&&t.call(n)});this.toggleTitleIcon(!1);this.expanded=!1;return this},setTitle:function(e){this.title.find(".aloha-sidebar-panel-title-text").html(e);return this},setContent:function(e){if(!e||""===e)e="&nbsp;";this.content.find(".aloha-sidebar-panel-content-inner-text").html(e);return this},rotateTitleIcon:function(e,t){var n=this.title.find(".aloha-sidebar-panel-title-arrow");n.animate({angle:e},{duration:"number"==typeof t?t:500,easing:"easeOutExpo",step:function(e){n.css({"-o-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)","-ms-transform":"rotate("+e+"deg)"})}})},renderEffectiveParents:function(e,n){for(var r=e.first(),i=[],s=[],o=this.activeOn,u,a;0<r.length&&!r.is(".aloha-editable");){if(o(r)){s.push("<span>"+r[0].tagName.toLowerCase()+"</span>");u=s.length;for(a=[];u--;)a.push(s[u]);i.push('<div class="aloha-sidebar-panel-parent"><div class="aloha-sidebar-panel-parent-path">'+a.join("")+'</div><div class="aloha-sidebar-panel-parent-contentaloha-sidebar-opened">'+("function"==typeof n?n(r):"----")+"</div></div>")}r=r.parent()}this.setContent(i.join(""));t(".aloha-sidebar-panel-parent-path").click(function(){var e=t(this).parent().find(".aloha-sidebar-panel-parent-content");e.hasClass("aloha-sidebar-opened")?e.hide().removeClass("aloha-sidebar-opened"):e.show().addClass("aloha-sidebar-opened")});this.content.height("auto").find(".aloha-sidebar-panel-content-inner").height("auto")}});var f=new o({position:"left",width:250}),o=new o({position:"right",width:250});e.Sidebar={left:f,right:o};return e.Sidebar});GENTICS=window.GENTICS||{};GENTICS.Utils=GENTICS.Utils||{};define("util/position",["jquery"],function(e){var t=window.GENTICS;t.Utils.Position={};t.Utils.Position.w=e(window);t.Utils.Position.Scroll={top:0,left:0,isScrolling:!1};t.Utils.Position.ScrollCorrection={top:100,left:50};t.Utils.Position.Mouse={x:0,y:0,oldX:0,oldY:0,isMoving:!1,triggeredMouseStop:!0};t.Utils.Position.mouseStopCallbacks=[];t.Utils.Position.mouseMoveCallbacks=[];t.Utils.Position.update=function(){var e=this.w.scrollTop(),t=this.w.scrollLeft();if(this.Scroll.isScrolling)this.Scroll.top==e&&this.Scroll.left==t&&(this.Scroll.isScrolling=!1);else if(this.Scroll.top!=e||this.Scroll.left!=t)this.Scroll.isScrolling=!0;this.Scroll.top=e;this.Scroll.left=t;if(this.Mouse.x==this.Mouse.oldX&&this.Mouse.y==this.Mouse.oldY){if(this.Mouse.isMoving=!1,!this.Mouse.triggeredMouseStop){this.Mouse.triggeredMouseStop=!0;for(e=0;e<this.mouseStopCallbacks.length;e++)this.mouseStopCallbacks[e].call()}}else{this.Mouse.isMoving=!0;this.Mouse.triggeredMouseStop=!1;for(e=0;e<this.mouseMoveCallbacks.length;e++)this.mouseMoveCallbacks[e].call()}this.Mouse.oldX=this.Mouse.x;this.Mouse.oldY=this.Mouse.y};t.Utils.Position.addMouseStopCallback=function(e){this.mouseStopCallbacks.push(e);return this.mouseStopCallbacks.length-1};t.Utils.Position.addMouseMoveCallback=function(e){this.mouseMoveCallbacks.push(e);return this.mouseMoveCallbacks.length-1};e(function(){window.setInterval(function(){t.Utils.Position.update()},500)});e("html").mousemove(function(e){t.Utils.Position.Mouse.x=e.pageX;t.Utils.Position.Mouse.y=e.pageY})});define("aloha/repositorymanager",["aloha/core","util/class","jquery","aloha/console"],function(e,t,n,r){e.RepositoryManager=t.extend({repositories:[],settings:{},init:function(){var t=this.repositories,r=0,i=t.length,s;e.settings&&e.settings.repositories&&(this.settings=e.settings.repositories);for(this.settings.timeout=this.settings.timeout||5e3;r<i;++r)s=t[r],s.settings||(s.settings={}),this.settings[s.repositoryId]&&n.extend(s.settings,this.settings[s.repositoryId]),s.init()},register:function(e){this.getRepository(e.repositoryId)?r.warn(this,"A repository with name { "+e.repositoryId+" } already registerd. Ignoring this."):this.repositories.push(e)},getRepository:function(e){for(var t=this.repositories,n=0,r=t.length;n<r;++n)if(t[n].repositoryId===e)return t[n];return null},query:function(e,t){var i=this,s,o=[],u={numItems:0,hasMoreItems:!1},f=[],l=0,c,h,p,d=function(e,s){if(0!==l){var f=e?e.length:0;if(f){if(!e[0].repositoryId){var h=this.repositoryId,p;for(p=0;p<f;++p)e[p].repositoryId=h}n.merge(o,e)}s&&u?(u.numItems=n.isNumeric(s.numItems)&&n.isNumeric(u.numItems)?u.numItems+s.numItems:void 0,u.hasMoreItems="boolean"==typeof s.hasMoreItems&&"boolean"==typeof u.hasMoreItems?u.hasMoreItems||s.hasMoreItems:void 0):u=void 0;r.debug(this,"The repository "+this.repositoryId+" returned with "+f+" results.");0===--l&&i.queryCallback(t,o,u,c)}},v=parseInt(e.timeout,10)||this.settings.timeout;c=window.setTimeout(function(){0<l&&r.warn(this,l+" repositories did not return before the configured timeout of "+v+"ms.");l=0;i.queryCallback(t,o,u,c)},v);e.repositoryId?f.push(this.getRepository(e.repositoryId)):f=this.repositories;p=f.length;var m=[];for(h=0;h<p;++h)s=f[h],"function"==typeof s.query&&(++l,m.push(s));p=m.length;for(h=0;h<p;++h)s=m[h],s.query(e,function(){d.apply(s,arguments)});0===l&&this.queryCallback(t,o,u,c)},queryCallback:function(e,t,n,r){r&&clearTimeout(r);t={items:t,results:t.length};n&&(t.numItems=n.numItems,t.hasMoreItems=n.hasMoreItems);e.call(this,t)},getChildren:function(t,r){var i=this,s,o=[],u=[],f=0,l,c,h,p=function(e){0!==f&&(o&&e&&n.merge(o,e),0===--f&&i.getChildrenCallback(r,o,l))};if("aloha"===t.inFolderId){var d=t.repositoryFilter,v=d&&d.length;h=this.repositories.length;for(c=0;c<h;++c)s=this.repositories[c],(!v||-1<n.inArray(s.repositoryId,d))&&u.push(new e.RepositoryFolder({id:s.repositoryId,name:s.repositoryName,repositoryId:s.repositoryId,type:"repository",hasMoreItems:!0}));i.getChildrenCallback(r,u,null)}else{u=this.repositories;c=parseInt(t.timeout,10)||this.settings.timeout;l=window.setTimeout(function(){f=0;i.getChildrenCallback(r,o,l)},c);h=u.length;for(c=0;c<h;++c)s=u[c],"function"==typeof s.getChildren&&(++f,s.getChildren(t,function(){p.apply(s,arguments)}));0===f&&this.getChildrenCallback(r,o,l)}},getChildrenCallback:function(e,t,n){n&&clearTimeout(n);e.call(this,t)},makeClean:function(e){var t=this,n={},i=0,s=t.repositories.length;e.find("[data-gentics-aloha-repository="+this.prefix+"]").each(function(){for(;i<s;++i)n.makeClean(e);r.debug(t,"Passing contents of HTML Element with id { "+this.attr("id")+" } for cleaning to repository { "+n.repositoryId+" }");n.makeClean(this)})},markObject:function(e,t){if(e)if(t){var i=this.getRepository(t.repositoryId);i?(n(e).attr({"data-gentics-aloha-repository":t.repositoryId,"data-gentics-aloha-object-id":t.id}),i.markObject(e,t)):r.error(this,"Trying to apply a repository { "+t.name+" } to an object, but item has no repositoryId.")}else n(e).removeAttr("data-gentics-aloha-repository").removeAttr("data-gentics-aloha-object-id")},getObject:function(e,t){var r=this,i=n(e),s=this.getRepository(i.attr("data-gentics-aloha-repository")),o=i.attr("data-gentics-aloha-object-id");s&&o&&(this.itemCache=this.itemCache||[],this.itemCache[s.repositoryId]=this.itemCache[s.repositoryId]||[],this.itemCache[s.repositoryId][o]?t.call(this,[this.itemCache[s.repositoryId][o]]):s.getObjectById(o,function(e){r.itemCache[s.repositoryId][o]=e[0];t.call(this,e)}))},toString:function(){return"repositorymanager"}});e.RepositoryManager=new e.RepositoryManager;return e.RepositoryManager});define("aloha/repository",["aloha/core","util/class","aloha/repositorymanager"],function(e,t,n){t=t.extend({_constructor:function(e,t){this.repositoryId=e;this.settings={};this.repositoryName=t?t:e;n.register(this)},init:function(){},query:null,getChildren:null,makeClean:function(){},markObject:function(){},setTemplate:function(e){this.template=e?e:null},hasTemplate:function(){return this.template?!0:!1},getTemplate:function(){return this.template},getObjectById:function(){return!0}});return e.AbstractRepository=t});define("aloha/repositoryobjects",["aloha/core","util/class"],function(e,t){var n=window.GENTICS;e.RepositoryObject=function(){};e.RepositoryDocument=t.extend({_constructor:function(e){this.type="document";e.id&&e.name&&e.repositoryId&&(n.Utils.applyProperties(this,e),this.baseType="document")}});e.RepositoryFolder=t.extend({_constructor:function(e){this.type="folder";e.id&&e.name&&e.repositoryId&&(n.Utils.applyProperties(this,e),this.baseType="folder")}})});(function(e){function t(){var e,t,n=Aloha.settings.plugins&&Aloha.settings.plugins.load,r=Aloha.settings.baseUrl,i,s=/\/aloha\.js$/,o=/\/[^\/]*\.js$/,u;if(!n||!r){e=document.getElementsByTagName("script");for(u=0;u<e.length;u++){t=e[u];i=t.getAttribute("data-aloha-plugins");if(null!=i){n||(n=i);r||(r=t.src.replace(o,""));break}!r&&s.test(t.src)&&(r=t.src.replace(s,""))}}"string"==typeof n&&""!==n&&(n=n.replace(/\s+/g,"").split(","));return{baseUrl:r,plugins:n||[]}}function n(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++)if("true"===e[t].getAttribute("data-aloha-defer-init"))return!0;return!1}function r(e){var t={},n=[],r={},i={},s,o,u=Aloha.settings.basePath||"",a=Aloha.settings.bundles||{},f;for(f=0;f<e.length;f++){s=e[f].split("/");o=s[0];s=s[1];o=a[o]?u+a[o]:u+"../plugins/"+o;var l=t,c=o,h=s,p=["nls","css","vendor","res"],d=void 0,v=void 0;l[h]=c+"/"+h+"/lib";for(v=0;v<p.length;v++)d=p[v],l[h+"/"+d]=c+"/"+h+"/"+d;r[s]=o+"/"+s;n.push(s+"/"+s+"-plugin");i[s]={jquery:"aloha/jquery"}}return{paths:t,entryPoints:n,baseUrlByName:r,names:[],map:i}}function i(){var e={},t=Array.prototype.slice.call(arguments),n,r,i;for(r=0;r<t.length;r++)for(n in i=t[r],i)i.hasOwnProperty(n)&&(e[n]=t[r][n]);return e}function s(e,t){define(e,function(){return t})}function o(){Aloha.defaults={};Aloha.settings=Aloha.settings||{};var e=t(),n=r(e.plugins);Aloha.settings.baseUrl=e.baseUrl;Aloha.settings.loadedPlugins=n.names;Aloha.settings._pluginBaseUrlByName=n.baseUrlByName;var e=i({aloha:{jquery:"aloha/jquery"},"aloha/jquery":{jquery:"jquery"},jqueryui:{jquery:"aloha/jquery"},vendor:{jquery:"aloha/jquery"},util:{jquery:"aloha/jquery"},RepositoryBrowser:{jquery:"aloha/jquery"},jstree:{jquery:"aloha/jquery"},jqgrid:{jquery:"aloha/jquery"},"jqgrid-locale-en":{jquery:"aloha/jquery"},"jqgrid-locale-de":{jquery:"aloha/jquery"},"jquery-layout":{jquery:"aloha/jquery"}},n.map),o=i({context:"aloha",locale:Aloha.settings.locale||"en",baseUrl:Aloha.settings.baseUrl,map:e},Aloha.settings.requireConfig);o.paths=i({jquery:"vendor/jquery-1.7.2",jqueryui:"vendor/jquery-ui-1.9m6"},{PubSub:"vendor/pubsub/js/pubsub-unminified",Class:"vendor/class",RepositoryBrowser:"vendor/repository-browser/js/repository-browser-unminified",jstree:"vendor/jquery.jstree",jqgrid:"vendor/jquery.jqgrid","jquery-layout":"vendor/jquery.layout","jqgrid-locale-en":"vendor/grid.locale.en","jqgrid-locale-de":"vendor/grid.locale.de","repository-browser-i18n-de":"vendor/repository-browser/js/repository-browser-unminified","repository-browser-i18n-en":"vendor/repository-browser/js/repository-browser-unminified"},n.paths,o.paths);e=Aloha.settings.predefinedModules||{};Aloha.settings.jQuery&&(e.jquery=Aloha.settings.jQuery);for(var u in e)e.hasOwnProperty(u)&&(s(u,e[u]),delete o.paths[u]);var a=require.config(o);Aloha.require=function(e){return 1===arguments.length&&typeof e=="function"?a(["aloha"],e):a.apply(this,arguments)};var l;Aloha.bind=function(e,t){Aloha.require(["aloha/jquery"],function(n){Aloha.bind=function(e,t){l=l||n.Deferred();"aloha-ready"===e?"alohaReady"!==Aloha.stage?l.done(t):t():n(Aloha,"body").bind(e,t);return this};Aloha.bind(e,t)});return this};Aloha.trigger=function(e,t){Aloha.require(["aloha/jquery"],function(n){Aloha.trigger=function(e,t){l=l||n.Deferred();"aloha-ready"===e&&n(l.resolve);n(Aloha,"body").trigger(e,t);return this};Aloha.trigger(e,t)});return this};Aloha.unbind=function(e){Aloha.require(["aloha/jquery"],function(t){Aloha.unbind=function(e){t(Aloha,"body").unbind(e)};Aloha.unbind(e)})};Aloha.ready=function(e){this.bind("aloha-ready",e);return this};var h=Aloha.settings.jQuery;define("aloha/jquery",["jquery"],function(e){return h||e});define("aloha","aloha/jquery util/json2 aloha/rangy-core util/class util/lang util/range util/dom aloha/core aloha/editable aloha/console aloha/markup aloha/plugin aloha/selection aloha/command aloha/jquery.aloha aloha/sidebar util/position aloha/repositorymanager aloha/repository aloha/repositoryobjects aloha/contenthandlermanager".split(" "),function(e){Aloha.jQuery=e;Aloha.settings=e.extendObjects(!0,{},Aloha.defaults,Aloha.settings);return Aloha});Aloha.stage="loadingAloha";require(o,["aloha","aloha/jquery"],function(e,t){e.stage="loadPlugins";require(o,n.entryPoints,function(){t(function(){window.rangy.init();e.init()})})})}e.Aloha=e.Aloha||{};e.Aloha.deferInit||n()?e.Aloha.deferInit=o:Aloha._load=o})(window);define("ui/context",["aloha","jquery","util/class"],function(e,t,n){var r;r=t("#aloha-ui-context");r.length||(r=t("<div>",{"class":"aloha",id:"aloha-ui-context"}),t(function(){r.appendTo("body")}));e=n.extend({surfaces:[],containers:[]});t.extend(e,{selector:"#aloha-ui-context",element:r});return e});define("ui/scopes",["jquery","PubSub"],function(e,t){function n(e,t){if(r.hasOwnProperty(t))for(var i=r[t],s=0;s<i.length;s++){var o=i[s];e.push(o);n(e,o)}}var r={"Aloha.empty":[],"Aloha.global":["Aloha.empty"],"Aloha.continuoustext":["Aloha.global"]},i=[],s={},o=!1;Aloha.bind("aloha-selection-changed-before",function(){o=!1});Aloha.bind("aloha-selection-changed-after",function(e,t,n){"undefined"!=typeof n&&!o&&u.setScope("Aloha.continuoustext")});var u={enterScope:function(e){var n=s[e]||0;s[e]=n+1;n||t.pub("aloha.ui.scope.change")},leaveScope:function(e){var n=s[e]-1;n?s[e]=n:(delete s[e],t.pub("aloha.ui.scope.change"))},isActiveScope:function(t){return s[t]||-1!==e.inArray(t,i)?!0:!1},getPrimaryScope:function(){return i[0]},setScope:function(e){o=!0;i[0]!=e&&(i=[e],n(i,e),t.pub("aloha.ui.scope.change"))},createScope:function(e,t){t?"string"==typeof t&&(t=[t]):t=["Aloha.empty"];r[e]=t}};return u});define("ui/container",["jquery","util/class","ui/scopes"],function(e,t,n){function r(t,r){switch(e.type(r)){case"function":return r;case"object":if(r.scope)return s[r.scope]?s[r.scope]:s[r.scope]=function(){return n.isActiveScope(r.scope)};throw"Invalid showOn configuration";default:return o}}var i=0,s={},o=function(){return!0},t=t.extend({element:null,_constructor:function(e,t){var n=r(this,t.showOn),s;n.showOnId||(n.showOnId=++i);s=n.showOnId;var o=e.containers[s];this.context=e;o||(o=e.containers[s]={shouldShow:n,containers:[]});o.containers.push(this)},show:function(){},hide:function(){},focus:function(){},foreground:function(){},childVisible:function(){},childFocus:function(){},childForeground:function(){}});e.extend(t,{showContainersForContext:function(e,t){var n,r,i;if(e.containers)for(r in i=e.containers,i)if(i.hasOwnProperty(r)){n=i[r];var s=n.containers;n=n.shouldShow(t)?"show":"hide";for(var o=void 0,o=0;o<s.length;o++)s[o][n]()}}});return t});define("ui/surface",["aloha/core","jquery","util/class","ui/container"],function(e,t,n){var r=n.extend({_constructor:function(e){e.surfaces.push(this)},isActive:function(){return!0}});t.extend(r,{range:null,show:function(e){t.each(e.surfaces,function(e,t){t.show()})},hide:function(e){t.each(e.surfaces,function(e,t){t.hide()})},trackRange:function(t){t.bind("mousedown",function(t){t.originalEvent.stopSelectionUpdate=!0;e.eventHandled=!0;r.suppressHide=!0;e.activeEditable&&(t=e.getSelection(),r.range=0<t.getRangeCount()?t.getRangeAt(0):null)});t.bind("mouseup",function(t){t.originalEvent.stopSelectionUpdate=!0;e.eventHandled=!1;r.suppressHide=!1})}});return r});define("ui/component",["aloha/core","jquery","util/class"],function(e,t,n){var r=0;return n.extend({id:0,isInstance:!0,container:null,type:null,visible:!0,_constructor:function(){this.id=r++;this.init()},adoptParent:function(e){this.container=e},init:function(){},isVisible:function(){return this.visible},show:function(e){!1===e?this.hide():this.visible||(this.visible=!0,this.element.show(),this.container&&this.container.childVisible(this,!0))},hide:function(){this.visible&&(this.visible=!1,this.element.hide(),this.container&&this.container.childVisible(this,!1))},focus:function(){this.element.focus();this.container&&this.container.childFocus(this)},foreground:function(){this.container&&this.container.childForeground(this)},enable:function(){},disable:function(){}})});define("jqueryui",["jquery"],function(k){(function(e,t){function n(t,n){var i=t.nodeName.toLowerCase();if("area"===i){var i=t.parentNode,s=i.name;if(!t.href||!s||"map"!==i.nodeName.toLowerCase())return!1;i=e("img[usemap=#"+s+"]")[0];return!!i&&r(i)}return(/input|select|textarea|button|object/.test(i)?!t.disabled:"a"==i?t.href||n:n)&&r(t)}function r(t){return!e(t).parents().andSelf().filter(function(){return"hidden"===e.curCSS(this,"visibility")||e.expr.filters.hidden(this)}).length}e.ui=e.ui||{};e.ui.version||(e.extend(e.ui,{version:"1.9m6",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return"number"==typeof t?this.each(function(){var r=this;setTimeout(function(){e(r).focus();n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;t=e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.curCSS(this,"position",1))&&/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.curCSS(this,"overflow",1)+e.curCSS(this,"overflow-y",1)+e.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var n=e(this[0]),r;n.length&&n[0]!==document;){r=n.css("position");if("absolute"===r||"relative"===r||"fixed"===r)if(r=parseInt(n.css("zIndex"),10),!isNaN(r)&&0!==r)return r;n=n.parent()}return 0},disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.each(["Width","Height"],function(n,r){function i(t,n,r,i){e.each(s,function(){n-=parseFloat(e.curCSS(t,"padding"+this,!0))||0;r&&(n-=parseFloat(e.curCSS(t,"border"+this+"Width",!0))||0);i&&(n-=parseFloat(e.curCSS(t,"margin"+this,!0))||0)});return n}var s="Width"===r?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})};e.fn["outer"+r]=function(t,n){return"number"!=typeof t?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}}),e.extend(e.expr[":"],{data:function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||0<=r)&&n(t,!i)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});e.support.minHeight=100===n.offsetHeight;e.support.selectstart="onselectstart"in n;t.removeChild(n).style.display="none"}),e.extend(e.ui,{plugin:{add:function(t,n,r){var t=e.ui[t].prototype,i;for(i in r)t.plugins[i]=t.plugins[i]||[],t.plugins[i].push([n,r[i]])},call:function(e,t,n){if((t=e.plugins[t])&&e.element[0].parentNode)for(var r=0;r<t.length;r++)e.options[t[r][0]]&&t[r][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;if(0<t[r])return!0;t[r]=1;i=0<t[r];t[r]=0;return i},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,r,i,s,o){return e.ui.isOverAxis(t,r,s)&&e.ui.isOverAxis(n,i,o)}}))})(k);(function(e,t){var n=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var n=0,i;null!=(i=t[n]);n++)try{e(i).triggerHandler("remove")}catch(s){}r(t)};e.widget=function(t,r,i){var s=t.split(".")[0],o,t=t.split(".")[1];o=s+"-"+t;i||(i=r,r=e.Widget);e.expr[":"][o]=function(n){return!!e.data(n,t)};e[s]=e[s]||{};e[s][t]=e.extend(function(n,r){if(!this._createWidget)return new e[s][t](n,r);arguments.length&&this._createWidget(n,r)},e[s][t],{version:i.version});var u=new r;u.options=e.widget.extend({},u.options);e.each(i,function(t,s){e.isFunction(s)&&(i[t]=function(){var e=function(e){return r.prototype[e].apply(this,n.call(arguments,1))},t=function(e,t){return r.prototype[e].apply(this,t)};return function(){var n=this._super,r=this._superApply,i;this._super=e;this._superApply=t;i=s.apply(this,arguments);this._super=n;this._superApply=r;return i}}())});e[s][t].prototype=e.widget.extend(u,{namespace:s,widgetName:t,widgetEventPrefix:t,widgetBaseClass:o},i);e.widget.bridge(t,e[s][t])};e.widget.extend=function(r){for(var i=n.call(arguments,1),s=0,o=i.length,u,l;s<o;s++)for(u in i[s])l=i[s][u],i[s].hasOwnProperty(u)&&l!==t&&(r[u]=e.isPlainObject(l)?e.widget.extend({},r[u],l):l);return r};e.widget.bridge=function(r,i){e.fn[r]=function(s){var o="string"==typeof s,u=n.call(arguments,1),l=this,s=!o&&u.length?e.widget.extend.apply(null,[s].concat(u)):s;o?this.each(function(){var n=e.data(this,r);if(!n)return e.error("cannot call methods on "+r+" prior to initialization; attempted to call method '"+s+"'");if(!e.isFunction(n[s])||"_"===s.charAt(0))return e.error("no such method '"+s+"' for "+r+" widget instance");var i=n[s].apply(n,u);if(i!==n&&i!==t)return l=i&&i.jquery?l.pushStack(i.get()):i,!1}):this.each(function(){var t=e.data(this,r);t?t.option(s||{})._init():i(s,this)});return l}};e.Widget=function(t,n){if(!this._createWidget)return new e[namespace][name](t,n);arguments.length&&this._createWidget(t,n)};e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0];this.element=e(n);this.options=e.widget.extend({},this.options,this._getCreateOptions(),t);this.bindings=e();this.hoverable=e();this.focusable=e();n!==this&&(e.data(n,this.widgetName,this),this._bind({remove:"destroy"}));this._create();this._trigger("create");this._init()},_getCreateOptions:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy();this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled");this.bindings.unbind("."+this.widgetName);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(i={},s=n.split("."),n=s.shift(),s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}this._setOptions(i);return this},_setOptions:function(t){var n=this;e.each(t,function(e,t){n._setOption(e,t)});return this},_setOption:function(e,t){this.options[e]=t;"disabled"===e&&(this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"));return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_bind:function(t,n){n?(t=e(t),this.bindings=this.bindings.add(t)):(n=t,t=this.element);var r=this;e.each(n,function(n,i){function s(){if(r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return(typeof i=="string"?r[i]:i).apply(r,arguments)}var o=n.match(/^(\w+)\s*(.*)$/),u=o[1]+"."+r.widgetName;(o=o[2])?r.widget().delegate(o,u,s):t.bind(u,s)})},_delay:function(e,t){var n=this;return setTimeout(function(){return("string"==typeof e?n[e]:e).apply(n,arguments)},t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t);this._bind(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t);this._bind(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i=this.options[t],n=e.Event(n);n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase();r=r||{};if(n.originalEvent)for(var t=e.event.props.length
,s;t;)s=e.event.props[--t],n[s]=n.originalEvent[s];this.element.trigger(n,r);r=e.isArray(r)?[n].concat(r):[n,r];return!(e.isFunction(i)&&!1===i.apply(this.element[0],r)||n.isDefaultPrevented())}};e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){"string"==typeof i&&(i={effect:i});var o,u=i?!0===i||"number"==typeof i?n:i.effect||n:t,i=i||{};"number"==typeof i&&(i={duration:i});o=!e.isEmptyObject(i);i.complete=s;i.delay&&r.delay(i.delay);o&&e.effects&&(e.effects.effect[u]||!1!==e.uiBackCompat&&e.effects[u])?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t]();s&&s.call(r[0]);n()})}});!1!==e.uiBackCompat&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})})(k);(function(e){var t=!1;e(document).mouseup(function(){t=!1});e.widget("ui.mouse",{version:"1.9m6",options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n);this._mouseDownEvent=n;var r=this,i=1==n.which,s="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(n))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=!1!==this._mouseStart(n),!this._mouseStarted))return n.preventDefault(),!0;!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(e){return r._mouseMove(e)};this._mouseUpDelegate=function(e){return r._mouseUp(e)};e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);n.preventDefault();return t=!0}},_mouseMove:function(t){if(!e.browser.msie||9<=document.documentMode||!!t.button){if(this._mouseStarted)return this._mouseDrag(t),t.preventDefault();this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&((this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t))?this._mouseDrag(t):this._mouseUp(t));return!this._mouseStarted}return this._mouseUp(t)},_mouseUp:function(t){e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,t.target==this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t));return!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(k);(function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.9m6",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(t){var n=this.options;if(this.helper||n.disabled||e(t.target).is(".ui-resizable-handle"))return!1;this.handle=this._getHandle(t);if(!this.handle)return!1;e(!0===n.iframeFix?"iframe":n.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")});return!0},_mouseStart:function(t){var n=this.options;this.helper=this._createHelper(t);this._cacheHelperProportions();e.ui.ddmanager&&(e.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(t);this.originalPageX=t.pageX;this.originalPageY=t.pageY;n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt);n.containment&&this._setContainment();if(!1===this._trigger("start",t))return this._clear(),!1;this._cacheHelperProportions();e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(t,!0);e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t);return!0},_mouseDrag:function(t,n){this.position=this._generatePosition(t);this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(!1===this._trigger("drag",t,r))return this._mouseUp({}),!1;this.position=r.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";e.ui.ddmanager&&e.ui.ddmanager.drag(this,t);return!1},_mouseStop:function(t){var n=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t));this.dropped&&(n=this.dropped,this.dropped=!1);if(!this.element[0]||!this.element[0].parentNode)return!1;if("invalid"==this.options.revert&&!n||"valid"==this.options.revert&&n||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)){var r=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){r._trigger("stop",t)!==!1&&r._clear()})}else!1!==this._trigger("stop",t)&&this._clear();return!1},_mouseUp:function(t){!0===this.options.iframeFix&&e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t);return e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(t){var n=!this.options.handle||!e(this.options.handle,this.element).length?!0:!1;e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(n=!0)});return n},_createHelper:function(t){var n=this.options,t=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"==n.helper?this.element.clone().removeAttr("id"):this.element;t.parents("body").length||t.appendTo("parent"==n.appendTo?this.element[0].parentNode:n.appendTo);t[0]!=this.element[0]&&!/(fixed|absolute)/.test(t.css("position"))&&t.css("position","absolute");return t},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" "));e.isArray(t)&&(t={left:+t[0],top:+t[1]||0});"left"in t&&(this.offset.click.left=t.left+this.margins.left);"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left);"top"in t&&(this.offset.click.top=t.top+this.margins.top);"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.browser.msie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;"parent"==t.containment&&(t.containment=this.helper[0].parentNode);if("document"==t.containment||"window"==t.containment)this.containment=["document"==t.containment?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==t.containment?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==t.containment?0:e(window).scrollLeft())+e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==t.containment?0:e(window).scrollTop())+(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)&&t.containment.constructor!=Array){var t=e(t.containment),n=t[0];if(n){t.offset();var r="hidden"!=e(n).css("overflow");this.containment=[(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0),(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0),(r?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(r?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=t}}else t.containment.constructor==Array&&(this.containment=t.containment)},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"==t?1:-1,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(e.browser.safari&&526>e.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r),left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(e.browser.safari&&526>e.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r)}},_generatePosition:function(t){var n=this.options,r="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName),s=t.pageX,o=t.pageY;if(this.originalPosition){var u;this.containment&&(this.relative_container?(u=this.relative_container.offset(),u=[this.containment[0]+u.left,this.containment[1]+u.top,this.containment[2]+u.left,this.containment[3]+u.top]):u=this.containment,t.pageX-this.offset.click.left<u[0]&&(s=u[0]+this.offset.click.left),t.pageY-this.offset.click.top<u[1]&&(o=u[1]+this.offset.click.top),t.pageX-this.offset.click.left>u[2]&&(s=u[2]+this.offset.click.left),t.pageY-this.offset.click.top>u[3]&&(o=u[3]+this.offset.click.top));n.grid&&(o=n.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY,o=u?o-this.offset.click.top<u[1]||o-this.offset.click.top>u[3]?o-this.offset.click.top<u[1]?o+n.grid[1]:o-n.grid[1]:o:o,s=n.grid[0]?this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX,s=u?s-this.offset.click.left<u[0]||s-this.offset.click.left>u[2]?s-this.offset.click.left<u[0]?s+n.grid[0]:s-n.grid[0]:s:s)}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&526>e.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&526>e.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(t,n,r){r=r||this._uiHash();e.ui.plugin.call(this,t,[n,r]);"drag"==t&&(this.positionAbs=this._convertPositionTo("absolute"));return e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[];e(i.connectToSortable).each(function(){var n=e.data(this,"sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"==r.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("draggable"),i=this;e.each(r.sortables,function(){this.instance.positionAbs=r.positionAbs;this.instance.helperProportions=r.helperProportions;this.instance.offset.click=r.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}});e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor"));t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}});e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity"));r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}});e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("draggable");t.scrollParent[0]!=document&&"HTML"!=t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("draggable"),r=n.options,i=!1;if(n.scrollParent[0]!=document&&"HTML"!=n.scrollParent[0].tagName){if(!r.axis||"x"!=r.axis)n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop-r.scrollSpeed);if(!r.axis||"y"!=r.axis)n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft-r.scrollSpeed)}else{if(!r.axis||"x"!=r.axis)t.pageY-e(document).scrollTop()<r.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed));if(!r.axis||"y"!=r.axis)t.pageX-e(document).scrollLeft()<r.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed))}!1!==i&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}});e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("draggable"),n=t.options;t.snapElements=[];e(n.snap.constructor!=String?n.snap.items||":data(draggable)":n.snap).each(function(){var n=e(this),r=n.offset();this!=t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:r.top,left:r.left})})},drag:function(t,n){for(var r=e(this).data("draggable"),i=r.options,s=i.snapTolerance,o=n.offset.left,u=o+r.helperProportions.width,a=n.offset.top,l=a+r.helperProportions.height,c=r.snapElements.length-1;0<=c;c--){var h=r.snapElements[c].left,p=h+r.snapElements[c].width,d=r.snapElements[c].top,v=d+r.snapElements[c].height;if(h-s<o&&o<p+s&&d-s<a&&a<v+s||h-s<o&&o<p+s&&d-s<l&&l<v+s||h-s<u&&u<p+s&&d-s<a&&a<v+s||h-s<u&&u<p+s&&d-s<l&&l<v+s){if("inner"!=i.snapMode){var m=Math.abs(d-l)<=s,g=Math.abs(v-a)<=s,y=Math.abs(h-u)<=s,b=Math.abs(p-o)<=s;m&&(n.position.top=r._convertPositionTo("relative",{top:d-r.helperProportions.height,left:0}).top-r.margins.top);g&&(n.position.top=r._convertPositionTo("relative",{top:v,left:0}).top-r.margins.top);y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h-r.helperProportions.width}).left-r.margins.left);b&&(n.position.left=r._convertPositionTo("relative",{top:0,left:p}).left-r.margins.left)}var w=m||g||y||b;"outer"!=i.snapMode&&(m=Math.abs(d-a)<=s,g=Math.abs(v-l)<=s,y=Math.abs(h-o)<=s,b=Math.abs(p-u)<=s,m&&(n.position.top=r._convertPositionTo("relative",{top:d,left:0}).top-r.margins.top),g&&(n.position.top=r._convertPositionTo("relative",{top:v-r.helperProportions.height,left:0}).top-r.margins.top),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h}).left-r.margins.left),b)&&(n.position.left=r._convertPositionTo("relative",{top:0,left:p-r.helperProportions.width}).left-r.margins.left);!r.snapElements[c].snapping&&(m||g||y||b||w)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[c].item}));r.snapElements[c].snapping=m||g||y||b||w}else r.snapElements[c].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[c].item})),r.snapElements[c].snapping=!1}}});e.ui.plugin.add("draggable","stack",{start:function(){var t=e(this).data("draggable").options,t=e.makeArray(e(t.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(t.length){var n=parseInt(t[0].style.zIndex)||0;e(t).each(function(e){this.style.zIndex=n+e});this[0].style.zIndex=n+t.length}}});e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex"));r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})})(k);(function(e){e.widget("ui.droppable",{version:"1.9m6",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var t=this.options,n=t.accept;this.isover=0;this.isout=1;this.accept=e.isFunction(n)?n:function(e){return e.is(n)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[];e.ui.ddmanager.droppables[t.scope].push(this);t.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var t=e.ui.ddmanager.droppables[this.options.scope],n=0;n<t.length;n++)t[n]==this&&t.splice(n,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(t,n){"accept"==t&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)});e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!=this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!=this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current;if(!r||(r.currentItem||r.element)[0]==this.element[0])return!1;var i=!1;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope==r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance))return i=!0,!1});return i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}});e.ui.intersect=function(t,n,r){if(!n.offset)return!1;var i=(t.positionAbs||t.position.absolute).left,s=i+t.helperProportions.width,o=(t.positionAbs||t.position.absolute).top,u=o+t.helperProportions.height,a=n.offset.left,l=a+n.proportions.width,c=n.offset.top,h=c+n.proportions.height;switch(r){case"fit":return a<=i&&s<=l&&c<=o&&u<=h;case"intersect":return a<i+t.helperProportions.width/2&&s-t.helperProportions.width/2<l&&c<o+t.helperProportions.height/2&&u-t.helperProportions.height/2<h;case"pointer":return e.ui.isOver((t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,c,a,n.proportions.height,n.proportions.width);case"touch":return(o>=c&&o<=h||u>=c&&u<=h||o<c&&u>h)&&(i>=a&&i<=l||s>=a&&s<=l||i<a&&s>l);default:return!1}};e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r=e.ui.ddmanager.droppables[t.options.scope]||[],i=n?n.type:null,s=(t.currentItem||t.element).find(":data(droppable)").andSelf(),o=0;e:for(;o<r.length;o++)if(!(r[o].options.disabled||t&&!r[o].accept.call(r[o].element[0],t.currentItem||t.element))){for(var u=0;u<s.length;u++)if(s[u]==r[o].element[0]){r[o].proportions.height=0;continue e}r[o].visible="none"!=r[o].element.css("display");r[o].visible&&("mousedown"==i&&r[o]._activate.call(r[o],n),r[o].offset=r[o].element.offset(),r[o].proportions={width:r[o].element[0].offsetWidth,height:r[o].element[0].offsetHeight})}},drop:function(t,n){var r=!1;e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=r||this._drop.call(this,n)),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element))&&(this.isout=1,this.isover=0,this._deactivate.call(this,n))});return r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n);e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r=e.ui.intersect(t,this,this.options.tolerance);if(r=!r&&1==this.isover?"isout":r&&0==this.isover?"isover":null){var i;if(this.options.greedy){var s=this.element.parents(":data(droppable):eq(0)");s.length&&(i=e.data(s[0],"droppable"),i.greedyChild="isover"==r?1:0)}i&&"isover"==r&&(i.isover=0,i.isout=1,i._out.call(i,n));this[r]=1;this["isout"==r?"isover":"isout"]=0;this["isover"==r?"_over":"_out"].call(this,n);i&&"isout"==r&&(i.isout=0,i.isover=1,i._over.call(i,n))}}})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable");t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}})(k);(function(e){e.widget("ui.resizable",e.ui.mouse,{version:"1.9m6",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,n=this.options;this.element.addClass("ui-resizable");e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null});this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(/relative/.test(this.element.css("position"))&&e.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"}),this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize());this.handles=n.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var r=this.handles.split(",");this.handles={};for(var i=0;i<r.length;i++){var s=e.trim(r[i]),o=e('<div class="ui-resizable-handle ui-resizable-'+s+'"></div>');/sw|se|ne|nw/.test(s)&&o.css({zIndex:++n.zIndex});"se"==s&&o.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[s]=".ui-resizable-"+s;this.element.append(o)}}this._renderAxis=function(t){var t=t||this.element,n;for(n in this.handles){this.handles[n].constructor==String&&(this.handles[n]=e(this.handles[n],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var r=e(this.handles[n],this.element),i=0,i=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth(),r=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");t.css(r,i);this._proportionallyResize()}e(this.handles[n])}};this._renderAxis(this.element);this._handles=e(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}});n.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").hover(function(){if(!n.disabled){e(this).removeClass("ui-resizable-autohide");t._handles.show()}},function(){if(!n.disabled&&!t.resizing){e(this).addClass("ui-resizable-autohide");t._handles.hide()}}));this._mouseInit()},destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var n=this.element;n.after(this.originalElement.css({position:n.css("position"),width:n.outerWidth(),height:n.outerHeight(),top:n.css("top"),left:n.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);t(this.originalElement);return this},_mouseCapture:function(t){var n=!1,r;for(r in this.handles)e(this.handles[r])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(n){var r=this.options,i=this.element.position(),s=this.element;this.resizing=!0;this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()};(s.is(".ui-draggable")||/absolute/.test(s.css("position")))&&s.css({position:"absolute",top:i.top,left:i.left});e.browser.opera&&/relative/.test(s.css("position"))&&s.css({position:"relative",top:"auto",left:"auto"});this._renderProxy();var i=t(this.helper.css("left")),o=t(this.helper.css("top"));r.containment&&(i+=e(r.containment).scrollLeft()||0,o+=e(r.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:i,top:o};this.size=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()};this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()};this.originalPosition={left:i,top:o};this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()};this.originalMousePosition={left:n.pageX,top:n.pageY};this.aspectRatio="number"==typeof r.aspectRatio?r.aspectRatio:this.originalSize.width/this.originalSize.height||1;r=e(".ui-resizable-"+this.axis).css("cursor");e("body").css("cursor","auto"==r?this.axis+"-resize":r);s.addClass("ui-resizable-resizing");this._propagate("start",n);return!0},_mouseDrag:function(e){var t=this.helper,n=this.originalMousePosition,r=this._change[this.axis];if(!r)return!1;n=r.apply(this,[e,e.
pageX-n.left||0,e.pageY-n.top||0]);this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey)n=this._updateRatio(n,e);n=this._respectSize(n,e);this._propagate("resize",e);t.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(n);this._trigger("resize",e,this.ui());return!1},_mouseStop:function(t){this.resizing=!1;var n=this.options;if(this._helper){var r=this._proportionallyResizeElements,i=r.length&&/textarea/i.test(r[0].nodeName),r=i&&e.ui.hasScroll(r[0],"left")?0:this.sizeDiff.height,i=i?0:this.sizeDiff.width,i={width:this.helper.width()-i,height:this.helper.height()-r},r=parseInt(this.element.css("left"),10)+(this.position.left-this.originalPosition.left)||null,s=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;n.animate||this.element.css(e.extend(i,{top:s,left:r}));this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!n.animate&&this._proportionallyResize()}e("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",t);this._helper&&this.helper.remove();return!1},_updateVirtualBoundaries:function(e){var t=this.options,r,i,s,t={minWidth:n(t.minWidth)?t.minWidth:0,maxWidth:n(t.maxWidth)?t.maxWidth:Infinity,minHeight:n(t.minHeight)?t.minHeight:0,maxHeight:n(t.maxHeight)?t.maxHeight:Infinity};if(this._aspectRatio||e)if(e=t.minHeight*this.aspectRatio,i=t.minWidth/this.aspectRatio,r=t.maxHeight*this.aspectRatio,s=t.maxWidth/this.aspectRatio,e>t.minWidth&&(t.minWidth=e),i>t.minHeight&&(t.minHeight=i),r<t.maxWidth&&(t.maxWidth=r),s<t.maxHeight)t.maxHeight=s;this._vBoundaries=t},_updateCache:function(e){this.offset=this.helper.offset();n(e.left)&&(this.position.left=e.left);n(e.top)&&(this.position.top=e.top);n(e.height)&&(this.size.height=e.height);n(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,r=this.size,i=this.axis;n(e.height)?e.width=e.height*this.aspectRatio:n(e.width)&&(e.height=e.width/this.aspectRatio);"sw"==i&&(e.left=t.left+(r.width-e.width),e.top=null);"nw"==i&&(e.top=t.top+(r.height-e.height),e.left=t.left+(r.width-e.width));return e},_respectSize:function(e){var t=this._vBoundaries,r=this.axis,i=n(e.width)&&t.maxWidth&&t.maxWidth<e.width,s=n(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=n(e.width)&&t.minWidth&&t.minWidth>e.width,u=n(e.height)&&t.minHeight&&t.minHeight>e.height;o&&(e.width=t.minWidth);u&&(e.height=t.minHeight);i&&(e.width=t.maxWidth);s&&(e.height=t.maxHeight);var a=this.originalPosition.left+this.originalSize.width,f=this.position.top+this.size.height,l=/sw|nw|w/.test(r),r=/nw|ne|n/.test(r);o&&l&&(e.left=a-t.minWidth);i&&l&&(e.left=a-t.maxWidth);u&&r&&(e.top=f-t.minHeight);s&&r&&(e.top=f-t.maxHeight);(t=!e.width&&!e.height)&&!e.left&&e.top?e.top=null:t&&!e.top&&e.left&&(e.left=null);return e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t=this.helper||this.element,n=0;n<this._proportionallyResizeElements.length;n++){var r=this._proportionallyResizeElements[n];if(!this.borderDif){var i=[r.css("borderTopWidth"),r.css("borderRightWidth"),r.css("borderBottomWidth"),r.css("borderLeftWidth")],s=[r.css("paddingTop"),r.css("paddingRight"),r.css("paddingBottom"),r.css("paddingLeft")];this.borderDif=e.map(i,function(e,t){var n=parseInt(e,10)||0,r=parseInt(s[t],10)||0;return n+r})}(!e.browser.msie||!e(t).is(":hidden")&&!e(t).parents(":hidden").length)&&r.css({height:t.height()-this.borderDif[0]-this.borderDif[2]||0,width:t.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var n=e.browser.msie&&7>e.browser.version,r=n?1:0,n=n?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+n,height:this.element.outerHeight()+n,position:"absolute",left:this.elementOffset.left-r+"px",top:this.elementOffset.top-r+"px",zIndex:++t.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){return{left:this.originalPosition.left+t,width:this.originalSize.width-t}},n:function(e,t,n){return{top:this.originalPosition.top+n,height:this.originalSize.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]);"resize"!=t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("resizable").options,n=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10),position:t.css("position")})})};"object"==typeof t.alsoResize&&!t.alsoResize.parentNode?t.alsoResize.length?(t.alsoResize=t.alsoResize[0],n(t.alsoResize)):e.each(t.alsoResize,function(e){n(e)}):n(t.alsoResize)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,i){e(t).each(function(){var t=e(this),s=e(this).data("resizable-alsoresize"),o={},a=i&&i.length?i:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(a,function(e,t){var n=(s[t]||0)+(u[t]||0);n&&0<=n&&(o[t]=n||null)});e.browser.opera&&/relative/.test(t.css("position"))&&(r._revertToRelativePosition=!0,t.css({position:"absolute",top:"auto",left:"auto"}));t.css(o)})};"object"==typeof i.alsoResize&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(){var t=e(this).data("resizable"),n=t.options,r=function(t){e(t).each(function(){var t=e(this);t.css({position:t.data("resizable-alsoresize").position})})};t._revertToRelativePosition&&(t._revertToRelativePosition=!1,"object"==typeof n.alsoResize&&!n.alsoResize.nodeType?e.each(n.alsoResize,function(e){r(e)}):r(n.alsoResize));e(this).removeData("resizable-alsoresize")}});e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("resizable"),r=n.options,i=n._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:n.sizeDiff.height,s={width:n.size.width-(s?0:n.sizeDiff.width),height:n.size.height-o},o=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,u=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(s,u&&o?{top:u,left:o}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};i&&i.length&&e(i[0]).css({width:r.width,height:r.height});n._updateCache(r);n._propagate("resize",t)}})}});e.ui.plugin.add("resizable","containment",{start:function(){var n=e(this).data("resizable"),r=n.element,i=n.options.containment;if(r=i instanceof e?i.get(0):/parent/.test(i)?r.parent().get(0):i)if(n.containerElement=e(r),/document/.test(i)||i==document)n.containerOffset={left:0,top:0},n.containerPosition={left:0,top:0},n.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var s=e(r),o=[];e(["Top","Right","Left","Bottom"]).each(function(e,n){o[e]=t(s.css("padding"+n))});n.containerOffset=s.offset();n.containerPosition=s.position();n.containerSize={height:s.innerHeight()-o[3],width:s.innerWidth()-o[1]};var i=n.containerOffset,u=n.containerSize.height,l=n.containerSize.width,l=e.ui.hasScroll(r,"left")?r.scrollWidth:l,u=e.ui.hasScroll(r)?r.scrollHeight:u;n.parentData={element:r,left:i.left,top:i.top,width:l,height:u}}},resize:function(t){var n=e(this).data("resizable"),r=n.options,i=n.containerOffset,s=n.position,t=n._aspectRatio||t.shiftKey,o={top:0,left:0},u=n.containerElement;u[0]!=document&&/static/.test(u.css("position"))&&(o=i);s.left<(n._helper?i.left:0)&&(n.size.width+=n._helper?n.position.left-i.left:n.position.left-o.left,t&&(n.size.height=n.size.width/r.aspectRatio),n.position.left=r.helper?i.left:0);s.top<(n._helper?i.top:0)&&(n.size.height+=n._helper?n.position.top-i.top:n.position.top,t&&(n.size.width=n.size.height*r.aspectRatio),n.position.top=n._helper?i.top:0);n.offset.left=n.parentData.left+n.position.left;n.offset.top=n.parentData.top+n.position.top;r=Math.abs(n.offset.left-o.left+n.sizeDiff.width);i=Math.abs((n._helper?n.offset.top-o.top:n.offset.top-i.top)+n.sizeDiff.height);s=n.containerElement.get(0)==n.element.parent().get(0);o=/relative|absolute/.test(n.containerElement.css("position"));s&&o&&(r-=n.parentData.left);r+n.size.width>=n.parentData.width&&(n.size.width=n.parentData.width-r,t&&(n.size.height=n.size.width/n.aspectRatio));i+n.size.height>=n.parentData.height&&(n.size.height=n.parentData.height-i,t&&(n.size.width=n.size.height*n.aspectRatio))},stop:function(){var t=e(this).data("resizable"),n=t.options,r=t.containerOffset,i=t.containerPosition,s=t.containerElement,o=e(t.helper),u=o.offset(),a=o.outerWidth()-t.sizeDiff.width,o=o.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:o});t._helper&&!n.animate&&/static/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:o})}});e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("resizable"),n=t.options,r=t.size;t.ghost=t.originalElement.clone();t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:"");t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}});e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("resizable"),n=t.options,r=t.size,i=t.originalSize,s=t.originalPosition,o=t.axis;n.grid="number"==typeof n.grid?[n.grid,n.grid]:n.grid;var u=Math.round((r.width-i.width)/(n.grid[0]||1))*(n.grid[0]||1),n=Math.round((r.height-i.height)/(n.grid[1]||1))*(n.grid[1]||1);/^(se|s|e)$/.test(o)?(t.size.width=i.width+u,t.size.height=i.height+n):/^(ne)$/.test(o)?(t.size.width=i.width+u,t.size.height=i.height+n,t.position.top=s.top-n):(/^(sw)$/.test(o)?(t.size.width=i.width+u,t.size.height=i.height+n):(t.size.width=i.width+u,t.size.height=i.height+n,t.position.top=s.top-n),t.position.left=s.left-u)}});var t=function(e){return parseInt(e,10)||0},n=function(e){return!isNaN(parseInt(e,10))}})(k);(function(e){e.widget("ui.selectable",e.ui.mouse,{version:"1.9m6",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var t=this;this.element.addClass("ui-selectable");this.dragged=!1;var n;this.refresh=function(){n=e(t.options.filter,t.element[0]);n.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})};this.refresh();this.selectees=n.addClass("ui-selectee");this._mouseInit();this.helper=e("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(t){var n=this;this.opos=[t.pageX,t.pageY];if(!this.options.disabled){var r=this.options;this.selectees=e(r.filter,this.element[0]);this._trigger("start",t);e(r.appendTo).append(this.helper);this.helper.css({left:t.clientX,top:t.clientY,width:0,height:0});r.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0;t.metaKey||(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))});e(t.target).parents().andSelf().each(function(){var r=e.data(this,"selectable-item");if(r){var i=!t.metaKey||!r.$element.hasClass("ui-selected");r.$element.removeClass(i?"ui-unselecting":"ui-selected").addClass(i?"ui-selecting":"ui-unselecting");r.unselecting=!i;r.selecting=i;(r.selected=i)?n._trigger("selecting",t,{selecting:r.element}):n._trigger("unselecting",t,{unselecting:r.element});return!1}})}},_mouseDrag:function(t){var n=this;this.dragged=!0;if(!this.options.disabled){var r=this.options,i=this.opos[0],s=this.opos[1],o=t.pageX,u=t.pageY;if(i>o)var a=o,o=i,i=a;s>u&&(a=u,u=s,s=a);this.helper.css({left:i,top:s,width:o-i,height:u-s});this.selectees.each(function(){var a=e.data(this,"selectable-item");if(a&&a.element!=n.element[0]){var h=!1;r.tolerance=="touch"?h=!(a.left>o||a.right<i||a.top>u||a.bottom<s):r.tolerance=="fit"&&(h=a.left>i&&a.right<o&&a.top>s&&a.bottom<u);if(h){if(a.selected){a.$element.removeClass("ui-selected");a.selected=!1}if(a.unselecting){a.$element.removeClass("ui-unselecting");a.unselecting=!1}if(!a.selecting){a.$element.addClass("ui-selecting");a.selecting=!0;n._trigger("selecting",t,{selecting:a.element})}}else{if(a.selecting)if(t.metaKey&&a.startselected){a.$element.removeClass("ui-selecting");a.selecting=!1;a.$element.addClass("ui-selected");a.selected=!0}else{a.$element.removeClass("ui-selecting");a.selecting=!1;if(a.startselected){a.$element.addClass("ui-unselecting");a.unselecting=!0}n._trigger("unselecting",t,{unselecting:a.element})}if(a.selected&&!t.metaKey&&!a.startselected){a.$element.removeClass("ui-selected");a.selected=!1;a.$element.addClass("ui-unselecting");a.unselecting=!0;n._trigger("unselecting",t,{unselecting:a.element})}}}});return!1}},_mouseStop:function(t){var n=this;this.dragged=!1;e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting");r.unselecting=!1;r.startselected=!1;n._trigger("unselected",t,{unselected:r.element})});e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected");r.selecting=!1;r.selected=!0;r.startselected=!0;n._trigger("selected",t,{selected:r.element})});this._trigger("stop",t);this.helper.remove();return!1}})})(k);(function(e){e.widget("ui.sortable",e.ui.mouse,{version:"1.9m6",widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?"x"===e.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var e=this.items.length-1;0<=e;e--)this.items[e].item.removeData("sortable-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(t);var r=null,i=this;e(t.target).parents().each(function(){if(e.data(this,"sortable-item")==i)return r=e(this),!1});e.data(t.target,"sortable-item")==i&&(r=e(t.target));if(!r)return!1;if(this.options.handle&&!n){var s=!1;e(this.options.handle,r).find("*").andSelf().each(function(){this==t.target&&(s=!0)});if(!s)return!1}this.currentItem=r;this._removeCurrentsFromItems();return!0},_mouseStart:function(t,n,r){n=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(t);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(t);this.originalPageX=t.pageX;this.originalPageY=t.pageY;n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();n.containment&&this._setContainment();n.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",n.cursor));n.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",n.opacity));n.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",n.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());this._trigger("start",t,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(r=this.containers.length-1;0<=r;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));e.ui.ddmanager&&(e.ui.ddmanager.current=this);e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t);this.dragging=!0;this.helper.addClass("ui-sortable-helper");this._mouseDrag(t);return!0},_mouseDrag:function(t){this.position=this._generatePosition(t);this.positionAbs=this._convertPositionTo("absolute");this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var n=this.options,r=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-this.overflowOffset.top<n.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-n.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity)?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-this.overflowOffset.left<n.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-n.scrollSpeed):(t.pageY-e(document).scrollTop()<n.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed)),t.pageX-e(document).scrollLeft()<n.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed)));!1!==r&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(n=this.items.length-1;0<=n;n--){var r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r);if(s&&i!=this.currentItem[0]&&this.placeholder[1==s?"next":"prev"]()[0]!=i&&!e.contains(this.placeholder[0],i)&&("semi-dynamic"==this.options.type?!e.contains(this.element[0],i):1)){this.direction=1==s?"down":"up";if("pointer"!=this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(t,r);this._trigger("change",t,this._uiHash());break}}this._contactContainers(t);e.ui.ddmanager&&e.ui.ddmanager.drag(this,t);this._trigger("sort",t,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(t,n){if(t){e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=r.placeholder.offset();r.reverting=!0;e(this.helper).animate({left:i.left-this.offset.parent.left-r.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:i.top-this.offset.parent.top-r.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;0<=t;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[],t=t||{};e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))});!r.length&&t.key&&r.push(t.key+"=");return r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[],t=t||{};n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")});return r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?r+f>u&&r+f<a&&t+l>s&&t+l<o:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),t=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=n&&t,t=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return n?this.floating?r&&"right"==r||"down"==t?2:1:t&&("down"==t?2:1):!1},_intersectsWithSides:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),t=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),r=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();return this.floating&&i?"right"==i&&t||"left"==i&&!t:r&&("down"==r&&n||"up"==r&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!=e&&(0<e?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!=e&&(0<e?"right":"left")},refresh:function(e){this._refreshItems(e);this.refreshPositions();return this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n=[],r=[],i=this._connectWith();if(i&&t)for(t=i.length-1;0<=t;t--)for(var s=e(i[t]),o=s.length-1;0<=o;o--){var u=e.data(s[o],"sortable");u&&u!=this&&!u.options.disabled&&r.push([e.isFunction(u.options.items)?u.options.items.call(u.element):e(u.options.items,u.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),u])}r.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(t=r.length-1;0<=t;t--)r[t][0].each(function(){n.push(this)});return e(n)},_removeCurrentsFromItems:function(){for(var e=this.currentItem.find(":data(sortable-item)"),t=0;t<this.items.length;t++)for(var n=0;n<e.length;n++)e[n]==this.items[t].item[0]&&this.items.splice(t,1)},_refreshItems:function(t){this.items=[];this.containers=[this];var n=this.items,r=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],i=this._connectWith();if(i)for(var s=i.length-1;0<=s;s--)for(var o=e(i[s]),u=o.length-1;0<=u;u--){var a=e.data(o[u],"sortable");a&&a!=this&&!a.options.disabled&&(r.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a))}for(s=r.length-1;0<=s;s--){t=r[s][1];i=r[s][0];u=0;for(o=i.length;u<o;u++)a=e(i[u]),a.data("sortable-item",t),n.push({item:a,instance:t,width:0,height:0,left:0,top:0})}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var n=this.items.length-1;0<=n;n--){var r=this.items[n];if(r.instance==this.currentContainer||!this.currentContainer||r.item[0]==this.currentItem[0]){var i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item;t||(r.width=i.outerWidth(),r.height=i.outerHeight());i=i.offset();r.left=i.left;r.top=i.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;0<=n;n--)i=this.containers[n].element.offset(),this.containers[n].containerCache.left=i.left,this.containers[n].containerCache.top=i.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){var n=t||this,r=n.options;if(!r.placeholder||r.placeholder.constructor==String){var i=r.placeholder;r.placeholder={element:function(){var t=e(document.createElement(n.currentItem[0].nodeName)).addClass(i||n.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];i||(t.style.visibility="hidden");return t},update:function(e,t){if(!i||r.forcePlaceholderSize)t.height()||t.height(n.currentItem.innerHeight()-parseInt(n.currentItem.css("paddingTop")||0,10)-parseInt(n.currentItem.css("paddingBottom")||0,10)),t.width()||t.width(n.currentItem.innerWidth()-parseInt(n.currentItem.css("paddingLeft")||0,10)-parseInt(n.currentItem.css("paddingRight")||0,10))}}}n.placeholder=e(r.placeholder.element.call(n.element,n.currentItem));n.currentItem.after(n.placeholder);r.placeholder.update(n,n.placeholder)},_contactContainers:function(t){for(var n=null,r=null,i=this.containers.length-1;0<=i;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(!n||!e.contains(this.containers[i].element[0],n.element[0]))n=this.containers[i],r=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(n)if(1===this.containers.length)this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1;else if(this.currentContainer!=this.containers[r]){for(var n=1e4,i=null,s=this.positionAbs[this.containers[r].floating?"left":"top"],o=this.items.length-1;0<=o;o--)if(e.contains(this.containers[r].element[0],this.items[o].item[0])){var u=this.items[o][this.containers[r].floating?"left":"top"];Math.abs(u-s)<n&&(n=Math.abs(u-s),i=this.items[o])}if(i||this.options.dropOnEmpty)this.currentContainer=this.containers[r],i?this._rearrange(t,i,null,!0):this._rearrange(t,null,this.containers[r].element,!0),this._trigger("change",t,this._uiHash()),this.containers[r]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1}},_createHelper:function(t){var n=this.options,t=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"==n.helper?this.currentItem.clone():this.currentItem;t.parents("body").length||e("parent"!=n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(t[0]);t[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")});(""==t[0].style.width||n.forceHelperSize)&&t.width(this.currentItem.width());(""==t[0].style.height||n.forceHelperSize)&&t.height(this.currentItem.height());return t},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" "));e.isArray(t)&&(t={left:+t[0],top:+t[1]||0});"left"in t&&(this.offset.click.left=t.left+this.margins.left);"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left);"top"in t&&(this.offset.click.top=t.top+this.margins.top);"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&e.browser.msie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;"parent"==t.containment&&(t.containment=this.helper[0].parentNode);if("document"==t.containment||"window"==t.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"==t.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"==t.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)){
var n=e(t.containment)[0],t=e(t.containment).offset(),r="hidden"!=e(n).css("overflow");this.containment=[t.left+(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0)-this.margins.top,t.left+(r?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(r?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"==t?1:-1,i="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(e.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r),left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(e.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r)}},_generatePosition:function(t){var n=this.options,r="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var s=t.pageX,o=t.pageY;this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid)&&(o=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?o-this.offset.click.top<this.containment[1]||o-this.offset.click.top>this.containment[3]?o-this.offset.click.top<this.containment[1]?o+n.grid[1]:o-n.grid[1]:o:o,s=this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0],s=this.containment?s-this.offset.click.left<this.containment[0]||s-this.offset.click.left>this.containment[2]?s-this.offset.click.left<this.containment[0]?s+n.grid[0]:s-n.grid[0]:s:s);return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(e.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(e.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?t.item[0]:t.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var i=this,s=this.counter;window.setTimeout(function(){s==i.counter&&i.refreshPositions(!r)},0)},_clear:function(t,n){this.reverting=!1;var r=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var i in this._storedCSS)if("auto"==this._storedCSS[i]||"static"==this._storedCSS[i])this._storedCSS[i]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!n&&r.push(function(e){this._trigger("update",e,this._uiHash())});if(!e.contains(this.element[0],this.currentItem[0])){n||r.push(function(e){this._trigger("remove",e,this._uiHash())});for(i=this.containers.length-1;0<=i;i--)e.contains(this.containers[i].element[0],this.currentItem[0])&&!n&&(r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.containers[i])),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.containers[i])))}for(i=this.containers.length-1;0<=i;i--)n||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);this._storedCursor&&e("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(i=0;i<r.length;i++)r[i].call(this,t);this._trigger("stop",t,this._uiHash())}return!1}n||this._trigger("beforeStop",t,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!n){for(i=0;i<r.length;i++)r[i].call(this,t);this._trigger("stop",t,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})})(k);k.effects||function(e,t){function n(t){var n;return t&&t.constructor===Array&&3===t.length?t:(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t))?[parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10)]:(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(t))?[2.55*parseFloat(n[1]),2.55*parseFloat(n[2]),2.55*parseFloat(n[3])]:(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t))?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(t))?[parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)]:/rgba\(0, 0, 0, 0\)/.exec(t)?u.transparent:u[e.trim(t).toLowerCase()]}function r(){var t=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,n={},r,i;if(t&&t.length&&t[0]&&t[t[0]])for(i=t.length;i--;)r=t[i],"string"==typeof t[r]&&(n[e.camelCase(r)]=t[r]);else for(r in t)"string"==typeof t[r]&&(n[r]=t[r]);return n}function i(n,r,i,s){if(e.isPlainObject(n))return n;n={effect:n};r===t&&(r={});e.isFunction(r)&&(s=r,i=null,r={});if("number"===e.type(r)||e.fx.speeds[r])s=i,i=r,r={};e.isFunction(i)&&(s=i,i=null);r&&e.extend(n,r);i=i||r.duration;n.duration=e.fx.off?0:"number"==typeof i?i:i in e.fx.speeds?e.fx.speeds[i]:e.fx.speeds._default;n.complete=s||r.complete;return n}function s(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"==typeof t&&!e.effects.effect[t]?o&&e.effects[t]?!1:!0:!1}var o=!1!==e.uiBackCompat;e.effects={effect:{}};e.each("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor borderColor color outlineColor".split(" "),function(t,r){e.fx.step[r]=function(t){if(!t.colorInit){var i;i=t.elem;var s=r,o;do{o=e.curCSS(i,s);if(o!=""&&o!=="transparent"||e.nodeName(i,"body"))break;s="backgroundColor"}while(i=i.parentNode);i=n(o);t.start=i;t.end=n(t.end);t.colorInit=!0}t.elem.style[r]="rgb("+Math.max(Math.min(parseInt(t.pos*(t.end[0]-t.start[0])+t.start[0],10),255),0)+","+Math.max(Math.min(parseInt(t.pos*(t.end[1]-t.start[1])+t.start[1],10),255),0)+","+Math.max(Math.min(parseInt(t.pos*(t.end[2]-t.start[2])+t.start[2],10),255),0)+")"}});var u={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},a=["add","remove","toggle"],f={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){if("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)k.style(e.elem,n,e.end),e.setAttr=!0}});e.effects.animateClass=function(t,n,i,s){var o=e.speed(n,i,s);return this.queue(function(){var n=e(this),i=n.attr("class"),s,u=o.children?n.find("*").andSelf():n,u=u.map(function(){var t=e(this);return{el:t,originalStyleAttr:t.attr("style")||" ",start:r.call(this)}});e.each(a,function(e,r){t[r]&&n[r+"Class"](t[r])});s=n.attr("class");u=u.map(function(){this.end=r.call(this.el[0]);var t=this.start,n=this.end,i={},s,o;for(s in n)if(o=n[s],t[s]!=o&&!f[s]&&(e.fx.step[s]||!isNaN(parseFloat(o))))i[s]=o;this.diff=i;return this});n.attr("class",i);u=u.map(function(){var t=this,n=e.Deferred();this.el.animate(this.diff,{duration:o.duration,easing:o.easing,queue:!1,complete:function(){n.resolve(t)}});return n.promise()});e.when.apply(e,u.get()).done(function(){n.attr("class",s);e.each(arguments,function(){"object"==typeof this.el.attr("style")?(this.el.attr("style").cssText="",this.el.attr("style").cssText=this.originalStyleAttr):this.el.attr("style",this.originalStyleAttr)});o.complete.call(n[0])})})};e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.apply(this,[{add:t},n,r,i]):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return n?e.effects.animateClass.apply(this,[{remove:t},n,r,i]):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return"boolean"==typeof r||r===t?i?e.effects.animateClass.apply(this,[r?{add:n}:{remove:n},i,s,o]):this._toggleClass(n,r):e.effects.animateClass.apply(this,[{toggle:n},r,i,s])},switchClass:function(t,n,r,i,s){return e.effects.animateClass.apply(this,[{add:n,remove:t},r,i,s])}});e.extend(e.effects,{version:"1.9m6",save:function(e,t){for(var n=0;n<t.length;n++)null!==t[n]&&e.data("ec.storage."+t[n],e[0].style[t[n]])},restore:function(e,t){for(var n=0;n<t.length;n++)null!==t[n]&&e.css(t[n],e.data("ec.storage."+t[n]))},setMode:function(e,t){"toggle"===t&&(t=e.is(":hidden")?"show":"hide");return t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;t.wrap(r);(t[0]===s||e.contains(t[0],s))&&e(s).focus();r=t.parent();"static"===t.css("position")?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r);isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"}));t.css(i);return r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus());return t},setTransition:function(t,n,r,i){i=i||{};e.each(n,function(e,n){var s=t.cssUnit(n);0<s[0]&&(i[n]=s[0]*r+s[1])});return i}});e.fn.extend({effect:function(t,n,r,s){function u(t){function n(){e.isFunction(i)&&i.call(r[0]);e.isFunction(t)&&t()}var r=e(this),i=a.complete,s=a.mode;(r.is(":hidden")?"hide"===s:"show"===s)?n():h.call(r[0],a,n)}var a=i.apply(this,arguments),f=a.mode,c=a.queue,h=e.effects.effect[a.effect],p=!h&&o&&e.effects[a.effect];return e.fx.off||!h&&!p?f?this[f](a.duration,a.complete):this.each(function(){a.complete&&a.complete.call(this)}):h?!1===c?this.each(u):this.queue(c||"fx",u):p.call(this,{options:a,duration:a.duration,callback:a.complete,mode:a.mode})},_show:e.fn.show,show:function(e){if(s(e))return this._show.apply(this,arguments);var t=i.apply(this,arguments);t.mode="show";return this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(s(e))return this._hide.apply(this,arguments);var t=i.apply(this,arguments);t.mode="hide";return this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(s(t)||"boolean"==typeof t||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=i.apply(this,arguments);n.mode="toggle";return this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),r=[];e.each(["em","px","%","pt"],function(e,t){0<n.indexOf(t)&&(r=[parseFloat(n),t])});return r}});e.easing.jswing=e.easing.swing;e.extend(e.easing,{def:"easeOutQuad",swing:function(t,n,r,i,s){return e.easing[e.easing.def](t,n,r,i,s)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return 1>(t/=i/2)?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return 1>(t/=i/2)?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){return 1>(t/=i/2)?r/2*t*t*t*t+n:-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){return 1>(t/=i/2)?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return 0==t?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){return 0==t?n:t==i?n+r:1>(t/=i/2)?r/2*Math.pow(2,10*(t-1))+n:r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){return 1>(t/=i/2)?-r/2*(Math.sqrt(1-t*t)-1)+n:r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){var e=1.70158,s=.3*i,o=r;if(0==t)return n;if(1==(t/=i))return n+r;o<Math.abs(r)?(o=r,e=s/4):e=s/(2*Math.PI)*Math.asin(r/o);return-(o*Math.pow(2,10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s))+n},easeOutElastic:function(e,t,n,r,i){var e=1.70158,s=.3*i,o=r;if(0==t)return n;if(1==(t/=i))return n+r;o<Math.abs(r)?(o=r,e=s/4):e=s/(2*Math.PI)*Math.asin(r/o);return o*Math.pow(2,-10*t)*Math.sin((t*i-e)*2*Math.PI/s)+r+n},easeInOutElastic:function(e,t,n,r,i){var e=1.70158,s=i*.3*1.5,o=r;if(0==t)return n;if(2==(t/=i/2))return n+r;o<Math.abs(r)?(o=r,e=s/4):e=s/(2*Math.PI)*Math.asin(r/o);return 1>t?-0.5*o*Math.pow(2,10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s)+n:.5*o*Math.pow(2,-10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s)+r+n},easeInBack:function(e,n,r,i,s,o){o==t&&(o=1.70158);return i*(n/=s)*n*((o+1)*n-o)+r},easeOutBack:function(e,n,r,i,s,o){o==t&&(o=1.70158);return i*((n=n/s-1)*n*((o+1)*n+o)+1)+r},easeInOutBack:function(e,n,r,i,s,o){o==t&&(o=1.70158);return 1>(n/=s/2)?i/2*n*n*(((o*=1.525)+1)*n-o)+r:i/2*((n-=2)*n*(((o*=1.525)+1)*n+o)+2)+r},easeInBounce:function(t,n,r,i,s){return i-e.easing.easeOutBounce(t,s-n,0,i,s)+r},easeOutBounce:function(e,t,n,r,i){return(t/=i)<1/2.75?r*7.5625*t*t+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,r,i,s){return n<s/2?.5*e.easing.easeInBounce(t,2*n,0,i,s)+r:.5*e.easing.easeOutBounce(t,2*n-s,0,i,s)+.5*i+r}})}(k);(function(e){var t=/up|down|vertical/,n=/up|left|vertical|horizontal/;e.effects.effect.blind=function(r,i){var s=e(this),o="position top bottom left right height width".split(" "),u=e.effects.setMode(s,r.mode||"hide"),l=r.direction||"up",c=t.test(l),h=c?"height":"width",p=c?"top":"left",l=n.test(l),d={},v="show"===u,m,g;s.parent().is(".ui-effects-wrapper")?e.effects.save(s.parent(),o):e.effects.save(s,o);s.show();m=e.effects.createWrapper(s).css({overflow:"hidden"});g=m[h]();d[h]=v?g:0;l||(s.css(c?"bottom":"right",0).css(c?"top":"left","").css({position:"absolute"}),d[p]=v?0:g);v&&(m.css(h,0),l||m.css(p,g));m.animate(d,{duration:r.duration,easing:r.easing,queue:!1,complete:function(){u==="hide"&&s.hide();e.effects.restore(s,o);e.effects.removeWrapper(s);i()}})}})(k);(function(e){e.effects.effect.bounce=function(t,n){var r=e(this),i="position top bottom left right height width".split(" "),s=e.effects.setMode(r,t.mode||"effect"),o="hide"===s,u="show"===s,a=t.direction||"up",s=t.distance,l=t.times||5,c=2*l+(u||o?1:0),h=t.duration/c,p=t.easing,d="up"===a||"down"===a?"top":"left",a="up"===a||"left"===a,v,m,g=r.queue(),y=g.length;(u||o)&&i.push("opacity");e.effects.save(r,i);r.show();e.effects.createWrapper(r);s||(s=r["top"===d?"outerHeight":"outerWidth"]()/3);u&&(m={opacity:1},m[d]=0,r.css("opacity",0).css(d,a?2*-s:2*s).animate(m,h,p));o&&(s/=Math.pow(2,l-1));m={};for(u=m[d]=0;u<l;u++)v={},v[d]=(a?"-=":"+=")+s,r.animate(v,h,p).animate(m,h,p),s=o?2*s:s/2;o&&(v={opacity:0},v[d]=(a?"-=":"+=")+s,r.animate(v,h,p));r.queue(function(){o&&r.hide();e.effects.restore(r,i);e.effects.removeWrapper(r);n()});1<y&&g.splice.apply(g,[1,0].concat(g.splice(y,c+1)));r.dequeue()}})(k);(function(e){e.effects.effect.clip=function(t,n){var r=e(this),i="position top bottom left right height width".split(" "),s="show"===e.effects.setMode(r,t.mode||"hide"),o="vertical"===(t.direction||"vertical"),u=o?"height":"width",o=o?"top":"left",a={},l,c;e.effects.save(r,i);r.show();l=e.effects.createWrapper(r).css({overflow:"hidden"});l="IMG"===r[0].tagName?l:r;c=l[u]();s&&(l.css(u,0),l.css(o,c/2));a[u]=s?c:0;a[o]=s?0:c/2;l.animate(a,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s||r.hide();e.effects.restore(r,i);e.effects.removeWrapper(r);n()}})}})(k);(function(e){e.effects.effect.drop=function(t,n){var r=e(this),i="position top bottom left right opacity height width".split(" "),s=e.effects.setMode(r,t.mode||"hide"),o="show"===s,u=t.direction||"left",a="up"===u||"down"===u?"top":"left",u="up"===u||"left"===u?"pos":"neg",l={opacity:o?1:0},c;e.effects.save(r,i);r.show();e.effects.createWrapper(r);c=t.distance||r["top"==a?"outerHeight":"outerWidth"]({margin:!0})/2;o&&r.css("opacity",0).css(a,"pos"==u?-c:c);l[a]=(o?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+c;r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"==s&&r.hide();e.effects.restore(r,i);e.effects.removeWrapper(r);n()}})}})(k);(function(e){e.effects.effect.explode=function(t,n){function r(){h.push(this);h.length==i*s&&(o.css({visibility:"visible"}),e(h).remove(),u||o.hide(),n())}var i=t.pieces?Math.round(Math.sqrt(t.pieces)):3,s=i,o=e(this),u="show"===e.effects.setMode(o,t.mode||"hide"),a=o.show().css("visibility","hidden").offset(),l=Math.ceil(o.outerWidth()/s),c=Math.ceil(o.outerHeight()/i),h=[],p,d,v,m,g,y;for(p=0;p<i;p++){m=a.top+p*c;y=p-(i-1)/2;for(d=0;d<s;d++)v=a.left+d*l,g=d-(s-1)/2,o.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-d*l,top:-p*c}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:l,height:c,left:v+(u?g*l:0),top:m+(u?y*c:0),opacity:u?0:1}).animate({left:v+(u?0:g*l),top:m+(u?0:y*c),opacity:u?1:0},t.duration||500,t.easing,r)}}})(k);(function(e){e.effects.effect.fade=function(t,n){var r=e(this),i="hide"===e.effects.setMode(r,t.mode||"toggle");r.show();r.animate({opacity:i?0:1},{queue:!1,duration:t.duration,easing:t.easing,complete:function(){i&&r.hide();n()}})}})(k);(function(e){e.effects.effect.fold=function(t,n){var r=e(this),i="position top bottom left right height width".split(" "),s=e.effects.setMode(r,t.mode||"hide"),o="show"===s,u="hide"===s,s=t.size||15,a=/([0-9]+)%/.exec(s),l=!!t.horizFirst,c=o!=l,h=c?["width","height"]:["height","width"],p=t.duration/2,d,v={},m={};e.effects.save(r,i);r.show();d=e.effects.createWrapper(r).css({overflow:"hidden"});c=c?[d.width(),d.height()]:[d.height(),d.width()];a&&(s=parseInt(a[1],10)/100*c[u?0:1]);o&&d.css(l?{height:0,width:s}:{height:s,width:0});v[h[0]]=o?c[0]:s;m[h[1]]=o?c[1]:0;d.animate(v,p,t.easing).animate(m,p,t.easing,function(){u&&r.hide();e.effects.restore(r,i);e.effects.removeWrapper(r);n()})}})(k);(function(e){e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};"hide"===s&&(o.opacity=0);e.effects.save(r,i);r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide();e.effects.restore(r,i);n()}})}})(k);(function(e){e.effects.effect.pulsate=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"show"),s="show"===i,o="hide"===i,i=2*(t.times||5)+(s||"hide"===i?1:0),u=t.duration/i,a=0,l=r.queue(),c=l.length;if(s||!r.is(":visible"))r.css("opacity",0).show(),a=1;for(s=1;s<i;s++)r.animate({opacity:a},u,t.easing),a=1-a;r.animate({opacity:a},u,t.easing);r.queue(function(){o&&r.hide();n()});1<c&&l.splice.apply(l,[1,0].concat(l.splice(c,i+1)));r.dequeue()}})(k);(function(e){e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s="hide"===i,o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u}});r.effect(t)};e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(0==parseInt(t.percent,10)?0:"hide"==s?0:100),u=t.direction||"both",a=t.origin,l={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},c="horizontal"!=u?o/100:1,o="vertical"!=u?o/100:1;i.effect="size";i.queue=!1;i.complete=n;"effect"!=s&&(i.origin=a||["middle","center"],i.restore=!0);i.from=t.from||("show"==s?{height:0,width:0}:l);i.to={height:l.height*c,width:l.width*o,outerHeight:l.outerHeight*c,outerWidth:l.outerWidth*o};i.fade&&("show"==s&&(i.from.opacity=0,i.to.opacity=1),"hide"==s)&&(i.from.opacity=1,i.to.opacity=0);r.effect(i)};e.effects.effect.size=function(t,n){var r,i,s,o,u=e(this),a="position top bottom left right width height overflow opacity".split(" "),l="position top bottom left right overflow opacity".split(" "),c=["width","height","overflow"],h=["fontSize"],p=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],v=e.effects.setMode(u,t.mode||"effect"),m=t.restore||"effect"!==v,g=t.scale||"both",y=t.origin||["middle","center"],b,w,E=u.css("position"),S="auto"!==u.css("bottom")?"bottom":"top";originalHorizontalPositioning="auto"!==u.css("right")?"right":"left";"show"===v&&u.show();b={height:u.height(),width:u.width(),outerHeight:u.outerHeight(),outerWidth:u.outerWidth()};u.from=t.from||b;u.to=t.to||b;s=u.from.height/b.height;o=u.from.width/b.width;r=u.to.height/b.height;i=u.to.width/b.width;if("box"==g||"both"==g)if(s!==r&&(a=a.concat(p),u.from=e.effects.setTransition(u,p,s,u.from),u.to=e.effects.setTransition(u,p,r,u.to)),o!==i)a=a.concat(d),u.from=e.effects.setTransition(u,d,o,u.from),u.to=e.effects.setTransition(u,d,i,u.to);("content"==g||"both"==g)&&s!==r&&(a=a.concat(h),u.from=e.effects.setTransition(u,h,s,u.from),u.to=e.effects.setTransition(u,h,r,u.to));e.effects.save(u,m?a:l);u.show();e.effects.createWrapper(u);u.css("overflow","hidden").css(u.from);y&&(w=e.effects.getBaseline(y,b),u.from.top=(b.outerHeight-u.outerHeight())*w.y,u.from.left=(b.outerWidth-u.outerWidth())*w.x,u.to.top=(b.outerHeight-u.to.outerHeight)*w.y,u.to.left=(b.outerWidth-u.to.outerWidth)*w.x);u.css(u.from);if("content"==g||"both"==g)p=p.concat(["marginTop","marginBottom"]).concat(h),d=d.concat(["marginLeft","marginRight"]),c=a.concat(p).concat(d),u.find("*[width]").each(function(){var n=e(this),u=n.height(),a=n.width();m&&e.effects.save(n,c);n.from={height:u*s,width:a*o};n.to={height:u*r,width:a*i};if(s!=r){n.from=e.effects.setTransition(n,p,s,n.from);n.to=e.effects.setTransition(n,p,r,n.to)}if(o!=i){n.from=e.effects.setTransition(n,d,o,n.from);n.to=e.effects.setTransition(n,d,i,n.to)}n.css(n.from);n.animate(n.to,t.duration,t.easing,function(){m&&e.effects.restore(n,c)})});u.animate(u.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){u.to.opacity===0&&u.css("opacity",u.from.opacity);v=="hide"&&u.hide();e.effects.restore(u,m?a:l);m||(E==="static"?u.css({position:"relative",top:u.to.top,left:u.to.left}):e.each([S,originalHorizontalPositioning],function(e,t){u.css(t,function(n,r){var i=parseInt(r,10),s=e?u.to.left:u.to.top,o=e?u.to.outerWidth-u.from.outerWidth:u.to.outerHeight-u.from.outerHeight,a=y[e]===t,f=y[e]==="middle"||y[e]==="center";if(r==="auto")return s+"px";t=="left"||t=="top"||(E==="relative"?s*=-1:f||(s-=o*(a?-1:1)));return i+s+"px"})}));e.effects.removeWrapper(u);n()}})}})(k);(function(e){e.effects.effect.shake=function(t,n){var r=e(this),i="position top bottom left right height width".split(" "),s=e.effects.setMode(r,t.mode||"effect"),o=t.direction||"left",u=t.distance||20,a=t.times||3,l=2*a+1,c=t.duration,h="up"==o||"down"==o?"top":"left",p="up"==o||"left"==o,o={},d={},v={},m=r.queue(),g=m.length;e.effects.save(r,i);r.show();e.effects.createWrapper(r);o[h]=(p?"-=":"+=")+u;d[h]=(p?"+=":"-=")+2*u;v[h]=(p?"-=":"+=")+2*u;r.animate(o,c,t.easing);for(u=1;u<a;u++)r.animate(d,c,t.easing).animate(v,c,t.easing);r.animate(d,c,t.easing).animate(o,c/2,t.easing).queue(function(){"hide"===s&&r.hide();e.effects.restore(r,i);e.effects.removeWrapper(r);n()});1<g&&m.splice.apply(m,[1,0].concat(m.splice(g,l+1)));r.dequeue()}})(k);(function(e){e.effects.effect.slide=function(t,n){var r=e(this),i="position top bottom left right width height".split(" "),s=e.effects.setMode(r,t.mode||"show"),o="show"===s,u=t.direction||"left",a="up"==u||"down"==u?"top":"left",u="up"==u||"left"==u,l,c={};e.effects.save(r,i);r.show();l=t.distance||r["top"===a?"outerHeight":"outerWidth"]({margin:!0});e.effects.createWrapper(r).css({overflow:"hidden"});o&&r.css(a,u?isNaN(l)?"-"+l:-l:l);c[a]=(o?u?"+=":"-=":u?"-=":"+=")+l;r.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&r.hide();e.effects.restore(r,i);e.effects.removeWrapper(r);n()}})}})(k);(function(e){e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s="fixed"===i.css("position"),o=e("body"),u=s?o.scrollTop():0,o=s?o.scrollLeft():0,a=i.offset(),i={top:a.top-u,left:a.left-o,height:i.innerHeight(),width:i.innerWidth()},a=r.offset(),l=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.className).css({top:a.top-u,left:a.left-o,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(i,t.duration,t.easing,function(){l.remove();n()})}})(k);(function(e){var t={};e.widget("ui.accordion",{version:"1.9m6",options:{active:0,animated:"slide",collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.element.addClass("ui-accordion ui-widget ui-helper-reset");this.headers=this.element.find(t.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this._hoverable(this.headers);this._focusable(this.headers);this.headers.find(":first-child").addClass("ui-accordion-heading");this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");!t.collapsible&&!1===t.active&&(t.active=0);0>t.active&&(t.active+=this.headers.length);this.active=this._findActive(t.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");this.active.next().addClass("ui-accordion-content-active");this._createIcons();this.refresh();this.element.attr("role","tablist");this.headers.attr("role","tab").bind("keydown.accordion",e.proxy(this,"_keydown")).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();this.active.length?this.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):this.headers.eq(0).attr("tabIndex",0);e.browser.safari||this.headers.find("a").attr("tabIndex",-1);this._setupEvents(t.event)},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.element.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.children(".ui-accordion-header-icon").remove();this.element.removeClass("ui-accordion-icons")},_destroy:function(){this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex").find("a").removeAttr("tabIndex").end().find(".ui-accordion-heading").removeClass("ui-accordion-heading");this._destroyIcons();var e=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){"active"===e?this._activate(t):("event"===e&&(this.options.event&&this.headers.unbind(this.options.event+".accordion",this._eventHandler),this._setupEvents(t)),this._super("_setOption",e,t),"collapsible"===e&&!t&&!1===this.options.active&&this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-accordion-disabled ui-state-disabled",!!t))},_keydown:function(t){if(!this.options.disabled&&!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t)}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())}},refresh:function(){var t=this.options,n=this.element.parent(),r,i;"fill"===t.heightStyle?(e.support.minHeight||(i=n.css("overflow"),n.css("overflow","hidden")),r=n.height(),this.element.siblings(":visible").each(function(){var t=e(this),n=t.css("position");n==="absolute"||n==="fixed"||(r-=t.outerHeight(!0))}),i&&n.css("overflow",i),this.headers.each(function(){r-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,r-e(this).innerHeight()+e(this).height()))
}).css("overflow","auto")):"auto"===t.heightStyle&&(r=0,this.headers.next().each(function(){r=Math.max(r,e(this).height("").height())}).height(r));return this},_activate:function(t){t=this._findActive(t)[0];t!==this.active[0]&&(t=t||this.active[0],this._eventHandler({target:t,currentTarget:t,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){t&&this.headers.bind(t.split(" ").join(".accordion ")+".accordion",e.proxy(this,"_eventHandler"))},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),a=r.next(),u={oldHeader:r,oldContent:a,newHeader:o?e():i,newContent:u};t.preventDefault();!n.disabled&&!(s&&!n.collapsible||!1===this._trigger("beforeActivate",t,u))&&(n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(u),r.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active")))},_toggle:function(n){function r(){i._completed(n)}var i=this,s=i.options,o=n.newContent,u=n.oldContent;if(s.animated){var l=e.ui.accordion.animations,s=s.animated,c;l[s]||(c={easing:e.easing[s]?s:"slide",duration:700},s="slide");l[s]({toShow:o,toHide:u,prevShow:t.toShow,prevHide:t.toHide,complete:r,down:o.length&&(!u.length||o.index()<u.index())},c)}else u.hide(),o.show(),r();u.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();o.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(e){var t=e.newContent,n=e.oldContent;"content"===this.options.heightStyle&&t.add(n).css({height:"",overflow:""});n.removeClass("ui-accordion-content-active");n.length&&(n.parent()[0].className=n.parent()[0].className);this._trigger("activate",null,e)}});e.extend(e.ui.accordion,{animations:{slide:function(n,r){if(n.prevShow||n.prevHide)n.prevHide.stop(!0,!0),n.toHide=n.prevShow;var i=n.toShow.css("overflow"),s=n.toHide.css("overflow"),o=0,u={},l={},c=["height","paddingTop","paddingBottom"],h;t=n=e.extend({easing:"swing",duration:300},n,r);if(n.toHide.size())if(n.toShow.size()){var p=n.toShow;h=p[0].style.width;p.width(parseInt(p.parent().width(),10)-parseInt(p.css("paddingLeft"),10)-parseInt(p.css("paddingRight"),10)-(parseInt(p.css("borderLeftWidth"),10)||0)-(parseInt(p.css("borderRightWidth"),10)||0));e.each(c,function(t,r){l[r]="hide";var i=(""+e.css(n.toShow[0],r)).match(/^([\d+-.]+)(.*)$/);u[r]={value:"height"===r&&"0"===i[1]?1:i[1],unit:i[2]||"px"}});n.toShow.css({height:0,overflow:"hidden"}).show();n.toHide.filter(":hidden").each(n.complete).end().filter(":visible").animate(l,{step:function(e,t){if("height"==t.prop||"paddingTop"==t.prop||"paddingBottom"==t.prop)o=0===t.end-t.start?0:(t.now-t.start)/(t.end-t.start);n.toShow[0].style[t.prop]=o*u[t.prop].value+u[t.prop].unit},duration:n.duration,easing:n.easing,complete:function(){n.toShow.css({width:h,overflow:i});n.toHide.css("overflow",s);n.complete()}})}else n.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},n);else h=n.toShow[0].style.width,n.toShow.show().width(n.toShow.width()).hide().animate({height:"show",paddingTop:"show",paddingBottom:"show"},{duration:n.duration,easing:n.easing,complete:function(){n.toShow.width(h);n.complete()}})},bounceslide:function(e){this.slide(e,{easing:e.down?"easeOutBounce":"swing",duration:e.down?1e3:200})}}});!1!==e.uiBackCompat&&(function(e,t){e.extend(t.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var n=t._create;t._create=function(){if(this.options.navigation){var t=this,r=this.element.find(this.options.header),i=r.next(),s=r.add(i).find("a").filter(this.options.navigationFilter)[0];s&&r.add(i).each(function(n){if(e.contains(this,s))return t.options.active=Math.floor(n/2),!1})}n.call(this)}}(k,k.ui.accordion.prototype),function(e,t){e.extend(t.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var n=t._create,r=t._setOption;e.extend(t,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle();n.call(this)},_setOption:function(e,t){if("autoHeight"===e||"clearStyle"===e||"fillSpace"===e)this.options.heightStyle=this._mergeHeightStyle();r.apply(this,arguments)},_mergeHeightStyle:function(){var e=this.options;if(e.fillSpace)return"fill";if(e.clearStyle)return"content";if(e.autoHeight)return"auto"}})}(k,k.ui.accordion.prototype),function(e,t){e.extend(t.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var n=t._createIcons;t._createIcons=function(){this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected;n.call(this)}}(k,k.ui.accordion.prototype),function(e,t){t.activate=t._activate;var n=t._findActive;t._findActive=function(e){-1===e&&(e=!1);e&&"number"!=typeof e&&(e=this.headers.index(this.headers.filter(e)),-1===e&&(e=!1));return n.call(this,e)}}(k,k.ui.accordion.prototype),k.ui.accordion.prototype.resize=k.ui.accordion.prototype.refresh,function(e,t){e.extend(t.options,{change:null,changestart:null});var n=t._trigger;t._trigger=function(e,t,r){var i=n.apply(this,arguments);if(!i)return!1;"beforeActivate"===e?i=n.call(this,"changestart",t,r):"activate"===e&&(i=n.call(this,"change",t,r));return i}}(k,k.ui.accordion.prototype))})(k);(function(e){var t=0;e.widget("ui.autocomplete",{version:"1.9m6",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t=this,n=this.element[0].ownerDocument,r,i;this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"];this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(n){if(t.options.disabled||t.element.prop("readOnly"))i=r=!0;else{i=r=!1;var s=e.ui.keyCode;switch(n.keyCode){case s.PAGE_UP:r=!0;t._move("previousPage",n);break;case s.PAGE_DOWN:r=!0;t._move("nextPage",n);break;case s.UP:r=!0;t._move("previous",n);n.preventDefault();break;case s.DOWN:r=!0;t._move("next",n);n.preventDefault();break;case s.ENTER:case s.NUMPAD_ENTER:t.menu.active&&(r=!0,n.preventDefault());case s.TAB:if(!t.menu.active)break;t.menu.select(n);break;case s.ESCAPE:t._value(t.term);t.close(n);break;default:t._searchTimeout(n)}}}).bind("keypress.autocomplete",function(n){if(r)r=!1,n.preventDefault();else{var i=e.ui.keyCode;switch(n.keyCode){case i.PAGE_UP:t._move("previousPage",n);break;case i.PAGE_DOWN:t._move("nextPage",n);break;case i.UP:t._move("previous",n);n.preventDefault();break;case i.DOWN:t._move("next",n),n.preventDefault()}}}).bind("input.autocomplete",function(e){i?(i=!1,e.preventDefault()):t._searchTimeout(e)}).bind("focus.autocomplete",function(){t.options.disabled||(t.selectedItem=null,t.previous=t._value())}).bind("blur.autocomplete",function(e){t.options.disabled||(clearTimeout(t.searching),t.closing=setTimeout(function(){t.close(e);t._change(e)},150))});this._initSource();this.response=function(){return t._response.apply(t,arguments)};this.menu=e("<ul></ul>").addClass("ui-autocomplete").appendTo(e(this.options.appendTo||"body",n)[0]).mousedown(function(n){var r=t.menu.element[0];e(n.target).closest(".ui-menu-item").length||setTimeout(function(){e(document).one("mousedown",function(n){n.target!==t.element[0]&&n.target!==r&&!e.contains(r,n.target)&&t.close()})},1);setTimeout(function(){clearTimeout(t.closing)},13)}).menu({input:e(),focus:function(e,n){var r=n.item.data("item.autocomplete");!1!==t._trigger("focus",e,{item:r})&&/^key/.test(e.originalEvent.type)&&t._value(r.value)},select:function(e,r){var i=r.item.data("item.autocomplete"),s=t.previous;t.element[0]!==n.activeElement&&(t.element.focus(),t.previous=s,setTimeout(function(){t.previous=s;t.selectedItem=i},1));!1!==t._trigger("select",e,{item:i})&&t._value(i.value);t.term=t._value();t.close(e);t.selectedItem=i},blur:function(){t.menu.element.is(":visible")&&t._value()!==t.term&&t._value(t.term)}}).zIndex(this.element.zIndex()+1).hide().data("menu");e.fn.bgiframe&&this.menu.element.bgiframe()},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove()},_setOption:function(t,n){this._super("_setOption",t,n);"source"===t&&this._initSource();"appendTo"===t&&this.menu.element.appendTo(e(n||"body",this.element[0].ownerDocument)[0]);"disabled"===t&&n&&this.xhr&&this.xhr.abort()},_initSource:function(){var n=this,r,i;e.isArray(this.options.source)?(r=this.options.source,this.source=function(t,n){n(e.ui.autocomplete.filter(r,t.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(r,s){n.xhr&&n.xhr.abort();n.xhr=e.ajax({url:i,data:r,dataType:"json",autocompleteRequest:++t,success:function(e){this.autocompleteRequest===t&&s(e)},error:function(){this.autocompleteRequest===t&&s([])}})}):this.source=this.options.source},_searchTimeout:function(e){var t=this;t.searching=setTimeout(function(){t.term!=t.element.val()&&(t.selectedItem=null,t.search(null,e))},t.options.delay)},search:function(e,t){e=null!=e?e:this._value();this.term=this._value();if(e.length<this.options.minLength)return this.close(t);clearTimeout(this.closing);if(!1!==this._trigger("search",t))return this._search(e)},_search:function(e){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:e},this.response)},_response:function(e){e&&(e=this._normalize(e));this._trigger("response",null,{content:e});!this.options.disabled&&e&&e.length?(this._suggest(e),this._trigger("open")):this.close();this.pending--;this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(e){clearTimeout(this.closing);this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t);this.menu.blur();this.menu.refresh();n.show();this._resizeMenu();n.position(e.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next(new e.Event("mouseover"))},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItem(t,n)})},_renderItem:function(t,n){return e("<li></li>").data("item.autocomplete",n).append(e("<a></a>").text(n.label)).appendTo(t)},_move:function(e,t){this.menu.element.is(":visible")?this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e)?(this._value(this.term),this.menu.blur()):this.menu[e](t):this.search(null,t)},widget:function(){return this.menu.element},_value:function(e){return this.valueMethod.apply(this.element,arguments)}});e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}})})(k);(function(e){var t,n,r,i,s=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},o=function(t){var n=t.name,r=t.form,i=e([]);n&&(i=r?e(r).find("[name='"+n+"']"):e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form}));return i};e.widget("ui.button",{version:"1.9m6",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",s);"boolean"!=typeof this.options.disabled&&(this.options.disabled=this.element.prop("disabled"));this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var u=this,h=this.options,p="checkbox"===this.type||"radio"===this.type,d="ui-state-hover"+(p?"":" ui-state-active");null===h.label&&(h.label=this.buttonElement.html());this.element.is(":disabled")&&(h.disabled=!0);this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",function(){if(!h.disabled){e(this).addClass("ui-state-hover");this===t&&e(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){h.disabled||e(this).removeClass(d)}).bind("click.button",function(e){if(h.disabled){e.preventDefault();e.stopImmediatePropagation()}});this.element.bind("focus.button",function(){u.buttonElement.addClass("ui-state-focus")}).bind("blur.button",function(){u.buttonElement.removeClass("ui-state-focus")});p&&(this.element.bind("change.button",function(){i||u.refresh()}),this.buttonElement.bind("mousedown.button",function(e){if(!h.disabled){i=!1;n=e.pageX;r=e.pageY}}).bind("mouseup.button",function(e){!h.disabled&&(n!==e.pageX||r!==e.pageY)&&(i=!0)}));"checkbox"===this.type?this.buttonElement.bind("click.button",function(){if(h.disabled||i)return!1;e(this).toggleClass("ui-state-active");u.buttonElement.attr("aria-pressed",u.element[0].checked)}):"radio"===this.type?this.buttonElement.bind("click.button",function(){if(h.disabled||i)return!1;e(this).addClass("ui-state-active");u.buttonElement.attr("aria-pressed","true");var t=u.element[0];o(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(h.disabled)return!1;e(this).addClass("ui-state-active");t=this;e(document).one("mouseup",function(){t=null})}).bind("mouseup.button",function(){if(h.disabled)return!1;e(this).removeClass("ui-state-active")}).bind("keydown.button",function(t){if(h.disabled)return!1;(t.keyCode==e.ui.keyCode.SPACE||t.keyCode==e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active")}).bind("keyup.button",function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()}));this._setOption("disabled",h.disabled);this._resetButton()},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if("checkbox"===this.type||"radio"===this.type){var e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']";this.buttonElement=e.find(t);this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t)));this.element.addClass("ui-helper-hidden-accessible");(e=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active");this.buttonElement.prop("aria-pressed",e)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){this._super("_setOption",e,t);"disabled"===e?t?this.element.prop("disabled",!0):this.element.prop("disabled",!1):this._resetButton()},refresh:function(){var t=this.element.is(":disabled");t!==this.options.disabled&&this._setOption("disabled",t);"radio"===this.type?o(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)this.options.label&&this.element.val(this.options.label);else{var t=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),n=e("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,i=r.primary&&r.secondary,s=[];r.primary||r.secondary?(this.options.text&&s.push("ui-button-text-icon"+(i?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(s.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",n))):s.push("ui-button-text-only");t.addClass(s.join(" "))}}});e.ui.button.version="1.9m6";e.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t);this._super("_setOption",e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(k);(function(f,a){function e(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};f.extend(this._defaults,this.regional[""]);this.dpDiv=c(f('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function c(e){return e.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseout",function(){f(this).removeClass("ui-state-hover");-1!=this.className.indexOf("ui-datepicker-prev")&&f(this).removeClass("ui-datepicker-prev-hover");-1!=this.className.indexOf("ui-datepicker-next")&&f(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){f.datepicker._isDisabledDatepicker(l.inline?e.parent()[0]:l.input[0])||(f(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),f(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&f(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&f(this).addClass("ui-datepicker-next-hover"))})}function b(e,t){f.extend(e,t);for(var n in t)if(null==t[n]||t[n]==a)e[n]=t[n];return e}f.extend(f.ui,{datepicker:{version:"1.9m6"}});var m=(new Date).getTime(),l;f.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){b(this._defaults,e||{});return this},_attachDatepicker:function(a,b){var d=null,c;for(c in this._defaults){var e=a.getAttribute("date:"+c);if(e){d=d||{};try{d[c]=eval(e)}catch(m){d[c]=e}}}c=a.nodeName.toLowerCase();e="div"==c||"span"==c;a.id||(this.uuid+=1,a.id="dp"+this.uuid);var l=this._newInst(f(a),e);l.settings=f.extend({},b||{},d||{});"input"==c?this._connectDatepicker(a,l):e&&this._inlineDatepicker(a,l)},_newInst:function(e,t){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?c(f('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(e,t){var n=f(e);t.append=f([]);t.trigger=f([]);n.hasClass(this.markerClassName)||(this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),this._autoSize(t),f.data(e,"datepicker",t),t.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,t){var n=this._get(t,"appendText"),r=this._get(t,"isRTL");t.append&&t.append.remove();n&&(t.append=f('<span class="'+this._appendClass+'">'+n+"</span>"),e[r?"before":"after"](t.append));e.unbind("focus",this._showDatepicker);t.trigger&&t.trigger.remove();n=this._get(t,"showOn");("focus"==n||"both"==n)&&e.focus(this._showDatepicker);if("button"==n||"both"==n){var n=this._get(t,"buttonText"),i=this._get(t,"buttonImage");t.trigger=f(this._get(t,"buttonImageOnly")?f("<img/>").addClass(this._triggerClass).attr({src:i,alt:n,title:n}):f('<button type="button"></button>').addClass(this._triggerClass).html(""==i?n:f("<img/>").attr({src:i,alt:n,title:n})));e[r?"before":"after"](t.trigger);t.trigger.click(function(){f.datepicker._datepickerShowing&&f.datepicker._lastInput==e[0]?f.datepicker._hideDatepicker():f.datepicker._showDatepicker(e[0]);return!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),n=this._get(e,"dateFormat");if(n.match(/[DM]/)){var r=function(e){for(var t=0,n=0,r=0;r<e.length;r++)e[r].length>t&&(t=e[r].length,n=r);return n};t.setMonth(r(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort")));t.setDate(r(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var n=f(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),f.data(e,"datepicker",t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block"))},_dialogDatepicker:function(e,t,n,r,i){e=this._dialogInst;e||(this.uuid+=1,this._dialogInput=f('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),this._dialogInput.keydown(this._doKeyDown),f("body").append(this._dialogInput),e=this._dialogInst=this._newInst(this._dialogInput,!1),e.settings={},f.data(this._dialogInput[0],"datepicker",e));b(e.settings,r||{});t=t&&t.constructor==Date?this._formatDate(e,t):t;this._dialogInput.val(t);this._pos=i?i.length?i:[i.pageX,i.pageY]:null;this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");e.settings.onSelect=n;this._inDialog=!0;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);f.blockUI&&f.blockUI(this.dpDiv);f.data(this._dialogInput[0],"datepicker",e);return this},_destroyDatepicker:function(e){var t=f(e),n=f.data(e,"datepicker");if(t.hasClass(this.markerClassName)){var r=e.nodeName.toLowerCase();f.removeData(e,"datepicker");"input"==r?(n.append.remove(),n.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==r||"span"==r)&&t.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(e){var t=f(e),n=f.data(e,"datepicker");if(t.hasClass(this.markerClassName)){var r=e.nodeName.toLowerCase();if("input"==r)e.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==r||"span"==r)t=t.children("."+this._inlineClass),t.children().removeClass("ui-state-disabled"),t.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=f.map(this._disabledInputs,function(t){return t==e?null:t})}},_disableDatepicker:function(e){var t=f(e),n=f.data(e,"datepicker");if(t.hasClass(this.markerClassName)){var r=e.nodeName.toLowerCase();if("input"==r)e.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==r||"span"==r)t=t.children("."+this._inlineClass),t.children().addClass("ui-state-disabled"),t.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=f.map(this._disabledInputs,function(t){return t==e?null:t});this._disabledInputs[this._disabledInputs.length]=e}},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_getInst:function(e){try{return f.data(e,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,n){var r=this._getInst(e);if(2==arguments.length&&"string"==typeof t)return"defaults"==t?f.extend({},f.datepicker._defaults):r?"all"==t?f.extend({},r.settings):this._get(r,t):null;var i=t||{};"string"==typeof t&&(i={},i[t]=n);if(r){this._curInst==r&&this._hideDatepicker();var s=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(r,"min"),u=this._getMinMaxDate(r,"max");b(r.settings,i);null!==o&&i.dateFormat!==a&&i.minDate===a&&(r.settings.minDate=this._formatDate(r,o));null!==u&&i.dateFormat!==a&&i.maxDate===a&&(r.settings.maxDate=this._formatDate(r,u));this._attachments(f(e),r);this._autoSize(r);this._setDate(r,s);this._updateAlternate(r);this._updateDatepicker(r)}},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){(e=this._getInst(e))&&this._updateDatepicker(e)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);n&&!n.inline&&this._setDateFromField(n,t);return n?this._getDate(n):null},_doKeyDown:function(e){var t=f.datepicker._getInst(e.target),n=!0,r=t.dpDiv.is(".ui-datepicker-rtl");t._keyEvent=!0;if(f.datepicker._datepickerShowing)switch(e.keyCode){case 9:f.datepicker._hideDatepicker();n=!1;break;case 13:return n=f("td."+f.datepicker._dayOverClass+":not(."+f.datepicker._currentClass+")",t.dpDiv),n[0]&&f.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,n[0]),(e=f.datepicker._get(t,"onSelect"))?(n=f.datepicker._formatDate(t),e.apply(t.input?t.input[0]:null,[n,t])):f.datepicker._hideDatepicker(),!1;case 27:f.datepicker._hideDatepicker();break;case 33:f.datepicker._adjustDate(e.target,e.ctrlKey?-f.datepicker._get(t,"stepBigMonths"):-f.datepicker._get(t,"stepMonths"),"M");break;case 34:f.datepicker._adjustDate(e.target,e.ctrlKey?+f.datepicker._get(t,"stepBigMonths"):+f.datepicker._get(t,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&f.datepicker._clearDate(e.target);n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&f.datepicker._gotoToday(e.target);n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&f.datepicker._adjustDate(e.target,r?1:-1,"D");n=e.ctrlKey||e.metaKey;e.originalEvent.altKey&&f.datepicker._adjustDate(e.target,e.ctrlKey?-f.datepicker._get(t,"stepBigMonths"):-f.datepicker._get(t,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&f.datepicker._adjustDate(e.target,-7,"D");n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&f.datepicker._adjustDate(e.target,r?-1:1,"D");n=e.ctrlKey||e.metaKey;e.originalEvent.altKey&&f.datepicker._adjustDate(e.target,e.ctrlKey?+f.datepicker._get(t,"stepBigMonths"):+f.datepicker._get(t,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&f.datepicker._adjustDate(e.target,7,"D");n=e.ctrlKey||e.metaKey;break;default:n=!1}else 36==e.keyCode&&e.ctrlKey?f.datepicker._showDatepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t=f.datepicker._getInst(e.target);if(f.datepicker._get(t,"constrainInput")){var t=f.datepicker._possibleChars(f.datepicker._get(t,"dateFormat")),n=String.fromCharCode(e.charCode==a?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||" ">n||!t||-1<t.indexOf(n)}},_doKeyUp:function(e){e=f.datepicker._getInst(e.target);if(e.input.val()!=e.lastVal)try{f.datepicker.parseDate(f.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,f.datepicker._getFormatConfig(e))&&(f.datepicker._setDateFromField(e),f.datepicker._updateAlternate(e),f.datepicker._updateDatepicker(e))}catch(t){f.datepicker.log(t)}return!0},_showDatepicker:function(e){e=e.target||e;"input"!=e.nodeName.toLowerCase()&&(e=f("input",e.parentNode)[0]);if(!f.datepicker._isDisabledDatepicker(e)&&f.datepicker._lastInput!=e){var t=f.datepicker._getInst(e);f.datepicker._curInst&&f.datepicker._curInst!=t&&(f.datepicker._datepickerShowing&&f.datepicker._triggerOnClose(f.datepicker._curInst),f.datepicker._curInst.dpDiv.stop(!0,!0));var n=f.datepicker._get(t,"beforeShow"),n=n?n.apply(e,[e,t]):{};if(!1!==n){b(t.settings,n);t.lastVal=null;f.datepicker._lastInput=e;f.datepicker._setDateFromField(t);f.datepicker._inDialog&&(e.value="");f.datepicker._pos||(f.datepicker._pos=f.datepicker._findPos(e),f.datepicker._pos[1]+=e.offsetHeight);var r=!1;f(e).parents().each(function(){r|=f(this).css("position")=="fixed";return!r});r&&f.browser.opera&&(f.datepicker._pos[0]-=document.documentElement.scrollLeft,f.datepicker._pos[1]-=document.documentElement.scrollTop);n={left:f.datepicker._pos[0],top:f.datepicker._pos[1]};f.datepicker._pos=null;t.dpDiv.empty();t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});f.datepicker._updateDatepicker(t);n=f.datepicker._checkOffset(t,n,r);t.dpDiv.css({position:f.datepicker._inDialog&&f.blockUI?"static":r?"fixed":"absolute",display:"none",left:n.left+"px",top:n.top+"px"});if(!t.inline){var n=f.datepicker._get(t,"showAnim"),
i=f.datepicker._get(t,"duration"),s=function(){var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(e.length){var n=f.datepicker._getBorders(t.dpDiv);e.css({left:-n[0],top:-n[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex(f(e).zIndex()+1);f.datepicker._datepickerShowing=!0;f.effects&&(f.effects.effect[n]||f.effects[n])?t.dpDiv.show(n,f.datepicker._get(t,"showOptions"),i,s):t.dpDiv[n||"show"](n?i:null,s);(!n||!i)&&s();t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus();f.datepicker._curInst=t}}}},_updateDatepicker:function(e){this.maxRows=4;var t=f.datepicker._getBorders(e.dpDiv);l=e;e.dpDiv.empty().append(this._generateHTML(e));var n=e.dpDiv.find("iframe.ui-datepicker-cover");n.length&&n.css({left:-t[0],top:-t[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()});e.dpDiv.find("."+this._dayOverClass+" a").mouseover();t=this._getNumberOfMonths(e);n=t[1];e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<n&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",17*n+"em");e.dpDiv[(1!=t[0]||1!=t[1]?"add":"remove")+"Class"]("ui-datepicker-multi");e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");e==f.datepicker._curInst&&f.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&e.input.focus();if(e.yearshtml){var r=e.yearshtml;setTimeout(function(){r===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml);r=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,n){var r=e.dpDiv.outerWidth(),i=e.dpDiv.outerHeight(),s=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,u=document.documentElement.clientWidth+f(document).scrollLeft(),a=document.documentElement.clientHeight+f(document).scrollTop();t.left-=this._get(e,"isRTL")?r-s:0;t.left-=n&&t.left==e.input.offset().left?f(document).scrollLeft():0;t.top-=n&&t.top==e.input.offset().top+o?f(document).scrollTop():0;t.left-=Math.min(t.left,t.left+r>u&&u>r?Math.abs(t.left+r-u):0);t.top-=Math.min(t.top,t.top+i>a&&a>i?Math.abs(i+o):0);return t},_findPos:function(e){for(var t=this._get(this._getInst(e),"isRTL");e&&("hidden"==e.type||1!=e.nodeType||f.expr.filters.hidden(e));)e=e[t?"previousSibling":"nextSibling"];e=f(e).offset();return[e.left,e.top]},_triggerOnClose:function(e){var t=this._get(e,"onClose");t&&t.apply(e.input?e.input[0]:null,[e.input?e.input.val():"",e])},_hideDatepicker:function(e){var t=this._curInst;if(t&&(!e||t==f.data(e,"datepicker"))&&this._datepickerShowing){var e=this._get(t,"showAnim"),n=this._get(t,"duration"),r=function(){f.datepicker._tidyDialog(t);this._curInst=null};f.effects&&(f.effects.effect[e]||f.effects[e])?t.dpDiv.hide(e,f.datepicker._get(t,"showOptions"),n,r):t.dpDiv["slideDown"==e?"slideUp":"fadeIn"==e?"fadeOut":"hide"](e?n:null,r);e||r();f.datepicker._triggerOnClose(t);this._datepickerShowing=!1;this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),f.blockUI&&(f.unblockUI(),f("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){f.datepicker._curInst&&(e=f(e.target),e[0].id!=f.datepicker._mainDivId&&0==e.parents("#"+f.datepicker._mainDivId).length&&!e.hasClass(f.datepicker.markerClassName)&&!e.hasClass(f.datepicker._triggerClass)&&f.datepicker._datepickerShowing&&(!f.datepicker._inDialog||!f.blockUI)&&f.datepicker._hideDatepicker())},_adjustDate:function(e,t,n){var e=f(e),r=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(r,t+("M"==n?this._get(r,"showCurrentAtPos"):0),n),this._updateDatepicker(r))},_gotoToday:function(e){var e=f(e),t=this._getInst(e[0]);if(this._get(t,"gotoCurrent")&&t.currentDay)t.selectedDay=t.currentDay,t.drawMonth=t.selectedMonth=t.currentMonth,t.drawYear=t.selectedYear=t.currentYear;else{var n=new Date;t.selectedDay=n.getDate();t.drawMonth=t.selectedMonth=n.getMonth();t.drawYear=t.selectedYear=n.getFullYear()}this._notifyChange(t);this._adjustDate(e)},_selectMonthYear:function(e,t,n){var e=f(e),r=this._getInst(e[0]);r["selected"+("M"==n?"Month":"Year")]=r["draw"+("M"==n?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10);this._notifyChange(r);this._adjustDate(e)},_selectDay:function(e,t,n,r){var i=f(e);!f(r).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(i[0])&&(i=this._getInst(i[0]),i.selectedDay=i.currentDay=f("a",r).html(),i.selectedMonth=i.currentMonth=t,i.selectedYear=i.currentYear=n,this._selectDate(e,this._formatDate(i,i.currentDay,i.currentMonth,i.currentYear)))},_clearDate:function(e){e=f(e);this._getInst(e[0]);this._selectDate(e,"")},_selectDate:function(e,t){var n=this._getInst(f(e)[0]),t=null!=t?t:this._formatDate(n);n.input&&n.input.val(t);this._updateAlternate(n);var r=this._get(n,"onSelect");r?r.apply(n.input?n.input[0]:null,[t,n]):n.input&&n.input.trigger("change");n.inline?this._updateDatepicker(n):(this._hideDatepicker(),this._lastInput=n.input[0],"object"!=typeof n.input[0]&&n.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var n=this._get(e,"altFormat")||this._get(e,"dateFormat"),r=this._getDate(e),i=this.formatDate(n,r,this._getFormatConfig(e));f(t).each(function(){f(this).val(i)})}},noWeekends:function(e){e=e.getDay();return[0<e&&6>e,""]},iso8601Week:function(e){e=new Date(e.getTime());e.setDate(e.getDate()+4-(e.getDay()||7));var t=e.getTime();e.setMonth(0);e.setDate(1);return Math.floor(Math.round((t-e)/864e5)/7)+1},parseDate:function(e,t,n){if(null==e||null==t)throw"Invalid arguments";t="object"==typeof t?t.toString():t+"";if(""==t)return null;for(var r=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,r="string"!=typeof r?r:(new Date).getFullYear()%100+parseInt(r,10),i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=n=-1,l=-1,c=-1,h=!1,p=function(t){(t=y+1<e.length&&e.charAt(y+1)==t)&&y++;return t},d=function(e){var n=p(e),e=RegExp("^\\d{1,"+("@"==e?14:"!"==e?20:"y"==e&&n?4:"o"==e?3:2)+"}"),e=t.substring(g).match(e);if(!e)throw"Missing number at position "+g;g+=e[0].length;return parseInt(e[0],10)},v=function(e,n,r){var e=f.map(p(e)?r:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)}),i=-1;f.each(e,function(e,n){var r=n[1];if(t.substr(g,r.length).toLowerCase()==r.toLowerCase())return i=n[0],g+=r.length,!1});if(-1!=i)return i+1;throw"Unknown name at position "+g},m=function(){if(t.charAt(g)!=e.charAt(y))throw"Unexpected literal at position "+g;g++},g=0,y=0;y<e.length;y++)if(h)"'"==e.charAt(y)&&!p("'")?h=!1:m();else switch(e.charAt(y)){case"d":l=d("d");break;case"D":v("D",i,s);break;case"o":c=d("o");break;case"m":a=d("m");break;case"M":a=v("M",o,u);break;case"y":n=d("y");break;case"@":var b=new Date(d("@")),n=b.getFullYear(),a=b.getMonth()+1,l=b.getDate();break;case"!":b=new Date((d("!")-this._ticksTo1970)/1e4);n=b.getFullYear();a=b.getMonth()+1;l=b.getDate();break;case"'":p("'")?m():h=!0;break;default:m()}if(g<t.length&&(i=t.substr(g),!/^\s+/.test(i)))throw"Extra/unparsed characters found in date: "+i;-1==n?n=(new Date).getFullYear():100>n&&(n+=(new Date).getFullYear()-(new Date).getFullYear()%100+(n<=r?0:-100));if(-1<c){a=1;l=c;do{r=this._getDaysInMonth(n,a-1);if(l<=r)break;a++;l-=r}while(1)}b=this._daylightSavingAdjust(new Date(n,a-1,l));if(b.getFullYear()!=n||b.getMonth()+1!=a||b.getDate()!=l)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,n){if(!t)return"";var r=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,i=(n?n.dayNames:null)||this._defaults.dayNames,s=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,n=(n?n.monthNames:null)||this._defaults.monthNames,o=function(t){(t=c+1<e.length&&e.charAt(c+1)==t)&&c++;return t},u=function(e,t,n){t=""+t;if(o(e))for(;t.length<n;)t="0"+t;return t},a=function(e,t,n,r){return o(e)?r[t]:n[t]},f="",l=!1;if(t)for(var c=0;c<e.length;c++)if(l)"'"==e.charAt(c)&&!o("'")?l=!1:f+=e.charAt(c);else switch(e.charAt(c)){case"d":f+=u("d",t.getDate(),2);break;case"D":f+=a("D",t.getDay(),r,i);break;case"o":f+=u("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":f+=u("m",t.getMonth()+1,2);break;case"M":f+=a("M",t.getMonth(),s,n);break;case"y":f+=o("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":f+=t.getTime();break;case"!":f+=1e4*t.getTime()+this._ticksTo1970;break;case"'":o("'")?f+="'":l=!0;break;default:f+=e.charAt(c)}return f},_possibleChars:function(e){for(var t="",n=!1,r=function(t){(t=i+1<e.length&&e.charAt(i+1)==t)&&i++;return t},i=0;i<e.length;i++)if(n)"'"==e.charAt(i)&&!r("'")?n=!1:t+=e.charAt(i);else switch(e.charAt(i)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":r("'")?t+="'":n=!0;break;default:t+=e.charAt(i)}return t},_get:function(e,t){return e.settings[t]!==a?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!=e.lastVal){var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i,s;i=s=this._getDefaultDate(e);var o=this._getFormatConfig(e);try{i=this.parseDate(n,r,o)||s}catch(u){this.log(u),r=t?"":r}e.selectedDay=i.getDate();e.drawMonth=e.selectedMonth=i.getMonth();e.drawYear=e.selectedYear=i.getFullYear();e.currentDay=r?i.getDate():0;e.currentMonth=r?i.getMonth():0;e.currentYear=r?i.getFullYear():0;this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,n){var r=function(e){var t=new Date;t.setDate(t.getDate()+e);return t},i=function(t){try{return f.datepicker.parseDate(f.datepicker._get(e,"dateFormat"),t,f.datepicker._getFormatConfig(e))}catch(n){}for(var r=(t.toLowerCase().match(/^c/)?f.datepicker._getDate(e):null)||new Date,i=r.getFullYear(),s=r.getMonth(),r=r.getDate(),o=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,u=o.exec(t);u;){switch(u[2]||"d"){case"d":case"D":r+=parseInt(u[1],10);break;case"w":case"W":r+=7*parseInt(u[1],10);break;case"m":case"M":s+=parseInt(u[1],10);r=Math.min(r,f.datepicker._getDaysInMonth(i,s));break;case"y":case"Y":i+=parseInt(u[1],10),r=Math.min(r,f.datepicker._getDaysInMonth(i,s))}u=o.exec(t)}return new Date(i,s,r)};if(t=(t=null==t||""===t?n:"string"==typeof t?i(t):"number"==typeof t?isNaN(t)?n:r(t):new Date(t.getTime()))&&"Invalid Date"==t.toString()?n:t)t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);return this._daylightSavingAdjust(t)},_daylightSavingAdjust:function(e){if(!e)return null;e.setHours(12<e.getHours()?e.getHours()+2:0);return e},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,t=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=t.getDate();e.drawMonth=e.selectedMonth=e.currentMonth=t.getMonth();e.drawYear=e.selectedYear=e.currentYear=t.getFullYear();(i!=e.selectedMonth||s!=e.selectedYear)&&!n&&this._notifyChange(e);this._adjustInstDate(e);e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""==e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_generateHTML:function(e){var t=new Date,t=this._daylightSavingAdjust(new Date(t.getFullYear(),t.getMonth(),t.getDate())),n=this._get(e,"isRTL"),r=this._get(e,"showButtonPanel"),i=this._get(e,"hideIfNoPrevNext"),s=this._get(e,"navigationAsDateFormat"),o=this._getNumberOfMonths(e),u=this._get(e,"showCurrentAtPos"),a=this._get(e,"stepMonths"),l=1!=o[0]||1!=o[1],c=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),h=this._getMinMaxDate(e,"min"),p=this._getMinMaxDate(e,"max"),u=e.drawMonth-u,d=e.drawYear;0>u&&(u+=12,d--);if(p)for(var v=this._daylightSavingAdjust(new Date(p.getFullYear(),p.getMonth()-o[0]*o[1]+1,p.getDate())),v=h&&v<h?h:v;this._daylightSavingAdjust(new Date(d,u,1))>v;)u--,0>u&&(u=11,d--);e.drawMonth=u;e.drawYear=d;var v=this._get(e,"prevText"),v=s?this.formatDate(v,this._daylightSavingAdjust(new Date(d,u-a,1)),this._getFormatConfig(e)):v,v=this._canAdjustMonth(e,-1,d,u)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+m+".datepicker._adjustDate('#"+e.id+"', -"+a+", 'M');\" title=\""+v+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+v+"</span></a>":i?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+v+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+v+"</span></a>",g=this._get(e,"nextText"),g=s?this.formatDate(g,this._daylightSavingAdjust(new Date(d,u+a,1)),this._getFormatConfig(e)):g,i=this._canAdjustMonth(e,1,d,u)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+m+".datepicker._adjustDate('#"+e.id+"', +"+a+", 'M');\" title=\""+g+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+g+"</span></a>":i?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+g+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+g+"</span></a>",a=this._get(e,"currentText"),g=this._get(e,"gotoCurrent")&&e.currentDay?c:t,a=s?this.formatDate(a,g,this._getFormatConfig(e)):a,s=e.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+m+'.datepicker._hideDatepicker();">'+this._get(e,"closeText")+"</button>",r=r?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(n?s:"")+(this._isInRange(e,g)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+m+".datepicker._gotoToday('#"+e.id+"');\">"+a+"</button>":"")+(n?"":s)+"</div>":"",s=parseInt(this._get(e,"firstDay"),10),s=isNaN(s)?0:s,a=this._get(e,"showWeek"),g=this._get(e,"dayNames");this._get(e,"dayNamesShort");var y=this._get(e,"dayNamesMin"),b=this._get(e,"monthNames"),w=this._get(e,"monthNamesShort"),E=this._get(e,"beforeShowDay"),S=this._get(e,"showOtherMonths"),x=this._get(e,"selectOtherMonths");this._get(e,"calculateWeek");for(var T=this._getDefaultDate(e),N="",C=0;C<o[0];C++){var k="";this.maxRows=4;for(var L=0;L<o[1];L++){var A=this._daylightSavingAdjust(new Date(d,u,e.selectedDay)),O=" ui-corner-all",M="";if(l){M+='<div class="ui-datepicker-group';if(1<o[1])switch(L){case 0:M+=" ui-datepicker-group-first";O=" ui-corner-"+(n?"right":"left");break;case o[1]-1:M+=" ui-datepicker-group-last";O=" ui-corner-"+(n?"left":"right");break;default:M+=" ui-datepicker-group-middle",O=""}M+='">'}for(var M=M+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+O+'">'+(/all|left/.test(O)&&0==C?n?i:v:"")+(/all|right/.test(O)&&0==C?n?v:i:"")+this._generateMonthYearHeader(e,u,d,h,p,0<C||0<L,b,w)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),_=a?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"",O=0;7>O;O++)var D=(O+s)%7,_=_+("<th"+(5<=(O+s+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+g[D]+'">'+y[D]+"</span></th>");M+=_+"</tr></thead><tbody>";_=this._getDaysInMonth(d,u);d==e.selectedYear&&u==e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,_));O=(this._getFirstDayOfMonth(d,u)-s+7)%7;_=Math.ceil((O+_)/7);this.maxRows=_=l?this.maxRows>_?this.maxRows:_:_;for(var D=this._daylightSavingAdjust(new Date(d,u,1-O)),P=0;P<_;P++){for(var M=M+"<tr>",H=a?'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(D)+"</td>":"",O=0;7>O;O++){var B=E?E.apply(e.input?e.input[0]:null,[D]):[!0,""],j=D.getMonth()!=u,F=j&&!x||!B[0]||h&&D<h||p&&D>p,H=H+('<td class="'+(5<=(O+s+6)%7?" ui-datepicker-week-end":"")+(j?" ui-datepicker-other-month":"")+(D.getTime()==A.getTime()&&u==e.selectedMonth&&e._keyEvent||T.getTime()==D.getTime()&&T.getTime()==A.getTime()?" "+this._dayOverClass:"")+(F?" "+this._unselectableClass+" ui-state-disabled":"")+(j&&!S?"":" "+B[1]+(D.getTime()==c.getTime()?" "+this._currentClass:"")+(D.getTime()==t.getTime()?" ui-datepicker-today":""))+'"'+((!j||S)&&B[2]?' title="'+B[2]+'"':"")+(F?"":' onclick="DP_jQuery_'+m+".datepicker._selectDay('#"+e.id+"',"+D.getMonth()+","+D.getFullYear()+', this);return false;"')+">"+(j&&!S?"&#xa0;":F?'<span class="ui-state-default">'+D.getDate()+"</span>":'<a class="ui-state-default'+(D.getTime()==t.getTime()?" ui-state-highlight":"")+(D.getTime()==c.getTime()?" ui-state-active":"")+(j?" ui-priority-secondary":"")+'" href="#">'+D.getDate()+"</a>")+"</td>");D.setDate(D.getDate()+1);D=this._daylightSavingAdjust(D)}M+=H+"</tr>"}u++;11<u&&(u=0,d++);M+="</tbody></table>"+(l?"</div>"+(0<o[0]&&L==o[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");k+=M}N+=k}N+=r+(f.browser.msie&&7>parseInt(f.browser.version,10)&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");e._keyEvent=!1;return N},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a=this._get(e,"changeMonth"),f=this._get(e,"changeYear"),l=this._get(e,"showMonthAfterYear"),c='<div class="ui-datepicker-title">',h="";if(s||!a)h+='<span class="ui-datepicker-month">'+o[t]+"</span>";else{for(var o=r&&r.getFullYear()==n,p=i&&i.getFullYear()==n,h=h+('<select class="ui-datepicker-month" onchange="DP_jQuery_'+m+".datepicker._selectMonthYear('#"+e.id+"', this, 'M');\" >"),d=0;12>d;d++)(!o||d>=r.getMonth())&&(!p||d<=i.getMonth())&&(h+='<option value="'+d+'"'+(d==t?' selected="selected"':"")+">"+u[d]+"</option>");h+="</select>"}l||(c+=h+(s||!a||!f?"&#xa0;":""));if(!e.yearshtml)if(e.yearshtml="",s||!f)c+='<span class="ui-datepicker-year">'+n+"</span>";else{var u=this._get(e,"yearRange").split(":"),v=(new Date).getFullYear(),o=function(e){e=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?v+parseInt(e,10):parseInt(e,10);return isNaN(e)?v:e},t=o(u[0]),u=Math.max(t,o(u[1]||"")),t=r?Math.max(t,r.getFullYear()):t,u=i?Math.min(u,i.getFullYear()):u;for(e.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+m+".datepicker._selectMonthYear('#"+e.id+"', this, 'Y');\" >";t<=u;t++)e.yearshtml+='<option value="'+t+'"'+(t==n?' selected="selected"':"")+">"+t+"</option>";e.yearshtml+="</select>";c+=e.yearshtml;e.yearshtml=null}c+=this._get(e,"yearSuffix");l&&(c+=(s||!a||!f?"&#xa0;":"")+h);return c+"</div>"},_adjustInstDate:function(e,t,n){var r=e.drawYear+("Y"==n?t:0),i=e.drawMonth+("M"==n?t:0),t=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+("D"==n?t:0),r=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,t)));e.selectedDay=r.getDate();e.drawMonth=e.selectedMonth=r.getMonth();e.drawYear=e.selectedYear=r.getFullYear();("M"==n||"Y"==n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),n=n&&t<n?n:t;return r&&n>r?r:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){e=this._get(e,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),n=this._daylightSavingAdjust(new Date(n,r+(0>t?t:i[0]*i[1]),1));0>t&&n.setDate(this._getDaysInMonth(n.getFullYear(),n.getMonth()));return this._isInRange(e,n)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max");return(!n||t.getTime()>=n.getTime())&&(!r||t.getTime()<=r.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff"),t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10);return{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);t=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),t,this._getFormatConfig(e))}});f.fn.datepicker=function(e){if(!this.length)return this;f.datepicker.initialized||(f(document).mousedown(f.datepicker._checkExternalClick).find("body").append(f.datepicker.dpDiv),f.datepicker.initialized=!0);var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&("isDisabled"==e||"getDate"==e||"widget"==e)||"option"==e&&2==arguments.length&&"string"==typeof arguments[1]?f.datepicker["_"+e+"Datepicker"].apply(f.datepicker,[this[0]].concat(t)):this.each(function(){typeof e=="string"?f.datepicker["_"+e+"Datepicker"].apply(f.datepicker,[this].concat(t)):f.datepicker._attachDatepicker(this,e)})};f.datepicker=new e;f.datepicker.initialized=!1;f.datepicker.uuid=(new Date).getTime();f.datepicker.version="1.9m6";window["DP_jQuery_"+m]=f})(k);(function(e,t){var n={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},r={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.9m6",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;0>n&&e(this).css("top",t.top-n)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title");"string"!=typeof this.originalTitle&&(this.originalTitle="");this.options.title=this.options.title||this.originalTitle;var t=this,n=t.options,r=n.title||"&#160;",i=e.ui.dialog.getTitleId(t.element),s=(t.uiDialog=e("<div>")).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+n.dialogClass).css({display:"none",outline:0,zIndex:n.zIndex}).attr("tabIndex",-1).keydown(function(r){if(n.closeOnEscape&&!r.isDefaultPrevented()&&r.keyCode&&r.keyCode===e.ui.keyCode.ESCAPE){t.close(r);r.preventDefault()}}).attr({role:"dialog","aria-labelledby":i}).mousedown(function(e){t.moveToTop(!1,e)}).appendTo("body");t.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(s);var o=(t.uiDialogTitlebar=e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(s),u=e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(e){e.preventDefault();t.close(e)}).appendTo(o);(t.uiDialogTitlebarCloseText=e("<span>")).addClass("ui-icon ui-icon-closethick").text(n.closeText).appendTo(u);e("<span>").addClass("ui-dialog-title").attr("id",i).html(r).prependTo(o);o.find("*").add(o).disableSelection();this._hoverable(u);this._focusable(u);n.draggable&&e.fn.draggable&&t._makeDraggable();n.resizable&&e.fn.resizable&&t._makeResizable();t._createButtons(n.buttons);t._isOpen=!1;e.fn.bgiframe&&s.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();this.originalTitle&&this.element.attr("title",this.originalTitle)},widget:function(){return this.uiDialog},close:function(t){if(!this._isOpen)return n;var n=this,r,i;if(!1!==n._trigger("beforeClose",t))return n._isOpen=!1,n.overlay&&n.overlay.destroy(),n.uiDialog.unbind("keypress.ui-dialog"),n.options.hide?n.uiDialog.hide(n.options.hide,function(){n._trigger("close",t)}):(n.uiDialog.hide(),n._trigger("close",t)),e.ui.dialog.overlay.resize(),n.options.modal&&(r=0,e(".ui-dialog").each(function(){if(this!==n.uiDialog[0]){i=e(this).css("z-index");isNaN(i)||(r=Math.max(r,i))}}),e.ui.dialog.maxZ=r),n},isOpen:function(){return this._isOpen},moveToTop:function(t,n){var r=this.options;if(r.modal&&!t||!r.stack&&!r.modal)return this._trigger("focus",n);r.zIndex>e.ui.dialog.maxZ&&(e.ui.dialog.maxZ=r.zIndex);this.overlay&&(e.ui.dialog.maxZ+=1,e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ,this.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ));r={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()};e.ui.dialog.maxZ+=1;this.uiDialog.css("z-index",e.ui.dialog.maxZ);this.element.attr(r);this._trigger("focus",n);return this},open:function(){if(!this._isOpen){var t=this.options,n=this.uiDialog;this._size();this._position(t.position);n.show(t.show);this.overlay=t.modal?new e.ui.dialog.overlay(this):null;this.moveToTop(!0);t.modal&&n.bind("keydown.ui-dialog",function(t){if(t.keyCode===e.ui.keyCode.TAB){var n=e(":tabbable",this),r=n.filter(":first"),n=n.filter(":last");if(t.target===n[0]&&!t.shiftKey)return r.focus(1),!1;if(t.target===r[0]&&t.shiftKey)return n.focus(1),!1}});t=this.element.find(":tabbable");t.length||(t=n.find(".ui-dialog-buttonpane :tabbable"),t.length||(t=n));t.eq(0).focus();this._isOpen=!0;this._trigger("open");return this}},_createButtons:function(t){var n=this,r=!1;n.uiDialog.find(".ui-dialog-buttonpane").remove();"object"==typeof t&&null!==t&&e.each(t,function(){return!(r=!0)});if(r){var i=e("<div>").addClass("ui-dialog-buttonpane  ui-widget-content ui-helper-clearfix"),s=e("<div>").addClass("ui-dialog-buttonset").appendTo(i);e.each(t,function(t,r){var r=e.isFunction(r)?{click:r,text:t}:r,i=e("<button type='button'>").attr(r,!0).unbind("click").click(function(){r.click.apply(n.element[0],arguments)}).appendTo(s);e.fn.button&&i.button()});n.uiDialog.addClass("ui-dialog-buttons");i.appendTo(n.uiDialog)}else n.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var n=this,r=n.options,i=e(document);n.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(r,i){e(this).addClass("ui-dialog-dragging");n._trigger("dragStart",r,t(i))},drag:function(e,r){n._trigger("drag",e,t(r))},stop:function(s,o){r.position=[o.position.left-i.scrollLeft(),o.position.top-i.scrollTop()];e(this).removeClass("ui-dialog-dragging");n._trigger("dragStop",s,t(o));e.ui.dialog.overlay.resize()}})},_makeResizable:function(n){function r(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var n=n===t?this.options.resizable:n,i=this,s=i.options,o=i.uiDialog.css("position"),n="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";i.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:i.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:i._minHeight(),handles:n,start:function(t,n){e(this).addClass("ui-dialog-resizing");i._trigger("resizeStart",t,r(n))},resize:function(e,t){i._trigger("resize",e,r(t))},stop:function(t,n){e(this).removeClass("ui-dialog-resizing");s.height=e(this).height();s.width=e(this).width();i._trigger("resizeStop",t,r(n));e.ui.dialog.overlay.resize()}}).css("position",o).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(t){var n=[],r=[0,0],i;if(t){if("string"==typeof t||"object"==typeof t&&"0"in t)n=t.split?t.split(" "):[t[0],t[1]],1===n.length&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(r[e]=n[e],n[e]=t)}),t={my:n.join(" "),at:n.join(" "),offset:r.join(" ")};t=e.extend({},e.ui.dialog.prototype.options.position,t)}else t=e.ui.dialog.prototype.options.position;(i=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.position(t);i||this.uiDialog.hide()},_setOptions:function(t){var i=this,s={},o=!1;e.each(t,function(e,t){i._setOption(e,t);e in n&&(o=!0);e in r&&(s[e]=t)});o&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(t,n){var r=this.uiDialog;switch(t){case"buttons":this._createButtons(n);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+n);break;case"dialogClass":r.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+n);break;case"disabled":n?r.addClass("ui-dialog-disabled"):r.removeClass("ui-dialog-disabled");break;case"draggable":var i=r.is(":data(draggable)");i&&!n&&r.draggable("destroy");!i&&n&&this._makeDraggable();break;case"position":this._position(n);break;case"resizable":(i=r.is(":data(resizable)"))&&!n&&r.resizable("destroy");i&&"string"==typeof n&&r.resizable("option","handles",n);!i&&!1!==n&&this._makeResizable(n);break;case"title":e(".ui-dialog-title",this.uiDialogTitlebar).html(""+(n||"&#160;"))}this._super("_setOption",t,n)},_size:function(){var t=this.options,n,r,i=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});t.minWidth>t.width&&(t.width=t.minWidth);n=this.uiDialog.css({height:"auto",width:t.width}).height();r=Math.max(0,t.minHeight-n);"auto"===t.height?e.support.minHeight?this.element.css({minHeight:r,height:"auto"}):(this.uiDialog.show(),t=this.element.css("height","auto").height(),i||this.uiDialog.hide(),this.element.height(Math.max(t,r))):this.element.height(Math.max(t.height-n,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}});e.extend(e.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(e){e=e.attr("id");e||(e=this.uuid+=1);return"ui-dialog-title-"+e},overlay:function(t){this.$el=e.ui.dialog.overlay.create(t)}});e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus mousedown mouseup keydown keypress click".split(" "),function(e){return e+".dialog-overlay"}).join(" "),create:function(t){0===this.instances.length&&(setTimeout(function(){e.ui.dialog.overlay.instances.length&&e(document).bind(e.ui.dialog.overlay.events,function(t){if(e(t.target).zIndex()<e.ui.dialog.overlay.maxZ)return!1})},1),e(document).bind("keydown.dialog-overlay",function(n){t.options.closeOnEscape&&!n.isDefaultPrevented()&&n.keyCode&&n.keyCode===e.ui.keyCode.ESCAPE&&(t.close(n),n.preventDefault())}),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var n=(this.oldInstances.pop()||e("<div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});e.fn.bgiframe&&n.bgiframe();this.instances.push(n);return n},destroy:function(t){var n=e.inArray(t,this.instances);-1!==n&&this.oldInstances.push(this.instances.splice(n,1)[0]);0===this.instances.length&&e([document,window]).unbind(".dialog-overlay");t.height(0).width(0).remove();var r=0;e.each(this.instances,function(){r=Math.max(r,this.css("z-index"))});this.maxZ=r},height:function(){var t,n;return e.browser.msie?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),n=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),t<n?e(window).height()+"px":t+"px"):e(document).height()+"px"},width:function(){var t,n;return e.browser.msie?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),n=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),t<n?e(window).width()+"px":t+"px"):e(document).width()+"px"},resize:function(){var t=e([]);e.each(e.ui.dialog.overlay.instances,function(){t=t.add(this)});t.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}});e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})})(k);(function(e){function t(t){if(!e(t.target).closest(".ui-menu").length)for(var n in i)i.hasOwnProperty(n)&&i[n].collapseAll(t)}var n=0,r=0,i={};e.widget("ui.menu",{version:"1.9m6",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){this.activeMenu=this
.element;this.menuId=this.element.attr("id")||"ui-menu-"+n++;this.element.find(".ui-icon").length&&this.element.addClass("ui-menu-icons");this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",e.proxy(function(e){this.options.disabled&&e.preventDefault()},this));this._bind({"click .ui-menu-item:has(a)":function(t){t.stopImmediatePropagation();var n=e(t.currentTarget);(!this.active||this.active[0]!==n[0])&&this.focus(t,n);this.select(t)},"mouseover .ui-menu-item":function(t){t.stopImmediatePropagation();var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(t,n)},mouseleave:"_mouseleave","mouseleave .ui-menu":"_mouseleave","mouseout .ui-menu-item":"blur",focus:function(t){this.focus(t,e(t.target).children(".ui-menu-item:first"))},blur:"collapseAll"});this.refresh();this.element.attr("tabIndex",0);this._bind({keydown:function(t){switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);t.preventDefault();t.stopImmediatePropagation();break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);t.preventDefault();t.stopImmediatePropagation();break;case e.ui.keyCode.HOME:this._move("first","first",t);t.preventDefault();t.stopImmediatePropagation();break;case e.ui.keyCode.END:this._move("last","last",t);t.preventDefault();t.stopImmediatePropagation();break;case e.ui.keyCode.UP:this.previous(t);t.preventDefault();t.stopImmediatePropagation();break;case e.ui.keyCode.DOWN:this.next(t);t.preventDefault();t.stopImmediatePropagation();break;case e.ui.keyCode.LEFT:this.collapse(t)&&t.stopImmediatePropagation();t.preventDefault();break;case e.ui.keyCode.RIGHT:this.expand(t)&&t.stopImmediatePropagation();t.preventDefault();break;case e.ui.keyCode.ENTER:this.active.children("a[aria-haspopup='true']").length?this.expand(t)&&t.stopImmediatePropagation():(this.select(t),t.stopImmediatePropagation());t.preventDefault();break;case e.ui.keyCode.ESCAPE:this.collapse(t)&&t.stopImmediatePropagation();t.preventDefault();break;default:t.stopPropagation();clearTimeout(this.filterTimer);var n;n=this.previousFilter||"";var r=String.fromCharCode(t.keyCode),i=!1;r==n?i=!0:r=n+r;var s=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};n=this.activeMenu.children(".ui-menu-item").filter(function(){return RegExp("^"+s(r),"i").test(e(this).children("a").text())});n=i&&-1!=n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n;n.length||(r=String.fromCharCode(t.keyCode),n=this.activeMenu.children(".ui-menu-item").filter(function(){return RegExp("^"+s(r),"i").test(e(this).children("a").text())}));n.length?(this.focus(t,n),1<n.length?(this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show();this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var t=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),n=this.menuId;t.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(e){return n+"-"+e});t.each(function(){var t=e(this),n=t.prev("a");n.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>');t.attr("aria-labelledby",n.attr("id"))})},focus:function(t,n){this.blur(t);if(this._hasScroll()){var r=parseFloat(e.curCSS(this.activeMenu[0],"borderTopWidth",!0))||0,i=parseFloat(e.curCSS(this.activeMenu[0],"paddingTop",!0))||0,r=n.offset().top-this.activeMenu.offset().top-r-i,i=this.activeMenu.scrollTop(),s=this.activeMenu.height(),o=n.height();0>r?this.activeMenu.scrollTop(i+r):r+o>s&&this.activeMenu.scrollTop(i+r-s+o)}this.active=n.first().children("a").addClass("ui-state-focus").end();this.element.attr("aria-activedescendant",this.active.children("a").attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");this.timer=this._delay(function(){this._close()},this.delay);r=e(">ul",n);r.length&&/^mouse/.test(t.type)&&this._startOpening(r);this.activeMenu=n.parent();this._trigger("focus",t,{item:n})},blur:function(e){this.active&&(clearTimeout(this.timer),this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer);"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();this._open(e)},this.delay))},_open:function(n){clearTimeout(this.timer);this.element.find(".ui-menu").not(n.parents()).hide().attr("aria-hidden","true");var s=e.extend({},{of:this.active},"function"==e.type(this.options.position)?this.options.position(this.active):this.options.position);n.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(s);i[this.menuId]||(i[this.menuId]=this,r++||e("body").click(t))},collapseAll:function(t){var n=!1;if(t){var r=e(t.target);r.is("ui.menu")?n=r:r.closest(".ui-menu").length&&(n=r.closest(".ui-menu"))}this._close(n);n||(this.blur(t),this.activeMenu=this.element)},_close:function(n){n||(n=this.active?this.active.parent():this.element);n.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active");n[0]===this.element[0]&&i[this.menuId]&&(delete i[this.menuId],r&&!--r&&e("body").unbind("click",t))},collapse:function(e){var t=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(t&&t.length)return this._close(),this.focus(e,t),!0},expand:function(e){var t=this.active&&this.active.children("ul").children("li").first();if(t&&t.length)return this._open(t.parent()),this._delay(function(){this.focus(e,t)},20),!0},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){this.active?(e="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0),e.length?this.focus(n,e):this.focus(n,this.activeMenu.children(".ui-menu-item")[t]())):this.focus(n,this.activeMenu.children(".ui-menu-item")[t]())},nextPage:function(t){if(this._hasScroll())if(this.active){if(!this.last()){var n=this.active.offset().top,r=this.element.height(),i;this.active.nextAll(".ui-menu-item").each(function(){i=e(this);return 0>e(this).offset().top-n-r});this.focus(t,i)}}else this.focus(t,this.activeMenu.children(".ui-menu-item").first());else this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(t){if(this._hasScroll())if(this.active){if(!this.first()){var n=this.active.offset().top,r=this.element.height(),i;this.active.prevAll(".ui-menu-item").each(function(){i=e(this);return 0<e(this).offset().top-n+r});this.focus(t,i)}}else this.focus(t,this.activeMenu.children(".ui-menu-item").first());else this.focus(t,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.height()<this.element.prop("scrollHeight")},_mouseleave:function(e){this.collapseAll(e);this.blur()},select:function(e){var t={item:this.active};this.collapseAll(e);this._trigger("select",e,t)}})})(k);(function(e){e.widget("ui.menubar",{version:"1.9m6",options:{autoExpand:!1,buttons:!1,menuIcon:!1,position:{my:"left top",at:"left bottom"}},_create:function(){var t=this,n=this.items=this.element.children("li").addClass("ui-menubar-item").attr("role","presentation").children("button, a");n.slice(1).attr("tabIndex",-1);this.element.addClass("ui-menubar ui-widget-header ui-helper-clearfix").attr("role","menubar");this._focusable(n);this._hoverable(n);n.next("ul").menu({position:{within:this.options.position.within},select:function(n,r){r.item.parents("ul.ui-menu:last").hide();t._close();e(n.target).prev().focus();t._trigger("select",n,r)}}).hide().attr({"aria-hidden":"true","aria-expanded":"false"}).bind("keydown.menubar",function(n){if(!e(this).is(":hidden"))switch(n.keyCode){case e.ui.keyCode.LEFT:t._left(n);n.preventDefault();break;case e.ui.keyCode.RIGHT:t._right(n),n.preventDefault()}});n.each(function(){var n=e(this),r=n.next("ul");n.bind("click.menubar focus.menubar mouseenter.menubar",function(e){if("focus"!=e.type||e.originalEvent)if(e.preventDefault(),"click"==e.type&&r.is(":visible")&&t.active&&t.active[0]==r[0])t._close();else if(t.open&&"mouseenter"==e.type||"click"==e.type||t.options.autoExpand)t.options.autoExpand&&clearTimeout(t.timer),t._open(e,r)}).bind("keydown",function(n){switch(n.keyCode){case e.ui.keyCode.SPACE:case e.ui.keyCode.UP:case e.ui.keyCode.DOWN:t._open(n,e(this).next());n.preventDefault();break;case e.ui.keyCode.LEFT:t._prev(n,e(this));n.preventDefault();break;case e.ui.keyCode.RIGHT:t._next(n,e(this)),n.preventDefault()}}).addClass("ui-button ui-widget ui-button-text-only ui-menubar-link").attr("role","menuitem").attr("aria-haspopup","true").wrapInner("<span class='ui-button-text'></span>");t.options.autoExpand&&(n.bind("mouseleave.menubar",function(){t.timer=setTimeout(function(){t._close()},150)}),r.bind("mouseleave.menubar",function(){t.timer=setTimeout(function(){t._close()},150)}).bind("mouseenter.menubar",function(){clearTimeout(t.timer)}));t.options.menuIcon&&(n.addClass("ui-state-default").append("<span class='ui-button-icon-secondary ui-icon ui-icon-triangle-1-s'></span>"),n.removeClass("ui-button-text-only").addClass("ui-button-text-icon-secondary"));t.options.buttons||n.addClass("ui-menubar-link").removeClass("ui-state-default")});t._bind({keydown:function(n){if(n.keyCode==e.ui.keyCode.ESCAPE&&t.active&&!0!==t.active.menu("collapse",n)){var r=t.active;t.active.blur();t._close(n);r.prev().focus()}},focusin:function(){clearTimeout(t.closeTimer)},focusout:function(e){t.closeTimer=setTimeout(function(){t._close(e)},100)}})},_destroy:function(){var t=this.element.children("li").removeClass("ui-menubar-item").removeAttr("role").children("button, a");this.element.removeClass("ui-menubar ui-widget-header ui-helper-clearfix").removeAttr("role").unbind(".menubar");t.unbind(".menubar").removeClass("ui-button ui-widget ui-button-text-only ui-menubar-link ui-state-default").removeAttr("role").removeAttr("aria-haspopup").children("span.ui-button-text").each(function(){var t=e(this);t.parent().html(t.html())}).end().children(".ui-icon").remove();this.element.find(":ui-menu").menu("destroy").show().removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("tabindex").unbind(".menubar")},_close:function(){this.active&&this.active.length&&(this.active.menu("collapseAll").hide().attr({"aria-hidden":"true","aria-expanded":"false"}),this.active.prev().removeClass("ui-state-active").removeAttr("tabIndex"),this.active=null,this.open=!1)},_open:function(t,n){if(!this.active||this.active[0]!=n[0]){this.active&&(this.active.menu("collapseAll").hide().attr({"aria-hidden":"true","aria-expanded":"false"}),this.active.prev().removeClass("ui-state-active"));var r=n.prev().addClass("ui-state-active").attr("tabIndex",-1);this.active=n.show().position(e.extend({of:r},this.options.position)).removeAttr("aria-hidden").attr("aria-expanded","true").menu("focus",t,n.children("li").first()).focus().focusin();this.open=!0}},_prev:function(e,t){t.attr("tabIndex",-1);var n=t.parent().prevAll("li").children(".ui-button").eq(0);n.length?n.removeAttr("tabIndex")[0].focus():this.element.children("li:last").children(".ui-button:last").removeAttr("tabIndex")[0].focus()},_next:function(e,t){t.attr("tabIndex",-1);var n=t.parent().nextAll("li").children(".ui-button").eq(0);n.length?n.removeAttr("tabIndex")[0].focus():this.element.children("li:first").children(".ui-button:first").removeAttr("tabIndex")[0].focus()},_left:function(e){var t=this.active.parent().prevAll("li:eq(0)").children(".ui-menu").eq(0);t.length||(t=this.element.children("li:last").children(".ui-menu:first"));this._open(e,t)},_right:function(e){var t=this.active.parent().nextAll("li:eq(0)").children(".ui-menu").eq(0);t.length||(t=this.element.children("li:first").children(".ui-menu:first"));this._open(e,t)}})})(k);(function(e){var t=0;e.widget("ui.popup",{version:"1.9m6",options:{position:{my:"left top",at:"left bottom"}},_create:function(){this.options.trigger||(this.options.trigger=this.element.prev());this.element.attr("id")||(this.element.attr("id","ui-popup-"+t++),this.generatedId=!0);this.element.attr("role")||(this.element.attr("role","dialog"),this.generatedRole=!0);this.options.trigger.attr("aria-haspopup","true").attr("aria-owns",this.element.attr("id"));this.element.addClass("ui-popup");this.close();this._bind(this.options.trigger,{keydown:function(t){e.ui.button&&this.options.trigger.is("a:ui-button")&&t.keyCode==e.ui.keyCode.SPACE&&t.preventDefault();t.keyCode==e.ui.keyCode.SPACE&&this.options.trigger.is("a:not(:ui-button)")&&this.options.trigger.trigger("click",t);if(t.keyCode==e.ui.keyCode.DOWN){t.preventDefault();this.options.trigger.trigger("click",t)}},click:function(e){e.preventDefault();if(!this.isOpen){clearTimeout(this.closeTimer);this._delay(function(){this.open(e)},1)}}});this.element.is(":ui-menu")||this._bind({keydown:function(t){if(t.keyCode===e.ui.keyCode.TAB){var n=e(":tabbable",this.element),r=n.first(),n=n.last();if(t.target===n[0]&&!t.shiftKey){r.focus(1);t.preventDefault()}else if(t.target===r[0]&&t.shiftKey){n.focus(1);t.preventDefault()}}}});this._bind({focusout:function(e){this.closeTimer=this._delay(function(){this.close(e)},100)},focusin:function(){clearTimeout(this.closeTimer)}});this._bind({keyup:function(t){if(t.keyCode==e.ui.keyCode.ESCAPE&&this.element.is(":visible")){this.close(t);this.options.trigger.focus()}}});this._bind(document,{click:function(t){this.isOpen&&!e(t.target).closest(".ui-popup").length&&this.close(t)}})},_destroy:function(){this.element.show().removeClass("ui-popup").removeAttr("aria-hidden").removeAttr("aria-expanded").unbind("keypress.ui-popup");this.options.trigger.removeAttr("aria-haspopup").removeAttr("aria-owns");this.generatedId&&this.element.removeAttr("id");this.generatedRole&&this.element.removeAttr("role")},open:function(t){var n=e.extend({},{of:this.options.trigger},this.options.position);this.element.show().attr("aria-hidden","false").attr("aria-expanded","true").position(n);this.element.is(":ui-menu")?(this.element.menu("focus",t,this.element.children("li").first()),this.element.focus()):(n=this.element.find(":tabbable"),this.removeTabIndex=!1,n.length||(this.element.is(":tabbable")||(this.element.attr("tabindex","0"),this.removeTabIndex=!0),n=n.add(this.element[0])),n.first().focus(1));this.options.trigger.attr("tabindex",-1);this.isOpen=!0;this._trigger("open",t)},close:function(e){this.element.hide().attr("aria-hidden","true").attr("aria-expanded","false");this.options.trigger.attr("tabindex",0);this.removeTabIndex&&this.element.removeAttr("tabindex");this.isOpen=!1;this._trigger("close",e)}})})(k);(function(e,t){e.ui=e.ui||{};var n=/left|center|right/,r=/top|center|bottom/,i=/[+-]\d+%?/,s=/^\w+/,o=/%$/,u=e.fn.position;e.position={scrollbarWidth:function(){var t,n,r=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>");n=r.children()[0];e("body").append(r);t=n.offsetWidth;r.css("overflow","scroll");n=n.offsetWidth;t===n&&(n=r[0].clientWidth);r.remove();return t-n},getScrollInfo:function(t){var n=t[0]!==window,r=n?t.css("overflow-x"):"",n=n?t.css("overflow-y"):"",r="auto"===r||"scroll"===r?e.position.scrollbarWidth():0,n="auto"===n||"scroll"===n?e.position.scrollbarWidth():0;return{height:t.height()<t[0].scrollHeight?n:0,width:t.width()<t[0].scrollWidth?r:0}}};e.fn.position=function(t){if(!t||!t.of)return u.apply(this,arguments);var t=e.extend({},t),a=e(t.of),h=e(t.within||window),p=a[0],d=(t.collision||"flip").split(" "),v={},y,w,E,S;9===p.nodeType?(w=a.width(),E=a.height(),S={top:0,left:0}):e.isWindow(p)?(w=a.width(),E=a.height(),S={top:a.scrollTop(),left:a.scrollLeft()}):p.preventDefault?(t.at="left top",w=E=0,S={top:t.of.pageY,left:t.of.pageX}):(w=a.outerWidth(),E=a.outerHeight(),S=a.offset());e.each(["my","at"],function(){var e=(t[this]||"").split(" "),o,u;e.length===1&&(e=n.test(e[0])?e.concat(["center"]):r.test(e[0])?["center"].concat(e):["center","center"]);e[0]=n.test(e[0])?e[0]:"center";e[1]=r.test(e[1])?e[1]:"center";o=i.exec(e[0]);u=i.exec(e[1]);v[this]=[o?o[0]:0,u?u[0]:0];t[this]=[s.exec(e[0])[0],s.exec(e[1])[0]]});1===d.length&&(d[1]=d[0]);"right"===t.at[0]?S.left+=w:"center"===t.at[0]&&(S.left+=w/2);"bottom"===t.at[1]?S.top+=E:"center"===t.at[1]&&(S.top+=E/2);y=[parseInt(v.at[0],10)*(o.test(v.at[0])?w/100:1),parseInt(v.at[1],10)*(o.test(v.at[1])?E/100:1)];S.left+=y[0];S.top+=y[1];return this.each(function(){var n=e(this),r=n.outerWidth(),i=n.outerHeight(),s=parseInt(e.curCSS(this,"marginLeft",!0))||0,u=parseInt(e.curCSS(this,"marginTop",!0))||0,a=e.position.getScrollInfo(h),c=r+s+(parseInt(e.curCSS(this,"marginRight",!0))||0)+a.width,p=i+u+(parseInt(e.curCSS(this,"marginBottom",!0))||0)+a.height,m=e.extend({},S),g=[parseInt(v.my[0],10)*(o.test(v.my[0])?n.outerWidth()/100:1),parseInt(v.my[1],10)*(o.test(v.my[1])?n.outerHeight()/100:1)],b;t.my[0]==="right"?m.left=m.left-r:t.my[0]==="center"&&(m.left=m.left-r/2);t.my[1]==="bottom"?m.top=m.top-i:t.my[1]==="center"&&(m.top=m.top-i/2);m.left=m.left+g[0];m.top=m.top+g[1];b={marginLeft:s,marginTop:u};e.each(["left","top"],function(s,o){e.ui.position[d[s]]&&e.ui.position[d[s]][o](m,{targetWidth:w,targetHeight:E,elemWidth:r,elemHeight:i,collisionPosition:b,collisionWidth:c,collisionHeight:p,offset:[y[0]+g[0],y[1]+g[1]],my:t.my,at:t.at,within:h,elem:n})});e.fn.bgiframe&&n.bgiframe();n.offset(e.extend(m,{using:t.using}))})};e.ui.position={fit:{left:function(t,n){var r=n.within,i=e(window),s=e.isWindow(n.within[0]),o=s?i.scrollLeft():r.offset().left,i=s?i.width():r.outerWidth(),s=t.left-n.collisionPosition.marginLeft,r=o-s,u=s+n.collisionWidth-i-o;n.collisionWidth>i?0<r&&0>=u?(o=t.left+r+n.collisionWidth-i-o,t.left+=r-o):t.left=0<u&&0>=r?o:r>u?o+i-n.collisionWidth:o:t.left=0<r?t.left+r:0<u?t.left-u:Math.max(t.left-s,t.left)},top:function(t,n){var r=n.within,i=e(window),s=e.isWindow(n.within[0]),o=s?i.scrollTop():r.offset().top,i=s?i.height():r.outerHeight(),s=t.top-n.collisionPosition.marginTop,r=o-s,u=s+n.collisionHeight-i-o;n.collisionHeight>i?0<r&&0>=u?(o=t.top+r+n.collisionHeight-i-o,t.top+=r-o):t.top=0<u&&0>=r?o:r>u?o+i-n.collisionHeight:o:t.top=0<r?t.top+r:0<u?t.top-u:Math.max(t.top-s,t.top)}},flip:{left:function(t,n){if("center"!==n.at[0]){n.elem.removeClass("ui-flipped-left ui-flipped-right");var r=n.within;e(window);var i=e.isWindow(n.within[0]),s=(i?0:r.offset().left)+r.scrollLeft(),o=i?r.width():r.outerWidth(),i=t.left-n.collisionPosition.marginLeft,r=i-s,u=i+n.collisionWidth-o-s,i="left"===n.my[0]?-n.elemWidth:"right"===n.my[0]?n.elemWidth:0,a="left"===n.at[0]?n.targetWidth:-n.targetWidth,l=-2*n.offset[0];if(0>r){if(s=t.left+i+a+l+n.collisionWidth-o-s,0>s||s<Math.abs(r))n.elem.addClass("ui-flipped-right"),t.left+=i+a+l}else 0<u&&(s=t.left-n.collisionPosition.marginLeft+i+a+l-s,0<s||Math.abs(s)<u)&&(n.elem.addClass("ui-flipped-left"),t.left+=i+a+l)}},top:function(t,n){if("center"!==n.at[1]){n.elem.removeClass("ui-flipped-top ui-flipped-bottom");var r=n.within;e(window);var i=e.isWindow(n.within[0]),s=(i?0:r.offset().top)+r.scrollTop(),o=i?r.height():r.outerHeight(),i=t.top-n.collisionPosition.marginTop,r=i-s,u=i+n.collisionHeight-o-s,i="top"===n.my[1]?-n.elemHeight:"bottom"===n.my[1]?n.elemHeight:0,a="top"===n.at[1]?n.targetHeight:-n.targetHeight,l=-2*n.offset[1];if(0>r){if(s=t.top+i+a+l+n.collisionHeight-o-s,0>s||s<Math.abs(r))n.elem.addClass("ui-flipped-bottom"),t.top+=i+a+l}else 0<u&&(s=t.top-n.collisionPosition.marginTop+i+a+l-s,0<s||Math.abs(s)<u)&&(n.elem.addClass("ui-flipped-top"),t.top+=i+a+l)}}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments);e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments);e.ui.position.fit.top.apply(this,arguments)}}};!1!==e.uiBackCompat&&function(e){var n=e.fn.position;e.fn.position=function(r){if(!r||!r.offset)return n.call(this,r);var i=r.offset.split(" "),s=r.at.split(" ");1===i.length&&(i[1]=i[0]);/^\d/.test(i[0])&&(i[0]="+"+i[0]);/^\d/.test(i[1])&&(i[1]="+"+i[1]);1===s.length&&(/left|center|right/.test(s[0])?s[1]="center":(s[1]=s[0],s[0]="center"));return n.call(this,e.extend(r,{at:s[0]+i[0]+" "+s[1]+i[1],offset:t}))}}(k)})(k);(function(e,t){e.widget("ui.progressbar",{version:"1.9m6",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(e){if(e===t)return this._value();this._setOption("value",e);return this},_setOption:function(e,t){"value"===e&&(this.options.value=t,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete"));this._super("_setOption",e,t)},_value:function(){var e=this.options.value;"number"!=typeof e&&(e=0);return Math.min(this.options.max,Math.max(this.min,e))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var e=this.value(),t=this._percentage();this.oldValue!==e&&(this.oldValue=e,this._trigger("change"));this.valueDiv.toggle(e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%");this.element.attr("aria-valuenow",e)}})})(k);(function(e){e.widget("ui.slider",e.ui.mouse,{version:"1.9m6",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var t=this,n=this.options,r=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),i=n.values&&n.values.length||1,s=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(n.disabled?" ui-slider-disabled ui-disabled":""));this.range=e([]);if(n.range){!0===n.range&&(n.values||(n.values=[this._valueMin(),this._valueMin()]),n.values.length&&2!==n.values.length)&&(n.values=[n.values[0],n.values[0]]);this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===n.range||"max"===n.range?" ui-slider-range-"+n.range:""))}for(var o=r.length;o<i;o+=1)s.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=r.add(e(s.join("")).appendTo(t.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).hover(function(){n.disabled||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}).focus(function(){n.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")});this.handles.each(function(t){e(this).data("index.ui-slider-handle",t)});this.handles.keydown(function(n){var r=!0,i=e(this).data("index.ui-slider-handle"),s,o,u;if(!t.options.disabled){switch(n.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(r=!1,!t._keySliding&&(t._keySliding=!0,e(this).addClass("ui-state-active"),s=t._start(n,i),!1===s))return}u=t.options.step;s=t.options.values&&t.options.values.length?o=t.values(i):o=t.value();switch(n.keyCode){case e.ui.keyCode.HOME:o=t._valueMin();break;case e.ui.keyCode.END:o=t._valueMax();break;case e.ui.keyCode.PAGE_UP:o=t._trimAlignValue(s+(t._valueMax()-t._valueMin())/5);break;case e.ui.keyCode.PAGE_DOWN:o=t._trimAlignValue(s-(t._valueMax()-t._valueMin())/5);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===t._valueMax())return;o=t._trimAlignValue(s+u);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===t._valueMin())return;o=t._trimAlignValue(s-u)}t._slide(n,i,o);return r}}).keyup(function(n){var r=e(this).data("index.ui-slider-handle");t._keySliding&&(t._keySliding=!1,t._stop(n,r),t._change(n,r),e(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=!1},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(t){var n=this.options,r,i,s,o,u;if(n.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();r=this._normValueFromMouse({x:t.pageX,y:t.pageY});i=this._valueMax()-this._valueMin()+1;o=this;this.handles.each(function(t){var n=Math.abs(r-o.values(t));i>n&&(i=n,s=e(this),u=t)});!0===n.range&&this.values(1)===n.min&&(u+=1,s=e(this.handles[u]));if(!1===this._start(t,u))return!1;this._mouseSliding=!0;o._handleIndex=u;s.addClass("ui-state-active").focus();n=s.offset();this._clickOffset=e(t.target).parents().andSelf().is(".ui-slider-handle")?{left:t.pageX-n.left-s.width()/2,top:t.pageY-n.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)}:{left:0,top:0};this.handles.hasClass("ui-state-hover")||this._slide(t,u,r);return this._animateOff=!0},_mouseStart:function(){return!0},_mouseDrag:function(e){var t=this._normValueFromMouse({x:e.pageX,y:e.pageY});this._slide(e,this._handleIndex,t);return!1},_mouseStop:function(e){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(e,this._handleIndex);this._change(e,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t;"horizontal"===this.orientation?(t=this.elementSize.width,e=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,e=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));t=e/t;1<t&&(t=1);0>t&&(t=0);"vertical"===this.orientation&&(t=1-t);e=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+t*e)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values());return this._trigger("start",e,n)},_slide:function(e,t,n){var r;if(this.options.values&&this.options.values.length){r=this.values(t?0:1);2===this.options.values.length&&!0===this.options.range&&(0===t&&n>r||1===t&&n<r)&&(n=r);n!==this.values(t)&&(r=this.values(),r[t]=n,e=this._trigger("slide",e,{handle:this.handles[t],value:n,values:r}),this.values(t?0:1),!1!==e&&this.values(t,n,!0))}else n!==this.value()&&(e=this._trigger("slide",e,{handle:this.handles[t],value:n}),!1!==e&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values());this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values());this._trigger("change",e,n)}},value:function(e){if(!arguments.length)return this._value();this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0)},values:function(t,n){var r,i,s;if(1<arguments.length)this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t);else{if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values;i=arguments[0];for(s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()}},_setOption:function(t,n){var r,i=0;e.isArray(this.options.values)&&(i=this.options.values.length);e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case"values":this._animateOff=!0;this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);t=this.options.values.slice();for(n=0;n<t.length;n+=1)t[n]=this._trimAlignValue(t[n]);return t},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=0<this.options.step?this.options.step:1,n=(e-this._valueMin())%t,e=e-n;2*Math.abs(n)>=t&&(e+=0<n?t:-t);return parseFloat(e.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t=this.options.range,n=this.options,r=this,i=this._animateOff?!1:n.animate,s,o={},u,a,l,c;if(this.options.values&&this.options.values.length)this.handles.each(function(t){s=100*((r.values(t)-r._valueMin())/(r._valueMax()-r._valueMin()));o["horizontal"===r.orientation?"left":"bottom"]=s+"%";e(this).stop(1,1)[i?"animate":"css"](o,n.animate);if(!0===r.options.range)if("horizontal"===r.orientation){0===t&&r.range.stop(1,1)[i?"animate":"css"]({left:s+"%"},n.animate);1===t&&r.range[i?"animate":"css"]({width:s-u+"%"},{queue:!1,duration:n.animate})}else{0===t&&r.range.stop(1,1)[i?"animate":"css"]({bottom:s+"%"},n.animate);1===t&&r.range[i?"animate":"css"]({height:s-u+"%"},{queue:!1,duration:n.animate})}u=s});else{a=this.value();l=this._valueMin();c=this._valueMax();s=c!==l?100*((a-l)/(c-l)):0;o["horizontal"===r.orientation?"left":"bottom"]=s+"%";this.handle.stop(1,1)[i?"animate":"css"](o,n.animate);"min"===t&&"horizontal"===this.orientation&&this.range.stop(1,1)[i?"animate":"css"]({width:s+"%"},n.animate);"max"===t&&"horizontal"===this.orientation&&this.range[i?"animate":"css"]({width:100-s+"%"},{queue:!1,duration:n.animate});"min"===t&&"vertical"===this.orientation&&this.range.stop(1,1)[i?"animate":"css"]({height:s+"%"},n.animate);"max"===t&&"vertical"===this.orientation&&this.range[i?"animate":"css"]({height:100-s+"%"},{queue:!1,duration:n.animate})}}})})(k);(function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments);this._refresh();t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.9m6",defaultElement:"<input>",widgetEventPrefix:"spin",options:{incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._value(this.element.val(),!0);this._draw
();this._bind(this._events);this._refresh()},_getCreateOptions:function(){var t={},n=this.element;e.each(["min","max","step"],function(e,r){var i=n.attr(r);void 0!==i&&i.length&&(t[r]=i)});return t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.uiSpinner.addClass("ui-state-active");this.previous=this.element.val()},blur:function(e){this._refresh();this.uiSpinner.removeClass("ui-state-active");this.previous!==this.element.val()&&this._trigger("change",e)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((0<t?1:-1)*this.options.step,e);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=setTimeout(function(){this.spinning&&this._stop(e)},100);e.preventDefault()}},"mousedown .ui-spinner-button":function(t){t.preventDefault();document.activeElement!==this.element[0]&&this.element.focus();!1!==this._start(t)&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(e(t.currentTarget).hasClass("ui-state-active")){if(!1===this._start(t))return!1;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)}},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this._hoverable(e);this.element.attr("role","spinbutton");this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()===e.height()&&e.height(e.height());this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:return this._repeat(null,1,t),!0;case r.DOWN:return this._repeat(null,-1,t),!0;case r.PAGE_UP:return this._repeat(null,n.page,t),!0;case r.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-state-default ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon ui-icon-triangle-1-n'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon ui-icon-triangle-1-s'>&#9660;</span></a>"},_start:function(e){if(!this.spinning&&!1===this._trigger("start",e))return!1;this.counter||(this.counter=1);return this.spinning=!0},_repeat:function(e,t,n){e=e||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,t,n)},e);this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1);n=this._adjustValue(n+e*this._increment(this.counter));if(!this.spinning||!1!==this._trigger("spin",t,{value:n}))this._value(n),this.counter++},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min)));return e},_precisionOf:function(e){var e=e.toString(),t=e.indexOf(".");return-1===t?0:e.length-t-1},_adjustValue:function(e){var t,n=this.options;t=null!==n.min?n.min:0;e=Math.round((e-t)/n.step)*n.step;e=parseFloat((t+e).toFixed(this._precision()));return null!==n.max&&e>n.max?n.max:null!==n.min&&e<n.min?n.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){this._super("_setOption",e,t);"disabled"===e&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super("_setOptions",e);this._value(this.element.val())}),_parse:function(e){"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e):+e);return""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;""!==e&&(n=this._parse(e),null!==n&&(t||(n=this._adjustValue(n)),e=this._format(n)));this.element.val(e);this._refresh()},destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this._super("destroy");this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._spin((e||1)*this.options.step)},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._spin((e||1)*-this.options.step)},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,e)},widget:function(){return this.uiSpinner}})})(k);(function(e,t){var n=0,r=function(){var e=/#.*$/,t=location.href.replace(e,"");return function(n){n=n.cloneNode(!1);return 1<n.hash.length&&n.href.replace(e,"")===t}}();e.widget("ui.tabs",{version:"1.9m6",options:{active:null,collapsible:!1,event:"click",fx:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=t.options,r=n.active;t.running=!1;t.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");t._processTabs();null===r&&(location.hash&&t.anchors.each(function(e,t){if(t.hash===location.hash)return r=e,!1}),null===r&&(r=t.lis.filter(".ui-tabs-active").index()),null===r||-1===r)&&(r=t.lis.length?0:!1);!1!==r&&(r=this.lis.eq(r).index(),-1===r&&(r=n.collapsible?!1:0));n.active=r;!n.collapsible&&!1===n.active&&this.anchors.length&&(n.active=0);e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.lis.filter(".ui-state-disabled"),function(e){return t.lis.index(e)}))).sort());this._setupFx(n.fx);this._refresh();this.panels.hide();this.lis.removeClass("ui-tabs-active ui-state-active");!1!==n.active&&this.anchors.length?(this.active=this._findActive(n.active),t._getPanelForTab(this.active).show(),this.lis.eq(n.active).addClass("ui-tabs-active ui-state-active"),this.load(n.active)):this.active=e()},_setOption:function(e,t){"active"==e?this._activate(t):"disabled"===e?this._setupDisabled(t):(this._super("_setOption",e,t),"collapsible"===e&&!t&&!1===this.options.active&&this._activate(0),"event"===e&&this._setupEvents(t),"fx"===e&&this._setupFx(t))},_tabId:function(t){return e(t).attr("aria-controls")||"ui-tabs-"+ ++n},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@[\]^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.list.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)});this._processTabs();this._refresh();this.panels.not(this._getPanelForTab(this.active)).hide();!1===t.active||!this.anchors.length?(t.active=!1,this.active=e()):this.active.length&&!e.contains(this.list[0],this.active[0])?(t=t.active-1,this._activate(0<=t?t:0)):t.active=this.anchors.index(this.active)},_refresh:function(){var e=this.options;this.element.toggleClass("ui-tabs-collapsible",e.collapsible);this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");this._setupDisabled(e.disabled);this._setupEvents(e.event);this.lis.unbind(".tabs");this._focusable(this.lis);this._hoverable(this.lis)},_processTabs:function(){var t=this;this.list=this.element.find("ol,ul").eq(0);this.lis=e(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return e("a",this)[0]});this.panels=e([]);this.anchors.each(function(n,i){var s,o;if(r(i))s=i.hash,o=t.element.find(t._sanitizeSelector(s));else{var u=t._tabId(i);s="#"+u;o=t.element.find(s);o.length||(o=t._createPanel(u),o.insertAfter(t.panels[n-1]||t.list))}o.length&&(t.panels=t.panels.add(o));e(i).attr("aria-controls",s.substring(1))})},_createPanel:function(t){return e("<div></div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("destroy.tabs",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n=0,r;r=this.lis[n];n++)e(r).toggleClass("ui-state-disabled",!0===t||-1!==e.inArray(n,t));this.options.disabled=t},_setupFx:function(t){t&&(e.isArray(t)?(this.hideFx=t[0],this.showFx=t[1]):this.hideFx=this.showFx=t)},_resetStyle:function(t,n){!e.support.opacity&&n.opacity&&t[0].style.removeAttribute("filter")},_setupEvents:function(t){this.anchors.unbind(".tabs");t&&this.anchors.bind(t.split(" ").join(".tabs ")+".tabs",e.proxy(this,"_eventHandler"));this.anchors.bind("click.tabs",function(e){e.preventDefault()})},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():this._getPanelForTab(i),a=r.length?this._getPanelForTab(r):e(),l=i.closest("li"),r={oldTab:r,oldPanel:a,newTab:o?e():i,newPanel:u};t.preventDefault();if(l.hasClass("ui-state-disabled")||l.hasClass("ui-tabs-loading")||this.running||s&&!n.collapsible||!1===this._trigger("beforeActivate",t,r))i[0].blur();else{n.active=o?!1:this.anchors.index(i);this.active=s?e():i;this.xhr&&this.xhr.abort();if(!a.length&&!u.length)throw"jQuery UI Tabs: Mismatching fragment identifier.";u.length&&(this.load(this.anchors.index(i),t),i[0].blur());this._toggle(t,r)}},_toggle:function(t,n){function r(){s.running=!1;s._trigger("activate",t,n)}function i(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active");o.length&&s.showFx?o.animate(s.showFx,s.showFx.duration||"normal",function(){s._resetStyle(e(this),s.showFx);r()}):(o.show(),r())}var s=this,o=n.newPanel,u=n.oldPanel;s.running=!0;u.length&&s.hideFx?u.animate(s.hideFx,s.hideFx.duration||"normal",function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");s._resetStyle(e(this),s.hideFx);i()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u.hide(),i())},_activate:function(t){t=this._findActive(t)[0];t!==this.active[0]&&(t=t||this.active[0],this._eventHandler({target:t,currentTarget:t,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.anchors.eq(t):"string"==typeof t?this.anchors.filter("[href$='"+t+"']"):e()},_getIndex:function(e){"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$="+e+"]")));return e},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.unbind(".tabs").removeData("href.tabs").removeData("load.tabs");this.lis.unbind(".tabs").add(this.panels).each(function(){e.data(this,"destroy.tabs")?e(this).remove():e(this).removeClass("ui-state-default ui-corner-top ui-tabs-active ui-state-active ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom")});return this},enable:function(n){var r=this.options.disabled;!1!==r&&(n===t?r=!1:(n=this._getIndex(n),r=e.isArray(r)?e.map(r,function(e){return e!==n?e:null}):e.map(this.lis,function(e,t){return t!==n?t:null})),this._setupDisabled(r))},disable:function(n){var r=this.options.disabled;if(!0!==r){if(n===t)r=!0;else{n=this._getIndex(n);if(-1!==e.inArray(n,r))return;r=e.isArray(r)?e.merge([n],r).sort():[n]}this._setupDisabled(r)}},load:function(t,n){var t=this._getIndex(t),i=this,s=this.anchors.eq(t),o=i._getPanelForTab(s),u={tab:s,panel:o};if(!r(s[0])){if(this.xhr=e.ajax({url:s.attr("href"),beforeSend:function(t,r){return i._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:r},u))}}))this.lis.eq(t).addClass("ui-tabs-loading"),this.xhr.success(function(e){o.html(e);i._trigger("load",n,u)}).complete(function(e,n){"abort"===n&&i.panels.stop(!1,!0);i.lis.eq(t).removeClass("ui-tabs-loading");e===i.xhr&&delete i.xhr});return this}},_getPanelForTab:function(t){return this.element.find(this._sanitizeSelector("#"+e(t).attr("aria-controls")))}});if(!1!==e.uiBackCompat){e.ui.tabs.prototype._ui=function(e,t){return{tab:e,panel:t,index:this.anchors.index(e)}};(function(e,t){t.url=function(e,t){this.anchors.eq(e).attr("href",t)}})(k,k.ui.tabs.prototype);(function(e,t){e.extend(t.options,{ajaxOptions:null,cache:!1});var n=t._create,r=t._setOption,i=t._destroy,s=t.url||e.noop;e.extend(t,{_create:function(){n.call(this);var t=this;this.element.bind("tabsbeforeload.tabs",function(n,r){e.data(r.tab[0],"cache.tabs")?n.preventDefault():(e.extend(r.ajaxSettings,t.options.ajaxOptions,{error:function(e,n){try{t.options.ajaxOptions.error(e,n,r.tab.closest("li").index(),r.tab[0])}catch(i){}}}),r.jqXHR.success(function(){t.options.cache&&e.data(r.tab[0],"cache.tabs",!0)}))})},_setOption:function(e,t){"cache"===e&&!1===t&&this.anchors.removeData("cache.tabs");r.apply(this,arguments)},_destroy:function(){this.anchors.removeData("cache.tabs");i.call(this)},url:function(e,t){this.anchors.eq(e).removeData("cache.tabs");s.apply(this,arguments)}})})(k,k.ui.tabs.prototype);(function(e,t){t.abort=function(){this.xhr&&this.xhr.abort()}})(k,k.ui.tabs.prototype);e.widget("ui.tabs",e.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super("_create");this._bind({tabsbeforeload:function(e,t){if(this.options.spinner){var n=t.tab.find("span"),r=n.html();n.html(this.options.spinner);t.jqXHR.complete(function(){n.html(r)})}}})}});(function(e,t){e.extend(t.options,{enable:null,disable:null});var n=t.enable,r=t.disable;t.enable=function(t){var r=this.options,i;if(t&&!0===r.disabled||e.isArray(r.disabled)&&-1!==e.inArray(t,r.disabled))i=!0;n.apply(this,arguments);i&&this._trigger("enable",null,this._ui(this.anchors[t],this.panels[t]))};t.disable=function(t){var n=this.options,i;if(t&&!1===n.disabled||e.isArray(n.disabled)&&-1===e.inArray(t,n.disabled))i=!0;r.apply(this,arguments);i&&this._trigger("disable",null,this._ui(this.anchors[t],this.panels[t]))}})(k,k.ui.tabs.prototype);(function(e,n){e.extend(n.options,{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"});n.add=function(n,r,i){i===t&&(i=this.anchors.length);var s=this.options,r=e(s.tabTemplate.replace(/#\{href\}/g,n).replace(/#\{label\}/g,r)),n=n.indexOf("#")?this._tabId(r.find("a")[0]):n.replace("#","");r.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);r.find("a").attr("aria-controls",n);var o=i>=this.lis.length,u=this.element.find("#"+n);u.length||(u=this._createPanel(n),o?0<i?u.insertAfter(this.panels.eq(-1)):u.appendTo(this.element):u.insertBefore(this.panels[i]));u.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide();o?r.appendTo(this.list):r.insertBefore(this.lis[i]);s.disabled=e.map(s.disabled,function(e){return e>=i?++e:e});this.refresh();1===this.lis.length&&!1===s.active&&this.option("active",0);this._trigger("add",null,this._ui(this.anchors[i],this.panels[i]));return this};n.remove=function(t){var t=this._getIndex(t),n=this.options,r=this.lis.eq(t).remove(),i=this._getPanelForTab(r.find("a[aria-controls]")).remove();r.hasClass("ui-tabs-active")&&2<this.anchors.length&&this._activate(t+(t+1<this.anchors.length?1:-1));n.disabled=e.map(e.grep(n.disabled,function(e){return e!==t}),function(e){return e>=t?--e:e});this.refresh();this._trigger("remove",null,this._ui(r.find("a")[0],i[0]));return this}})(k,k.ui.tabs.prototype);(function(e,t){t.length=function(){return this.anchors.length}})(k,k.ui.tabs.prototype);(function(e,t){e.extend(t.options,{idPrefix:"ui-tabs-"});t._tabId=function(t){return e(t).attr("aria-controls")||t.title&&t.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+ ++n}})(k,k.ui.tabs.prototype);(function(e,t){e.extend(t.options,{panelTemplate:"<div></div>"});t._createPanel=function(t){return e(this.options.panelTemplate).attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("destroy.tabs",!0)}})(k,k.ui.tabs.prototype);(function(e,n){var r=n._create,i=n._setOption,s=n._eventHandler;n._create=function(){var e=this.options;null===e.active&&e.selected!==t&&(e.active=-1===e.selected?!1:e.selected);r.call(this);e.selected=e.active;!1===e.selected&&(e.selected=-1)};n._setOption=function(e,t){if("selected"!==e)return i.apply(this,arguments);var n=this.options;i.call(this,"active",-1===t?!1:t);n.selected=n.active;!1===n.selected&&(n.selected=-1)};n._eventHandler=function(e){s.apply(this,arguments);this.options.selected=this.options.active;!1===this.options.selected&&(this.options.selected=-1)}})(k,k.ui.tabs.prototype);(function(e,t){e.extend(t.options,{show:null,select:null});var n=t._create,r=t._trigger;t._create=function(){n.call(this);!1!==this.options.active&&this._trigger("show",null,this._ui(this.active[0],this._getPanelForTab(this.active)[0]))};t._trigger=function(e,t,n){if(!r.apply(this,arguments))return!1;"beforeActivate"===e&&n.newTab.length?r.call(this,"select",t,{tab:n.newTab[0],panel:n.newPanel[0],index:n.newTab.closest("li").index()}):"activate"===e&&n.newTab.length&&r.call(this,"show",t,{tab:n.newTab[0],panel:n.newPanel[0],index:n.newTab.closest("li").index()})}})(k,k.ui.tabs.prototype);(function(e,t){t.select=function(e){e=this._getIndex(e);if(-1===e){if(!this.options.collapsible||-1===this.options.selected)return;e=this.options.selected}this.anchors.eq(e).trigger(this.options.event+".tabs")}})(k,k.ui.tabs.prototype);var i=0;e.widget("ui.tabs",e.ui.tabs,{options:{cookie:null},_create:function(){var e=this.options,t;null==e.active&&e.cookie&&(t=parseInt(this._cookie(),10),-1===t&&(t=!1),e.active=t);this._super("_create")},_cookie:function(t){var n=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++i)];arguments.length&&(n.push(!1===t?-1:t),n.push(this.options.cookie));return e.cookie.apply(null,n)},_refresh:function(){this._super("_refresh");this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(e){this._superApply("_eventHandler",arguments);this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super("_destroy");this.options.cookie&&this._cookie(null,this.options.cookie)}});e.widget("ui.tabs",e.ui.tabs,{_trigger:function(t,n,r){r=e.extend({},r);"load"===t&&(r.panel=r.panel[0],r.tab=r.tab[0]);return this._super("_trigger",t,n,r)}})}})(k);(function(e){var t=0;e.widget("ui.tooltip",{version:"1.9m6",options:{content:function(){return e(this).attr("title")},hide:!0,items:"[title]",position:{my:"left+15 center",at:"right center",collision:"flipfit flipfit"},show:!0,tooltipClass:null,close:null,open:null},_create:function(){this._bind({mouseover:"open",focusin:"open"});this.tooltips={}},_setOption:function(e,t){"disabled"===e?(this[t?"_disable":"_enable"](),this.options[e]=t):this._super("_setOption",e,t)},_disable:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0];t.close(i,!0)});this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.is("[title]")&&t.data("tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.data("tooltip-title")&&t.attr("title",t.data("tooltip-title"))})},open:function(t){var n,r=this,i=e(t?t.target:this.element).closest(this.options.items);i.length&&!i.attr("aria-describedby")&&(i.data("tooltip-title")||i.data("tooltip-title",i.attr("title")),(n=this.options.content.call(i[0],function(e){setTimeout(function(){r._open(t,i,e)},1)}))&&r._open(t,i,n))},_open:function(t,n,r){if(r){n.is("[title]")&&n.attr("title","");var i=this._find(n);i.length||(i=this._tooltip(n),n.attr("aria-describedby",i.attr("id")));i.find(".ui-tooltip-content").html(r);i.stop(!0).position(e.extend({of:n},this.options.position)).hide();this._show(i,this.options.show);this._trigger("open",t,{tooltip:i});this._bind(n,{mouseleave:"close",blur:"close",keyup:function(t){if(t.keyCode==e.ui.keyCode.ESCAPE){t=e.Event(t);t.currentTarget=n[0];this.close(t,!0)}}})}},close:function(t,n){var r=this,i=e(t?t.currentTarget:this.element),s=this._find(i);if(n||document.activeElement!==i[0])i.data("tooltip-title")&&i.attr("title",i.data("tooltip-title")),i.removeAttr("aria-describedby"),s.stop(!0),this._hide(s,this.options.hide,function(){e(this).remove();delete r.tooltips[this.id]}),i.unbind("mouseleave.tooltip blur.tooltip keyup.tooltip"),this._trigger("close",t,{tooltip:s})},_tooltip:function(n){var r="ui-tooltip-"+t++,i=e("<div>").attr({id:r,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));e("<div>").addClass("ui-tooltip-content").appendTo(i);i.appendTo(document.body);e.fn.bgiframe&&i.bgiframe();this.tooltips[r]=n;return i},_find:function(t){return(t=t.attr("aria-describedby"))?e("#"+t):e()},_destroy:function(){e.each(this.tooltips,function(t){e("#"+t).remove()})}})})(k);return k.ui});define("ui/tab","aloha/core jquery ui/container ui/component PubSub jqueryui".split(" "),function(e,t,n,r,i){var s=0,o={},e=n.extend({_elemBySlot:null,_groupBySlot:null,_groupByComponent:null,_constructor:function(e,n,r){var i,o,u,a,l;this._elemBySlot={};this._groupBySlot={};this._groupByComponent={};this._super(e,n);this.container=n.container;this.list=this.container.data("list");this.panels=this.container.data("panels");this.id="tab-ui-container-"+ ++s;this.panel=t("<div>",{id:this.id,unselectable:"on"});this.handle=t('<li><a href="#'+this.id+'">'+n.label+"</a></li>");for(e=0;e<r.length;e++)if(typeof r[e]=="string")if(1===r[e].length&&r[e].charCodeAt(0)===10)this.panel.append("<div>",{unselectable:"on"});else{o=t("<span>",{unselectable:"on"});this._elemBySlot[r[e]]=o;this.panel.append(o)}else{a=t("<div>",{"class":"aloha-ui-component-group aloha-ui-hidden",unselectable:"on"}).appendTo(this.panel);l={element:a,visibleCounter:0};u=r[e];for(i=0;i<u.length;i++){this._groupBySlot[u[i]]=l;if(u[i]&&1===u[i].length&&u[i].charCodeAt(0)===10)a.append(t("<div>",{unselectable:"on"}));else{o=t("<span>",{unselectable:"on"});this._elemBySlot[u[i]]=o;a.append(o)}}}this.panel.append(t("<div>",{"class":"aloha-ui-clear",unselectable:"on"}));this.handle.appendTo(this.list);this.panel.appendTo(this.panels);this.container.tabs("refresh");n=n.container.data("aloha-tabs");this.index=n.length;n.push(this)},adoptInto:function(e,t){var n=this._elemBySlot[e];if(!n)return!1;o[e]=t;t.adoptParent(this);n.append(t.element);if(n=this._groupBySlot[e]){this._groupByComponent[t.id]=n;if(t.isVisible()){n.visibleCounter||n.element.removeClass("aloha-ui-hidden");n.visibleCounter=n.visibleCounter+1}}return!0},foreground:function(){this.container.tabs("select",this.index)},childForeground:function(){this.foreground()},hasVisibleComponents:function(){var e=this._elemBySlot,t;for(t in e)if(e.hasOwnProperty(t)&&o[t]&&o[t].visible)return!0;return!1},childVisible:function(e,t){t?e.container.show():e.container.hasVisibleComponents()||e.container.hide();var n=this._groupByComponent[e.id];if(n)if(t){0===n.visibleCounter&&n.element.removeClass("aloha-ui-hidden");n.visibleCounter=n.visibleCounter+1}else{n.visibleCounter=n.visibleCounter-1;0===n.visibleCounter&&n.element.addClass("aloha-ui-hidden")}},show:function(){if(this.list.children().length){this.handle.show();this.visible=!0;this.container.show();(!this.container.find(".ui-tabs-active").length||this.container.tabs("option","selected")===this.index)&&this.foreground()}},hide:function(){var e=this.list.children();if(0!==e.length){this.handle.hide();this.visible=!1;if(this.index===this.container.tabs("option","selected")){var e=this.container.data("aloha-tabs"),t;for(t=0;t<e.length;++t)if(e[t].visible){this.container.tabs("select",t);return}this.handle.removeClass("ui-tabs-active");this.container.hide()}}}});t.extend(e,{createContainer:function(){var e=t("<div>",{unselectable:"on"}),n=t("<ul>",{unselectable:"on"}).appendTo(e),r=t("<div>",{unselectable:"on"}).appendTo(e);e.data("list",n).data("panels",r).data("aloha-tabs",[]).tabs({select:function(t,n){var r=e.data("aloha-tabs");e.data("aloha-active-container",r[n.index]);i.pub("aloha.ui.container.selected",{data:r[n.index]})}});return e}});return e});define("ui/subguarded",["aloha/core","jquery","PubSub"],function(e,t,n){function r(e){e.alohaUid||(e.alohaUid=++u);return e.alohaUid}function i(e,t){a[e.alohaUid]||(a[e.alohaUid]=[]);a[e.alohaUid].push(t);return a[e.alohaUid]}function s(e,t){f[e]||(f[e]=[]);f[e].push(t);return f[e]}function o(e){var t=f[e]||[],n;for(n=0;n<t.length;n++)t[n].apply(null,[a[t[n].alohaUid]||[]].concat(arguments))}var u=0,a={},f={};return function(){var t=Array.prototype.slice.call(arguments),u=t.shift();"string"==typeof u&&(u=[u]);var a=t.shift();r(a);i(a,t);for(var f,l=function(e,t,n){o(f,e,t,n)},h=function(){o(f)},t=0;t<u.length;t++)f=u[t],s(f,a),e.bind(f,l),n.sub(f,h)}});define("vendor/amplify.store",["util/json2"],function(){var e={};(function(e,t){function n(e,n){r.addType(e,function(s,o,u){var f,l=o,h=(new Date).getTime();if(!s){l={};u=[];o=0;try{for(s=n.length;s=n.key(o++);)i.test(s)&&(f=ka.parse(n.getItem(s)),f.expires&&f.expires<=h?u.push(s):l[s.replace(i,"")]=f.data);for(;s=u.pop();)n.removeItem(s)}catch(p){}return l}s="__amplify__"+s;if(o===t){if(f=(f=n.getItem(s))?ka.parse(f):{expires:-1},!(f.expires&&f.expires<=h))return f.data;n.removeItem(s)}else if(null===o)n.removeItem(s);else{f=ka.stringify({data:o,expires:u.expires?h+u.expires:null});try{n.setItem(s,f)}catch(v){r[e]();try{n.setItem(s,f)}catch(m){throw r.error()}}}return l})}var r=e.store=function(e,t,n,i){i=r.type;n&&n.type&&n.type in r.types&&(i=n.type);return r.types[i](e,t,n||{})};r.types={};r.type=null;r.addType=function(e,t){r.type||(r.type=e);r.types[e]=t;r[e]=function(t,n,i){i=i||{};i.type=e;return r(t,n,i)}};r.error=function(){return"amplify.store quota exceeded"};var i=/^__amplify__/,s;for(s in{localStorage:1,sessionStorage:1})try{window[s].getItem&&n(s,window[s])}catch(o){}if(window.globalStorage)try{n("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===r.type&&(r.type="globalStorage")}catch(u){}(function(){if(!r.types.localStorage){var e=document.createElement("div");e.style.display="none";document.getElementsByTagName("head")[0].appendChild(e);try{e.addBehavior("#default#userdata"),e.load("amplify")}catch(n){e.parentNode.removeChild(e);return}r.addType("userData",function(n,i,s){e.load("amplify");var o,u,f=i,l=(new Date).getTime();if(!n){f={};u=[];for(n=0;i=e.XMLDocument.documentElement.attributes[n++];)o=ka.parse(i.value),o.expires&&o.expires<=l?u.push(i.name):f[i.name]=o.data;for(;n=u.pop();)e.removeAttribute(n);e.save("amplify");return f}n=n.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");if(i===t){if(o=(i=e.getAttribute(n))?ka.parse(i):{expires:-1},!(o.expires&&o.expires<=l))return o.data;e.removeAttribute(n)}else null===i?e.removeAttribute(n):(u=e.getAttribute(n),o=ka.stringify({data:i,expires:s.expires?l+s.expires:null}),e.setAttribute(n,o));try{e.save("amplify")}catch(h){null===u?e.removeAttribute(n):e.setAttribute(n,u);r.userData();try{e.setAttribute(n,o),e.save("amplify")}catch(p){throw null===u?e.removeAttribute(n):e.setAttribute(n,u),r.error()}}return f})}})();(function(){var e={},n={};r.addType("memory",function(r,i,s){if(!r)return e===t?t:ka.parse(ka.stringify(e));if(i===t)return e[r]===t?t:ka.parse(ka.stringify(e[r]));n[r]&&(clearTimeout(n[r]),delete n[r]);if(null===i)return delete e[r],null;e[r]=i;s.expires&&(n[r]=setTimeout(function(){delete e[r];delete n[r]},s.expires));return i})})()})(e);return e});define("ui/floating",["jquery","aloha/core","ui/surface","ui/subguarded","vendor/amplify.store"],function(e,t,n,r,i){function s(e,t,n,r){e.stop().animate(t,n,function(){r(t)})}function o(e){i.store("Aloha.FloatingMenu.pinned","true");i.store("Aloha.FloatingMenu.top",e.top);i.store("Aloha.FloatingMenu.left",e.left)}function u(e,t,n,r,i){for(t=0;t<e.length;t++)e[t][0].isActive()&&e[t][1](n,r,i)}var a=e(window);return{getPinState:function(){return"true"===i.store("Aloha.FloatingMenu.pinned")?{top:parseInt(i.store("Aloha.FloatingMenu.top"),10),left:parseInt(i.store("Aloha.FloatingMenu.left"),10),isPinned:!0}:{top:null,left:null,isPinned:!1}},makeFloating:function(t,n){r(["aloha-selection-changed","aloha.ui.container.selected"],u,t,function(){t._move()});var i=function(){var e;e=n.pinLeft;var r=n.pinTop;0>r?r=0:r>a.height()&&(r=a.height()/2);0>e?e=0:e>a.width()&&(e=a.width()/2);e={top:r,left:e};n.setFloatingPosition(e);t.$element.css({top:e.top,left:e.left})};a.scroll(function(){t._move(0)});a.resize(function(){n.isFloatingMode||i()});t.addPin();if(e.browser.msie){var s=t.$element.parent();t.$element.appendTo("body");t.$element.css("position","fixed");s.length?t.$element.appendTo(s):t.$element.detach()}else t.$element.css("position","fixed");n.isFloatingMode||i();t.$element.css("z-index",10100).draggable({distance:20,stop:function(e,t){n.setFloatingPosition(t.position);n.isFloatingMode||o(t.position)}})},floatSurface:function(t,n,r,i){"number"!=typeof r&&(r=500);var o=(parseInt(e("body").css("marginTop"),10)||0)+(parseInt(e("body").css("paddingTop"),10)||0),t=t.$element;t.offset();var u=n.obj.offset(),f=a.scrollTop(),l=u.top-f-o,c=u.left,h=c+t.width()-a.width()-10;0<h&&(c-=h);l>=t.height()?(u.top-=f,u.top-=t.height()+10,s(t,u,r,i)):(n=l+t.height()>u.top+n.obj.height()?{top:u.top+n.obj.height(),left:c}:{top:o,left:c},n.top+=10,s(t,n,r,i))},togglePinSurface:function(e,t,n){e=e.$element;n?(i.store("Aloha.FloatingMenu.pinned",null),i.store("Aloha.FloatingMenu.top",null),i.store("Aloha.FloatingMenu.left",null),e.find(".aloha-ui-pin").removeClass("aloha-ui-pin-down")):(o(t),e.find(".aloha-ui-pin").addClass("aloha-ui-pin-down"));e.css({position:"fixed",top:t.top})}}});(function(){function e(e,t,n,r,i,s){t[e]&&(n.push(e),(!0===t[e]||1===t[e])&&r.push(i+e+"/"+s))}function t(e,t,n,r,i){t=r+t+"/"+i;require._fileExists(e.toUrl(t))&&n.push(t)}function n(e,t,r){for(var i in t)t.hasOwnProperty(i)&&(!e.hasOwnProperty(i)||r)?e[i]=t[i]:"object"==typeof t[i]&&n(e[i],t[i],r)}var r=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(i){var s=i.config();return{version:"2.0.1",load:function(i,o,u,l){l=l||{};l.locale&&(s.locale=l.locale);var c=r.exec(i),h=c[1],p=c[4],d=c[5],v=p.split("-"),m=[],g={},y,w="";c[5]?(h=c[1],i=h+d):(d=c[4],p=s.locale,p||(p=s.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),v=p.split("-"));if(l.isBuild){m.push(i);t(o,"root",m,h,d);for(y=0;y<v.length;y++)l=v[y],w+=(w?"-":"")+l,t(o,w,m,h,d);o(m,function(){u()})}else o([i],function(t){var r=[],i;e("root",t,r,m,h,d);for(y=0;y<v.length;y++){i=v[y];w+=(w?"-":"")+i;e(w,t,r,m,h,d)}o(m,function(){var e,i,s;for(e=r.length-1;e>-1&&r[e];e--){s=r[e];i=t[s];if(i===!0||i===1)i=o(h+s+"/"+d);n(g,i)}g.t=function(e,t){return this[e]?this[e]:t?t:e};u(g)})})}}})})();define("ui/nls/i18n",{root:{"button.bold.label":"Bold","button.italic.label":"Italic","button.strikethrough.label":"Strikethrough","button.subscript.label":"Subscript","button.superscript.label":"Superscript","button.underline.label":"Underline","button.p.label":"Paragraph","button.h1.label":"Heading 1","button.h2.label":"Heading 2","button.h3.label":"Heading 3","button.h4.label":"Heading 4","button.h5.label":"Heading 5","button.h6.label":"Heading 6","button.pre.label":"Preformatted text","button.removeFormatting.label":"Remove formatting","button.ol.label":"Insert ordered list","button.ul.label":"Insert unordered list","button.indent.label":"Indent list","button.outdent.label":"Outdent list","button.createLink.label":"Insert link","button.removeLink.label":"Remove link","button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.justifyLeft.label":"Align to the left","button.justifyRight.label":"Align to the right","button.justifyCenter.label":"Center","button.justifyFull.label":"Justify","button.horizontalRule.label":"Insert horizontal rule","button.createLanguageAnnotation.label":"Insert language annotation","button.metaview.label":"Switch between meta and normal view","button.quote.label":"Format selection as quote","button.blockquote.label"
:"Format selection as blockquote","tab.format.label":"Format","tab.insert.label":"Insert","tab.abbr.label":"Abbreviation","tab.img.label":"Image","tab.link.label":"Link","tab.list.label":"List","tab.table.label":"Table","tab.col.label":"Table Column","tab.row.label":"Table Row","tab.wai-lang.label":"Language annotation"},de:!0});define("ui/toolbar","jquery aloha/core ui/surface ui/tab ui/floating ui/context i18n!ui/nls/i18n jqueryui".split(" "),function(e,t,n,r,i,s,o){var u=n.extend({_moveTimeout:null,$_container:null,_tabBySlot:null,_tabs:[],_constructor:function(t,n){var s,a,f,h;this._super(t);this.$element=e("<div>",{"class":"aloha-ui aloha-ui-toolbar",unselectable:"on"});this.$_container=r.createContainer().appendTo(this.$element);this._tabBySlot={};for(f=0;f<n.length;f++){s=n[f];a=new r(t,{label:o.t(s.label,s.label),showOn:s.showOn,container:this.$_container},s.components);for(h in a._elemBySlot)a._elemBySlot.hasOwnProperty(h)&&(this._tabBySlot[h]=a);this._tabs.push({tab:a,settings:s})}i.makeFloating(this,u)},adoptInto:function(e,t){var n=this._tabBySlot[e];return n&&n.adoptInto(e,t)},getActiveContainer:function(){return this.$_container.data("aloha-active-container")},getContainers:function(){return this.$_container.data("aloha-tabs")},_move:function(e){var n=this;this._moveTimeout&&clearTimeout(this._moveTimeout);this._moveTimeout=setTimeout(function(){n._moveTimeout=null;if(t.activeEditable&&u.isFloatingMode){n.$element.stop();i.floatSurface(n,t.activeEditable,e,function(e){u.setFloatingPosition(e)})}},20)},addPin:function(){var t=e('<div class="aloha-ui-pin">'),n=this.$element;n.find(".ui-tabs").append(t);n.find(".ui-tabs").hover(function(){n.addClass("aloha-ui-hover")},function(){n.removeClass("aloha-ui-hover")});u.isFloatingMode||t.addClass("aloha-ui-pin-down");var r=this;t.click(function(){u.isFloatingMode=!u.isFloatingMode;var t;if(u.isFloatingMode)t={top:u.pinTop,left:u.pinLeft};else{t=r.$element.offset();t.top=t.top-e(window).scrollTop()}u.setFloatingPosition(t);i.togglePinSurface(r,t,u.isFloatingMode)})},show:function(){u.$surfaceContainer.children().detach();u.$surfaceContainer.append(this.$element);u.$surfaceContainer.stop().fadeTo(200,1);var e=u.getFloatingPosition();this.$element.stop().css({top:e.top,left:e.left});this._move()},hide:function(){u.$surfaceContainer.stop().fadeOut(200,function(){u.$surfaceContainer.children().detach()})}});e.extend(u,{$surfaceContainer:null,isFloatingMode:!0,pinLeft:0,pinTop:0,init:function(){u.$surfaceContainer=e("<div>",{"class":"aloha aloha-surface aloha-toolbar",unselectable:"on"}).hide();e(function(){u.$surfaceContainer.appendTo("body")});n.trackRange(u.$surfaceContainer);var t=i.getPinState();u.pinTop=t.top;u.pinLeft=t.left;u.isFloatingMode=!t.isPinned},setFloatingPosition:function(e){u.pinTop=e.top;u.pinLeft=e.left},getFloatingPosition:function(){return{top:u.pinTop,left:u.pinLeft}}});u.init();return u});define("util/maps",[],function(){return{isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fillTuples:function(e,t){for(var n=t.length,r;n--;)r=t[n],e[r[0]]=r[1];return e},fillKeys:function(e,t,n){for(var r=t.length;r--;)e[t[r]]=n;return e}}});define("util/functions",[],function(){return{identity:function(e){return e}}});define("util/trees",["jquery","util/functions"],function(e,t){function n(t,n,r){var i=e.type(t);if("array"===i)for(var r=[],s=0,i=t.length;s<i;s++)n(t[s],r.length,r);else if("object"===i)for(s in r={},t)t.hasOwnProperty(s)&&n(t[s],s,r);else r=r(t);return r}function r(e,t,n){if(1===e.nodeType){for(var n=e.cloneNode(!1),e=e.firstChild,r=[];e;)t(e,0,r),0!==r.length&&n.appendChild(r[0]),e=e.nextSibling;t=n}else t=n(e.cloneNode(!0));return t}function i(e,t,n,r,i,s,o){s[i]=o(t(e),r,n)}function s(e,t,n,r,i,s,o){s[i]=t(o(e,r,n))}function o(e,t,n,r,i,s,o){t(e)||(s[i]=o(e,r,n))}function u(e,t,n,r,i,s,o){e=o(e,r,n);t(e)||(s[i]=e)}function a(e,t,n,r,i){var s=[null];(function o(e,s,u){r(e,t,n,o,s,u,i)})(e,0,s);return s[0]}return{prewalk:function(e,r,s){return a(e,r,s||t.identity,i,n)},postwalk:function(e,r,i){return a(e,r,i||t.identity,s,n)},preprune:function(e,r,i){return a(e,r,i||t.identity,o,n)},postprune:function(e,r,i){return a(e,r,i||t.identity,u,n)},leaves:function(e,r){return a(e,t.identity,r,s,n)},prepruneNodes:function(e,n,i){return a(e,n,i||t.identity,o,r)},postpruneNodes:function(e,n,i){return a(e,n,i||t.identity,u,r)},flatten:function(e){var r=[];a(e,t.identity,function(e){r.push(e)},s,n);return r}}});define("ui/settings",["jquery","util/arrays","util/maps","util/trees"],function(e,t,n,r){function i(t,n,i){var s,o,u=[],a;for(s=0;s<t.length;s++)if(o=t[s],!n[o.label]&&(a=r.postprune(o.components,i)))o=e.extend({},o),o.components=a,u.push(o);return u}function s(t,n,i){var s,o,u=[],a,f,l;for(s=0;s<t.length;s++)o=t[s],a=o.components||[],f=n[o.label],!o.exclusive&&f&&(l=r.postprune(f.components,i))&&(a=a.concat(l)),o=e.extend({},f||{},o),o.components=a,u.push(o);return u}function o(e,t){var i,s=n.fillKeys({},t,!0);for(i=0;i<e.length;i++)s[e[i].label]=!0,n.fillKeys(s,r.flatten(e[i].components),!0);return s}return{defaultToolbarSettings:{tabs:[{label:"tab.format.label",showOn:{scope:"Aloha.continuoustext"},components:["bold strong italic emphasis \n subscript superscript strikethrough quote".split(" "),"formatLink formatAbbr formatNumeratedHeaders \n toggleMetaView wailang toggleFormatlessPaste \n toggleDragDrop".split(" "),"alignLeft alignCenter alignRight alignJustify \n orderedList unorderedList indentList outdentList".split(" "),["formatBlock"]]},{label:"tab.insert.label",showOn:{scope:"Aloha.continuoustext"},components:["createTable characterPicker insertLink insertImage insertAbbr insertToc insertHorizontalRule insertTag".split(" ")]},{label:"tab.link.label",showOn:{scope:"link"},components:["editLink","removeLink","linkBrowser"]},{label:"tab.img.label",showOn:{scope:"image"},components:[["imageSource","\n","imageTitle"],["imageResizeWidth","\n","imageResizeHeight"],"imageAlignLeft imageAlignRight imageAlignNone imageIncPadding \n imageCropButton imageCnrReset imageCnrRatio imageDecPadding".split(" "),["imageBrowser"]]},{label:"tab.abbr.label",showOn:{scope:"abbr"},components:[["abbrText"]]},{label:"tab.wai-lang.label",showOn:{scope:"wai-lang"},components:[["wailangfield","removewailang"]]},{label:"tab.table.label",showOn:{scope:"table.cell"},components:[["mergecells","splitcells","tableCaption","tableSummary","formatTable"]]},{label:"tab.col.label",showOn:{scope:"table.column"},components:["addcolumnleft addcolumnright deletecolumns columnheader mergecellsColumn splitcellsColumn formatColumn".split(" ")]},{label:"tab.row.label",showOn:{scope:"table.row"},components:["addrowbefore addrowafter deleterows rowheader mergecellsRow splitcellsRow formatRow".split(" ")]}]},combineToolbarSettings:function(r,u,l){function h(t){return"array"===e.type(t)?!t.length:d[t]}var p=n.fillTuples({},t.map(u,function(e){return[e.label,e]})),d=o(r,l),r=s(r,p,h),u=i(u,d,h);return r.concat(u)}}});define("ui/ui-plugin","jquery aloha ui/context ui/container ui/surface ui/toolbar ui/scopes ui/settings PubSub jqueryui".split(" "),function(e,t,n,r,i,s,o,u,a){var f=new n,l=new s(f,function(){var e=t.settings.toolbar,n=u.defaultToolbarSettings;return e?u.combineToolbarSettings(e.tabs||[],n.tabs,e.exclude||[]):n.tabs}());t.bind("aloha-editable-activated",function(e){i.show(f);r.showContainersForContext(f,e)});t.bind("aloha-editable-deactivated",function(){i.suppressHide||i.hide(f)});a.sub("aloha.ui.scope.change",function(){r.showContainersForContext(f);o.getPrimaryScope();var t=l._tabs,n=o.getPrimaryScope(),i,s;for(s=0;s<t.length;s++){i=t[s].settings;if("object"===e.type(i.showOn)&&i.showOn.scope===n){t[s].tab.foreground();break}}});return{adoptInto:function(e,t){return l.adoptInto(e,t)},showToolbar:function(e){i.show(f);r.showContainersForContext(f,e)}}});define("ui/ui",["jquery","ui/ui-plugin"],function(e,t){var n={};return{adopt:function(r,i,s){"string"!==e.type(r)&&(s=i,i=r,r=s.name);i.isInstance||(i=s?i.extend(s):i,i=new i);n[r]=i;t.adoptInto(r,i);return i},getAdoptedComponent:function(e){return n[e]||null}}});define("ui/utils",["jquery","jqueryui"],function(e){function t(e){return e.html||e.text||e.tooltip}function n(e){return'<img class="aloha-ui-inline-icon" src="'+e+'">'}return{wrapWithLabel:function(t,n){return e("<label>",{"class":"aloha-ui-label"}).append(e("<span>",{"class":"aloha-ui-label-text",text:t})).append(n)},makeButton:function(e,r,i){e.button({label:t(r),text:!!r.text||!!r.html,icons:{primary:r.icon||r.iconUrl&&"aloha-ui-inline-icon-container"||null,secondary:i&&"aloha-jqueryui-icon ui-icon-triangle-1-s"||null}});r.iconUrl&&e.button("widget").children(".ui-button-icon-primary").append(n(r.iconUrl));return e},makeButtonElement:function(t){return e("<button>",t).attr("type","button")},makeButtonLabel:t,makeButtonLabelWithIcon:function(e){var r=t(e);e.iconUrl&&(r=n(e.iconUrl)+r);return r},makeButtonIconFromUrl:n}});define("ui/vendor/jquery-ui-autocomplete-html",["jquery","jqueryui"],function(e){(function(e){function t(t,n){var r=RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(t){return r.test(e("<div>").html(t.label||t.value||t).text())})}var n=e.ui.autocomplete.prototype,r=n._initSource;e.extend(n,{_initSource:function(){this.options.html&&e.isArray(this.options.source)?this.source=function(e,n){n(t(this.options.source,e.term))}:r.call(this)},_renderItem:function(t,n){return e("<li></li>").data("item.autocomplete",n).append(e("<a></a>")[this.options.html?"html":"text"](n.label)).appendTo(t)}})})(e)});define("ui/port-helper-attribute-field","jquery ui/ui ui/component ui/scopes ui/context ui/utils aloha/repositorymanager aloha/selection aloha/console ui/vendor/jquery-ui-autocomplete-html".split(" "),function(e,t,n,r,i,s,o,u){return function(r){function h(e,t){t.item&&w(t.item.obj);p()}function p(){if(!C){var t=e(D),n=t.attr("data-original-background-color");n?t.css("background-color",n):t.css("background-color","");t.removeAttr("data-original-background-color")}if(D&&H!==e(D).attr(P)){M||o.markObject(D);g()===""&&v()}}function d(e,t){return e.replace(/\{([^}]+)\}/g,function(e,n){return n in t?t[n]:""})}function v(){if(null!=N){L.css("color","#AAA");L.val(N)}}function g(){return L.val()}function y(e){L.val(e);L.css("color","black")}function w(e){if(M=e){var t=e[x];y(t);_=t;E(P,e[S]);o.markObject(D,e)}else _=null}function E(t,n,r,i){if(D){var s=!0;typeof i!="undefined"&&(i.match(RegExp(r))||(s=!1));s?e(D).attr(t,n):e(D).removeAttr(t)}}var S=r.valueField||"id",x=r.displayField||"name",T=r.objectTypeFilter||["all"],N=r.placeholder,C=!!r.noTargetHighlight,L=e('<input id="aloha-attribute-field-'+r.name+'">'),A,O,M,_,D,P,H;r.cls&&L.addClass(r.cls);r.width&&L.width(r.width);A=t.adopt(r.name,n,{scope:r.scope,init:function(){if(r.label){this.element=s.wrapWithLabel(r.label,L);r.labelClass&&this.element.addClass(r.labelClass)}else this.element=e("<span>").append(L);L.autocomplete({html:!0,appendTo:i.selector,source:function(t,n){o.query({queryString:t.term,objectTypeFilter:T},function(t){n(e.map(t.items,function(e){return{label:d(O,e),value:e.name,obj:e}}))})},select:h})}});L.bind("focus",function(t){if(e(t.target).is(":visible")){if(!C){(t=e(D))&&t.context&&t.context.style&&t.context.style["background-color"]&&t.attr("data-original-background-color",t.context.style["background-color"]);t.css("background-color","#80B5F2")}g()===N&&y("")}}).bind("blur",function(){p()}).bind("keydown",function(e){(e.keyCode==13||e.keyCode==27)&&e.preventDefault()}).bind("keyup",function(e){M&&_!==g()&&(_=M=null);M||E(P,g());if(e.keyCode==13||e.keyCode==27){u.getRangeObject().select();p()}});v();var B={getInputElem:function(){return L[0]},hasInputElem:function(){return!0},getInputId:function(){return L.attr("id")},hide:function(){L.hide()},show:function(){L.show()},foreground:function(){A.foreground()},focus:function(){A.focus();L.focus()},getTargetObject:function(){return D},setTargetObject:function(t,n){D=t;P=n;w(null);if(t&&n){H=e(t).attr(n);y(e(D).attr(P));o.getObject(t,function(e){e&&e.length>0&&w(e[0])})}else y("")},setAttribute:E,getItem:function(){return M},setItem:w,setValue:y,getValue:g,addListener:function(t,n){L.bind(t,e.proxy(n,B))},setObjectTypeFilter:function(e){T=e},setTemplate:function(e){O=e},setPlaceholder:v};return B}});define("ui/button",["jquery","ui/component","ui/utils","jqueryui"],function(e,t,n){return t.extend({init:function(){this._super();this.createButtonElement();n.makeButton(this.buttonElement,this).button("widget").tooltip({tooltipClass:"aloha aloha-ui-tooltip",position:{my:"left top",at:"right bottom"}}).click(e.proxy(function(){this.buttonElement.tooltip("close",null,!0);this._onClick()},this))},_onClick:function(){this.click()},click:function(){},createButtonElement:function(){var e=n.makeButtonElement();this["class"]&&e.addClass(this["class"]);return this.element=this.buttonElement=e},disable:function(){this.element.button("option","disabled",!1)},enable:function(e){this.element.button("option","disabled",!1===e)}})});define("ui/toggleButton",["jquery","ui/button","jqueryui"],function(e,t){return t.extend({_checked:!1,setState:function(e){this._checked!==e&&((this._checked=e)?this.element.addClass("aloha-button-active"):this.element.removeClass("aloha-button-active"))},getState:function(){return this._checked},_onClick:function(){this.setState(!this._checked);this.click()}})});define("link/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link","button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link","link.target.self":"Self","link.target.blank":"Blank","link.target.parent":"Parent","link.target.top":"Top","link.target.framename":"Framename","link.target.legend":"Target","link.title.legend":"Title",insertLink:"ctrl+k"},de:!0,fr:!0,pl:!0,ru:!0});define("aloha/nls/i18n",{root:{"plugin.abbr.floatingmenu.tab.abbr":"Abbreviation","floatingmenu.tab.format":"Format","floatingmenu.tab.insert":"Insert",yes:"Yes",no:"No",cancel:"Cancel","repository.no_item_found":"No item found.","repository.loading":"Loading","repository.no_items_found_yet":"No items found yet..."},de:!0});define("link/../extra/linklist",["aloha","jquery"],function(e,t){var n=[{name:"Aloha Editor - The HTML5 Editor",url:"http://aloha-editor.org",type:"website"},{name:"Aloha Editor - Wiki",url:"http://github.com/alohaeditor/Aloha-Editor/wiki",type:"website"},{name:"Aloha Editor - GitHub",url:"http://github.com/alohaeditor/Aloha-Editor",type:"website"},{name:"Aloha Logo",url:"http://www.aloha-editor.com/images/aloha-editor-logo.png",type:"image"}];new(e.AbstractRepository.extend({_constructor:function(){this._super("linklist")},folder:[],init:function(){e.settings.repositories&&e.settings.repositories.linklist&&e.settings.repositories.linklist.data&&(n=n.concat(e.settings.repositories.linklist.data));"filter"in Array.prototype||(n.filter=function(e,t){for(var n=[],r,i=0,s=this.length;i<s;i++)i in this&&e.call(t,r=this[i],i,this)&&n.push(r);return n});for(var t=n.length,r=0;r<t;++r){var i=n[r];i.repositoryId=this.repositoryId;i.id=i.id?i.id:i.url;for(var s=i.uri=this.parseUri(i.url),o=this.addFolder("",s.host),s=s.path.split("/"),u=0;u<s.length;u++)s[u]&&0>s[u].lastIndexOf(".")&&(o=this.addFolder(o,s[u]));i.parentId=o;n[r]=new e.RepositoryDocument(i)}this.repositoryName="Linklist"},addFolder:function(t,n){var r=t?t+"/"+n:n;n&&!this.folder[r]&&(this.folder[r]=new e.RepositoryFolder({id:r,name:n||r,parentId:t,type:"host",repositoryId:this.repositoryId}));return r},query:function(e,r){var i=RegExp(e.queryString,"i"),s=n.filter(function(n){return(!e.queryString||n.name.match(i)||n.url.match(i))&&(!e.objectTypeFilter||!e.objectTypeFilter.length||-1<t.inArray(n.type,e.objectTypeFilter))&&!0});r.call(this,s)},getChildren:function(e,t){var n=[],r;for(r in this.folder)"function"!=typeof this.folder[r]&&(this.folder[r].parentId==e.inFolderId||!this.folder[r].parentId&&e.inFolderId==this.repositoryId)&&n.push(this.folder[r]);t.call(this,n)},parseUri:function(e){for(var t="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),e=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),n={},r=14;r--;)n[t[r]]=e[r]||"";n.queryKey={};n[t[12]].replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(n.queryKey[t]=r)});return n},getObjectById:function(e,t){for(var r=0,i=n.length,s=[];r<i;r++)n[r].id==e&&s.push(n[r]);t.call(this,s)}}))});define("link/link-plugin","aloha aloha/plugin jquery ui/port-helper-attribute-field ui/ui ui/scopes ui/surface ui/button ui/toggleButton i18n!link/nls/i18n i18n!aloha/nls/i18n aloha/console link/../extra/linklist".split(" "),function(e,t,n,r,i,s,o,u,a,f){function l(t,r){var i,s=!1;if(!t.ignoreNextSelectionChangedEvent&&e.Selection.isSelectionEditable()&&e.activeEditable!=null)if(i=t.findLinkMarkup(r)){t.toggleLinkScope(!0);t.hrefField.setTargetObject(i,"href");if(n("#"+t.hrefField.getInputId()).length==0){t.hrefUpdateInt!==null&&clearInterval(t.hrefUpdateInt);t.hrefUpdateInt=setInterval(function(){if(n("#"+t.hrefField.getInputId()).length>0){t.hrefField.setTargetObject(i,"href");clearInterval(t.hrefUpdateInt)}},200)}e.trigger("aloha-link-selected");s=!0}else{t.toggleLinkScope(!1);t.hrefField.setTargetObject(null);e.trigger("aloha-link-unselected")}else t.toggleLinkScope(!1);t.ignoreNextSelectionChangedEvent=!1;return s}var c=window.GENTICS,h="",p;return t.create("link",{languages:["en","de","fr","ru","pl"],config:["a"],targetregex:"",target:"",cssclassregex:"",cssclass:"",objectTypeFilter:[],onHrefChange:null,ignoreNextSelectionChangedEvent:!1,hrefUpdateInt:null,hotKey:{insertLink:f.t("insertLink","ctrl+k")},hrefValue:"http://",init:function(){var t=this;typeof this.settings.targetregex!="undefined"&&(this.targetregex=this.settings.targetregex);typeof this.settings.target!="undefined"&&(this.target=this.settings.target);typeof this.settings.cssclassregex!="undefined"&&(this.cssclassregex=this.settings.cssclassregex);typeof this.settings.cssclass!="undefined"&&(this.cssclass=this.settings.cssclass);typeof this.settings.objectTypeFilter!="undefined"&&(this.objectTypeFilter=this.settings.objectTypeFilter);typeof this.settings.onHrefChange!="undefined"&&(this.onHrefChange=this.settings.onHrefChange);typeof this.settings.hotKey!="undefined"&&n.extend(!0,this.hotKey,this.settings.hotKey);typeof this.settings.hrefValue!="undefined"&&(this.hrefValue=this.settings.hrefValue);this.createButtons();this.subscribeEvents();this.bindInteractions();e.ready(function(){t.initSidebar(e.Sidebar.right)})},nsSel:function(){var e=[];n.each(arguments,function(){e.push("."+(this==""?"aloha-link":"aloha-link-"+this))});return n.trim(e.join(" "))},nsClass:function(){var e=[];n.each(arguments,function(){e.push(this==""?"aloha-link":"aloha-link-"+this)});return n.trim(e.join(" "))},initSidebar:function(e){var t=this;t.sidebar=e;e.addPanel({id:t.nsClass("sidebar-panel-target"),title:f.t("floatingmenu.tab.link"),content:"",expanded:!0,activeOn:"a, link",onInit:function(){var e=this;this.setContent('<div class="'+t.nsClass("target-container")+'"><fieldset><legend>'+f.t("link.target.legend")+'</legend><ul><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_self" /><span>'+f.t("link.target.self")+'</span></li><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_blank" /><span>'+f.t("link.target.blank")+'</span></li><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_parent" /><span>'+f.t("link.target.parent")+'</span></li><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_top" /><span>'+f.t("link.target.top")+'</span></li><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="framename" /><span>'+f.t("link.target.framename")+'</span></li><li><input type="text" class="'+t.nsClass("framename")+'" /></li></ul></fieldset></div><div class="'+t.nsClass("title-container")+'" ><fieldset><legend>'+f.t("link.title.legend")+'</legend><input type="text" class="'+t.nsClass("linkTitle")+'" /></fieldset></div>');n(t.nsSel("framename")).live("keyup",function(){n(e.effective).attr("target",n(this).val().replace('"',"&quot;").replace("'","&#39;"))});n(t.nsSel("radioTarget")).live("change",function(){if(n(this).val()=="framename")n(t.nsSel("framename")).slideDown();else{n(t.nsSel("framename")).slideUp().val("");n(e.effective).attr("target",n(this).val())}});n(t.nsSel("linkTitle")).live("keyup",function(){n(e.effective).attr("title",n(this).val().replace('"',"&quot;").replace("'","&#39;"))})},onActivate:function(e){var r=this;r.effective=e;if(n(r.effective).attr("target")!=null){var i=!0;n(t.nsSel("framename")).hide().val("");n(t.nsSel("radioTarget")).each(function(){n(this).removeAttr("checked");if(n(this).val()===n(r.effective).attr("target")){i=!1;n(this).attr("checked","checked")}});if(i){n(t.nsSel('radioTarget[value="framename"]')).attr("checked","checked");n(t.nsSel("framename")).val(n(r.effective).attr("target")).show()}}else{n(t.nsSel("radioTarget")).first().attr("checked","checked");n(r.effective).attr("target",n(t.nsSel("radioTarget")).first().val())}r=this;r.effective=e;n(t.nsSel("linkTitle")).val(n(r.effective).attr("title"))}});e.show()},subscribeEvents:function(){var t=this,r={};e.bind("aloha-editable-created",function(e,i){var s=t.getEditableConfig(i.obj),s=n.inArray("a",s)!==-1;if(r[i.getId()]=s){i.obj.bind("keydown",t.hotKey.insertLink,function(){if(t.findLinkMarkup()){t.hrefField.foreground();t.hrefField.focus()}else t.insertLink(!0);return!1});i.obj.find("a").each(function(){t.addLinkEventHandlers(this)})}});e.bind("aloha-editable-activated",function(){if(r[e.activeEditable.getId()]){t._formatLinkButton.show(!0);t._insertLinkButton.show(!0)}else{t._formatLinkButton.show(!1);t._insertLinkButton.show(!1)}});var i=!1;e.bind("aloha-selection-changed",function(n,s){var o=!1;e.activeEditable&&r[e.activeEditable.getId()]&&(o=l(t,s))&&i!==o&&t.hrefField.foreground();i=o})},toggleLinkScope:function(e){if(this._isScopeActive!==e)if(this._isScopeActive=e){this.hrefField.show();this._insertLinkButton.show(!1);this._removeLinkButton.show(!0);this._formatLinkButton.setState(!0);s.enterScope(this.name)}else{this.hrefField.hide();this._insertLinkButton.show(!0);this._removeLinkButton.show(!1);this._formatLinkButton.setState(!1);s.leaveScope(this.name)}},addLinkEventHandlers:function(t){var r=this;n(t).mouseenter(function(){e.Log.debug(r,"mouse over link.");r.mouseOverLink=t;r.updateMousePointer()});n(t).mouseleave(function(){e.Log.debug(r,"mouse left link.");r.mouseOverLink=null;r.updateMousePointer()});n(t).click(function(t){if(t.metaKey){e.activeEditable.blur();window.setTimeout(function(){location.href=t.target},0);t.stopPropagation();return!1}})},createButtons:function(){var e=this;this._formatLinkButton=i.adopt("formatLink",a,{tooltip:f.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){e.formatLink()}});this._insertLinkButton=i.adopt("insertLink",u,{tooltip:f.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){e.insertLink(!1)}});this.hrefField=r({name:"editLink",width:320,valueField:"url",cls:"aloha-link-href-field",scope:"Aloha.continuoustext"});this.hrefField.setTemplate("<span><b>{name}</b><br/>{url}</span>");this.hrefField.setObjectTypeFilter(this.objectTypeFilter);this._removeLinkButton=i.adopt("removeLink",u,{tooltip:f.t("button.removelink.tooltip"),icon:"aloha-icon aloha-icon-unlink",scope:"Aloha.continuoustext",click:function(){e.removeLink()}})},bindInteractions:function(){var t=this;this.hrefField.addListener("keyup",function(r){if(r.keyCode==27){var i=t.hrefField.getValue();if(!(i[0]=="/"||i[0]=="#"||i.match(/^.*\.([a-z]){2,4}$/i)||i.match(/^([a-z]){3,10}:\/\/.+/i)||i.match(/^(mailto|tel):.+/i))){i=t.hrefField.getValue();t.hrefField.setValue(i);(i==t.hrefValue||i=="")&&t.removeLink(!1)}}t.hrefChange();if(r.keyCode==13){r=e.Selection.getRangeObject();t.ignoreNextSelectionChangedEvent=!0;r.startContainer=r.endContainer;r.startOffset=r.endOffset;r.select();t.ignoreNextSelectionChangedEvent=!0;i=n(t.hrefField.getInputElem()).attr("value");(i==t.hrefValue||i=="")&&t.removeLink(!1);window.setTimeout(function(){s.setScope("Aloha.continuoustext")},100)}else{p=n(t.hrefField.getInputElem()).attr("value");h!=p&&(h=p)}});n(document).keydown(function(n){e.Log.debug(t,"Meta key down.");t.metaKey=n.metaKey;t.updateMousePointer()}).keyup(function(n){e.Log.debug(t,"Meta key up.");t.metaKey=n.metaKey;t.updateMousePointer()})},updateMousePointer:function(){if(this.metaKey&&this.mouseOverLink){e.Log.debug(this,"set pointer");n(this.mouseOverLink).removeClass("aloha-link-text");n(this.mouseOverLink).addClass("aloha-link-pointer")}else{n(this.mouseOverLink).removeClass("aloha-link-pointer");n(this.mouseOverLink).addClass("aloha-link-text")}},findLinkMarkup:function(t){typeof t=="undefined"&&(t=e.Selection.getRangeObject());return e.activeEditable?t.findMarkup(function(){return this.nodeName.toLowerCase()=="a"},e.activeEditable.obj):null},formatLink:function(){e.activeEditable&&(this.findLinkMarkup(e.Selection.getRangeObject())?this.removeLink():this.insertLink())},insertLink:function(t){var r=this,i=e.Selection.getRangeObject(),s;if(i.startContainer&&i.endContainer&&!this.findLinkMarkup(i)){this.hrefField.foreground();i.isCollapsed()&&t!==!1&&c.Utils.Dom.extendToWord(i);if(i.isCollapsed()){t=f.t("newlink.defaulttext");s=n('<a href="'+r.hrefValue+'" class="aloha-new-link">'+t+"</a>");c.Utils.Dom.insertIntoDOM(s,i,n(e.activeEditable.obj));i.startContainer=i.endContainer=s.contents().get(0);i.startOffset=0;i.endOffset=t.length}else{s=n('<a href="'+r.hrefValue+'" class="aloha-new-link"></a>');c.Utils.Dom.addMarkup(i,s,!1)}e.activeEditable.obj.find("a.aloha-new-link").each(function(){r.addLinkEventHandlers(this);n(this).removeClass("aloha-new-link")});i.select();this.hrefField.focus();this.hrefField.hasInputElem()&&n(this.hrefField.getInputElem()).attr("value",r.hrefValue).select();this.hrefChange()}},removeLink:function(t){var n=e.Selection.getRangeObject(),r=this.findLinkMarkup();this.hrefField.setItem(null);if(r){c.Utils.Dom.removeFromDOM(r,n,!0);n.startContainer=n.endContainer;n.startOffset=n.endOffset;n.select();(typeof t=="undefined"||t===!0)&&s.setScope("Aloha.continuoustext")}},hrefChange:function(){this.target!=""&&this.hrefField.setAttribute("target",this.target,this.targetregex,this.hrefField.getValue());this.hrefField.setAttribute("class",this.cssclass,this.cssclassregex,this.hrefField.getValue());e.trigger("aloha-link-href-change",{obj:this.hrefField.getTargetObject(),href:this.hrefField.getValue(),item:this.hrefField.getItem()});typeof this.onHrefChange=="function"&&this.onHrefChange.call(this,this.hrefField.getTargetObject(),this.hrefField.getValue(),this.hrefField.getItem())},makeClean:function(e){e.find("a").each(function(){n(this).removeClass("aloha-link-pointer").removeClass("aloha-link-text")})}})});define("ui/dialog",["jquery","ui/component"],function(e){function t(t){var n={};t.text&&(n.text=t.text);t.html&&(n.html=t.html);return e("<div>",n)}function n(t){for(var n in t)t.hasOwnProperty(n)&&(t[n]=function(t){return function(){t.apply(this);e(this).dialog("destroy").remove()}}(t[n]));return t}function r(e,t){var n="aloha aloha-dialog";e.cls&&(n+=" "+e.cls);return{resizable:!1,modal:!0,title:e.title||t,dialogClass:n,zIndex:10200}}return{confirm:function(i){var s=i.buttons||{};s.Yes=s.Yes||i.yes||e.noop;s.No=s.No||i.no||e.noop;if(i.answer){var o=s.Yes,u=s.No;s.Yes=function(){o();i.answer(!0)};s.No=function(){u();i.answer(!1)}}var l=t(i).dialog(e.extend(r(i,"Confirm"),{buttons:n(s)}));return function(){l.dialog("destroy").remove()}},alert:function(i){var s=t(i).dialog(e.extend(r(i,"Alert"),{buttons:n({Dismiss:e.noop})}));return function(){s.dialog("destroy").remove()}},progress:function(n){var i=e("<div>").progressbar({value:null!=n.value?n.value:100}),s=t(n).dialog(e.extend(r(n,"Progress"),{open:function(){e(this).append(i)}}));return function(e){null!=e?i.progressbar({value:e}):s.dialog("destroy").remove()}}}});define("ui/multiSplit",["jquery","ui/component","ui/button","ui/utils"],function(e,t,n,r){return t.extend({_activeButton:null,_isOpen:!1,init:function(){this._super();var t=this,n=this.element=e("<div>",{"class":"aloha-multisplit"});this.contentElement=e("<div>",{"class":"aloha-multisplit-content"}).appendTo(n);this.toggleButton=r.makeButtonElement({"class":"aloha-multisplit-toggle",click:function(){t.toggle()}}).button().appendTo(n);this.buttons=[];var i=this.getButtons();0===i.length&&n.hide();for(n=0;n<i.length;n++)this.addButton(i[n]);e("body").click(function(e){t._isOpen&&!t.element.is(e.target)&&0===t.element.find(e.target).length&&t.close()})},addButton:function(e){var t=this,r=new(n.extend({tooltip:e.tooltip,icon:e.wide?e.icon:"aloha-large-icon "+e.icon,iconOnly:e.wide?!1:!0,init:function(){this._super();e.init&&e.init.call(this)},click:function(){e.click.apply(t,arguments);t.close()}}));e.wide||r.element.addClass("aloha-large-button");t.buttons[e.name]={settings:e,component:r,element:r.element,visible:!0};var i=this.contentElement.children(".aloha-ui-multisplit-fullwidth");!e.wide&&i.length?i.before(r.element[0]):this.contentElement.append(r.element[0])},setActiveButton:function(e){e||(e=null);null!==this._activeButton&&this.buttons[this._activeButton].element.removeClass("aloha-multisplit-active");this._activeButton=e;null!==e&&this.buttons[e].element.addClass("aloha-multisplit-active")},toggle:function(){this.element.toggleClass("aloha-multisplit-open");this._isOpen=!this._isOpen},open:function(){this.element.addClass("aloha-multisplit-open");this._isOpen=!0},close:function(){this.element.removeClass("aloha-multisplit-open");this._isOpen=!1},show:function(e){e||(e=null);null!==e&&void 0!==this.buttons[e]&&(this.buttons[e].element.show(),this.buttons[e].visible=!0,this.element.show())},hide:function(e){var t,n=!1;e||(e=null);if(null!==e&&void 0!==this.buttons[e]){this.buttons[e].element.hide();this.buttons[e].visible=!1;for(t in this.buttons)if(this.buttons.hasOwnProperty(t)&&this.buttons[t].visible){this.element.show();n=!0;break}n||this.element.hide()}}})});define("ui/port-helper-multi-split",["aloha/core","jquery","ui/ui","ui/multiSplit"],function(e,t,n,r){return function(e){var i;i=n.adopt(e.name,r,{scope:e.scope,getButtons:function(){var n=[];t.each(e.items,function(e,t){n.push({tooltip:t.tooltip,text:t.text,name:t.name,icon:t.iconClass,click:t.click,init:function(){t.cls&&this.element.addClass(t.cls);t.init&&t.init.call(this)},wide:t.wide})});return n}});return{pushItem:function(e){i.addButton(e)},showItem:function(e){i.show(e)},hideItem:function(e){i.hide(e)},setActiveItem:function(e){i.setActiveButton(e)}}}});define("table/nls/i18n",{root:{"floatingmenu.tab.table":"Table","floatingmenu.tab.tablelayout":"Table Layout","deleterows.confirm":"Do you really want to delete the selected rows?","deletecolumns.confirm":"Do you really want to delete the selected columns?","deletetable.confirm":"Do you really want to delete the table?",Table:"Table","button.createtable.tooltip":"Insert Table","button.addcolleft.tooltip":"Add Column left","button.addcolright.tooltip":"Add Column right","button.delcols.tooltip":"Delete Columns","button.addrowbefore.tooltip":"Add Row before","button.addrowafter.tooltip":"Add Row after","button.delrows.tooltip":"Delete Rows","button.caption.tooltip":"Table caption","empty.caption":"Table caption","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting","button.rowheader.tooltip":"Format row as table header","button.columnheader.tooltip":"Format column as table header","button.mergecells.tooltip":"Merge Cells","button.splitcells.tooltip":"Split Cells","table.label.target":"Summary","table.sidebar.title":"Table","table.mergeCells.notRectangular":"Only a rectangular selection can be merged","table.addColumns.nonConsecutive":"Please select a single column or a consecutive range of columns","table.createTable.nestedTablesNoSupported":"Sorry, nested tables are not supported"},de:!0,eo:!0,fi:!0,fr:!0,it:!0,pl:!0,ru:!0});define("table/table-create-layer",["jquery"],function(e){CreateLayer=function(e){this.TablePlugin=e};CreateLayer.prototype.parameters={elemId:"aloha-table-createLayer",className:"aloha-table-createdialog",numX:10,numY:10,layer:void 0,target:void 0};CreateLayer.prototype
.config={};CreateLayer.prototype.visible=!1;CreateLayer.prototype.show=function(){var e=this.get("layer");null==e?this.create():(this.setPosition(e),e.find("td").removeClass("hover"),e.show());this.visible=!0};CreateLayer.prototype.create=function(){var t=this,n=e("<div></div>");n.id=this.get("elemId");n.addClass(this.get("className"));var r=e("<table></table>");r.css("width",15*(this.get("numX")+6));for(var i,s,o=0;o<this.get("numY");o++){i=e("<tr></tr>");for(var u=0;u<this.get("numX");u++)s=e("<td> </td>"),0==o&&0==u&&s.addClass("hover"),s.bind("mouseover",{rowId:o,colId:u},function(e){t.handleMouseOver(e,r)}),s.bind("click",{rowId:o,colId:u},function(e){t.TablePlugin.createTable(e.data.colId+1,e.data.rowId+1);t.hide()}),i.append(s);r.append(i)}n.append(r);this.set("layer",n);this.setPosition();n.bind("click",function(e){e.stopPropagation()}).mousedown(function(e){e.stopPropagation()});e("body").append(n).bind("click",function(n){t.visible&&n.target!==t.get("target")[0]&&!e.contains(t.get("target")[0],n.target)&&t.hide()})};CreateLayer.prototype.handleMouseOver=function(t,n){for(var r=t.data.rowId,i=t.data.colId,s=n.find("tr"),o=0;o<=s.length;o++)for(var u=e(s[o]).find("td"),a=0;a<=u.length;a++)o<=r&&a<=i?e(u[a]).addClass("hover"):e(u[a]).removeClass("hover")};CreateLayer.prototype.setPosition=function(){var t=e(this.get("target")),n=t.offset();this.get("layer").css("left",n.left+"px");this.get("layer").css("top",n.top+t.height()+"px")};CreateLayer.prototype.hide=function(){this.get("layer").hide();this.visible=!1};CreateLayer.prototype.get=function(e){if(this.config[e])return this.config[e];if(this.parameters[e])return this.parameters[e]};CreateLayer.prototype.set=function(e,t){this.config[e]?this.config[e]=t:this.parameters[e]=t};return CreateLayer});define("table/table-plugin-utils",["jquery"],function(e){var t={cellIndexToGridColumn:function(e,n,r){var i=null;t.walkCells(e,function(e,t,s){if(e===n&&t===r)return i=s,!1});return i},walkCells:function(e,n){for(var r=[],i=0;i<e.length;i++){for(var s=e[i].cells,o=0,u=0;u<s.length;u++){for(var a=s[u],l=t.colspan(a),a=t.rowspan(a);r[u+o];)r[u+o]-=1,o+=1;if(!1===n(i,u,u+o,l,a))return;for(var c=0;c<l;c++){if(r[u+o+c])throw"an impossible case has occurred";r[u+o+c]=a-1}o+=l-1}for(;u+o<r.length;o++)r[u+o]&&(r[u+o]-=1)}},makeGrid:function(e){var n=[];t.walkCells(e,function(t,r,i,s,o){for(var r=e[t].cells[r],u=0;u<o;u++){n[t+u]=n[t+u]||[];for(var f=0;f<s;f++)n[t+u][i+f]={cell:r,colspan:s,rowspan:o,spannedX:f,spannedY:u}}});return n},containsDomCell:function(e){return 0===e.spannedX&&0===e.spannedY},leftDomCell:function(e,t,n){do{var r=e[t][n];if(0===r.spannedY)return r.cell;n-=r.spannedX+1}while(0<=n);return null},splitCell:function(n,r){var i=e(n),s=t.colspan(n),o=t.rowspan(n);if(1!==s||1!==o){for(var u=i.parent(),a=u.parent().children(),u=u.index(),l=i.index(),c=t.makeGrid(a),l=t.cellIndexToGridColumn(a,u,l),h=0;h<o;h++)for(var p=0===h?1:0;p<s;p++){var d=t.leftDomCell(c,u+h,l);null==d?a.eq(u+h).prepend(r()):e(d).after(r())}i.removeAttr("colSpan");i.removeAttr("rowSpan")}},rowspan:function(t){return parseInt(e(t).attr("rowspan"))||1},colspan:function(t){return parseInt(e(t).attr("colspan"))||1},walkGrid:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)if(!1===t(e[n][r],r,n))return},walkGridInsideRect:function(e,n,r){t.walkGrid(e,function(e,t,i){if(i>=n.top&&i<n.bottom&&t>=n.left&&t<n.right)return r(e,t,i)})},leftTrimArray:function(e){for(var t=0;t<e.length;t++)if(null!=e[t])return e.slice(t,e.length);return[]},makeContour:function(e,n){var r=[],i=[],s=[],o=[];t.walkGrid(e,function(e,t,u){if(n(e,t,u)){if(null==r[u]||t<r[u])r[u]=t;if(null==i[u]||t>i[u])i[u]=t;if(null==s[t]||u<s[t])s[t]=u;if(null==o[t]||u>o[t])o[t]=u}});r=t.leftTrimArray(r);i=t.leftTrimArray(i);s=t.leftTrimArray(s);o=t.leftTrimArray(o);return{left:r,right:i,top:s,bottom:o}},indexOfAnyBut:function(e,t){for(var n=0;n<e.length;n++)if(t!==e[n])return n;return-1},isConsecutive:function(e){for(var t=1;t<e.length;t++)if(1!==Math.abs(e[t]-e[t-1]))return!1;return!0}};return t});define("table/table-cell",["jquery","table/table-plugin-utils"],function(e,t){var n=function(t,n){null==t&&(t="<td>&nbsp;</td>");t=e(t).get(0);this.obj=e(t);this.tableObj=n;n.cells.push(this)};n.prototype.tableObj=void 0;n.prototype.obj=void 0;n.prototype.wrapper=void 0;n.prototype.hasFocus=!1;n.prototype.activate=function(){this.obj.wrapInner("<div/>");var e=this.obj.children("div").eq(0);e.contentEditable(!0);e.addClass("aloha-table-cell-editable");var t=this;e.bind("focus",function(e){e.currentTarget&&(e.currentTarget.indexOf=function(){return-1});t._editableFocus(e)});e.bind("mousedown",function(e){e.currentTarget&&(e.currentTarget.indexOf=function(){return-1});t._editableMouseDown(e);t._startCellSelection()});e.bind("blur",function(e){t._editableBlur(e)});e.bind("keyup",function(e){t._editableKeyUp(e)});e.bind("keydown",function(e){t._editableKeyDown(e)});e.bind("mouseover",function(){t._selectCellRange()});e.contentEditableSelectionChange(function(t){Aloha.Selection.onChange(e,t);return e});this.obj.bind("mousedown",function(e){window.setTimeout(function(){t.wrapper.trigger("focus")},1);t.tableObj.selection.unselectCells();t._startCellSelection();e.stopPropagation()});this.obj.get(0)&&(this.obj.get(0).onselectstart=function(){return!1});this.wrapper=this.obj.children();this.wrapper.get(0)&&(this.wrapper.get(0).onselectstart=function(){window.event.cancelBubble=!0},this.wrapper.get(0).ondragstart=function(){return!1});return this};n.prototype.deactivate=function(){var t=e(this.obj.children(".aloha-table-cell-editable"));t.length&&(t.parent().append(t.contents()),t.remove(),this.obj.unbind("click"),this.obj.unbind("mousedown"),""==e.trim(this.obj.attr("class"))&&this.obj.removeAttr("class"))};n.prototype.toString=function(){return"TableCell"};n.prototype._editableFocus=function(){this.hasFocus||(this.tableObj.focus(),this.obj.addClass("aloha-table-cell_active"),this.hasFocus=!0,this.tableObj.selection.selectionType="cell")};n.prototype._editableBlur=function(){this.hasFocus=!1;this.obj.removeClass("aloha-table-cell_active")};n.prototype._virtualX=function(){var e=this.tableObj.obj.children().children("tr"),n=this.obj.parent().index(),r=this.obj.index();return t.cellIndexToGridColumn(e,n,r)};n.prototype._virtualY=function(){return this.obj.parent("tr").index()};n.prototype._startCellSelection=function(){if(!this.tableObj.selection.cellSelectionMode){this.tableObj.selection.unselectCells();this.tableObj.selection.cellSelectionMode=!0;var t=this;e("body").bind("mouseup.cellselection",function(){t._endCellSelection()});this.tableObj.selection.baseCellPosition=[this._virtualY(),this._virtualX()]}};n.prototype._endCellSelection=function(){this.tableObj.selection.cellSelectionMode&&(this.tableObj.selection.cellSelectionMode=!1,this.tableObj.selection.baseCellPosition=null,this.tableObj.selection.lastSelectionRange=null,this.tableObj.selection.selectionType="cell",e("body").unbind("mouseup.cellselection"))};n.prototype._getSelectedRect=function(){var e=this._virtualX(),t=this._virtualY(),n=this.tableObj.selection.baseCellPosition,r=n[1];r>e&&(r=e,e=n[1]);var i=n[0];i>t&&(i=t,t=n[0]);return{top:i,right:e,bottom:t,left:r}};n.prototype._selectCellRange=function(){if(this.tableObj.selection.cellSelectionMode){var n=this._getSelectedRect(),r=this.tableObj,i=r.obj.children().children("tr"),i=t.makeGrid(i);r.selection.selectedCells=[];var s=r.get("classCellSelected");t.walkGrid(i,function(i,o,u){t.containsDomCell(i)&&(u>=n.top&&u<=n.bottom&&o>=n.left&&o<=n.right?(e(i.cell).addClass(s),r.selection.selectedCells.push(i.cell)):e(i.cell).removeClass(s))});r.selection.notifyCellsSelected()}};n.prototype._selectAll=function(t){t=t.jquery?t.get(0):t;if(e.browser.msie)document.getSelection?(n=document.getSelection(),r=document.createRange(),r.selectNodeContents(t),n.removeAllRanges(),n.addRange(r)):document.selection&&(r=document.body.createTextRange(),r.moveToElementText(t),r.select());else{var n=window.getSelection();if(n.setBaseAndExtent)n.setBaseAndExtent(t,0,t,Math.max(0,t.innerText.length-1));else{window.opera&&"<BR>"==t.innerHTML.substring(t.innerHTML.length-4)&&(t.innerHTML+="&#160;");var r=document.createRange();r.selectNodeContents(t);n.removeAllRanges();n.addRange(r)}}};n.prototype._editableMouseDown=function(e){this.tableObj.selection.unselectCells();this.tableObj.hasFocus&&e.stopPropagation()};n.prototype._editableKeyUp=function(){};n.prototype._editableKeyDown=function(e){this._checkForEmptyEvent(e);this.obj[0]===this.tableObj.obj.find("tr:last td:last")[0]&&9==e.keyCode&&!e.altKey&&!e.shiftKey&&!e.ctrlKey&&(this.tableObj.addRow(this.obj.parent().index()+1),this.tableObj.cells[this.tableObj.cells.length-1]._selectAll(this.wrapper.get(0)),e.stopPropagation())};n.prototype._checkForEmptyEvent=function(){var t=e(this.wrapper),n=t.text();!(0<t.children().length)&&""===n&&(this.wrapper.text(" "),this.wrapper.get(0).blur(),this.wrapper.get(0).focus())};n.getContainer=function(t){return e(t.firstChild).hasClass("aloha-table-cell-editable")?t.firstChild:t};return n});define("table/table-selection","aloha jquery table/table-plugin-utils table/table-cell ui/dialog i18n!table/nls/i18n".split(" "),function(e,t,n,r,i,s){function o(e){return{top:e.top[0],right:e.right[0]+1,bottom:e.bottom[0]+1,left:e.left[0]}}function u(e,t,r){var i=!0;if(-1!==n.indexOfAnyBut(t.top,t.top[0])||-1!==n.indexOfAnyBut(t.right,t.right[0])||-1!==n.indexOfAnyBut(t.bottom,t.bottom[0])||-1!==n.indexOfAnyBut(t.left,t.left[0]))i=!1;else{t=o(t);n.walkGridInsideRect(e,t,function(e){if(!r(e))return i=!1})}return i}var a=function(e){this.table=e};a.prototype.selectionType=void 0;a.prototype.selectedCells=[];a.prototype.selectedColumnIdxs=[];a.prototype.selectedRowIdxs=[];a.prototype.cellSelectionMode=!1;a.prototype.baseCellPosition=null;a.prototype.lastSelectionRange=null;a.prototype.selectColumns=function(e){this.unselectCells();var r=this.table.getRows();r.shift();for(var r=n.makeGrid(r),i=0;i<e.length;i++)if(-1===t.inArray(e[i],this.selectedColumnIdxs)){this.selectedColumnIdxs.push(e[i]);for(var s=0;s<r.length;s++){var o=r[s][e[i]];if(n.containsDomCell(o)){t(o.cell).addClass(this.table.get("classCellSelected"));this.selectedCells.push(o.cell)}}}this.selectionType="column"};a.prototype.selectRows=function(e){this.unselectCells();var n=this.table.getRows();e.sort(function(e,t){return e-t});for(var r=0;r<e.length;r++)if(n[e[r]]){for(var i=0;i<this.selectedRowIdxs.length;i++)if(e[r]==this.selectedRowIdxs[i])return;this.selectedRowIdxs.push(e[r]);for(i=1;i<n[e[r]].cells.length;i++){this.selectedCells.push(n[e[r]].cells[i]);t(n[e[r]].cells[i]).addClass(this.table.get("classCellSelected"))}}this.selectionType="row"};a.prototype.selectAll=function(){var e=t.map(this.table.getRows(),function(e,t){return t});e.shift();this.selectRows(e)};a.prototype.notifyCellsSelected=function(){e.trigger("aloha-table-selection-changed")};a.prototype._notifyCellsUnselected=function(){e.trigger("aloha-table-selection-changed")};a.prototype.isHeader=function(){if(this.selectedCells.length==0)return!1;for(var e=0;e<this.selectedCells.length;e++)if(!this.selectedCells[e]||this.selectedCells[e].nodeName.toLowerCase()!="th")return!1;return!0};a.prototype.unselectCells=function(){var e;if(!this.cellSelectionMode&&this.selectedCells.length>0){e=this.table.getRows();for(var n=0;n<e.length;n++)for(var r=1;r<e[n].cells.length;r++)t(e[n].cells[r]).removeClass(this.table.get("classCellSelected"));this.selectedCells=[];this.selectedColumnIdxs=[];this.selectedRowIdxs=[];this.selectionType="cell";this._notifyCellsUnselected()}};a.prototype.selectionIndex=function(e){for(var t=0;t<this.selectedCells.length;t++)if(this.selectedCells[t]===e)return t;return-1};a.prototype.mergeCells=function(){var a=this.selectedCells;if(0!==a.length){var h=function(e){return-1!=t.inArray(e.cell,a)},p=n.makeGrid(this.table.getRows()),d=n.makeContour(p,h);if(u(p,d,h)){var v=o(d),h=t(p[v.top][v.left].cell),g=t(r.getContainer(h.get(0)));n.walkGridInsideRect(p,v,function(e,n,i){if(n-e.spannedX!==v.left||i-e.spannedY!==v.top){e=e.cell;n=t(r.getContainer(e)).contents();for(i=0;i<n.length;i++)if("string"!=typeof n[i]||""!==t.trim(n[i])){g.append(" ");g.append(n);break}t(e).remove()}});h.attr({rowspan:v.bottom-v.top,colspan:v.right-v.left});this.selectedCells=[h.get(0)];this.cellSelectionMode=!1;this.lastSelectionRange=this.baseCellPosition=null;this.selectionType="cell";e.trigger("aloha-table-selection-changed")}else i.alert({title:s.t("Table"),text:s.t("table.mergeCells.notRectangular")})}};a.prototype.splitCells=function(){var r=this,i=this.selectedCells;if(i.length>0){t(i).each(function(){n.splitCell(this,function(){return r.table.newActiveCell().obj})});this.cellSelectionMode=!1;this.lastSelectionRange=this.baseCellPosition=null;this.selectionType="cell";e.trigger("aloha-table-selection-changed")}};a.prototype.cellsAreMergeable=function(){var e=this.selectedCells;if(e.length<2)return!1;var r=function(n){return-1!=t.inArray(n.cell,e)},i=n.makeGrid(this.table.getRows()),s=n.makeContour(i,r);return u(i,s,r)?!0:!1};a.prototype.cellsAreSplitable=function(){var e=0;if(this.selectedCells.length>0){t(this.selectedCells).each(function(){var t=n.colspan(this),r=n.rowspan(this);(t>1||r>1)&&e++});return e>0?!0:!1}return!1};return a});define("table/table","aloha jquery ui/scopes ui/dialog i18n!table/nls/i18n table/table-cell table/table-selection table/table-plugin-utils".split(" "),function(e,t,n,r,i,s,o,u){function a(e,t){var n=-1,r=null;"before"===e?r=t.selectedCells[0]:"after"===e&&(r=t.selectedCells[t.selectedCells.length-1]);r&&r.nodeType==1&&(n=r.parentNode.rowIndex);return n}var f=window.GENTICS,l=function(e,n){this.obj=t(e);var r,i,s=this.getRows(),a=s.length,l,c=0,h=[],p;for(r=0;r<a;r++){i=t(s[r]);i=i.children("td, th");l=i.length;l=u.cellIndexToGridColumn(s,r,l-1)+1;p=parseInt(i.last().attr("colspan"),10);if(p!=0&&!isNaN(p)){p==1&&i.last().removeAttr("colspan");l+=p-1}h.push(l);l>c&&(c=l)}for(r=0;r<a;r++){i=c-h[r];i>0&&t(s[r]).append(Array(i+1).join("<td></td>"))}this.obj.attr("id")||this.obj.attr("id",f.Utils.guid());this.tablePlugin=n;this.selection=new o(this);this.refresh()};t.extend(l.prototype,{obj:void 0,tableWrapper:void 0,cells:void 0,numRows:void 0,numCols:void 0,isActive:!1,hasFocus:!1,parentEditable:void 0,mousedown:!1,clickedColumnId:-1,clickedRowId:-1,columnsToSelect:[],rowsToSelect:[],fmPluginId:void 0});l.prototype.refresh=function(){this.numCols=this.countVirtualCols();var e=this.getRows();this.numRows=e.length;this.cells=[];for(var n=0;n<e.length;n++)for(var r=t(e[n]).children(),i=0;i<r.length;i++)this.newCell(r[i])};l.prototype.countVirtualCols=function(){var e=this.obj.children().children("tr:first-child").children();return e.length-e.filter("."+this.get("classLeftUpperCorner")).length};l.prototype.get=function(e){return this.tablePlugin.get(e)};l.prototype.set=function(e,t){this.tablePlugin.set(e,t)};l.prototype.activate=function(){if(!this.isActive){var n=this,r;this.obj.addClass(this.get("className"));this.obj.contentEditable(!1);this.obj.attr("id")==""&&this.obj.attr("id",f.Utils.guid());this.selection.selectionType=void 0;r=this.obj.children("tbody");r.length===0&&(r=this.obj);r.bind("keydown",function(e){!e.ctrlKey&&!e.shiftKey&&n.selection.selectedCells.length>0&&n.selection.selectedCells[0].length>0&&n.selection.selectedCells[0][0].firstChild.focus()});r.bind("mousedown",function(e){n.hasFocus||n.focus();e.stopPropagation();e.preventDefault();return!1});this.obj.wrap(t('<div class="'+this.get("classTableWrapper")+'" data-block-skip-scope="true"></div>'));r=this.obj.parent();r.alohaBlock&&r.alohaBlock();r=this.obj.parents("."+this.get("classTableWrapper"));r.get(0).onresizestart=function(){return!1};r.get(0).oncontrolselect=function(){return!1};r.get(0).ondragstart=function(){return!1};r.get(0).onmovestart=function(){return!1};this.tableWrapper=this.obj.parents("."+this.get("classTableWrapper")).get(0);t(this.cells).each(function(){this.activate()});this.attachSelectionColumn();this.attachSelectionRow();this.makeCaptionEditable();this.checkWai();this.isActive=!0;e.trigger("aloha-table-activated")}};l.prototype.makeCaptionEditable=function(){var e=this.obj.find("caption").eq(0);e&&this.tablePlugin.makeCaptionEditable(e)};l.prototype.checkWai=function(){var e=this.wai;if(e){e.removeClass(this.get("waiGreen"));e.removeClass(this.get("waiRed"));t.trim(this.obj[0].summary)!=""?e.addClass(this.get("waiGreen")):e.addClass(this.get("waiRed"))}};l.prototype.attachSelectionColumn=function(){var e=t("<td>"),n,r,i,s;e.html(" ");i=this.obj.context.rows;for(s=0;s<i.length;s++){r=t(i[s]);n=e.clone();n.addClass(this.get("classSelectionColumn"));n.css("width",this.get("selectionArea")+"px");r.prepend(n);this.attachRowSelectionEventsToCell(n)}};l.prototype.attachRowSelectionEventsToCell=function(e){var t=this;e.unbind("mousedown");e.unbind("mouseover");e.get(0).onselectstart=function(){return!1};e.bind("mousedown",function(e){return t.rowSelectionMouseDown(e)});e.bind("mouseover",function(e){if(t.mousedown)return t.rowSelectionMouseOver(e)})};l.prototype.rowSelectionMouseDown=function(e){this.focus();this.selection.selectedCells.length==0&&(this.rowsToSelect=[]);this.clickedRowId=e.currentTarget.parentNode.rowIndex;if(e.metaKey){var n=t.inArray(this.clickedRowId,this.rowsToSelect);n>=0?this.rowsToSelect.splice(n,1):this.rowsToSelect.push(this.clickedRowId)}else if(e.shiftKey){this.rowsToSelect.sort(function(e,t){return e-t});var r=this.rowsToSelect[0],n=this.clickedRowId;if(r>n){r=n;n=this.rowsToSelect[0]}for(this.rowsToSelect=[];r<=n;r++)this.rowsToSelect.push(r)}else this.rowsToSelect=[this.clickedRowId];this.selectRows();e.preventDefault();e.stopPropagation();this.tablePlugin.summary.focus();return!1};l.prototype.rowSelectionMouseOver=function(e){var n=e.currentTarget.parentNode.rowIndex,r;if(this.mousedown&&this.clickedRowId>=0){t.inArray(n,this.rowsToSelect);r=n<this.clickedRowId?n:this.clickedRowId;n=n<this.clickedRowId?this.clickedRowId:n;for(this.rowsToSelect=[];r<=n;r++)this.rowsToSelect.push(r);this.selectRows();e.preventDefault();e.stopPropagation();return!1}};l.prototype.attachSelectionRow=function(){var e=this,n=t("<td>");n.html(" ");for(var r=0,i=0;i<this.obj.context.rows.length;i++){for(var s=0,o=0;o<this.obj.context.rows[i].cells.length;o++)var a=u.colspan(this.obj.context.rows[i].cells[o]),s=s+a;r<s&&(r=s)}s=t("<tr>");s.addClass(this.get("classSelectionRow"));s.css("height",this.get("selectionArea")+"px");for(i=0;i<r;i++){o=n.clone();if(i>0)this.attachColumnSelectEventsToCell(o);else{o=t("<td>").clone();o.addClass(this.get("classLeftUpperCorner"));this.wai=t("<div/>").width(25).height(12).click(function(t){e.focus();e.selection.selectAll();e.tablePlugin.activeTable.selection.selectionType="cell";e.tablePlugin.updateFloatingMenuScope();e._removeCursorSelection();if(e.tablePlugin.settings.summaryinsidebar){e.tablePlugin.sidebar.open();e.tablePlugin.sidebarPanel.activate(e.obj);e.tablePlugin.sidebar.correctHeight()}try{e.tablePlugin.summary.focus();t.stopPropagation();t.preventDefault()}catch(n){}return!1});o.append(this.wai)}s.append(o)}t(document).bind("mouseup",function(t){e.columnSelectionMouseUp(t)});this.obj.find("tr:first").before(s)};l.prototype.attachColumnSelectEventsToCell=function(e){var t=this;e.unbind("mousedown");e.unbind("mouseover");e.get(0).onselectstart=function(){return!1};e.bind("mousedown",function(e){t.columnSelectionMouseDown(e)});e.bind("mouseover",function(e){t.columnSelectionMouseOver(e)})};l.prototype.columnSelectionMouseDown=function(e){this.focus();this.selection.selectedCells.length==0&&(this.columnsToSelect=[]);this.clickedColumnId=t(e.currentTarget.parentNode).children().index(e.currentTarget);if(e.metaKey){var n=t.inArray(this.clickedColumnId,this.columnsToSelect);n>=0?this.columnsToSelect.splice(n,1):this.columnsToSelect.push(this.clickedColumnId)}else if(e.shiftKey){this.columnsToSelect.sort(function(e,t){return e-t});var r=this.columnsToSelect[0],n=this.clickedColumnId;if(r>n){r=n;n=this.columnsToSelect[0]}for(this.columnsToSelect=[];r<=n;r++)this.columnsToSelect.push(r)}else this.columnsToSelect=[this.clickedColumnId];this.selectColumns();e.preventDefault();e.stopPropagation();return!1};l.prototype.columnSelectionMouseOver=function(e){var t=e.currentTarget.cellIndex,e=[],n;if(this.mouseDownColIdx){n=t<this.mouseDownColIdx?t:this.mouseDownColIdx;for(t=t<this.mouseDownColIdx?this.mouseDownColIdx:t;n<=t;n++)e.push(n);this.selectColumns(e)}};l.prototype.columnSelectionMouseUp=function(){this.mouseDownColIdx=!1};l.prototype.deleteRows=function(){var e=[],n={},s=this;if(0!==this.selection.selectedCells.length){for(var o=0;o<this.selection.selectedCells.length;o++)n[this.selection.selectedCells[o].parentNode.rowIndex]=!0;for(rowId in n)e.push(rowId);n=!1;e.length==this.numRows&&(n=!0);if(n){var a=this;r.confirm({title:i.t("Table"),text:i.t("deletetable.confirm"),yes:function(){a.deleteTable()}})}else{e.sort(function(e,t){return e-t});var f=e[0];f>this.numRows-e.length&&f--;var l=this.getRows();t.each(e,function(e,t){for(var n=l[t],r=0;r<n.cells.length;r++)u.splitCell(n.cells[r],function(){return s.newActiveCell().obj})});var h=u.makeGrid(l);t.each(e,function(e,n){for(var r=h[n],i=0;i<r.length;){var s=r[i],o=u.rowspan(s.cell);1<o&&t(s.cell).attr("rowspan",o-1);i+=s.colspan}t(l[n]).remove()});this.numRows=this.numRows-e.length;window.setTimeout(function(){t(l[1].cells[f+1]).focus()},5);this.selection.unselectCells()}}};l.prototype.deleteColumns=function(){var e=[],n=this.getRows(),s=this,o,a=u.makeGrid(n);if(this.selection.selectedColumnIdxs.length==a[0].length-1)r.confirm({title:i.t("Table"),text:i.t("deletetable.confirm"),yes:function(){s.deleteTable()}});else{e.sort(function(e,t){return e-t});for(var f=this.selection.selectedColumnIdxs.sort(function(e,t){return t-e}),l=0;l<f.length;l++){for(var h=f[l],p=0;p<n.length;p++)if(o=a[p][h]){if(0===o.spannedX){if(1<o.colspan){var d=this.newActiveCell().obj;t(o.cell).after(d);d.attr("rowspan",o.rowspan);d.attr("colspan",o.colspan-1)}t(o.cell).remove()}else t(o.cell).attr("colspan",o.colspan-1);p+=o.rowspan-1}a=u.makeGrid(n)}this.numCols=this.numCols-e.length;window.setTimeout(function(){t(n[1].cells[1]).focus()},5);this.selection.unselectCells()}};l.prototype.deleteTable=function(){for(var t=-1,n=0;n<this.tablePlugin.TableRegistry.length;n++)if(this.tablePlugin.TableRegistry[n].obj.attr("id")==this.obj.attr("id")){t=n;break}if(t>=0){this.deactivate();this.selection.selectionType=void 0;this.tablePlugin.TableRegistry.splice(n,1);t=e.Selection.rangeObject;t.startContainer=t.endContainer=this.obj.get(0).parentNode;t.startOffset=t.endOffset=f.Utils.Dom.getIndexInParent(this.obj.get(0).parentNode);t.clearCaches();this.obj.remove();this.parentEditable.obj.focus();t.correctRange();t.select()}};l.prototype.addRowBeforeSelection=function(){var e=a("before",this.selection);-1!==e&&this.addRow(e)};l.prototype.addRowAfterSelection=function(){var e=a("after",this.selection);-1!==e&&this.addRow(e+1)};l.prototype.addRow=function(e){this.countVirtualCols();for(var n=this.obj.children().children("tr"),r=0;r<1;r++){var i=t("<tr>"),s=t("<td>");s.addClass(this.get("classSelectionColumn"));this.attachRowSelectionEventsToCell(s);i.append(s);s=u.makeGrid(n);if(e>=s.length)for(var o=1;o<s[0].length;o++)i.append(this.newActiveCell().obj);else for(o=1;o<s[e].length;){var a=s[e][o];if(u.containsDomCell(a))for(var f=a.colspan;f--;)i.append(this.newActiveCell().obj);else t(a.cell).attr("rowspan",a.rowspan+1);o+=a.colspan}e>=n.length?n.eq(n.length-1).after(i):n.eq(e).before(i)}this.numRows=this.numRows+1};l.prototype.addColumnsRight=function(){this.addColumns("right")};l.prototype.addColumnsLeft=function(){this.addColumns("left")};l.prototype.addColumns=function(e){var n=t("<td>"),s=this.getRows(),o,a;o=this.selection.selectedColumnIdxs;if(0!==o.length){o.sort(function(e,t){return e-t});if(u.isConsecutive(o)){if("left"===e){a=o[0];for(var f=0;f<this.selection.selectedColumnIdxs.length;f++)this.selection.selectedColumnIdxs[f]=this.selection.selectedColumnIdxs[f]+1}else a=o[o.length-1];for(var l=u.makeGrid(s),f=0;f<s.length;f++){o=n.clone();o.html(" ");if(f==0)this.attachColumnSelectEventsToCell(o);else{cellObj=this.newActiveCell(o.get(0));o=cellObj.obj}var h=u.leftDomCell(l,f,a);null==h?t(s[f]).prepend(o):"left"===e&&u.containsDomCell(l[f][a])?t(h).before(o):t(h).after(o);this.numCols++}}else r.alert({title:i.t("Table"),text:i.t("table.addColumns.nonConsecutive")})}};l.prototype.focus=function(){if(!this.hasFocus){this.parentEditable.isActive||this.parentEditable.obj.focus();this.tablePlugin.setFocusedTable(this)}};l.prototype.focusOut=function(){if(this.hasFocus){this.tablePlugin.setFocusedTable(void 0);this.selection.selectionType=void 0}};l.prototype._removeCursorSelection=function(){var n=e.getSelection();if(n&&n._nativeSelection&&n._nativeSelection._ranges.length!=0){n=n.getRangeAt(0);if(null!=n.startContainer&&0===t(n.startContainer).closest("table").length&&0!==this.selection.selectedCells.length){n=s.getContainer(this.selection.selectedCells[0]);t(n).focus()}}};l.prototype.selectColumns=function(e){for(var e=e?e:this.columnsToSelect,r=0;r<this.tablePlugin.columnMSItems.length;r++)this.tablePlugin.columnMSButton.showItem(this.tablePlugin.columnMSItems[r].name);n.setScope(this.tablePlugin.name+".column");this.tablePlugin._columnheaderButton.setState(this.selection.isHeader());r=this.getRows();this.tablePlugin.columnMSButton.setActiveItem();for(var i=0;i<this.tablePlugin.columnConfig.length;i++)if(t(r[0].cells[0]).hasClass(this.tablePlugin.columnConfig[i].cssClass)){this.tablePlugin.columnMSButton.setActiveItem(this.tablePlugin.columnConfig[i].name);i=this.tablePlugin.columnConfig.length}this.obj.find("div.aloha-ui-table-cell-editable").blur();this.selection.selectColumns(e);this.selection.notifyCellsSelected();this._removeCursorSelection()};l.prototype.selectRows=function(){for(var e=0;e<this.tablePlugin.rowMSItems.length;e++)this.tablePlugin.rowMSButton.showItem(this.tablePlugin.rowMSItems[e].name);for(e=0;e<this.rowsToSelect.length;e++){var r=this.rowsToSelect[e],r=t(this.getRows()[r].cells).toArray();if(e==0)for(var i=0;i<r.length;i++){this.tablePlugin.rowMSButton.setActiveItem();for(var s=0;s<this.tablePlugin.rowConfig.length;s++)if(t(r[i]).hasClass(this.tablePlugin.rowConfig[s].cssClass)){this.tablePlugin.rowMSButton.setActiveItem(this.tablePlugin.rowConfig[s].name);s=this.tablePlugin.rowConfig.length}}}n.setScope(this.tablePlugin.name+".row");this.selection.selectRows(this.rowsToSelect);this.tablePlugin._rowheaderButton.setState(this.selection.isHeader());this.obj.find("div.aloha-ui-table-cell-editable").blur();this.selection.notifyCellsSelected();this._removeCursorSelection()};l.prototype.deactivate=function(){var e=this.obj.parent();e.mahaloBlock&&e.mahaloBlock();this.obj.removeClass(this.get("className"));t.trim(this.obj.attr("class"))==""&&this.obj.removeAttr("class");this.obj.removeAttr("contenteditable");this.obj.parents("."+this.get("classTableWrapper")).length&&this.obj.unwrap();this.obj.find("tr."+this.get("classSelectionRow")+":first").remove();var n=this;t.each(this.obj.context.rows,function(){t(this).children("td."+n.get("classSelectionColumn")).remove()});this.obj.find("td, th").removeClass(this.get("classCellSelected"));this.obj.find("td, th").removeClass("aloha-table-cell_active");this.obj.unbind();this.obj.children("tbody").unbind();for(e=0;e<this.cells.length;e++)this.cells[e].deactivate();this.obj.find("caption div").each(function(){t(this).contents().unwrap()});this.isActive=!1};l.prototype.toString=function(){return"Table"};l.prototype.newCell=function(e){return new s(e,this)};l.prototype.newActiveCell=function(e){e=new s(e,this);e.activate();return e};l.prototype.getRows=function(){var e=this.obj.get(0).rows;return t.makeArray(e)};return l});define("table/table-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/scopes ui/button ui/toggleButton ui/dialog ui/port-helper-attribute-field ui/port-helper-multi-split i18n!table/nls/i18n i18n!aloha/nls/i18n table/table-create-layer table/table table/table-plugin-utils".split(" "),function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){function v(){var e=[],n=E;t.each(arguments,function(){e.push("."+(this==""?n:n+"-"+this))});return t.trim(e.join(" "))}function m(){var e=[],n=E;t.each(arguments,function(){e.push(this==""?n:n+"-"+this)});return t.trim(e.join(" "))}function g(e,n){var r=e.endContainer,i=e.startContainer,s=r.nodeType==3?r.length:r.childNodes.length;if(i.nodeType==3&&i.parentNode.tagName=="P"&&i.parentNode.childNodes.length==1&&/^(\s|%A0)$/.test(escape(i.data))){i.data="";e.startOffset=0;r==i&&(e.endOffset=0)}if(!b.Utils.Dom.allowsNesting(i.nodeType==3?i.parentNode:i,n)){e.startOffset==0&&t(i.nodeType==3?i.parentNode:i).addClass("aloha-table-cleanme");e.endOffset==s&&t(r.nodeType==3?r.parentNode:r).addClass("aloha-table-cleanme")}}function y(){for(var e=t(".aloha-table-cleanme").removeClass("aloha-table-cleanme"),n=0;n<e.length;n++)t.trim(t(e[n]).html())==""&&!b.Utils.Dom.isEditingHost(e[n])&&t(e[n]).remove()}var b=window.GENTICS,w=new n("table");w.createLayer=void 0;w.languages=["en","de","fr","eo","fi","ru","it","pl"];w.config=["table"];w.TableRegistry=[];w.activeTable=void 0;w.parameters={className:"aloha-table",classSelectionRow:"aloha-table-selectcolumn",classSelectionColumn:"aloha-table-selectrow",classLeftUpperCorner:"aloha-table-leftuppercorner",classTableWrapper:"aloha-table-wrapper",classCellSelected:"aloha-cell-selected",waiRed:"aloha-wai-red",waiGreen:"aloha-wai-green",selectionArea:10};w.checkConfig=function(e){if(typeof e=="object"&&e.length){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push({text:e[n].text?e[n].text:e[n].name,tooltip:e[n].tooltip?e[n].tooltip:e[n].text,iconClass:e[n].iconClass?e[n].iconClass:"aloha-icon-"+e[n].name,cssClass:e[n].cssClass?e[n].cssClass:e[n].name});e=t}else e=[];return e};w.init=function(){var n=this,r={};this.tableConfig=this.checkConfig(this.tableConfig||this.settings.tableConfig);this.columnConfig=this.checkConfig(this.columnConfig||this.settings.columnConfig);this.rowConfig=this.checkConfig(this.rowConfig||this.settings.rowConfig);this.createLayer=new p(this);e.bind("aloha-editable-created",function(e,i){var s=n.getEditableConfig(i.obj);r[i.getId()]=-1!==t.inArray("table",s);i.obj.bind("mousedown",function(){w.setFocusedTable(void 0)});i.obj.find("table").each(function(){if(n.isEditableTable(this)&&!w.isWithinTable(this)){var e=new d(this,w);e.parentEditable=i;w.TableRegistry.push(e)}w.checkForNestedTables(i.obj)})});this.initTableButtons();e.bind("aloha-table-selection-changed",function(){null!=w.activeTable&&0!==w.activeTable.selection.selectedCells.length&&w.updateFloatingMenuScope();if(typeof w.activeTable!="undefined"&&w.activeTable.selection){if(w.activeTable.selection.cellsAreSplitable()){n._splitcellsButton.enable(!0);n._splitcellsRowButton.enable(!0);n._splitcellsColumnButton.enable(!0)}else{n._splitcellsButton.enable(!1);n._splitcellsRowButton.enable(!1);n._splitcellsColumnButton.enable(!1)}if(w.activeTable.selection.cellsAreMergeable()){n._mergecellsButton.enable(!0);n._mergecellsRowButton.enable(!0);n._mergecellsColumnButton.enable(!0)}else{n._mergecellsButton.enable(!1);n._mergecellsRowButton.enable(!1);n._mergecellsColumnButton.enable(!1)}}});e.bind("aloha-selection-changed",function(t,i){if(i.startContainer&&e.activeEditable){r[e.activeEditable.getId()]&&e.Selection.mayInsertTag("table")?n._createTableButton.show():n._createTableButton.hide();if(n.activeTable)if(i.findMarkup(function(){return this.nodeName==="TABLE"},e.activeEditable.obj))w.updateFloatingMenuScope();else{n.activeTable.selection.cellSelectionMode=!1;n.activeTable.selection.baseCellPosition=null;n.activeTable.selection.lastSelectionRange=null;n.activeTable.focusOut()}}});e.bind("aloha-editable-activated",function(e,r){n._splitcellsButton.enable(!1);n._mergecellsButton.enable(!1);n._splitcellsRowButton.enable(!1);n._mergecellsRowButton.enable(!1);n._splitcellsColumnButton.enable(!1);n._mergecellsColumnButton.enable(!1);r.editable.obj.find("table").each(function(){for(var e=w.TableRegistry,i=0;i<e.length;i++)if(e[i].obj.attr("id")==t(this).attr("id")){e[i].activate();return!0}if(n.isEditableTable(this)&&!w.isWithinTable(this)){e=new d(this,w);e.parentEditable=r.editable;e.activate();w.TableRegistry.push(e)}w.checkForNestedTables(r.editable.obj)})});e.bind("aloha-editable-deactivated",function(){w.activeTable&&w.activeTable.selection.unselectCells();w.setFocusedTable(void 0);for(var e=w.TableRegistry,t=0;t<e.length;t++)e[t].deactivate()});e.bind("aloha-smart-content-changed",function(
){e.activeEditable&&e.activeEditable.obj.find("table").each(function(){if(w.indexOfTableInRegistry(this)==-1&&!w.isWithinTable(this)){this.id=b.Utils.guid();var t=new d(this,w);t.parentEditable=e.activeEditable;w.TableRegistry.push(t);t.activate()}w.checkForNestedTables(e.activeEditable.obj)})});this.settings.summaryinsidebar&&e.ready(function(){n.initSidebar(e.Sidebar.right.show())})};var E="aloha-table";w.initSidebar=function(e){var n=this;n.sidebar=e;n.sidebarPanel=e.addPanel({id:m("sidebar-panel"),title:c.t("table.sidebar.title"),content:"",expanded:!0,activeOn:"table",onInit:function(){var e=this;this.setContent('<label class="'+m("label")+'" for="'+m("textarea")+'" >'+c.t("table.label.target")+'</label><textarea id="'+m("textarea")+'" class="'+m("textarea")+'" />');t(v("textarea")).live("keyup",function(){t(e.effective).attr("summary",t(v("textarea")).val());var r=t('div[class*="wai"]',"table#"+t(e.effective).attr("id"));r.removeClass(n.get("waiGreen"));r.removeClass(n.get("waiRed"));t(v("textarea")).val().trim()!=""?r.addClass(n.get("waiGreen")):r.addClass(n.get("waiRed"))})},onActivate:function(e){this.effective=e;t(v("textarea")).val(t(this.effective).attr("summary"))}});e.show()};w.isEditableTable=function(e){return b.Utils.Dom.isEditable(e)};w.indexOfTableInRegistry=function(e){for(var t=this.TableRegistry,n=0;n<t.length;n++)if(t[n].obj[0].id==e.id)return n;return-1};w.getTableFromRegistry=function(e){e=this.indexOfTableInRegistry(e);return e>-1?this.TableRegistry[e]:null};w.isSelectionInTable=function(){var n=e.Selection.getRangeObject(),n=t(n.commonAncestorContainer);return n.length==0?!1:n.parents(".aloha-editable table").length?!0:!1};w.preventNestedTables=function(){if(this.isSelectionInTable()){a.alert({title:c.t("Table"),text:c.t("table.createTable.nestedTablesNoSupported")});return!0}return!1};w.isWithinTable=function(e){return t(e).parents(".aloha-editable table").length>0};w.checkForNestedTables=function(e){e.find("table table")};w.initMergeSplitCellsBtns=function(){this._mergecellsButton=i.adopt("mergecells",o,{tooltip:c.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".cell",click:function(){w.activeTable&&w.activeTable.selection.mergeCells()}});this._splitcellsButton=i.adopt("splitcells",o,{tooltip:c.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".cell",click:function(){w.activeTable&&w.activeTable.selection.splitCells()}});this._mergecellsRowButton=i.adopt("mergecellsRow",o,{tooltip:c.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".row",click:function(){w.activeTable&&w.activeTable.selection.mergeCells()}});this._splitcellsRowButton=i.adopt("splitcellsRow",o,{tooltip:c.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".row",click:function(){w.activeTable&&w.activeTable.selection.splitCells()}});this._mergecellsColumnButton=i.adopt("mergecellsColumn",o,{tooltip:c.t("button.mergecells.tooltip"),icon:"aloha-icon aloha-icon-mergecells",scope:this.name+".column",click:function(){w.activeTable&&w.activeTable.selection.mergeCells()}});this._splitcellsColumnButton=i.adopt("splitcellsColumn",o,{tooltip:c.t("button.splitcells.tooltip"),icon:"aloha-icon aloha-icon-splitcells",scope:this.name+".column",click:function(){w.activeTable&&w.activeTable.selection.splitCells()}})};w.initRowsBtns=function(){var n=this;this._addrowbeforeButton=i.adopt("addrowbefore",o,{tooltip:c.t("button.addrowbefore.tooltip"),icon:"aloha-icon aloha-icon-addrowbefore",scope:this.name+".row",click:function(){n.activeTable&&n.activeTable.addRowBeforeSelection()}});this._addrowafterButton=i.adopt("addrowafter",o,{tooltip:c.t("button.addrowafter.tooltip"),icon:"aloha-icon aloha-icon-addrowafter",scope:this.name+".row",click:function(){n.activeTable&&n.activeTable.addRowAfterSelection()}});this._deleterowsButton=i.adopt("deleterows",o,{tooltip:c.t("button.delrows.tooltip"),icon:"aloha-icon aloha-icon-deleterows",scope:this.name+".row",click:function(){if(n.activeTable){var e=n.activeTable;a.confirm({title:c.t("Table"),text:c.t("deleterows.confirm"),yes:function(){e.deleteRows()}})}}});this._rowheaderButton=i.adopt("rowheader",u,{tooltip:c.t("button.rowheader.tooltip"),icon:"aloha-icon aloha-icon-rowheader",scope:this.name+".row",click:function(){if(n.activeTable){for(var r=n.activeTable.selection.selectedRowIdxs,i,s=n.activeTable.selection.isHeader(),o=!0,u=0;u<n.activeTable.selection.selectedCells.length;u++){i=n.activeTable.selection.selectedCells[u];if(!s){o=!1;break}}for(u=0;u<n.activeTable.selection.selectedCells.length;u++){i=n.activeTable.selection.selectedCells[u];i=o?e.Markup.transformDomObject(i,"td").removeAttr("scope").get(0):e.Markup.transformDomObject(i,"th").attr("scope","row").get(0);t(n.activeTable.selection.selectedCells[u]).bind("mousedown",function(){var e=t(this).children("div").eq(0);window.setTimeout(function(){e.trigger("focus")},1)})}n.activeTable.refresh();n.activeTable.selection.unselectCells();n.activeTable.selection.selectRows(r)}}});this.rowMSItems=[];t.each(this.rowConfig,function(e,r){n.rowMSItems.push({name:r.name,text:c.t(r.text),tooltip:c.t(r.tooltip),iconClass:"aloha-icon aloha-row-layout "+r.iconClass,click:function(){if(n.activeTable){for(var e=n.activeTable.selection.selectedCells,i=0;i<e.length;i++)if(t(e[i]).attr("class").indexOf(r.cssClass)>-1)t(e[i]).removeClass(r.cssClass);else{t(e[i]).addClass(r.cssClass);for(var s=0;s<n.rowConfig.length;s++)n.rowConfig[s].cssClass!=r.cssClass&&t(e[i]).removeClass(n.rowConfig[s].cssClass)}n.activeTable.selectRows()}}})});this.rowMSItems.length>0&&this.rowMSItems.push({name:"removeFormat",text:c.t("button.removeFormat.text"),tooltip:c.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(n.activeTable){for(var e=n.activeTable.selection.selectedCells,r=0;r<e.length;r++)for(var i=0;i<n.rowConfig.length;i++)t(e[r]).removeClass(n.rowConfig[i].cssClass);n.activeTable.selectRows()}}});this.rowMSButton=l({items:this.rowMSItems,name:"formatRow",hideIfEmpty:!0,scope:this.name+".row"})};w.initColumnBtns=function(){var n=this;this._addcolumnleftButton=i.adopt("addcolumnleft",o,{tooltip:c.t("button.addcolleft.tooltip"),icon:"aloha-icon aloha-icon-addcolumnleft",scope:this.name+".column",click:function(){n.activeTable&&n.activeTable.addColumnsLeft()}});this._addcolumnrightButton=i.adopt("addcolumnright",o,{tooltip:c.t("button.addcolright.tooltip"),icon:"aloha-icon aloha-icon-addcolumnright",scope:this.name+".column",click:function(){n.activeTable&&n.activeTable.addColumnsRight()}});this._deletecolumnsButton=i.adopt("deletecolumns",o,{tooltip:c.t("button.delcols.tooltip"),icon:"aloha-icon aloha-icon-deletecolumns",scope:this.name+".column",click:function(){if(n.activeTable){var e=n.activeTable;a.confirm({title:c.t("Table"),text:c.t("deletecolumns.confirm"),yes:function(){e.deleteColumns()}})}}});this._columnheaderButton=i.adopt("columnheader",u,{tooltip:c.t("button.columnheader.tooltip"),icon:"aloha-icon aloha-icon-columnheader",scope:this.name+".column",click:function(){if(n.activeTable){for(var r=n.activeTable.selection.selectedColumnIdxs,i,s=n.activeTable.selection.isHeader(),o=!0,u=0;u<n.activeTable.selection.selectedCells.length;u++){i=n.activeTable.selection.selectedCells[u];if(!s){o=!1;break}}for(u=0;u<n.activeTable.selection.selectedCells.length;u++){i=n.activeTable.selection.selectedCells[u];i=o?e.Markup.transformDomObject(i,"td").removeAttr("scope").get(0):e.Markup.transformDomObject(i,"th").attr("scope","row").get(0);t(n.activeTable.selection.selectedCells[u]).bind("mousedown",function(){var e=t(this).children("div").eq(0);window.setTimeout(function(){e.trigger("focus")},1)})}n.activeTable.refresh();n.activeTable.selection.unselectCells();n.activeTable.selection.selectColumns(r)}}});this.columnMSItems=[];t.each(this.columnConfig,function(e,r){var i={name:r.name,text:c.t(r.text),tooltip:c.t(r.tooltip),iconClass:"aloha-icon aloha-column-layout "+r.iconClass,click:function(){if(n.activeTable){for(var e=n.activeTable.selection.selectedCells,i=0;i<e.length;i++)if(t(e[i]).attr("class").indexOf(r.cssClass)>-1)t(e[i]).removeClass(r.cssClass);else{t(e[i]).addClass(r.cssClass);for(var s=0;s<n.columnConfig.length;s++)n.columnConfig[s].cssClass!=r.cssClass&&t(e[i]).removeClass(n.columnConfig[s].cssClass)}n.activeTable.selectColumns()}}};n.columnMSItems.push(i)});this.columnMSItems.length>0&&this.columnMSItems.push({name:"removeFormat",text:c.t("button.removeFormat.text"),tooltip:c.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(n.activeTable){for(var e=n.activeTable.selection.selectedCells,r=0;r<e.length;r++)for(var i=0;i<n.columnConfig.length;i++)t(e[r]).removeClass(n.columnConfig[i].cssClass);n.activeTable.selectColumns()}}});this.columnMSButton=l({items:this.columnMSItems,name:"formatColumn",hideIfEmpty:!0,scope:this.name+".column"})};w.initTableButtons=function(){var n=this;s.createScope(this.name+".row","Aloha.continuoustext");s.createScope(this.name+".column","Aloha.continuoustext");s.createScope(this.name+".cell","Aloha.continuoustext");this._createTableButton=i.adopt("createTable",o,{tooltip:c.t("button.createtable.tooltip"),icon:"aloha-icon aloha-icon-createTable",scope:"Aloha.continuoustext",click:function(){w.createDialog(this.element)}});this.initColumnBtns();this.initRowsBtns();this.initMergeSplitCellsBtns();this.tableMSItems=[];var r=this.tableConfig;t.each(r,function(e,t){n.tableMSItems.push({name:t.name,text:c.t(t.text),tooltip:c.t(t.tooltip),iconClass:"aloha-icon aloha-table-layout "+t.iconClass,click:function(){if(n.activeTable){for(var e=0;e<r.length;e++)n.activeTable.obj.removeClass(r[e].cssClass);n.activeTable.obj.addClass(t.cssClass)}}})});this.tableMSItems.length>0&&this.tableMSItems.push({name:"removeFormat",text:c.t("button.removeFormat.text"),tooltip:c.t("button.removeFormat.tooltip"),cls:"aloha-ui-multisplit-fullwidth",wide:!0,click:function(){if(n.activeTable)for(var e=0;e<r.length;e++)n.activeTable.obj.removeClass(n.tableConfig[e].cssClass)}});this.tableMSButton=l({items:this.tableMSItems,name:"formatTable",hideIfEmpty:!0,scope:this.name+".cell"});this._tableCaptionButton=i.adopt("tableCaption",u,{tooltip:c.t("button.caption.tooltip"),icon:"aloha-icon aloha-icon-table-caption",scope:this.name+".cell",click:function(){if(n.activeTable)if(n.activeTable.obj.children("caption").is("caption"))n.activeTable.obj.children("caption").remove();else{var r=c.t("empty.caption"),i=t("<caption></caption>");n.activeTable.obj.prepend(i);n.makeCaptionEditable(i,r);r=i.find("div").eq(0);i=r.contents().eq(0);if(i.length>0){var s=new b.Utils.RangeObject;s.startContainer=s.endContainer=i.get(0);s.startOffset=0;s.endOffset=i.text().length;n.activeTable.obj.find("div.aloha-table-cell-editable").blur();r.focus();s.select();e.Selection.updateSelection()}}}});this.summary=f({width:275,name:"tableSummary",noTargetHighlight:!0,scope:this.name+".cell"});this.summary.addListener("keyup",function(){n.activeTable.checkWai()})};w.makeCaptionEditable=function(e,n){var r=e.children("div");if(r.length===0){r=t("<div></div>");t(r).addClass("aloha-ui");t(r).addClass("aloha-editable-caption");e.contents().length>0?r.append(e.contents()):n&&r.text(n);e.append(r)}else if(r.length>1){e.children("div:not(:first-child)").each(function(){$this=t(this);r.eq(0).append($this.contents());$this.remove()});r=r.eq(0)}r.contentEditable(!0)};w.createDialog=function(e){this.createLayer.set("target",e);this.createLayer.show()};w.createTable=function(n,r){if(!this.preventNestedTables())if(e.activeEditable&&typeof e.activeEditable.obj!="undefined"){for(var i=document.createElement("table"),s=i.id=b.Utils.guid(),o=document.createElement("tbody"),u=0;u<r;u++){for(var a=document.createElement("tr"),f=0;f<n;f++){var l=document.createTextNode(" "),c=document.createElement("td");c.appendChild(l);a.appendChild(c)}o.appendChild(a)}i.appendChild(o);g(e.Selection.getRangeObject(),i);b.Utils.Dom.insertIntoDOM(t(i),e.Selection.getRangeObject(),e.activeEditable.obj);y();i=document.getElementById(s);if(!w.isWithinTable(i)){var h=new d(i,w);h.parentEditable=e.activeEditable;h.activate();t.browser.msie?window.setTimeout(function(){h.cells[0].wrapper.get(0).focus()},20):h.cells[0].wrapper.get(0).focus();w.TableRegistry.push(h)}w.checkForNestedTables(e.activeEditable.obj);h.focus();w.activeTable.selection.selectionType="cell";w.updateFloatingMenuScope()}else this.error("There is no active Editable where the table can be				inserted!")};w.setFocusedTable=function(e){null==e&&null!=this.activeTable&&this.activeTable.selection.unselectCells();for(var t=0;t<w.TableRegistry.length;t++)w.TableRegistry[t].hasFocus=!1;if(typeof e!="undefined"){this.summary.setTargetObject(e.obj,"summary");if(e.obj.children("caption").is("caption")){this._tableCaptionButton.setState(!0);this.makeCaptionEditable(e.obj.children("caption"))}e.hasFocus=!0}w.activeTable=e;for(t=0;t<this.tableMSItems.length;t++)this.tableMSButton.showItem(this.tableMSItems[t].name);this.tableMSButton.setActiveItem();if(this.activeTable)for(t=0;t<this.tableConfig.length;t++)this.activeTable.obj.hasClass(this.tableConfig[t].cssClass)&&this.tableMSButton.setActiveItem(this.tableConfig[t].name)};w.error=function(t){e.Log.error(this,t)};w.debug=function(t){e.Log.debug(this,t)};w.info=function(t){e.Log.info(this,t)};w.log=function(t){e.log("log",this,t)};w.get=function(e){if(this.config[e])return this.config[e];if(this.parameters[e])return this.parameters[e]};w.set=function(e,t){this.config[e]?this.config[e]=t:this.parameters[e]=t};w.makeClean=function(e){var n=this;e.find("table").each(function(){if(n.getTableFromRegistry(this)){(new d(this,n)).deactivate();t(this).attr("id",null)}})};w.toString=function(){return this.prefix};w.updateFloatingMenuScope=function(){null!=w.activeTable&&null!=w.activeTable.selection.selectionType&&s.setScope(w.name+"."+w.activeTable.selection.selectionType)};r.register(w);return w});define("format/nls/i18n",{root:{"button.strong.tooltip":"Strong","button.em.tooltip":"Emphasize","button.b.tooltip":"Bold","button.i.tooltip":"Italic","button.u.tooltip":"Underline","button.cite.tooltip":"Cite","button.q.tooltip":"","button.code.tooltip":"Code","button.abbr.tooltip":"Abbreviation","button.del.tooltip":"Strikethrough","button.s.tooltip":"Strikethrough","button.sub.tooltip":"Subscript","button.sup.tooltip":"Superscript","button.p.tooltip":"Paragraph","button.h1.tooltip":"Heading 1","button.h2.tooltip":"Heading 2","button.h3.tooltip":"Heading 3","button.h4.tooltip":"Heading 4","button.h5.tooltip":"Heading 5","button.h6.tooltip":"Heading 6","button.pre.tooltip":"Pre formated text","button.title.tooltip":"Title","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting",GENTICS_button_p:"GENTICS_button_p",GENTICS_button_h1:"GENTICS_button_h1",GENTICS_button_h2:"GENTICS_button_h2",GENTICS_button_h3:"GENTICS_button_h3",GENTICS_button_h4:"GENTICS_button_h4",GENTICS_button_h5:"GENTICS_button_h5",GENTICS_button_h6:"GENTICS_button_h6",GENTICS_button_pre:"GENTICS_button_pre",GENTICS_button_title:"GENTICS_button_title",formatBold:"Ctrl+b",formatItalic:"Ctrl+i",formatUnderline:"Ctrl+u",formatParagraph:"Alt+Ctrl+0",formatH1:"Alt+Ctrl+1",formatH2:"Alt+Ctrl+2",formatH3:"Alt+Ctrl+3",formatH4:"Alt+Ctrl+4",formatH5:"Alt+Ctrl+5",formatH6:"Alt+Ctrl+6",formatPre:"Alt+Ctrl+P",formatDel:"Ctrl+\\",formatSub:"Ctrl+,",formatSup:"Ctrl+.","floatingmenu.tab.format":"Format","format.class.legend":"CSS class","format.class.none":"none"},de:!0,eo:!0,fi:!0,fr:!0,it:!0,pl:!0,ru:!0});define("format/format-plugin","aloha aloha/plugin jquery ui/ui ui/toggleButton ui/port-helper-multi-split PubSub i18n!format/nls/i18n i18n!aloha/nls/i18n aloha/selection".split(" "),function(e,t,n,r,i,s,o,u){function a(t,r){var i=!1,s,o,u,a,f;n.each(t.buttons,function(t,n){i=!1;for(u=0;u<r.markupEffectiveAtStart.length;u++){s=r.markupEffectiveAtStart[u];if(e.Selection.standardTextLevelSemanticsComparator(s,n.markup)){n.handle.setState(!0);i=!0}}i||n.handle.setState(!1)});if(t.multiSplitItems.length>0){o=!1;for(u=0;u<r.markupEffectiveAtStart.length&&!o;u++){s=r.markupEffectiveAtStart[u];for(a=0;a<t.multiSplitItems.length&&!o;a++){f=t.multiSplitItems[a];if(f.markup&&e.Selection.standardTextLevelSemanticsComparator(s,f.markup)){t.multiSplitButton.setActiveItem(f.name);o=!0}}}o||t.multiSplitButton.setActiveItem(null)}}var f=window.GENTICS,l={b:"bold",strong:"bold",i:"italic",em:"italic",del:"strikethrough",sub:"subscript",sup:"superscript",u:"underline",s:"strikethrough"},c={strong:"strong",em:"emphasis",s:"strikethrough2"},h={u:!0,em:!0,strong:!0,b:!0,i:!0,cite:!0,q:!0,code:!0,abbr:!0,del:!0,s:!0,sub:!0,sup:!0},p={p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,pre:!0};return t.create("format",{languages:["en","de","fr","eo","fi","ru","it","pl"],config:["b","i","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],availableButtons:["u","strong","em","b","i","s","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],hotKey:{formatBold:"ctrl+b",formatItalic:"ctrl+i",formatParagraph:"alt+ctrl+0",formatH1:"alt+ctrl+1",formatH2:"alt+ctrl+2",formatH3:"alt+ctrl+3",formatH4:"alt+ctrl+4",formatH5:"alt+ctrl+5",formatH6:"alt+ctrl+6",formatPre:"ctrl+p",formatDel:"ctrl+d",formatSub:"alt+shift+s",formatSup:"ctrl+shift+s"},init:function(){var t=this;typeof this.settings.hotKey!="undefined"&&n.extend(!0,this.hotKey,this.settings.hotKey);this.initButtons();e.ready(function(){t.initSidebar(e.Sidebar.right)});e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable.obj);n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatBold,function(){t.addMarkup("b");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatItalic,function(){t.addMarkup("i");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatParagraph,function(){t.changeMarkup("p");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH1,function(){t.changeMarkup("h1");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH2,function(){t.changeMarkup("h2");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH3,function(){t.changeMarkup("h3");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH4,function(){t.changeMarkup("h4");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH5,function(){t.changeMarkup("h5");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH6,function(){t.changeMarkup("h6");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatPre,function(){t.changeMarkup("pre");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatDel,function(){t.addMarkup("del");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatSub,function(){t.addMarkup("sub");return!1});n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatSup,function(){t.addMarkup("sup");return!1})});e.bind("aloha-editable-deactivated",function(e,t){t.editable.obj.unbind("keydown.aloha.format")})},applyButtonConfig:function(e){var e=this.getEditableConfig(e),t,r;if(typeof e=="object"){var i=[];n.each(e,function(e,t){typeof e=="number"&&typeof t=="string"||i.push(e)});i.length>0&&(e=i)}this.formatOptions=e;for(t in this.buttons)this.buttons.hasOwnProperty(t)&&(n.inArray(t,e)!==-1?this.buttons[t].handle.show():this.buttons[t].handle.hide());r=this.multiSplitItems.length;for(t=0;t<r;t++)n.inArray(this.multiSplitItems[t].name,e)!==-1?this.multiSplitButton.showItem(this.multiSplitItems[t].name):this.multiSplitButton.hideItem(this.multiSplitItems[t].name)},initButtons:function(){var t=this;this.buttons={};this.multiSplitItems=[];n.each(this.availableButtons,function(s,o){var a=!1;if(typeof s!="number"&&typeof o!="string"){a=o;o=s}if(h[o]){var f=l[o];c.hasOwnProperty(o)&&(f=c[o]);f=r.adopt(f,i,{tooltip:u.t("button."+o+".tooltip"),icon:"aloha-icon aloha-icon-"+f,scope:"Aloha.continuoustext",click:function(){var e=n(".aloha-cell-selected");if(e.length>0){var r=0;e.each(function(){var e=n(this).find("div"),t=e.find(o);if(t.length>0){t.contents().unwrap();r++}e.contents().wrap("<"+o+"></"+o+">")});r===e.length&&e.find(o).contents().unwrap();return!1}t.addMarkup(o);return!1}});t.buttons[o]={handle:f,markup:n("<"+o+">",{"class":a||""})}}else p[o]?t.multiSplitItems.push({name:o,tooltip:u.t("button."+o+".tooltip"),iconClass:"aloha-icon "+u.t("aloha-large-icon-"+o),markup:n("<"+o+">"),click:function(){var r=n(".aloha-cell-selected");if(r.length>0){var i=0;r.each(function(){var e=n(this).find("div"),t=e.find(o);if(t.length>0){t.contents().unwrap();i++}e.contents().wrap("<"+o+"></"+o+">")});i===r.length&&r.find(o).contents().unwrap();return!1}t.changeMarkup(o);e.activeEditable&&n.browser.mozilla&&e.activeEditable.obj.focus();e.activeEditable&&e.trigger("aloha-format-block")}}):"removeFormat"===o?t.multiSplitItems.push({name:o,text:u.t("button."+o+".text"),tooltip:u.t("button."+o+".tooltip"),wide:!0,cls:"aloha-ui-multisplit-fullwidth",click:function(){t.removeFormat()}}):e.log("warn",this,'Button "'+o+'" is not defined')});this.multiSplitButton=s({name:"formatBlock",items:this.multiSplitItems,hideIfEmpty:!0,scope:"Aloha.continuoustext"});o.sub("aloha.selection.context-change",function(e){a(t,e.range)})},initSidebar:function(e){var t=this;t.sidebar=e;e.addPanel({id:t.nsClass("sidebar-panel-class"),title:u.t("floatingmenu.tab.format"),content:"",expanded:!0,activeOn:this.formatOptions||!1,onInit:function(){},onActivate:function(e){var r=this;r.effective=e;if(e[0]){r.format=e[0].nodeName.toLowerCase();var i=n("<div>").attr("class",t.nsClass("target-container")),s=n("<fieldset>");s.append(n("<legend>"+r.format+" "+u.t("format.class.legend")).append(n("<select>")));i.append(s);var o='<div class="'+t.nsClass("target-container")+'"><fieldset><legend>'+u.t("format.class.legend")+'</legend><select name="targetGroup" class="'+t.nsClass("radioTarget")+'"><option value="">'+u.t("format.class.none")+"</option>";t.config[r.format]&&t.config[r.format]["class"]&&n.each(t.config[r.format]["class"],function(e,t){o+='<option value="'+e+'" >'+t+"</option>"});o+="</select></fieldset></div>";r=this;this.setContent(o);n(t.nsSel("framename")).live("keyup",function(){n(r.effective).attr("target",n(this).val().replace('"',"&quot;").replace("'","&#39;"))});r=this;r.effective=e;n(t.nsSel("linkTitle")).val(n(r.effective).attr("title"))}}});e.show()},nsClass:function(){var e=[];n.each(arguments,function(){e.push(this==""?"aloha-format":"aloha-format-"+this)});return n.trim(e.join(" "))},nsSel:function(){var e=[];n.each(arguments,function(){e.push("."+(this==""?"aloha-format":"aloha-format-"+this))});return n.trim(e.join(" "))},addMarkup:function(t){var r=n("<"+t+">"),i=e.Selection.rangeObject;if(typeof t=="undefined"||t=="")return!1;if(t=i.findMarkup(function(){return this.nodeName===r[0].nodeName},e.activeEditable.obj))i.isCollapsed()?f.Utils.Dom.removeFromDOM(t,i,!0):f.Utils.Dom.removeMarkup(i,r,e.activeEditable.obj);else{i.isCollapsed()&&f.Utils.Dom.extendToWord(i);f.Utils.Dom.addMarkup(i,r)}i.select();a(this,e.Selection.getRangeObject());return!1},changeMarkup:function(t){e.Selection.changeMarkupOnSelection(n("<"+t+">"))},removeFormat:function(){var t=["u","strong","em","b","i","q","del","s","code","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","quote","blockquote"],r=e.Selection.rangeObject,i;this.settings.removeFormats&&(t=this.settings.removeFormats);if(!r.isCollapsed()){for(i=0;i<t.length;i++)f.Utils.Dom.removeMarkup(r,n("<"+t[i]+">"),e.activeEditable.obj);r.select()}},toString:function(){return"format"}})});define("list/nls/i18n",{root:{"button.createulist.tooltip":"Insert Unordered List","button.createolist.tooltip":"Insert Ordered List","button.indentlist.tooltip":"Indent List","button.outdentlist.tooltip":"Outdent List","floatingmenu.tab.list":"Lists"},de:!0,eo:!0,fi:!0,fr:!0,it:!0,ru:!0});define("list/list-plugin","aloha jquery aloha/plugin ui/ui ui/scopes ui/button ui/toggleButton i18n!list/nls/i18n i18n!aloha/nls/i18n aloha/engine PubSub".split(" "),function(e,t,n,r,s,o,u,a,f,l,c){var h=window.GENTICS,p=n.create("list",{languages:["en","de","fr","eo","fi","ru","it"],config:["ul","ol"],transformableElements:{p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ul:!0,ol:!0},init:function(){var n=this;this._orderedListButton=r.adopt("orderedList",u,{tooltip:a.t("button.createolist.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",scope:"Aloha.continuoustext",click:function(){n.transformList(!0)}});this._unorderedListButton=r.adopt("unorderedList",u,{tooltip:a.t("button.createulist.tooltip"),icon:"aloha-icon aloha-icon-unorderedlist",scope:"Aloha.continuoustext",click:function(){n.transformList(!1)}});this._indentListButton=r.adopt("indentList",o,{tooltip:a.t("button.indentlist.tooltip"),icon:"aloha-icon aloha-icon-indent",scope:"Aloha.continuoustext",click:function(){n.indentList()}});this._outdentListButton=r.adopt("outdentList",o,{tooltip:a.t("button.outdentlist.tooltip"),icon:"aloha-icon aloha-icon-outdent",scope:"Aloha.continuoustext",click:function(){n.outdentList()}});s.createScope("Aloha.List","Aloha.continuoustext");c.sub("aloha.selection.context-change",function(r){var i,s=r.range;n._outdentListButton.show(!1);n._indentListButton.show(!1);n._unorderedListButton.setState(!1);n._orderedListButton.setState(!1);for(r=0;r<s.markupEffectiveAtStart.length;r++){i=s.markupEffectiveAtStart[r];if(e.Selection.standardTagNameComparator(i,t("<ul></ul>"))){n._unorderedListButton.setState(!0);n._outdentListButton.show(!0);n._indentListButton.show(!0);break}if(e.Selection.standardTagNameComparator(i,t("<ol></ol>"))){n._orderedListButton.setState(!0);n._outdentListButton.show(!0);n._indentListButton.show(!0);break}}e.activeEditable&&n.applyButtonConfig(e.activeEditable.obj)});e.Markup.addKeyHandler(9,function(e){return n.processTab(e)})},applyButtonConfig:function(n){n=this.getEditableConfig(n);if(e.Selection.rangeObject.unmodifiableMarkupAtStart[0]){t.inArray("ul",n)!=-1&&e.Selection.canTag1WrapTag2(e.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ul")!=-1?this._unorderedListButton.show(!0):this._unorderedListButton.show(!1);t.inArray("ol",n)!=-1&&e.Selection.canTag1WrapTag2(e.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ol")!=-1?this._orderedListButton.show(!0):this._orderedListButton.show(!1)}},makeClean:function(e){e.find("li").each(function(){t(this).removeAttr("hidefocus");t(this).removeAttr("hideFocus");t(this).removeAttr("tabindex");t(this).removeAttr("tabIndex")})},processTab:function(e){return e.keyCode===9?e.shiftKey?this.outdentList():this.indentList():!0},getStartingDomObjectToTransform:function(){var t=e.Selection.rangeObject,n,r;for(n=0;n<t.markupEffectiveAtStart.length;n++){r=t.markupEffectiveAtStart[n];if(this.transformableElements[r.nodeName.toLowerCase()])return r}return!1},getNearestSelectedListItem:function(){var t=e.Selection.rangeObject,n,r;for(n=0;n<t.markupEffectiveAtStart.length;n++){r=t.markupEffectiveAtStart[n];if(h.Utils.Dom.isListElement(r))return r}return!1},transformList:function(n){var r=this.getStartingDomObjectToTransform(),i,s,o,u;this._outdentListButton.show(!0);this._indentListButton.show(!0);if(!r){e.Selection.changeMarkupOnSelection(t("<p></p>"));r=this.getStartingDomObjectToTransform();if(!r){if(e.Selection.rangeObject.startContainer.contentEditable){n=n?t("<ol></ol>"):t("<ul></ul>");s=t("<li></li>");n.append(s);o=s.get(0);r=e.getActiveEditable().obj;o.appendChild(document.createTextNode(""));r.append(n);r.focus();n=e.createRange();r=e.getSelection();n.setStart(o.firstChild,0);n.setEnd(o.firstChild,0);r.removeAllRanges();r.addRange(n);e.Selection.updateSelection()}else e.Log.error(this,"Could not transform selection into a list");return}}o=r.nodeName.toLowerCase();if(o=="ul"&&!n){n=t(r);o=n.parent();if(o.length>0&&h.Utils.Dom.isListElement(o.get(0)))if(o.get(0).nodeName.toLowerCase()==="li"){o.after(n.children());n.remove()}else n.children().unwrap();else{n=t(r);t.each(n.children("li"),function(t,n){u=e.Markup.transformDomObject(n,"p",e.Selection.rangeObject);u.after(u.children("ol,ul"));l.ensureContainerEditable(u.get(0))});n.children().unwrap()}}else if(o=="ul"&&n){e.Markup.transformDomObject(r,"ol",e.Selection.rangeObject);this.mergeAdjacentLists(t(r))}else if(o=="ol"&&!n){e.Markup.transformDomObject(r,"ul",e.Selection.rangeObject);this.mergeAdjacentLists(t(r))}else if(o=="ol"&&n){n=t(r);o=n.parent();if(o.length>0&&h.Utils.Dom.isListElement(o.get(0)))if(o.get(0).nodeName.toLowerCase()==="li"){o.after(n.children());n.remove()}else n.children().unwrap();else{n=t(r);t.each(n.children("li"),function(t,n){u=e.Markup.transformDomObject(n,"p",e.Selection.rangeObject);u.after(u.children("ol,ul"));l.ensureContainerEditable(u.get(0))});n.children().unwrap()}}else{o=e.Selection.rangeObject.getSelectedSiblings(r);n=n?t("<ol></ol>"):t("<ul></ul>");s=t("<li></li>");n.append(s);t(r).contents().appendTo(s);t(r).replaceWith(n);e.Selection.rangeObject.startContainer==r&&(e.Selection.rangeObject.startContainer=s.get(0));e.Selection.rangeObject.endContainer==r&&(e.Selection.rangeObject.endContainer=s.get(0));if(o){r=!1;for(i=0;i<o.length;++i)if(h.Utils.Dom.isBlockLevelElement(o[i])){r&&(r=!1);s=e.Markup.transformDomObject(o[i],"li",e.Selection.rangeObject);n.append(s)}else if(o[i].nodeType!=3||t.trim(o[i].data).length!==0){if(!r){r=t("<li></li>");n.append(r);s=r}r.append(o[i])}}this.mergeAdjacentLists(n);o=s.get(0);if(h.Utils.Dom.isEmpty(o)){n=e.createRange();r=e.getSelection();o.appendChild(document.createTextNode(""));n.selectNodeContents(o.lastChild);r.removeAllRanges();r.addRange(n);e.Selection.updateSelection()}}this.refreshSelection()},indentList:function(){var n=this.getNearestSelectedListItem(),r,i,s;if(n){s=t(n).prev("li");if(s.length===0)return!1;t(n).parent();i=e.Selection.rangeObject.getSelectedSiblings(n);r=t(n).parent().clone(!1).empty();r.append(n);s.append(r);if(i)for(n=0;n<i.length;++n)r.append(t(i[n]));this.mergeAdjacentLists(r,!0);this.refreshSelection();return!1}return!0},outdentList:function(){var n=this.getNearestSelectedListItem(),r,i,s,o,u;if(n){i=t(n);s=i.parent();r=s.parents("ul,ol");o=s.parent("li");if(r.length>0&&h.Utils.Dom.isListElement(r.get(0))){u=(n=e.Selection.rangeObject.getSelectedSiblings(n))&&n.length>0?t(n[n.length-1]):i;if(u.nextAll("li").length>0){r=s.clone(!1).empty();r.append(u.nextAll());u.append(r)}o.length>0?o.after(i):s.before(i);if(n&&n.length>0)for(r=n.length-1;r>=0;--r)i.after(t(n[r]));s.contents("li").length===0&&s.remove();o.length>0&&o.contents().length===0&&o.remove();this.refreshSelection()}return!1}return!0},refreshSelection:function(){e.Selection.rangeObject.update();e.Selection.rangeObject.select();e.Selection.updateSelection()},mergeAdjacentLists:function(e,n){for(var r=e.get(0),i;r.previousSibling&&r.previousSibling.nodeType===1&&this.isMergable(r.previousSibling,r,n);)r=r.previousSibling;for(e=t(r);r.nextSibling&&(r.nextSibling.nodeType===1&&this.isMergable(r.nextSibling,r,n)||r.nextSibling.nodeType===3&&t.trim(r.nextSibling.data).length===0);){i=t(r.nextSibling);r.nextSibling.nodeType==1&&i.contents().appendTo(e);i.remove()}},isMergable:function(e,t,n){return n?e.nodeName.toLowerCase()=="ul"||e.nodeName.toLowerCase()=="ol":e.nodeName==t.nodeName}});l.commands.insertorderedlist={action:function(t,n){p.transformList(!0);if(n&&e.Selection.rangeObject){n.startContainer=e.Selection.rangeObject.startContainer;n.startOffset=e.Selection.rangeObject.startOffset;n.endContainer=e.Selection.rangeObject.endContainer;n.endOffset=e.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ul></ul>")))break;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ol></ol>")))return!0}return!1}};l.commands.insertunorderedlist={action:function(t,n){p.transformList(!1);if(n&&e.Selection.rangeObject){n.startContainer=e.Selection.rangeObject.startContainer;n.startOffset=e.Selection.rangeObject.startOffset;n.endContainer=e.Selection.rangeObject.endContainer;n.endOffset=e.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ul></ul>")))return!0;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ol></ol>")))break}return!1}};l.commands.indent={action:function(t,n){p.indentList();if(n&&e.Selection
.rangeObject){n.startContainer=e.Selection.rangeObject.startContainer;n.startOffset=e.Selection.rangeObject.startOffset;n.endContainer=e.Selection.rangeObject.endContainer;n.endOffset=e.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){return!1}};l.commands.outdent={action:function(t,n){p.outdentList();if(n&&e.Selection.rangeObject){n.startContainer=e.Selection.rangeObject.startContainer;n.startOffset=e.Selection.rangeObject.startOffset;n.endContainer=e.Selection.rangeObject.endContainer;n.endOffset=e.Selection.rangeObject.endOffset}},indeterm:function(){},state:function(){return!1}};return p});define("image/nls/i18n",{root:{"size.natural":"Original size","button.addimg.tooltip":"add image ref","floatingmenu.tab.img":"Image","floatingmenu.tab.formatting":"Formatting","floatingmenu.tab.resize":"Resize","floatingmenu.tab.crop":"Crop","button.uploadimg.tooltip":"Upload img","button.uploadimg.label":"Upload","button.img.align.left.tooltip":"Left align","button.img.align.right.tooltip":"Right Align","button.img.align.none.tooltip":"No alignment","field.img.title.label":"Title","field.img.title.tooltip":"Title","field.img.src.label":"URL","field.img.src.tooltip":"Source",border:"Add Border to Image","padding.increase":"Increase Padding","padding.decrease":"Decrease Padding","size.increase":"Increase Size","size.decrease":"Decrease Size",Resize:"Resize",Crop:"Crop",Reset:"Reset",Accept:"Accept",Cancel:"Cancel",height:"Height",width:"Width","button.toggle.tooltip":"Toggle keep aspect ratio"},cz:!0,de:!0,fr:!0,ru:!0});define("image/image-floatingMenu","jquery util/class i18n!image/nls/i18n i18n!aloha/nls/i18n ui/ui ui/scopes ui/button ui/toggleButton ui/port-helper-attribute-field".split(" "),function(e,t,n,r,i,s,o,u,a){return t.extend({_constructor:function(){},init:function(e){e.floatingMenuControl=this;this.plugin=e;s.createScope(e.name,"Aloha.empty");this._addUIInsertButton();this._addUIMetaButtons();this._addUIResetButton();this._addUIAlignButtons();this._addUIMarginButtons();this._addUICropButtons();this._addUIResizeButtons();this._addUIAspectRatioToggleButton()},_addUIAspectRatioToggleButton:function(){var e=this.plugin;this._imageCnrRatioButton=i.adopt("imageCnrRatio",u,{tooltip:n.t("button.toggle.tooltip"),icon:"aloha-icon-cnr-ratio",scope:e.name,click:function(){e.toggleKeepAspectRatio()}});if(e.settings.fixedAspectRatio!==!1){this._imageCnrRatioButton.setState(!0);e.keepAspectRatio=!0}},_addUIResetButton:function(){var e=this.plugin;this._imageCnrResetButton=i.adopt("imageCnrReset",o,{tooltip:n.t("Reset"),icon:"aloha-icon-cnr-reset",scope:e.name,click:function(){e.reset()}})},_addUIInsertButton:function(){var e=this.plugin;this._insertImageButton=i.adopt("insertImage",o,{tooltip:n.t("button.addimg.tooltip"),icon:"aloha-button aloha-image-insert",scope:"Aloha.continuoustext",click:function(){e.insertImg()}})},_addUIMetaButtons:function(){var e=this.plugin;this.imgSrcField=a({label:n.t("field.img.src.label"),labelClass:"aloha-image-input-label",tooltip:n.t("field.img.src.tooltip"),name:"imageSource",scope:e.name});this.imgSrcField.setObjectTypeFilter(e.objectTypeFilter);this.imgTitleField=a({label:n.t("field.img.title.label"),labelClass:"aloha-image-input-label",tooltip:n.t("field.img.title.tooltip"),name:"imageTitle",scope:e.name});this.imgTitleField.setObjectTypeFilter()},_addUIAlignButtons:function(){var t=this.plugin;this._imageAlignLeftButton=i.adopt("imageAlignLeft",o,{tooltip:n.t("button.img.align.left.tooltip"),icon:"aloha-img aloha-image-align-left",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css("float","left")}});this._imageAlignRightButton=i.adopt("imageAlignRight",o,{tooltip:n.t("button.img.align.right.tooltip"),icon:"aloha-img aloha-image-align-right",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css("float","right")}});this._imageAlignNoneButton=i.adopt("imageAlignNone",o,{tooltip:n.t("button.img.align.none.tooltip"),icon:"aloha-img aloha-image-align-none",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css({"float":"none",display:"inline-block"})}})},_addUIMarginButtons:function(){var t=this.plugin;this._imageIncPaddingButton=i.adopt("imageIncPadding",o,{tooltip:n.t("padding.increase"),icon:"aloha-img aloha-image-padding-increase",scope:t.name,click:function(){e(t.getPluginFocus()).increase("padding")}});this._imageDecPaddingButton=i.adopt("imageDecPadding",o,{tooltip:n.t("padding.decrease"),icon:"aloha-img aloha-image-padding-decrease",scope:t.name,click:function(){e(t.getPluginFocus()).decrease("padding")}})},_addUICropButtons:function(){var e=this.plugin;s.createScope("Aloha.img",["Aloha.global"]);this._imageCropButton=i.adopt("imageCropButton",u,{tooltip:n.t("Crop"),icon:"aloha-icon-cnr-crop",scope:e.name,click:function(){this.getState()?e.crop():e.endCrop()}})},_addUIResizeButtons:function(){var e=this.plugin;this.imgResizeHeightField=a({label:n.t("height"),labelClass:"aloha-image-input-label",name:"imageResizeHeight",width:50,scope:e.name});this.imgResizeHeightField.maxValue=e.settings.maxHeight;this.imgResizeHeightField.minValue=e.settings.minHeight;this.imgResizeWidthField=a({label:n.t("width"),labelClass:"aloha-image-input-label",name:"imageResizeWidth",width:50,scope:e.name});this.imgResizeWidthField.maxValue=e.settings.maxWidth;this.imgResizeWidthField.minValue=e.settings.minWidth},setScope:function(){s.setScope(this.plugin.name)},doLayout:function(){}})});define("image/vendor/jcrop/jquery.jcrop.min",["jquery"],function(e){(function(e){e.Jcrop=function(t,n){function r(e){return""+parseInt(e)+"px"}function s(t){t=e(t).offset();return[t.left,t.top]}function o(e){return[e.pageX-q[0],e.pageY-q[1]]}function u(e,t){return function(n){if(S.aspectRatio)switch(e){case"e":n[1]=t.y+1;break;case"w":n[1]=t.y+1;break;case"n":n[0]=t.x+1;break;case"s":n[0]=t.x+1}else switch(e){case"e":n[1]=t.y2;break;case"w":n[1]=t.y2;break;case"n":n[0]=t.x2;break;case"s":n[0]=t.x2}X.setCurrent(n);V.update()}}function a(e){var t=e;J.watchKeys();return function(e){X.moveOffset([e[0]-t[0],e[1]-t[1]]);t=e;V.update()}}function l(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function c(e){return function(t){if(S.disabled||"move"==e&&!S.allowMove)return!1;R=!0;var n=o(t);q=s(T);$.setCursor("move"==e?e:e+"-resize");if("move"==e)$.activateHandlers(a(n),d);else{var n=X.getFixed(),r=l(e),i=X.getCorner(l(r));X.setPressed(X.getCorner(r));X.setCurrent(i);$.activateHandlers(u(e,n),d)}t.stopPropagation();t.preventDefault();return!1}}function p(e){return{x:parseInt(e.x*F),y:parseInt(e.y*I),x2:parseInt(e.x2*F),y2:parseInt(e.y2*I),w:parseInt(e.w*F),h:parseInt(e.h*I)}}function d(){var e=X.getFixed();e.w>S.minSelect[0]&&e.h>S.minSelect[1]?(V.enableHandles(),V.done()):V.release();$.setCursor(S.allowSelect?"crosshair":"default")}function v(e){X.setCurrent(e);V.update()}function m(){var t=e("<div></div>").addClass(S.baseClass+"-tracker");e.browser.msie&&t.css({opacity:0,backgroundColor:"white"});return t}function g(e){y([e[0]/F,e[1]/I,e[2]/F,e[3]/I])}function y(e){X.setPressed([e[0],e[1]]);X.setCurrent([e[2],e[3]]);V.update()}function b(t){"object"!=typeof t&&(t={});S=e.extend(S,t);"function"!=typeof S.onChange&&(S.onChange=function(){});"function"!=typeof S.onSelect&&(S.onSelect=function(){})}function E(e){S.allowResize?e?V.enableOnly():V.enableHandles():V.disableHandles();$.setCursor(S.allowSelect?"crosshair":"default");V.setCursor(S.allowMove?"move":"default");k.css("backgroundColor",S.bgColor);"setSelect"in S&&(g(n.setSelect),V.done(),delete S.setSelect);"trueSize"in S&&(F=S.trueSize[0]/N,I=S.trueSize[1]/C);P=S.maxSize[0]||0;H=S.maxSize[1]||0;B=S.minSize[0]||0;j=S.minSize[1]||0;"outerImage"in S&&(T.attr("src",S.outerImage),delete S.outerImage);V.refresh()}"object"!=typeof t&&(t=e(t)[0]);"object"!=typeof n&&(n={});"trackDocument"in n||(n.trackDocument=e.browser.msie?!1:!0,e.browser.msie&&"8"==e.browser.version.split(".")[0]&&(n.trackDocument=!0));"keySupport"in n||(n.keySupport=e.browser.msie?!1:!0);var S={trackDocument:!1,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,borderOpacity:.4,handleOpacity:.5,handlePad:5,handleSize:9,handleOffset:5,edgeMargin:14,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,boxWidth:0,boxHeight:0,boundary:8,animationDelay:20,swingSpeed:3,allowSelect:!0,allowMove:!0,allowResize:!0,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){}};b(n);var x=e(t),T=x.clone().removeAttr("id").css({position:"absolute"});T.width(x.width());T.height(x.height());x.after(T).hide();(function(e,t,n){var r=e.width(),i=e.height();if(r>t&&t>0){r=t;i=t/e.width()*e.height()}if(i>n&&n>0){i=n;r=n/e.height()*e.width()}F=e.width()/r;I=e.height()/i;e.width(r).height(i)})(T,S.boxWidth,S.boxHeight);var N=T.width(),C=T.height(),k=e("<div />").width(N).height(C).addClass(S.baseClass+"-holder").css({position:"relative",backgroundColor:S.bgColor}).insertAfter(x).append(T);S.addClass&&k.addClass(S.addClass);var L=e("<img />").attr("src",T.attr("src")).css("position","absolute").width(N).height(C),A=e("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}).append(L),O=e("<div />").width("100%").height("100%").css("zIndex",320),M=e("<div />").css({position:"absolute",zIndex:300}).insertBefore(T).append(A,O),_=S.boundary,D=m().width(N+2*_).height(C+2*_).css({position:"absolute",top:r(-_),left:r(-_),zIndex:290}).mousedown(function(e){if(S.disabled||!S.allowSelect)return!1;R=!0;q=s(T);V.disableHandles();if("crosshair"!=U){$.setCursor("crosshair");U="crosshair"}var t=o(e);X.setPressed(t);$.activateHandlers(v,d);J.watchKeys();V.update();e.stopPropagation();e.preventDefault();return!1}),P,H,B,j,F,I,q=s(T),R,U,z,W,X=function(){function e(){if(!S.aspectRatio){var e=o-i,t=u-s;P&&Math.abs(e)>P&&(o=e>0?i+P:i-P);H&&Math.abs(t)>H&&(u=t>0?s+H:s-H);j&&Math.abs(t)<j&&(u=t>0?s+j:s-j);B&&Math.abs(e)<B&&(o=e>0?i+B:i-B);if(i<0){o-=i;i-=i}if(s<0){u-=s;s-=s}if(o<0){i-=o;o-=o}if(u<0){s-=u;u-=u}if(o>N){e=o-N;i-=e;o-=e}if(u>C){e=u-C;s-=e;u-=e}if(i>N){e=i-C;u-=e;s-=e}if(s>C){e=s-C;u-=e;s-=e}return r(n(i,s,o,u))}var e=S.aspectRatio,t=S.minSize[0]/F,a=S.maxSize[0]/F,f=o-i,l=u-s,c=Math.abs(f),p=Math.abs(l);a==0&&(a=N*10);if(c/p<e){c=u;w=p*e;p=f<0?i-w:w+i;if(p<0){p=0;h=Math.abs((p-i)/e);c=l<0?s-h:h+s}else if(p>N){p=N;h=Math.abs((p-i)/e);c=l<0?s-h:h+s}}else{p=o;h=c/e;c=l<0?s-h:s+h;if(c<0){c=0;w=Math.abs((c-s)*e);p=f<0?i-w:w+i}else if(c>C){c=C;w=Math.abs(c-s)*e;p=f<0?i-w:w+i}}if(p>i){p-i<t?p=i+t:p-i>a&&(p=i+a);c=c>s?s+(p-i)/e:s-(p-i)/e}else if(p<i){i-p<t?p=i-t:i-p>a&&(p=i-a);c=c>s?s+(i-p)/e:s-(i-p)/e}if(p<0){i-=p;p=0}else if(p>N){i-=p-N;p=N}if(c<0){s-=c;c=0}else if(c>C){s-=c-C;c=C}return last=r(n(i,s,p,c))}function t(e){e[0]<0&&(e[0]=0);e[1]<0&&(e[1]=0);e[0]>N&&(e[0]=N);e[1]>C&&(e[1]=C);return[e[0],e[1]]}function n(e,t,n,r){var i=e,s=n,o=t,u=r;if(n<e){i=n;s=e}if(r<t){o=r;u=t}return[Math.round(i),Math.round(o),Math.round(s),Math.round(u)]}function r(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var i=0,s=0,o=0,u=0,a,f;return{flipCoords:n,setPressed:function(e){e=t(e);o=i=e[0];u=s=e[1]},setCurrent:function(e){e=t(e);a=e[0]-o;f=e[1]-u;o=e[0];u=e[1]},getOffset:function(){return[a,f]},moveOffset:function(e){var t=e[0],e=e[1];0>i+t&&(t-=t+i);0>s+e&&(e-=e+s);C<u+e&&(e+=C-(u+e));N<o+t&&(t+=N-(o+t));i+=t;o+=t;s+=e;u+=e},getCorner:function(t){var n=e();switch(t){case"ne":return[n.x2,n.y];case"nw":return[n.x,n.y];case"se":return[n.x2,n.y2];case"sw":return[n.x,n.y2]}},getFixed:e}}(),V=function(){function t(t){t=e("<div />").css({position:"absolute",opacity:S.borderOpacity}).addClass(S.baseClass+"-"+t);A.append(t);return t}function n(t,n){var r=e("<div />").mousedown(c(t)).css({cursor:t+"-resize",position:"absolute",zIndex:n});O.append(r);return r}function s(e){var t=S.handleSize,i=N,s=t;switch(e){case"n":case"s":t="100%";break;case"e":case"w":s="100%"}return n(e,b++).width(t).height(s).css({top:r(-i+1),left:r(-i+1)})}function o(e){for(i in e)E[e[i]]=n(e[i],b++).css({top:r(-N+1),left:r(-N+1),opacity:S.handleOpacity}).addClass(S.baseClass+"-handle")}function u(e){var t=Math.round(e.h/2-N),n=Math.round(e.w/2-N);west=-N+1;var i=e.w-N,e=e.h-N;"e"in E&&E.e.css({top:r(t),left:r(i)})&&E.w.css({top:r(t)})&&E.s.css({top:r(e),left:r(n)})&&E.n.css({left:r(n)});"ne"in E&&E.ne.css({left:r(i)})&&E.se.css({top:r(e),left:r(i)})&&E.sw.css({top:r(e)});"b"in E&&E.b.css({top:r(e)})&&E.r.css({left:r(i)})}function a(){var e=X.getFixed();X.setPressed([e.x,e.y]);X.setCurrent([e.x2,e.y2]);l()}function l(){if(y)return h()}function h(){var e=X.getFixed(),t=e.h;M.width(e.w).height(t);var t=e.x,n=e.y;L.css({top:r(-n),left:r(-t)});M.css({top:r(n),left:r(t)});S.drawBorders&&w.right.css({left:r(e.w-1)})&&w.bottom.css({top:r(e.h-1)});x&&u(e);if(!y){M.show();T.css("opacity",S.bgOpacity);y=!0}S.onChange(p(e))}function d(){x=!0;if(S.allowResize){u(X.getFixed());O.show();return!0}}function v(){x=!1;O.hide()}function g(e){(z=e)?v():d()}var y,b=370,w={},E={},x=!1,N=S.handleOffset;S.drawBorders&&(w={top:t("hline").css("top",e.browser.msie?r(-1):r(0)),bottom:t("hline"),left:t("vline"),right:t("vline")});if(S.dragEdges){E.t=s("n");E.b=s("s");E.r=s("e");E.l=s("w")}S.sideHandles&&o(["n","s","e","w"]);S.cornerHandles&&o(["sw","nw","ne","se"]);var C=m().mousedown(c("move")).css({cursor:"move",position:"absolute",zIndex:360});A.append(C);v();return{updateVisible:l,update:h,release:function(){v();M.hide();T.css("opacity",1);y=!1},refresh:a,setCursor:function(e){C.css("cursor",e)},enableHandles:d,enableOnly:function(){x=!0},showHandles:function(){if(x){u(X.getFixed());O.show()}},disableHandles:v,animMode:g,done:function(){g(!1);a()}}}(),$=function(){function t(e){r(o(e))}function n(u){u.preventDefault();u.stopPropagation();if(R){R=!1;i(o(u));S.onSelect(p(X.getFixed()));D.css({zIndex:290});s&&e(document).unbind("mousemove",t).unbind("mouseup",n);r=function(){};i=function(){}}return!1}var r=function(){},i=function(){},s=S.trackDocument;s||D.mousemove(t).mouseup(n).mouseout(n);T.before(D);return{activateHandlers:function(o,u){R=!0;r=o;i=u;D.css({zIndex:450});s&&e(document).mousemove(t).mouseup(n);return!1},setCursor:function(e){D.css("cursor",e)}}}(),J=function(){function t(e,t,n){if(S.allowMove){X.moveOffset([t,n]);V.updateVisible()}e.preventDefault();e.stopPropagation()}var n=e('<input type="radio" />').css({position:"absolute",left:"-30px"}).keypress(function(e){if(e.ctrlKey)return!0;var n=(W=e.shiftKey?!0:!1)?10:1;switch(e.keyCode){case 37:t(e,-n,0);break;case 39:t(e,n,0);break;case 38:t(e,0,-n);break;case 40:t(e,0,n);break;case 27:V.release();break;case 9:return!0}return nothing(e)}).blur(function(){n.hide()}),r=e("<div />").css({position:"absolute",overflow:"hidden"}).append(n);S.keySupport&&r.insertBefore(T);return{watchKeys:function(){if(S.keySupport){n.show();n.focus()}}}}();O.hide();E(!0);_={animateTo:function(e){var t=e[0]/F,n=e[1]/I,r=e[2]/F,i=e[3]/I;if(!z){var e=X.flipCoords(t,n,r,i),t=X.getFixed(),s=initcr=[t.x,t.y,t.x2,t.y2],o=S.animationDelay,u=s[0],a=s[1],r=s[2],i=s[3],f=e[0]-initcr[0],l=e[1]-initcr[1],c=e[2]-initcr[2],h=e[3]-initcr[3],p=0,d=S.swingSpeed;V.animMode(!0);var v=function(){return function(){p+=(100-p)/d;s[0]=u+p/100*f;s[1]=a+p/100*l;s[2]=r+p/100*c;s[3]=i+p/100*h;p<100?window.setTimeout(v,o):V.done();p>=99.8&&(p=100);y(s)}}();window.setTimeout(v,o)}},setSelect:g,setOptions:function(e){b(e);E()},tellSelect:function(){return p(X.getFixed())},tellScaled:function(){return X.getFixed()},disable:function(){S.disabled=!0;V.disableHandles();V.setCursor("default");$.setCursor("default")},enable:function(){S.disabled=!1;E()},cancel:function(){V.done();$.activateHandlers(null,null)},focus:J.watchKeys,getBounds:function(){return[N*F,C*I]},getWidgetSize:function(){return[N,C]},release:V.release,destroy:function(){k.remove();x.show()}};x.data("Jcrop",_);return _};e.fn.Jcrop=function(t){function n(n){var r=t.useImg||n.src,i=new Image;i.onload=function(){e.Jcrop(n,t)};i.src=r}"object"!=typeof t&&(t={});this.each(function(){if(e(this).data("Jcrop")){if("api"==t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else n(this)});return this}})(e)});define("image/vendor/mousewheel/mousewheel",["jquery"],function(e){(function(e){function t(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=0,o=0,t=e.event.fix(n);t.type="mousewheel";n.wheelDelta&&(i=n.wheelDelta/120);n.detail&&(i=-n.detail/3);o=i;void 0!==n.axis&&n.axis===n.HORIZONTAL_AXIS&&(o=0,s=-1*i);void 0!==n.wheelDeltaY&&(o=n.wheelDeltaY/120);void 0!==n.wheelDeltaX&&(s=-1*n.wheelDeltaX/120);r.unshift(t,i,s,o);return(e.event.dispatch||e.event.handle).apply(this,r)}var n=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var r=n.length;r;)e.event.fixHooks[n[--r]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(e)});define("image/image-plugin","jquery aloha/plugin image/image-floatingMenu i18n!aloha/nls/i18n i18n!image/nls/i18n jqueryui image/vendor/jcrop/jquery.jcrop.min image/vendor/mousewheel/mousewheel".split(" "),function(e,t,n,r,i){var s=e,o=window.GENTICS,u=window.Aloha;String.prototype.toInteger=String.prototype.toInteger||function(){return parseInt((""+this).replace(/px$/,"")||0,10)};String.prototype.toFloat=String.prototype.toInteger||function(){return parseFloat((""+this).replace(/px$/,"")||0,10)};Number.prototype.toInteger=Number.prototype.toInteger||String.prototype.toInteger;Number.prototype.toFloat=Number.prototype.toFloat||String.prototype.toFloat;e.extend(!0,e.fn,{increase:e.fn.increase||function(t){var n=e(this),r,i;if(!n.length)return n;r=n.css(t).toFloat();i=Math.round((r||1)*1.2);r===i&&i++;n.css(t,i);return n},decrease:e.fn.decrease||function(t){var n=e(this),r,i;if(!n.length)return n;r=n.css(t).toFloat();i=Math.round((r||0)*.8);r===i&&i>0&&i--;n.css(t,i);return n}});return t.create("image",{languages:["en","fr","de","ru","cz"],defaultSettings:{maxWidth:1600,minWidth:3,maxHeight:1200,minHeight:3,autoCorrectManualInput:!0,fixedAspectRatio:!1,autoResize:!1,ui:{oneTab:!1,insert:!0,reset:!0,aspectRatioToggle:!0,align:!0,resize:!0,meta:!0,margin:!0,crop:!0,resizable:!0,handles:"ne, se, sw, nw"},onCropped:function(e,t){u.Log.info("Default onCropped invoked",e,t)},onReset:function(e){u.Log.info("Default onReset invoked",e);return!1},onResize:function(e){u.Log.info("Default onResize invoked",e)},onResized:function(e){u.Log.info("Default onResized invoked",e)}},_onCropped:function(e,t){s("#"+this.ui.imgResizeHeightField.getInputId()).val(e.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(e.width());s("body").trigger("aloha-image-cropped",[e,t]);this.onCropped(e,t)},_onReset:function(e){s("#"+this.ui.imgResizeHeightField.getInputId()).val(e.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(e.width());s("body").trigger("aloha-image-reset",e);return this.onReset(e)},_onResize:function(e){s("#"+this.ui.imgResizeHeightField.getInputId()).val(e.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(e.width());s("body").trigger("aloha-image-resize",e);this.onResize(e)},_onResized:function(e){s("#"+this.ui.imgResizeHeightField.getInputId()).val(e.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(e.width());s("body").trigger("aloha-image-resized",e);this.onResized(e)},imageObj:null,jcAPI:null,keepAspectRatio:!1,startAspectRatio:!1,restoreProps:[],objectTypeFilter:[],init:function(){u.getPluginUrl("image");this.startAspectRatio=this.settings.fixedAspectRatio;this.config=this.defaultSettings;this.settings=e.extend(!0,this.defaultSettings,this.settings);this.initializeUI();this.bindInteractions();this.subscribeEvents()},initializeUI:function(){this.ui=new n;this.ui.init(this)},bindInteractions:function(){var t=this;if(t.settings.ui.resizable)try{document.execCommand("enableObjectResizing",!1,!1)}catch(n){u.Log.info(n,"Could not disable enableObjectResizing")}if(t.settings.ui.meta){t.ui.imgSrcField.addListener("keyup",function(){t.srcChange()});t.ui.imgSrcField.addListener("blur",function(){var n=e(t.ui.imgSrcField.getTargetObject());n.attr("src")===""&&n.remove()})}t.settings.onCropped&&typeof t.settings.onCropped=="function"&&(t.onCropped=t.settings.onCropped);t.settings.onReset&&typeof t.settings.onReset=="function"&&(t.onReset=t.settings.onReset);t.settings.onResized&&typeof t.settings.onResized=="function"&&(t.onResized=t.settings.onResized);t.settings.onResize&&typeof t.settings.onResize=="function"&&(t.onResize=this.settings.onResize)},subscribeEvents:function(){var t=this,n=this.settings;e("img").filter(n.globalselector).unbind();e("img").filter(n.globalselector).click(function(e){t.clickImage(e)});u.bind("aloha-drop-files-in-editable",function(n,r){for(var i,s=r.filesObjs.length,f;--s>=0;){f=r.filesObjs[s];if(f.file.type.match(/image\//)){t.getEditableConfig(r.editable);i=e("<img/>");i.css({"max-width":that.maxWidth,"max-height":that.maxHeight});i.attr("id",f.id);typeof f.src=="undefined"?i.attr("src",f.data):i.attr("src",f.src);o.Utils.Dom.insertIntoDOM(i,r.range,e(u.activeEditable.obj))}}});u.bind("aloha-selection-changed",function(n,r,i){if(i&&i.target&&t.settings.ui.resizable&&!e(i.target).hasClass("ui-resizable-handle")){t.endResize();t.imageObj=null;u.trigger("aloha-image-unselected")}if(u.activeEditable!==null){r=t.findImgMarkup(r);n=t.getEditableConfig(u.activeEditable.obj);if(typeof n!="undefined"){t.ui._insertImageButton.show();if(r){t.ui._insertImageButton.show();t.ui.setScope();if(t.settings.ui.meta){t.ui.imgSrcField.setTargetObject(r,"src");t.ui.imgTitleField.setTargetObject(r,"title")}t.ui.imgSrcField.foreground();t.ui.imgSrcField.focus()}else t.settings.ui.meta&&t.ui.imgSrcField.setTargetObject(null);t.ui.doLayout()}else t.ui._insertImageButton.hide()}});u.bind("aloha-editable-created",function(e,n){try{document.execCommand("enableObjectResizing",!1,!1)}catch(r){u.Log.info(r,"Could not disable enableObjectResizing")}n.obj.delegate("img","mouseup",function(e){t.clickImage(e);e.stopPropagation()})});t._subscribeToResizeFieldEvents()},autoResize:function(){var e=this.imageObj.width(),t=this.imageObj.height(),n=!1;if(e<this.settings.minWidth||e>this.settings.maxWidth||t<this.settings.minHeight||t>this.settings.maxHeight)n=!0;if(n&&e>=t){this._setNormalizedFieldValues("width");this.setSizeByFieldValue();return!0}if(n&&e<t){this._setNormalizedFieldValues("height");this.setSizeByFieldValue();return!0}return!1},toggleKeepAspectRatio:function(){this.keepAspectRatio=!this.keepAspectRatio;this.endResize();this.startAspectRatio=this.keepAspectRatio?typeof this.settings.fixedAspectRatio!="number"?this.imageObj.width()/this.imageObj.height():this.settings.fixedAspectRatio:!1;this.startResize()},_subscribeToResizeFieldEvents:function(){function e(e,t,n,i){typeof i=="undefined"&&(i=0);typeof n=="undefined"&&(n=8e3);var s=parseInt(e.val(),10);if(isNaN(s)){e.css("background-color","red");return!1}var o=s+t;if(t>=0&&o>n){if(r.settings.autoCorrectManualInput){e.val(n);return!0}e.css("background-color","red");return!1}if(t<=0&&o<i){if(r.settings.autoCorrectManualInput){e.val(i);return!0}e.css("background-color","red");return!1}e.css("background-color","");e.val(s+t);return!0}function t(t){var n=t.data.minValue,i=t.data.maxValue,o=t.data.fieldName;if(t.keyCode===8||t.keyCode===46){if(s(this).val()>=n)if(typeof r.jcAPI!="undefined"&&r.jcAPI!==null)r.setCropAreaByFieldValue();else{r._setNormalizedFieldValues(o);r.setSizeByFieldValue()}}else if(t.keyCode<=57&&t.keyCode>=48||t.keyCode<=105&&t.keyCode>=96){if(s(this).val()>=n)if(typeof r.jcAPI!="undefined"&&r.jcAPI!==null)r.setCropAreaByFieldValue();else{r._setNormalizedFieldValues(o);r.setSizeByFieldValue()}}else{var u=0;if(t.keyCode===38||t.keyCode===107)u=1;else if(t.keyCode===40||t.keyCode===109)u=-1;if(t.shiftKey||t.metaKey||t.ctrlKey)u*=10;if(e(s(this),u,i,n))if(typeof r.jcAPI!="undefined"&&r.jcAPI!==null)r.setCropAreaByFieldValue();else{r._setNormalizedFieldValues(o);r.setSizeByFieldValue()}}t.preventDefault();return!1}function n(t,n){var i=t.data.minValue,o=t.data.maxValue,u=t.data.fieldName;if(t.shiftKey||t.metaKey||t.ctrlKey)n*=10;if(e(s(this),n,o,i))if(typeof r.jcAPI!="undefined"&&r.jcAPI!==null)r.setCropAreaByFieldValue();else{r._setNormalizedFieldValues(u);r.setSizeByFieldValue()}return!1}var r=this,i=s("#"+r.ui.imgResizeHeightField.getInputId()),o={fieldName:"height",maxValue:r.ui.imgResizeHeightField.maxValue,minValue:r.ui.imgResizeHeightField.minValue};i.live("keyup",o,t);i.live("mousewheel",o,n);i=s("#"+r.ui.imgResizeWidthField.getInputId());o={fieldName:"width",maxValue:r.ui.imgResizeWidthField.maxValue,minValue:r.ui.imgResizeWidthField.minValue};i.live("keyup",o,t);i.live("mousewheel",o,n)},_setNormalizedFieldValues:function(t){var n=e("#"+this.ui.imgResizeWidthField.getInputId()),r=e("#"+this.ui.imgResizeHeightField.getInputId()),i=n.val(),s=r.val(),t=this._normalizeSize(i,s,t);n.val(t.width);r.val(t.height)},setSize:function(e,t){this.imageObj.width(e);this.imageObj.height(t);var n=this.imageObj.closest(".Aloha_Image_Resize");n.height(t);n.width(e);this._onResize(this.imageObj);this._onResized(this.imageObj)},clickImage:function(t){this.endResize();var n=this.imageObj=e(t.target);if(!n.hasClass("aloha-ui")){this.ui.setScope();n.closest(".aloha-editable");this.restoreProps.push({obj:t.srcElement,src:this.imageObj.attr("src"),width:this.imageObj.width(),height:this.imageObj.height()});s("#"+this.ui.imgResizeHeightField.getInputId()).val(this.imageObj.height());s("#"+this.ui.imgResizeWidthField.getInputId()).val(this.imageObj.width());if(this.settings.ui.meta){this.ui.imgSrcField.setTargetObject(this.imageObj,"src");this.ui.imgTitleField.setTargetObject(this.imageObj,"title")}u.Selection.preventSelectionChanged();try{this.ui.imgSrcField.focus()}catch(r){}this.settings.ui.resizable&&this.startResize();this.settings.autoResize&&this.autoResize();u.Selection.preventSelectionChangedFlag=!1;u.trigger("aloha-image-selected")}},findImgMarkup:function(t){var n,r;typeof t=="undefined"&&(t=u.Selection.getRangeObject());r=e(t.startContainer);try{if(u.activeEditable&&(typeof t.startContainer!="undefined"&&typeof t.startContainer.childNodes!="undefined"&&typeof t.startOffset!="undefined"&&typeof t.startContainer.childNodes[t.startOffset]!="undefined"&&t.startContainer.childNodes[t.startOffset].nodeName.toLowerCase()==="img"&&t.startOffset+1===t.endOffset||r.hasClass("Aloha_Image_Resize"))){n=r.find("img")[0];n.css||(n.css="");n.title||(n.title="");n.src||(n.src="");return n}}catch(i){u.Log.debug(i,"Error finding img markup.")}return null},getPluginFocus:function(){return this.imageObj},_normalizeSize:function(e,t,n){function r(n){if(t>o.settings.maxHeight){var r={org:t,"new":o.settings.maxHeight};s("body").trigger("aloha-image-resize-outofbounds",["height","max",r]);t=o.settings.maxHeight}else if(t<o.settings.minHeight){r={org:t,"new":o.settings.minHeight};s("body").trigger("aloha-image-resize-outofbounds",["height","min",r]);t=o.settings.minHeight}if(o.keepAspectRatio){e=t*u;n&&i(!1)}}function i(n){if(e>o.settings.maxWidth){var i={org:e,"new":o.settings.maxWidth};s("body").trigger("aloha-image-resize-outofbounds",["width","max",i]);e=o.settings.maxWidth}else if(e<o.settings.minWidth){i={org:e,"new":o.settings.minWidth};s("body").trigger("aloha-image-resize-outofbounds",["width","min",i]);e=o.settings.minWidth}if(o.keepAspectRatio){t=e/u;n&&r(!1)}}var o=this,e=parseInt(e),t=parseInt(t),u=1.33333;o.keepAspectRatio&&(u=e/t);typeof o.startAspectRatio=="number"&&(u=o.startAspectRatio);n=="width"&&i(!0);n=="height"&&r(!0);return{width:Math.floor(e),height:Math.floor(t)}},setSizeByFieldValue:function(){var e=s("#"+this.ui.imgResizeWidthField.getInputId()).val(),t=s("#"+this.ui.imgResizeHeightField.getInputId()).val();this.setSize(e,t)},setCropAreaByFieldValue:function(){var e=this.jcAPI.tellSelect(),t=s("#"+this.ui.imgResizeWidthField.getInputId()).val(),t=parseInt(t,10),n=s("#"+this.ui.imgResizeHeightField.getInputId()).val(),n=parseInt(n,10);this.jcAPI.setSelect([e.x,e.y,e.x+t,e.y+n])},insertImg:function(){var t=u.Selection.getRangeObject(),n=this.getEditableConfig(u.activeEditable.obj),r=u.getPluginUrl("image");if(t.isCollapsed()){n="max-width: "+n.maxWidth+"; max-height: "+n.maxHeight;r=e('<img style="'+n+'" src="'+r+'/img/blank.jpg" title="" />');o.Utils.Dom.insertIntoDOM(r,t,e(u.activeEditable.obj))}else u.Log.error("img cannot markup a selection")},srcChange:function(){this.imageObj.attr("src",this.ui.imgSrcField.getValue())},positionCropButtons:function(){var t=e(".jcrop-tracker:first"),n=t.offset(),r=n.top,n=n.left,i=t.height(),t=t.width(),s=e("#aloha-CropNResize-btns");r===0&&n===0&&s.hide();r=parseInt(r+i+3,10);n=parseInt(n+t/2-s.width()/2+10,10);(0!=n||0!=r)&&s.offset({top:r,left:n})},initCropButtons:function(){var t=this,n;e("body").append('<div id="aloha-CropNResize-btns" display="none"><button class="cnr-crop-apply" title="'+i.t("Accept")+'"></button><button class="cnr-crop-cancel" title="'+i.t("Cancel")+'"></button></div>');n=e("#aloha-CropNResize-btns");n.find(".cnr-crop-apply").click(function(){t.acceptCrop()});n.find(".cnr-crop-cancel").click(function(){t.endCrop()});this.interval=setInterval(function(){t.positionCropButtons()},10)},destroyCropButtons:function(){e("#aloha-CropNResize-btns").remove();clearInterval(this.interval)},_disableSelection:function(e){e.find("*").attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"})},crop:function(){var t=this;t.initCropButtons();t.settings.ui.resizable&&t.endResize();t.jcAPI=e.Jcrop(t.imageObj,{onSelect:function(){t._onCropSelect();window.setTimeout(function(){t.ui.setScope()},10)}});t._disableSelection(s(".jcrop-holder"));t._disableSelection(s("#imageContainer"));t._disableSelection(s("#aloha-CropNResize-btns"));s("body").trigger("aloha-image-crop-start",[t.imageObj])},_onCropSelect:function(){e("#aloha-CropNResize-btns").fadeIn("slow");e(".jcrop-handle").mousedown(function(){e("#aloha-CropNResize-btns").hide()});e(".jcrop-tracker").mousedown(function(){e("#aloha-CropNResize-btns").hide()});if(typeof this.jcAPI!="undefined"&&this.jcAPI!==null){this.positionCropButtons();var t=this.jcAPI.tellSelect();e("#"+this.ui.imgResizeWidthField.getInputId()).val(t.w);e("#"+this.ui.imgResizeHeightField.getInputId()).val(t.h)}},endCrop:function(){if(this.jcAPI){this.jcAPI.destroy();this.jcAPI=null}this.destroyCropButtons();this.ui._imageCropButton.setState(!1);this.settings.ui.resizable&&this.startResize();this.keepAspectRatio&&(this.startAspectRatio=this.imageObj.width()/this.imageObj.height());s("body").trigger("aloha-image-crop-stop",[this.imageObj])},acceptCrop:function(){this._onCropped(this.imageObj,this.jcAPI.tellSelect());this.endCrop()},startResize:function(){var t=this,n=this.imageObj,n=this.imageObj.css({height:this.imageObj.height(),width:this.imageObj.width(),position:"relative","max-height":"","max-width":""});n.resizable({maxHeight:t.settings.maxHeight,minHeight:t.settings.minHeight,maxWidth:t.settings.maxWidth,minWidth:t.settings.minWidth,aspectRatio:t.startAspectRatio,handles:t.settings.handles,grid:t.settings.grid,resize:function(){t._onResize(t.imageObj)},stop:function(e){t._onResized(t.imageObj);this.enableCrop&&window.setTimeout(function(){t.ui.setScope();that.done(e)},10)}});n.css("display","inline-block");e(".ui-wrapper").attr("contentEditable",!1).addClass("aloha-image-box-active Aloha_Image_Resize aloha").css({position:"relative",display:"inline-block","float":t.imageObj.css("float")}).bind("resizestart",function(e){e.preventDefault()}).bind("mouseup",function(e){e.originalEvent.stopSelectionUpdate=!0})},endResize:function(){this.imageObj&&this.imageObj.closest(".aloha-editable");this.imageObj&&this.imageObj.is(":ui-resizable")&&this.imageObj.resizable("destroy").css({top:0,left:0})},resetSize:function(){var t=this,n=new Image;n.onload=function(){var r=t.getPluginFocus();t.settings.ui.resizable&&t.endResize();e(r).add(r.parent()).css({width:n.width+"px",height:n.height+"px","max-width":"","max-height":""});t.settings.ui.resizable&&t.resize()};n.src=t.getPluginFocus().attr("src")},reset:function(){this.settings.ui.crop&&this.endCrop();this.settings.ui.resizable&&this.endResize
();if(!this._onReset(this.imageObj))for(var e=0;e<this.restoreProps.length;e++)if(this.imageObj.get(0)===this.restoreProps[e].obj){this.imageObj.attr("src",this.restoreProps[e].src);this.imageObj.width(this.restoreProps[e].width);this.imageObj.height(this.restoreProps[e].height);break}}})});define("highlighteditables/highlighteditables-plugin",["aloha","jquery","aloha/plugin"],function(e,t,n){var r=window.GENTICS;return n.create("highlighteditables",{config:["highlight"],init:function(){var t=this,n;r.Utils.Position.addMouseMoveCallback(function(){var r,i;for(r=0;r<e.editables.length;r++)i=e.editables[r],n=t.getEditableConfig(i.obj),!e.activeEditable&&!i.isDisabled()&&"highlight"==n&&i.obj.addClass("aloha-editable-highlight")});r.Utils.Position.addMouseStopCallback(function(){t.fade()});e.bind("aloha-editable-activated",function(){t.fade()})},fade:function(){var n,r,i=function(){t(this).css("outline","")};for(n=0;n<e.editables.length;n++)r=e.editables[n].obj,r.hasClass("aloha-editable-highlight")&&r.css("outline",r.css("outlineColor")+" "+r.css("outlineStyle")+" 5px").removeClass("aloha-editable-highlight").animate({outlineWidth:"0px"},300,"swing",i)}})});define("dom-to-xhtml/dom-to-xhtml",["aloha","jquery","aloha/console"],function(e,t,n){function r(e){for(var n=e.attributes,r=[],i=0;i<n.length;i++){var s=n[i];if("undefined"==typeof s.specified||s.specified){var o=s.nodeName,s="style"===o?t.attr(e,o):s.nodeValue;r.push([o,s])}}e="";for(n=0;n<r.length;n++)if(i=r[n][0].toLowerCase(),o=r[n][1],(s=-1!==t.inArray(i.toLowerCase(),f))||""!==o&&null!=o)e+=" "+i+'="'+(""+(s?i:o)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")+'"';return e}function i(e){for(var t="/"+e.nodeName,e=e.nextSibling;null!=e;){if(t==e.nodeName)return!0;e=e.nextSibling}return!1}function s(e,t,n,r){for(;null!=t;){if(1===t.nodeType&&n&&"/"+e.nodeName==t.nodeName){t=t.nextSibling;break}1===t.nodeType&&i(t)?t=o(t,t.nextSibling,!0,r):(u(t,r),t=t.nextSibling)}return t}function o(e,n,i,o){var u=e.nodeName.toLowerCase();e.scopeName&&"HTML"!=e.scopeName&&-1===u.indexOf(":")&&(u=e.scopeName.toLowerCase()+":"+u);!i&&null==n&&-1!==t.inArray(u,a)?o.push("<"+u+r(e)+"/>"):(o.push("<"+u+r(e)+">"),n=s(e,n,i,o),o.push("</"+u+">"));return n}function u(e,t){1===e.nodeType?o(e,e.firstChild,i(e),t):3===e.nodeType?t.push(e.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;")):8===e.nodeType?t.push("<!--"+e.nodeValue+"-->"):n.log("Unknown node type encountered during serialization, ignoring it: type="+e.nodeType+" name="+e.nodeName+" value="+e.nodeValue)}var a="area base basefont br col frame hr img input isindex link meta param embed".split(" "),f="checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected".split(" ");return{contentsToXhtml:function(e){var t=[];s(e,e.firstChild,!1,t);return t.join("")},nodeToXhtml:function(e){var t=[];u(e,t);return t.join("")}}});define("dom-to-xhtml/dom-to-xhtml-plugin",["aloha","jquery","aloha/plugin","dom-to-xhtml/dom-to-xhtml"],function(e,t,n,r){return n.create("dom-to-xhtml",{init:function(){var n=this;e.Editable.setContentSerializer(function(e){return!n.settings.editables&&!n.settings.config?r.contentsToXhtml(e):n.settings.editables&&"dom-to-xhtml"==n.settings.editables["#"+t(e).attr("id")]?r.contentsToXhtml(e):n.settings.config&&"dom-to-xhtml"==n.settings.config&&!n.settings.editables["#"+t(e).attr("id")]?r.contentsToXhtml(e):t(e).html()})}})});define("contenthandler/wordcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){return n.createHandler({handleContent:function(e){"string"==typeof e?e=t("<div>"+e+"</div>"):e instanceof t&&(e=t("<div>").append(e));this.detectWordContent(e)&&this.transformWordContent(e);return e.html()},detectWordContent:function(e){var n=!1;e.find("*").each(function(){var e=t(this).attr("style");if(e&&0<=e.toLowerCase().indexOf("mso")||(e=t(this).attr("class"))&&0<=e.toLowerCase().indexOf("mso"))return n=!0,!1});return n},isOrderedList:function(e){return"Wingdings"==e.css("fontFamily")||"Symbol"==e.css("fontFamily")?!1:e.text().match(/^([0-9]{1,3}\.)|([0-9]{1,3}\)|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\)))$/)?!0:!1},transformListsFromWord:function(e){var n=this,r,i;i=e.find("p.MsoListParagraphCxSpFirst,p.MsoListParagraphCxSpMiddle,p.MsoListParagraphCxSpLast,p.MsoListParagraph,p span");i.each(function(){var e=t(this),n=e.css("font-family")||"",r=e.css("mso-list")||"",i=e.attr("style")||"";e.hasClass("MsoListParagraphCxSpFirst")||e.hasClass("MsoListParagraph")?e.addClass("aloha-list-element"):0<=n.indexOf("Symbol")?e.closest("p").addClass("aloha-list-element"):0<=n.indexOf("Wingdings")?e.closest("p").addClass("aloha-list-element"):""!==r?e.closest("p").addClass("aloha-list-element"):0<=i.indexOf("mso-list")&&e.closest("p").addClass("aloha-list-element")});e.find("p span span span").each(function(){var e=t(this),n;0===t.trim(e.text()).replace(/&nbsp;/g,"").length&&(n=t.trim(e.parent().parent().text()).replace(/&nbsp;/g,""),n.match(/^([0-9]{1,3}\.)|([0-9]{1,3}\))|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\))|(.)$/)&&(e.closest("p").addClass("aloha-list-element"),e.parent().parent().addClass("aloha-list-bullet")))});i="p.aloha-list-element";r=":not("+i+", font)";i=e.find(i);0<i.length&&i.each(function(){var e=t(this),i,s,o,u,a,l,h,p;e.removeClass("aloha-list-element");e.find("font").each(function(){t(this).contents().unwrap()});p=[];h=parseFloat(e.css("marginLeft"));isNaN(h)&&(h=0);l=[];a=e.nextUntil(r);u=t(e.find("span.aloha-list-bullet"));0===u.length&&(u=e.find("span").eq(0));o=n.isOrderedList(u);u.remove();s=t(o?"<ol></ol>":"<ul></ul>");l.push(s);i=t("<li></li>");s.append(i);e.contents().appendTo(i);e.replaceWith(s);a.each(function(){var e=t(this),r,a;if(!e.is("font")){e.find("font").each(function(){t(this).contents().unwrap()});r=parseFloat(e.css("marginLeft"));isNaN(r)&&(r=0);u=t(e.find("span.aloha-list-bullet"));0===u.length&&(u=e.find("span").eq(0));o=n.isOrderedList(u);u.remove();if(r>h)a=t(o?"<ol></ol>":"<ul></ul>"),s.children(":last").append(a),s=a,l.push(s),p.push(r),h=r;else if(r<h&&0<p.length){for(;0<p.length&&p[p.length-1]>r;)p.pop(),l.pop();s=l[l.length-1];h=r}i=t("<li></li>");s.append(i);e.contents().appendTo(i);e.remove()}})})},transformTitles:function(n){n.find("p.MsoTitle").each(function(){e.Markup.transformDomObject(t(this),"h1")});n.find("p.MsoSubtitle").each(function(){e.Markup.transformDomObject(t(this),"h2")})},cleanHtml:function(e){e.find("*").filter(function(){return""==t.trim(t(this).text())&&!t(this).is("td")}).contents().unwrap();e.find("span").contents().unwrap();e.find("a").each(function(){t(this).attr("href")&&t.trim(t(this).attr("href")).match(/^#(.*)$/)&&t(this).contents().unwrap()});e.find("div").contents().unwrap();e.find("*").filter(function(){return""==t.trim(t(this).text())&&!t(this).is("td")}).remove()},removeParagraphNumbering:function(e){e=e.find("h1,h2,h3,h4,h5,h6");0<e.length&&e.each(function(){var e=t(this),n=e.find("span"),e=e.find("a");n.each(function(){t.trim(t(this).text()).match(/^([\.\(]?[\d\D][\.\(]?){1,4}$/)&&t(this).remove()});e.each(function(){"undefined"==typeof t(this).attr("href")&&t(this).contents().unwrap()})})},transformToc:function(e){e.find("[class*=MsoToc]").each(function(){var e=t(this),n=e.find("span"),e=e.find("a");n.each(function(){t(this).attr("style")&&-1<t(this).attr("style").search("mso-hide")&&t(this).remove();t(this).contents().unwrap()});e.each(function(){t(this).contents().unwrap()})})},transformWordContent:function(e){this.transformToc(e);this.removeParagraphNumbering(e);this.transformListsFromWord(e);this.transformTitles(e);this.cleanHtml(e)}})});define("contenthandler/genericcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){return n.createHandler({handleContent:function(n){if(null!=n){"string"==typeof n?n=t("<div>"+n+"</div>"):n instanceof t&&(n=t("<div>").append(n));if(0<n.find(".aloha-block").length)return n.html();this.cleanLists(n);this.transformTables(n);this.removeComments(n);this.unwrapTags(n);this.removeStyles(n);this.removeNamespacedElements(n);var r=!0;e.settings&&e.settings.contentHandler&&e.settings.contentHandler.handler&&e.settings.contentHandler.handler.generic&&"undefinded"!=typeof e.settings.contentHandler.handler.generic.transformFormattings&&!e.settings.contentHandler.handler.generic.transformFormattings&&(r=!1);!0===r&&this.transformFormattings(n);return n.html()}},cleanLists:function(e){e.find("ul,ol").each(function(){t(this).contents(":not(li,ul,ol)").each(function(){t(this).remove()})})},transformTables:function(e){e.find("table").each(function(){t(this).removeAttr("border").removeAttr("cellspacing").removeAttr("cellpadding")});e.find("td").each(function(){t(this).removeAttr("width").removeAttr("height").removeAttr("valign");"<p><br></p>"===this.innerHTML.replace(/[\s\xA0]+/g,"")&&(this.innerHTML="&nbsp;");1===t(this).find("p").length&&t(this).find("p").contents().unwrap()});e.find("tr").each(function(){t(this).removeAttr("width").removeAttr("height").removeAttr("valign")});e.find("colgroup").remove()},transformFormattings:function(n){n.find("strong,em,s,u,strike").each(function(){"STRONG"===this.nodeName?e.Markup.transformDomObject(t(this),"b"):"EM"===this.nodeName?e.Markup.transformDomObject(t(this),"i"):"S"===this.nodeName||"STRIKE"==this.nodeName?e.Markup.transformDomObject(t(this),"del"):"U"===this.nodeName&&t(this).contents().unwrap()})},transformLinks:function(e){e.find("a").each(function(){"undefined"==typeof t(this).attr("href")&&t(this).contents().unwrap()})},removeComments:function(e){var n=this;e.contents().each(function(){8===this.nodeType?t(this).remove():n.removeComments(t(this))})},unwrapTags:function(n){n.find("span,font,div").not(".aloha-wai-lang").each(function(){"DIV"==this.nodeName?"<br>"===this.innerHTML?t(this).contents().unwrap():t(e.Markup.transformDomObject(t(this),"p").append("<br>")).contents().unwrap():t(this).contents().unwrap()})},removeStyles:function(e){var n=this;e.children("style").filter(function(){return"false"!==this.contentEditable}).remove();e.children().filter(function(){return"false"!==this.contentEditable}).each(function(){t(this).removeAttr("style").removeClass();n.removeStyles(t(this))})},removeNamespacedElements:function(e){e.find("*").each(function(){var e=this.prefix?this.prefix:this.scopeName?this.scopeName:void 0;if(e&&"HTML"!==e||0<=this.nodeName.indexOf(":")){var e=t(this),n=e.contents();n.length?n.unwrap():e.remove()}})}})});define("contenthandler/oembedcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){function r(e,t){var n=e.apiendpoint,r="",i=e.callbackparameter||"callback",s,n=0>=n.indexOf("?")?n+"?":n+"&";null!=e.maxWidth&&null==e.params.maxwidth&&(e.params.maxwidth=e.maxWidth);null!=e.maxHeight&&null==e.params.maxheight&&(e.params.maxheight=e.maxHeight);for(s in e.params)s!=e.callbackparameter&&null!=e.params[s]&&(r+="&"+f(s)+"="+e.params[s]);return n+="format=json&url="+f(t)+r+"&"+i+"=?"}function i(e,n,i){var s=r(i,n),i=t.extend({url:s,type:"get",dataType:"json",success:function(r){r=t.extend({},r);switch(r.type){case"photo":r.code=t.fn.oembed.getPhotoCode(n,r);break;case"video":r.code=t.fn.oembed.getVideoCode(n,r);break;case"rich":r.code=t.fn.oembed.getRichCode(n,r);break;default:r.code=t.fn.oembed.getGenericCode(n,r)}l.beforeEmbed.call(e,r);l.onEmbed.call(e,r);l.afterEmbed.call(e,r)},error:l.onError.call(e,n,i)},l.ajaxOptions||{});t.ajax(i)}function s(){c=[];var e;e=[];var n,r;if(a(l.allowedProviders))c=t.fn.oembed.providers;else{for(n=0;n<t.fn.oembed.providers.length;n++)0<=t.inArray(t.fn.oembed.providers[n].name,l.allowedProviders)&&c.push(t.fn.oembed.providers[n]);l.greedy=!1}if(!a(l.disallowedProviders)){for(n=0;n<c.length;n++)0>t.inArray(c[n].name,l.disallowedProviders)&&e.push(c[n]);c=e;l.greedy=!1}a(l.customProviders)||t.each(l.customProviders,function(e,n){n instanceof t.fn.oembed.OEmbedProvider?c.push(r):(r=new t.fn.oembed.OEmbedProvider,r.fromJSON(n)&&c.push(r))});e=o(l.defaultOEmbedProvider);1==l.greedy&&c.push(e);for(n=0;n<c.length;n++)null==c[n].apiendpoint&&(c[n].apiendpoint=e.apiendpoint)}function o(e){var n="http://oohembed.com/oohembed/";"embed.ly"==e&&(n="http://api.embed.ly/v1/api/oembed?");return new t.fn.oembed.OEmbedProvider(e,null,null,n,"callback")}function u(e){if(null==e)return null;var t,n={};for(t in e)null!=t&&(n[t.toLowerCase()]=e[t]);return n}function a(e){return"undefined"==typeof e||null==e||t.isArray(e)&&0==e.length?!0:!1}var f=window.escape;t.fn.oembed=function(e,n,r){l=t.extend(!0,t.fn.oembed.defaults,n);s();return this.each(function(){var n=t(this),s=null!=e?e:n.attr("href"),o;l.onEmbed=r?r:function(e){t.fn.oembed.insertCode(this,l.embedMethod,e)};null!=s&&(o=t.fn.oembed.getOEmbedProvider(s),null!=o?(o.params=u(l[o.name])||{},o.maxWidth=l.maxWidth,o.maxHeight=l.maxHeight,i(n,s,o)):l.onProviderNotFound.call(n,s));return n})};var l,c=[];t.fn.oembed.defaults={maxWidth:null,maxHeight:null,embedMethod:"replace",defaultOEmbedProvider:"oohembed",allowedProviders:null,disallowedProviders:null,customProviders:null,defaultProvider:null,greedy:!0,onProviderNotFound:function(){},beforeEmbed:function(){},afterEmbed:function(){},onEmbed:function(){},onError:function(){},ajaxOptions:{}};t.fn.oembed.embedCode=!1;t.fn.oembed.insertCode=function(e,n,r){if(null!=r)switch(t.fn.oembed.embedCode=r.code,n){case"auto":null!=e.attr("href")?t.fn.oembed.insertCode(e,"append",r):t.fn.oembed.insertCode(e,"replace",r);break;case"replace":e.replaceWith(r.code);break;case"fill":e.html(r.code);break;case"append":n=e.next();if(null==n||!n.hasClass("oembed-container"))n=e.after('<div class="oembed-container"></div>').next(".oembed-container"),null!=r&&null!=r.provider_name&&n.toggleClass("oembed-container-"+r.provider_name);n.html(r.code)}};t.fn.oembed.getInsertCode=function(e,t,n){if(null!=n)return n.code};t.fn.oembed.getPhotoCode=function(e,t){var n;n=t.title?t.title:"";n+=t.author_name?" - "+t.author_name:"";n+=t.provider_name?" - "+t.provider_name:"";n='<div><a href="'+e+"\" target='_blank'><img src=\""+t.url+'" alt="'+n+'"/></a></div>';t.html&&(n+="<div>"+t.html+"</div>");return n};t.fn.oembed.getVideoCode=function(e,t){return t.html};t.fn.oembed.getRichCode=function(e,t){return t.html};t.fn.oembed.getGenericCode=function(e,t){var n='<a href="'+e+'">'+(null!=t.title?t.title:e)+"</a>";t.html&&(n+="<div>"+t.html+"</div>");return n};t.fn.oembed.isProviderAvailable=function(e){return null!=(void 0)(e)};t.fn.oembed.getOEmbedProvider=function(e){for(var t=0;t<c.length;t++)if(c[t].matches(e))return c[t];return null};t.fn.oembed.OEmbedProvider=function(e,n,r,i,s){this.name=e;this.type=n;this.urlschemes=a(r)?["."]:t.isArray(r)?r:r.split(";");this.apiendpoint=i;this.callbackparameter=s;this.maxWidth=500;this.maxHeight=400;var o,u,f;this.matches=function(e){for(o=0;o<this.urlschemes.length;o++)if(f=RegExp(this.urlschemes[o],"i"),null!=e.match(f))return!0;return!1};this.fromJSON=function(e){for(u in e)this[u]="urlschemes"!=u?e[u]:a(e[u])?["."]:t.isArray(e[u])?e[u]:e[u].split(";");return!0}};t.fn.oembed.providers=[new t.fn.oembed.OEmbedProvider("youtube","video",["youtube\\.com/watch.+v=[\\w-]+&?"]),new t.fn.oembed.OEmbedProvider("flickr","photo",["flickr\\.com/photos/[-.\\w@]+/\\d+/?"],"http://flickr.com/services/oembed","jsoncallback"),new t.fn.oembed.OEmbedProvider("viddler","video",["viddler.com"]),new t.fn.oembed.OEmbedProvider("blip","video",["blip\\.tv/.+"],"http://blip.tv/oembed/"),new t.fn.oembed.OEmbedProvider("hulu","video",["hulu\\.com/watch/.*"],"http://www.hulu.com/api/oembed.json"),new t.fn.oembed.OEmbedProvider("vimeo","video",["http://www.vimeo.com/groups/.*/videos/.*","http://www.vimeo.com/.*","http://vimeo.com/groups/.*/videos/.*","http://vimeo.com/.*"],"http://vimeo.com/api/oembed.json"),new t.fn.oembed.OEmbedProvider("dailymotion","video",["dailymotion\\.com/.+"]),new t.fn.oembed.OEmbedProvider("scribd","rich",["scribd\\.com/.+"]),new t.fn.oembed.OEmbedProvider("slideshare","rich",["slideshare.net"],"http://www.slideshare.net/api/oembed/1"),new t.fn.oembed.OEmbedProvider("photobucket","photo",["photobucket\\.com/(albums|groups)/.*"],"http://photobucket.com/oembed/")];return n.createHandler({handleContent:function(e){"string"==typeof e?e=t("<div>"+e+"</div>").get(0):e instanceof t&&(e=t("<div>").append(e).get(0));e=t(e).oembed(t(e).text(),{embedMethod:"replace"});setTimeout(function(){e=t.fn.oembed.embedCode;return t("<div>").append(e).html()},500)},replaceoEmbedContent:function(){}})});ya.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i;ya.RELATIVE="__relative__";ya.prototype.clean_node=function(e){function t(e,t){var n;for(n=0;n<t.length;n++)if(t[n]==e)return n;return-1}function n(){var e=[],t={},n,r;for(n=0;n<arguments.length;n++)if(arguments[n]&&arguments[n].length)for(r=0;r<arguments[n].length;r++)t[arguments[n][r]]||(t[arguments[n][r]]=!0,e.push(arguments[n][r]));return e}function r(e){for(var i,s=0;s<this.filters.length;s++)if(!this.filters[s](e)){i=e.cloneNode(!0);this.current_element.appendChild(i);return}switch(e.nodeType){case 1:var o,u,l,c,h,p,d;o=[];s=e;c=!1;for(u=0;u<this.transformers.length;u++)if(l=this.transformers[u]({allowed_elements:this.allowed_elements,config:this.config,node:e,node_name:e.nodeName.toLowerCase(),whitelist_nodes:this.whitelist_nodes,dom:this.dom}),null!=l){if("object"!=typeof l)throw Error("transformer output must be an object or null");if(l.whitelist_nodes&&l.whitelist_nodes instanceof Array)for(c=0;c<l.whitelist_nodes.length;c++)-1==t(l.whitelist_nodes[c],this.whitelist_nodes)&&this.whitelist_nodes.push(l.whitelist_nodes[c]);c=l.whitelist?!0:!1;l.attr_whitelist&&(o=n(o,l.attr_whitelist));s=l.node?l.node:s}e=this.jQuery;e=e.browser.msie&&"7.0"===e.browser.version;l=s.nodeName.toLowerCase();u=this.current_element;if(this.allowed_elements[l]||c){this.current_element=this.dom.createElement(s.nodeName);u.appendChild(this.current_element);c=n(this.config.attributes[l],this.config.attributes.__ALL__,o);for(o=0;o<c.length;o++)if(i=c[o],h=s.attributes[i])if(p=!0,this.config.protocols[l]&&this.config.protocols[l][i]&&(p=this.config.protocols[l][i],p=(d=h.nodeValue.toLowerCase().match(ya.REGEX_PROTOCOL))?-1!=t(d[1],p):-1!=t(ya.RELATIVE,p)),p&&(!e||e&&"style"!==i))p=document.createAttribute(i),p.value=h.nodeValue,this.current_element.setAttributeNode(p);if(this.config.add_attributes[l])for(i in this.config.add_attributes[l])if(!e||e&&"style"!==i)p=document.createAttribute(i),p.value=this.config.add_attributes[l][i],this.current_element.setAttributeNode(p)}else if(-1!=t(s,this.whitelist_nodes)){for(this.current_element=s.cloneNode(!0);0<this.current_element.childNodes.length;)this.current_element.removeChild(this.current_element.firstChild);u.appendChild(this.current_element)}if(!this.config.remove_all_contents&&!this.config.remove_element_contents[l])for(o=0;o<s.childNodes.length;o++)r.call(this,s.childNodes[o]);this.current_element.normalize&&this.current_element.normalize();this.current_element=u;break;case 3:i=e.cloneNode(!1);this.current_element.appendChild(i);break;case 5:i=e.cloneNode(!1);this.current_element.appendChild(i);break;case 8:this.config.allow_comments&&(i=e.cloneNode(!1),this.current_element.appendChild(i))}}var s=this.dom.createDocumentFragment();this.current_element=s;this.whitelist_nodes=[];for(i=0;i<e.childNodes.length;i++)r.call(this,e.childNodes[i]);s.normalize&&s.normalize();return s};define("vendor/sanitize",function(){});define("contenthandler/sanitizecontenthandler","aloha/core jquery aloha/contenthandlermanager aloha/plugin aloha/console vendor/sanitize".split(" "),function(e,t,n){function r(n){var r=["restricted","basic","relaxed"],s=e.defaults.supports,s=e.settings.contentHandler.sanitize&&t.inArray(e.settings.contentHandler.sanitize,r)>-1?e.defaults.sanitize[e.settings.contentHandler.sanitize]:e.defaults.sanitize.relaxed;e.settings.contentHandler.allows&&(s=e.settings.contentHandler.allows);n&&(s=n);s.filters=[function(e){return e.contentEditable!="false"}];i=new ya(s,t)}var i;e.defaults.sanitize||(e.defaults.sanitize={});e.defaults.sanitize.restricted={elements:["b","em","i","strong","u","del","p","span","div","br"]};e.defaults.sanitize.basic={elements:["a","abbr","b","blockquote","br","cite","code","dd","del","dl","dt","em","i","li","ol","p","pre","q","small","strike","strong","sub","sup","u","ul"],attributes:{a:["href"],blockquote:["cite"],q:["cite"],abbr:["title"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};e.defaults.sanitize.relaxed={elements:["a","abbr","b","blockquote","br","caption","cite","code","col","colgroup","dd","del","dl","dt","em","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","pre","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","span","hr","object","div"],attributes:{a:["href","title","id","class","target","data-gentics-aloha-repository","data-gentics-aloha-object-id"],div:["id","class","style"],abbr:["title"],blockquote:["cite"],br:["class"],col:["span","width"],colgroup:["span","width"],img:["align","alt","height","src","title","width","class","data-caption","data-align","data-width","data-original-image"],ol:["start","type"],p:["class","style","id"],q:["cite"],table:["summary","width"],td:["abbr","axis","colspan","rowspan","width"],th:["abbr","axis","colspan","rowspan","scope","width"],ul:["type"],span:["class","style","lang","xml:lang","role"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},img:{src:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};return n.createHandler({handleContent:function(n){var s,o;if(e.activeEditable&&e.settings.contentHandler&&e.settings.contentHandler.handler&&e.settings.contentHandler.handler.sanitize){e.settings.contentHandler.handler.sanitize&&(o=e.settings.contentHandler.handler.sanitize);if(typeof o["#"+e.activeEditable.getId()]!="undefined")s=o;else for(var u=e.activeEditable.obj.attr("class").split(" "),a=0;a<u.length;a++)typeof o["."+u[a]]!="undefined"&&(s=o["."+u[a]])}(typeof i=="undefined"||typeof s!="undefined")&&r(s);typeof n=="string"?n=t("<div>"+n+"</div>").get(0):n instanceof t&&(n=t("<div>").append(n).get(0));return t("<div>").append(i.clean_node(n)).html()}})});define("contenthandler/blockelementcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){var r=function(){var e=t(this);e.filter("h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty,p:empty,pre:empty,blockquote:empty").remove();t.browser.msie&&e.filter("br.aloha-end-br").remove();t.browser.msie||e.filter("li").each(function(){var e=t(this);(!this.lastChild||"br"!==this.lastChild.nodeName.toLowerCase()||!t(this.lastChild).hasClass("aloha-end-br"))&&e.append('<br class="aloha-end-br"/>')});e.children(":not(.aloha-block)").each(r)},i=function(){var e=t(this);e.filter("h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty,p:empty,pre:empty,blockquote:empty").append("​");e.children(":not(.aloha-block)").each(i)},s=function(){var e=t(this);0<e.filter("p,h1,h2,h3,h4,h5,h6,pre,blockquote").length&&(!this.lastChild||"br"!==this.lastChild.nodeName.toLowerCase()||!t(this.lastChild).hasClass("aloha-end-br"))&&e.append('<br class="aloha-end-br"/>');e.children(":not(.aloha-block)").each(s)};return n.createHandler({handleContent:function(e,n){"string"==typeof e?e=t("<div>"+e+"</div>"):e instanceof t&&(e=t("<div>").append(e));n=n||{};"initEditable"===n.command?(e.children(":not(.aloha-block)").each(r),t.browser.msie&&7>=t.browser.version&&e.children(":not(.aloha-block)").each(i)):"getContents"===n.command&&(e.children(":not(.aloha-block)").each(s),e.find("li > br.aloha-end-br").remove());return e.html()}})});define("contenthandler/contenthandler-plugin","aloha aloha/plugin jquery aloha/contenthandlermanager contenthandler/wordcontenthandler contenthandler/genericcontenthandler contenthandler/oembedcontenthandler contenthandler/sanitizecontenthandler contenthandler/blockelementcontenthandler".split(" "),function(e,t,n,r,i,s,o,u,a){return t.create("contenthandler",{settings:{},dependencies:[],init:function(){var e={word:i,generic:s,sanitize:u,blockelement:a},t;for(t in e)e.hasOwnProperty(t)&&r.register(t,e[t])}})});define("characterpicker/nls/i18n",{root:{"button.addcharacter.tooltip":"pick special characters"},de:!0});define("characterpicker/characterpicker-plugin","aloha jquery aloha/plugin ui/ui ui/button i18n!characterpicker/nls/i18n i18n!aloha/nls/i18n".split(" "),function(e,t,n,r,i,s){function o(e){this.$node=t('<table class="aloha-character-picker-overlay" unselectable="on" role="dialog"><tbody></tbody></table>');this.$node.mousedown(function(){return!1});this.onSelectCallback=e;this.$tbody=this.$node.find("tbody");this.$node.appendTo(t("body"));this._initHideOnDocumentClick();this._initHideOnEsc();this._initCursorFocus(e);this._initEvents()}function u(t){if(e.activeEditable){e.activeEditable.obj.focus();e.execCommand("insertHTML",!1,t)}}var a={};o.prototype={show:function(e){this.$node.css(t(e).offset());this.$node.show();this.$node.find(".focused").removeClass("focused");t(this.$node.find("td")[0]).addClass("focused");this._overlayActive=!0},hide:function(){this.$node.hide();this._overlayActive=!1},setCharacters:function(e){this._createCharacterButtons(e)},_initHideOnDocumentClick:function(){var e=this;e.$node.click(function(e){e.stopPropagation()});t("body").click(function(n){e._overlayActive&&n.target!==e.$node[0]&&!t(n.target).is(".aloha-icon-characterpicker")&&!t(n.target).find(".aloha-icon-characterpicker").length&&e.hide()})},_initHideOnEsc:function(){var e=this;t(document).keyup(function(t){e.$node.css("display")==="table"&&t.keyCode===27&&e.hide()})},_initCursorFocus:function(e){var n=this,r,i,s,o,u,a={13:function(){r=n.$node.find(".focused");n.hide();e(r.text())},37:function(){r=n.$node.find(".focused");s=r.prev().addClass("focused");s.length>0&&r.removeClass("focused")},38:function(){r=n.$node.find(".focused");u=r.parent().prev();if(u.length>0){s=t(u.children()[r.index()]).addClass("focused");s.length>0&&r.removeClass("focused")}},39:function(){r=n.$node.find(".focused");i=r.next().addClass("focused");i.length>0&&r.removeClass("focused")},40:function(){r=n.$node.find(".focused");o=r.parent().next();if(o.length>0){i=t(o.children()[r.index()]).addClass("focused");i.length>0&&r.removeClass("focused")}}};t(document).keydown(function(e){e.stopPropagation();if(n.$node.css("display")==="table")if(e=a[e.keyCode]){e();return!1}})},_initEvents:function(){var t=this;e.bind("aloha-editable-deactivated",function(){t.hide()})},_createCharacterButtons:function(e){var n=this,r=document.createElement("textarea");r.innerHTML=e;for(var e=r.value,e=t.grep(e.split(" "),function(e){return e!==""}),r=["<tr>"],i=0,s;s=e[i];){0!==i&&i%15===0&&r.push("</tr><tr>");r.push('<td unselectable="on">'+s+"</td>");i++}r.push("</tr>");n.$tbody.empty().append(r.join(""));n.$node.delegate("td","mouseover",function(){t(this).addClass("mouseover")}).delegate("td","mouseout",function(){t(this).removeClass("mouseover")}).delegate("td","click",function(){n.$node.hide();var e=t(this).text();n.onSelectCallback(e)})}};return n.create("characterpicker",{_constructor:function(){this._super("characterpicker")},languages:["en"],config:"&#38; &#34; &#162; &#8364; &#163; &#165; &#169; &#174; &#8482; &#8240; &#181; &#183; &#8226; &#8230; &#8242; &#8243; &#167; &#182; &#223; &#8249; &#8250; &#171; &#187; &#8216; &#8217; &#8220; &#8221; &#8218; &#8222; &#60; &#62; &#8804; &#8805; &#8211; &#8212; &#175; &#8254; &#164; &#166; &#168; &#161; &#191; &#710; &#732; &#176; &#8722; &#177; &#247; &#8260; &#215; &#185; &#178; &#179; &#188; &#189; &#190; &#402; &#8747; &#8721; &#8734; &#8730; &#8764; &#8773; &#8776; &#8800; &#8801; &#8712; &#8713; &#8715; &#8719; &#8743; &#8744; &#172; &#8745; &#8746; &#8706; &#8704; &#8707; &#8709; &#8711; &#8727; &#8733; &#8736; &#180; &#184; &#170; &#186; &#8224; &#8225; &#192; &#193; &#194; &#195; &#196; &#197; &#198; &#199; &#200; &#201; &#202; &#203; &#204; &#205; &#206; &#207; &#208; &#209; &#210; &#211; &#212; &#213; &#214; &#216; &#338; &#352; &#217; &#218; &#219; &#220; &#221; &#376; &#222; &#224; &#225; &#226; &#227; &#228; &#229; &#230; &#231; &#232; &#233; &#234; &#235; &#236; &#237; &#238; &#239; &#240; &#241; &#242; &#243; &#244; &#245; &#246; &#248; &#339; &#353; &#249; &#250; &#251; &#252; &#253; &#254; &#255; &#913; &#914; &#915; &#916; &#917; &#918; &#919; &#920; &#921; &#922; &#923; &#924; &#925; &#926; &#927; &#928; &#929; &#931; &#932; &#933; &#934; &#935; &#936; &#937; &#945; &#946; &#947; &#948; &#949; &#950; &#951; &#952; &#953; &#954; &#955; &#956; &#957; &#958; &#959; &#960; &#961; &#962; &#963; &#964; &#965; &#966; &#967; &#968; &#969; &#8501; &#982; &#8476; &#977; &#978; &#8472; &#8465; &#8592; &#8593; &#8594; &#8595; &#8596; &#8629; &#8656; &#8657; &#8658; &#8659; &#8660; &#8756; &#8834; &#8835; &#8836; &#8838; &#8839; &#8853; &#8855; &#8869; &#8901; &#8968; &#8969; &#8970; &#8971; &#9001; &#9002; &#9674; &#9824; &#9827; &#9829; &#9830;",init:function(){function t(r){if(r<e.editables.length){n.getOverlayForEditable(e.editables[r]);setTimeout(function(){t(r+1)},100)}}var n=this;typeof e.settings.plugins!="undefined"&&typeof e.settings.plugins.characterpicker!="undefined"&&(n.settings=e.settings.plugins.characterpicker);this._characterPickerButton=r.adopt("characterPicker",i,{tooltip:s.t("button.addcharacter.tooltip"),icon:"aloha-icon-characterpicker",scope:"Aloha.continuoustext",click:function(){!1!==n.characterOverlay&&n.characterOverlay.show(this.element)}});setTimeout(function(){t(0)},100);e.bind("aloha-editable-activated",function(e,t){n.characterOverlay=n.getOverlayForEditable(t.editable);n.characterOverlay?n._characterPickerButton.show():n._characterPickerButton.hide()})},getOverlayForEditable:function(e){var e=this.getEditableConfig(e.obj),n;if(!e)return!1;t.isArray(e)&&(e=e.join(" "));n=a[e];if(!n){n=new o(u);n.setCharacters(e);a[e]=n}return n}})});define("commands/inserthtml","aloha/core jquery aloha/command aloha/selection util/dom aloha/contenthandlermanager aloha/console".split(" "),function(e,t,n,r,i,s,o){n.register("inserthtml",{action:function(n,r){function u(e){var n=t(e);if(!i.insertIntoDOM(n,r,a,!1)){n=n.contents();(i.isBlockLevelElement(e)||i.isListElement(e))&&u(t("<br/>").get(0));for(h=n.length-1;h>=0;--h)u(n[h])}}var a=t(i.getEditingHostOf(r.startContainer)),l=r.commonAncestorContainer,h,p=[],n=s.handleContent(n,{contenthandler:e.settings.contentHandler.insertHtml});if(typeof n=="string")n=t("<div>"+n+"</div>");else{if(!(n instanceof t))throw"INVALID_VALUE_ERR";n=t("<div>").append(n)}p=n.contents();i.removeRange(r);for(h=p.length-1;h>=0;--h)u(p[h]);p.length>0?r=i.setCursorAfter(p.get(p.length-1)):r.select();i.doCleanup({merge:!0,removeempty:!0},r,l);try{r.select()}catch(d){o.warn("Error:",d)}}})});define("commands/commands-plugin",["aloha/command","./inserthtml"],function(){});define("block/blockmanager","aloha jquery ui/scopes aloha/observable aloha/registry util/class util/strings util/maps".split(" "),function(e,t,n,r,i,s,o,u){var a=window.GENTICS,f=new(s.extend(r,{defaults:{"aloha-block-type":"DefaultBlock"},blockTypes:null,blocks:null,_highlightedBlocks:null,_activeBlock:null,_dragdropEnabled:!0,_constructor:function(){n.createScope("Aloha.Block");this.blockTypes=new i;this.blocks=new i;this._highlightedBlocks={}},registerEventHandlers:function(){var n=this;this._registerEventHandlersForDeactivatingAlohaBlock();this._registerEventHandlersForDeterminingCurrentlyActiveBlock();this._registerEventHandlersForBlockDeletion();this._registerEventHandlersForCutCopyPaste();e.bind("aloha-selection-changed",function(e,r){r&&t(r.getCommonAncestorContainer()).parents(".aloha-block").length>0||n._deactivateHighlightedBlocks()})},_registerEventHandlersForDeactivatingAlohaBlock:function(){var e=this;t(document).bind("click",function(n){u.isEmpty(e._highlightedBlocks)||t(n.target).closest(".aloha-ui,.aloha-block-do-not-deactivate,.aloha-block").length>0||e._deactivateHighlightedBlocks()})},_registerEventHandlersForDeterminingCurrentlyActiveBlock:function(){var e=this;this.bind("block-selection-change",function(t){e._activeBlock=t.length>0?t[0]:null})},_registerEventHandlersForBlockDeletion:function(){var n=this;e.bind("aloha-command-will-execute",function(r,i){var s=i.commandId,o=e.getSelection().getRangeCount()===0||e.getSelection().getRangeCount()===1&&e.getSelection().getRangeAt(0).endContainer===e.getSelection().getRangeAt(0).startContainer&&e.getSelection().getRangeAt(0).endContainer===t("body")[0]||e.getSelection
().getRangeCount()===1&&e.getSelection().getRangeAt(0).endContainer===e.getSelection().getRangeAt(0).startContainer&&e.getSelection().getRangeAt(0).startOffset+1===e.getSelection().getRangeAt(0).endOffset;if(n._activeBlock&&(s==="delete"||s==="forwarddelete")&&o){i.preventDefault=!0;n._activeBlock.destroy()}else if(!n._activeBlock&&(s==="delete"||s==="forwarddelete")&&e.getSelection().getRangeCount()===1&&e.getSelection().getRangeAt(0).collapsed===!1){var u;u=function(e){for(var n,r=0,i=e.length;r<i;r++){n=e[r];if(n.domobj.nodeType===1){var s=t(n.domobj);n.selection==="full"&&s.is(".aloha-block")?s.remove():u(n.children)}}};u(e.Selection.getSelectionTree())}});t(window.document).keydown(function(e){if(typeof e.srcElement!="undefined"&&typeof e.srcElement.form!="undefined")return!0;if(n._activeBlock&&(e.which===46||e.which===8)&&n._activeBlock._isInsideNestedEditable===!1){if(t.browser.msie&&parseInt(t.browser.version,10)<=8&&n._activeBlock.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")){n._activeBlock.destroy();e.preventDefault();return!1}if(n._activeBlock.shouldDestroy()){n._activeBlock.destroy();e.preventDefault();return!1}}})},_registerEventHandlersForCutCopyPaste:function(){var e=this,n=!1,r=!1,i=null;t(window.document).keydown(function(t){if(e._activeBlock&&(t.ctrlKey||t.metaKey)&&t.which===67){n=!0;e._activeBlock.$element.attr("data-aloha-block-copy-only-block","true");a.Utils.Dom.selectDomNode(e._activeBlock.$element[0])}if(e._activeBlock&&(t.ctrlKey||t.metaKey)&&t.which===88){r=!0;e._activeBlock.$element.attr("data-aloha-block-copy-only-block","true");a.Utils.Dom.selectDomNode(e._activeBlock.$element[0])}});t(window.document).keyup(function(t){if(!r&&n&&(t.which===67||t.which===18||t.which===91)){n=!1;e._activeBlock.$element.removeAttr("data-aloha-block-copy-only-block");i&&(i=null)}r&&(t.which===67||t.which===18||t.which===88)&&(r=!1)})},initializeBlockLevelDragDrop:function(){var n=this;t.each(e.editables,function(e,t){t.obj.data("block-dragdrop",n._dragdropEnabled);n.createBlockLevelSortableForEditableOrBlockCollection(t.obj)});e.bind("aloha-editable-created",function(e,t){t.obj.data("block-dragdrop",n._dragdropEnabled);n.createBlockLevelSortableForEditableOrBlockCollection(t.obj)})},createBlockLevelSortableForEditableOrBlockCollection:function(e){if(!e.hasClass("aloha-block-blocklevel-sortable")){e.addClass("aloha-block-blocklevel-sortable").sortable({revert:100,handle:".aloha-block-draghandle-blocklevel",connectWith:".aloha-block-blocklevel-sortable.aloha-block-dropzone",disabled:!this._dragdropEnabled,start:function(e,t){t.item.data("block-sort-allowed",t.item.parents(".aloha-block-dropzone").length>0)},change:function(e,t){t.item.data("block-sort-allowed",t.placeholder.parents(".aloha-block-dropzone").length>0)},stop:function(e,n){n.item.data("block-sort-allowed")||t(this).sortable("cancel");n.item.removeData("block-sort-allowed")}});e.get(0).ondragstart=function(e,t){if(!t||!t.helper||!t.helper.is(".aloha-block"))return!1}}},setDragDropState:function(e){this._dragdropEnabled=e},getDragDropState:function(){return this._dragdropEnabled},registerBlockType:function(e,t){n.createScope("Aloha.Block."+e,"Aloha.Block");this.blockTypes.register(e,t)},_blockify:function(n,r){var i,s,o;o=t(n);i=o[0].tagName.toLowerCase();if(i!=="span"&&i!=="div")e.Log.error("block/blockmanager","Blocks can only be created from <div> or <span> element. You passed "+i+".");else{i=this.getConfig(o,r);if(this.blockTypes.has(i["aloha-block-type"])){s=new(this.blockTypes.get(i["aloha-block-type"]))(o);s.$element.addClass("aloha-block-"+i["aloha-block-type"]);t.each(i,function(e,t){s._setAttribute(e,t)});this.blocks.register(s.getId(),s)}else e.Log.error("block/blockmanager","Block Type "+i["aloha-block-type"]+" not found!")}},_unblockify:function(e){(e=this.getBlock(e))&&e.unblock()},getConfig:function(e,n){var r=e.clone(!0),i=r.data(),s={};r.removeData();for(var u in i)i.hasOwnProperty(u)&&(s[o.camelCaseToDashes(u)]=i[u]);return t.extend({},this.defaults,n,s)},getBlock:function(e){if(typeof e=="object"){e=t(e);e.hasClass("aloha-block-inner")&&(e=e.parent());e=e.attr("id")}return this.blocks.get(e)},_unregisterBlock:function(e){this.blocks.unregister(typeof e=="object"?e.getId():e)},_deactivateHighlightedBlocks:function(){t.each(t.extend({},this._highlightedBlocks),function(e){(e=f.getBlock(e))&&e.deactivate()})},_getHighlightedBlocks:function(){var e={};t.each(this.blocks.getEntries(),function(t,n){n.isActive()&&(e[t]=n)});return e},_setHighlighted:function(e){this._highlightedBlocks[e.id]=!0},_setUnhighlighted:function(e){delete this._highlightedBlocks[e.id]}}));e.Block=e.Block||{};return e.Block.BlockManager=f});define("block/editormanager",["aloha/registry"],function(e){return new(e.extend({createEditor:function(e){if(!this.has(e.type))throw'Editor for type "'+e.type+'" not found.';return new(this.get(e.type))(e)}}))});define("block/sidebarattributeeditor",["jquery","block/blockmanager","aloha/sidebar","block/editormanager","util/class"],function(e,t,n,r,i){return new(i.extend({_sidebar:null,init:function(){this._sidebar=n.right.show();t.bind("block-selection-change",this._onBlockSelectionChange,this)},_onBlockSelectionChange:function(t){var n=this;this._sidebar&&e.each(t,function(){var t=this.getSchema(),i=this,s=[];t&&n._sidebar.addPanel({title:i.getTitle(),expanded:!0,onInit:function(){var n=e("<form />");n.submit(function(){return!1});e.each(t,function(e,t){var o=r.createEditor(t);o.bind("change",function(t){i.attr(e,t)});i.bind("change",function(){o.setValue(i.attr(e))});n.append(o.render());o.setValue(i.attr(e));s.push(o)});this.setContent(n)},deactivate:function(){e.each(s,function(e,t){t._deactivate()});this.isActive=!1;this.effectiveElement=null}})})}}))});define("block/block","aloha jquery block/blockmanager aloha/observable ui/scopes util/class".split(" "),function(e,t,n,r,i,s){function o(e){e=e.closest(".aloha-editable");return e.length?!!e.data("block-dragdrop"):!0}var u=window.GENTICS,r=s.extend(r,{title:null,id:null,$element:null,_currentlyRendering:!1,_initialized:!1,_isInsideNestedEditable:!1,_constructor:function(e){var n=this;this.$element=e;if(e.attr("id"))this.id=e.attr("id");else{this.id=u.Utils.guid();e.attr("id",this.id)}e.contentEditable(!1);e.addClass("aloha-block");if(this.isDraggable()){e.find("img").attr("draggable","false");e.find("a").attr("draggable","false")}this._onElementClickHandler=function(e){if(t(e.target).closest(".aloha-block").get(0)===n.$element.get(0)){n._fixScrollPositionBugsInIE();n.activate(e.target,e)}};this._connectThisBlockToDomElement(e);this._initialized=!0},_onElementClickHandler:null,_preventSelectionChangedEventHandler:function(){e.Selection.preventSelectionChanged()},_connectThisBlockToDomElement:function(e){var n=this,e=t(e);this._disconnectFromDomElement();this.$element=e;this.$element.bind("click",this._onElementClickHandler);this.$element.bind("mousedown",this._preventSelectionChangedEventHandler);this.$element.bind("focus",this._preventSelectionChangedEventHandler);this.$element.bind("dblclick",this._preventSelectionChangedEventHandler);this.init(this.$element,function(){window.setTimeout(function(){n._postProcessElementIfNeeded()},5)})},_disconnectFromDomElement:function(){if(this.$element){this.$element.unbind("click",this._onElementClickHandler);this.$element.unbind("mousedown",this._preventSelectionChangedEventHandler);this.$element.unbind("focus",this._preventSelectionChangedEventHandler);this.$element.unbind("dblclick",this._preventSelectionChangedEventHandler)}},_fixScrollPositionBugsInIE:function(){var e=t(window).scrollTop();window.setTimeout(function(){t(window).scrollTop()!==e&&t(window).scrollTop(e)},10)},init:function(e,t){t()},shouldDestroy:function(){var e=this.$element.parent().closest(".aloha-block,.aloha-editable,.aloha-block-collection");return e.hasClass("aloha-block-collection")&&this.$element[0].tagName.toLowerCase()==="div"?!0:e.hasClass("aloha-editable")},destroy:function(e){if(this.shouldDestroy()||e===!0){var t=this,r=new u.Utils.RangeObject;r.startContainer=r.endContainer=this.$element.parent()[0];r.startOffset=r.endOffset=u.Utils.Dom.getIndexInParent(this.$element[0]);n.trigger("block-delete",this);this.free();var i=this.$element[0].tagName.toLowerCase()==="span";this.$element.fadeOut("fast",function(){t.$element.remove();n.trigger("block-selection-change",[]);window.setTimeout(function(){i&&r.select()},5)})}},unblock:function(){this.deactivate();this._disconnectFromDomElement();this.$element.removeClass("aloha-block");this.$element.children(".aloha-block-handle").remove();this.free()},free:function(){n._unregisterBlock(this);this.unbindAll()},getId:function(){return this.id},getSchema:function(){return null},getTitle:function(){return this.title},isDraggable:function(){return this.$element[0].tagName.toLowerCase()==="div"&&this.$element.parents(".aloha-editable,.aloha-block,.aloha-block-collection").first().hasClass("aloha-block-collection")?!0:this.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")},activate:function(r,s){var o=[];t.each(n._getHighlightedBlocks(),function(){this.deactivate()});this.$element.attr("data-block-skip-scope")!=="true"&&i.setScope("Aloha.Block."+this.attr("aloha-block-type"));this.$element.addClass("aloha-block-active");this._highlight();o.push(this);this.$element.parents(".aloha-block").each(function(){var e=n.getBlock(this);if(e){e._highlight();o.push(e)}});if(t(r).closest(".aloha-editable,.aloha-block,.aloha-table-cell-editable").first().hasClass("aloha-block")){this._isInsideNestedEditable=!1;e.getSelection().removeAllRanges()}else{this._isInsideNestedEditable=!0;s&&e.Selection.updateSelection(s)}n.trigger("block-activate",o);n.trigger("block-selection-change",o)},deactivate:function(){var e=this,t=[this];this._unhighlight();this.$element.parents(".aloha-block").each(function(){t.push(this);e._unhighlight()});this.$element.removeClass("aloha-block-active");n.trigger("block-deactivate",t);n.trigger("block-selection-change",[])},isActive:function(){return this.$element.hasClass("aloha-block-active")},_highlight:function(){this.$element.addClass("aloha-block-highlighted");n._setHighlighted(this)},_unhighlight:function(){this.$element.removeClass("aloha-block-highlighted");n._setUnhighlighted(this)},_update:function(){var e=this;if(!this._currentlyRendering&&this._initialized){this._currentlyRendering=!0;this.update(this.$element,function(){e._postProcessElementIfNeeded()});this._currentlyRendering=!1}},update:function(e,t){t()},_postProcessElementIfNeeded:function(){this.createEditablesIfNeeded();this._checkThatNestedBlocksAreStillConsistent();this._makeNestedBlockCollectionsSortable();this.renderBlockHandlesIfNeeded();if(this.isDraggable()&&this.$element[0].tagName.toLowerCase()==="span"){this._setupDragDropForInlineElements();this._disableUglyInternetExplorerDragHandles()}else if(this.isDraggable()&&this.$element[0].tagName.toLowerCase()==="div"){this._setupDragDropForBlockElements();this._disableUglyInternetExplorerDragHandles()}this._hideDragHandlesIfDragDropDisabled();this._attachDropzoneHighlightEvents()},_checkThatNestedBlocksAreStillConsistent:function(){this.$element.find(".aloha-block").each(function(){var e=n.getBlock(this);e&&e.$element[0]!==this&&e._connectThisBlockToDomElement(this)})},_makeNestedBlockCollectionsSortable:function(){var e=this;this.$element.find(".aloha-block-collection").each(function(){var r=t(this);r.closest(".aloha-block").get(0)===e.$element.get(0)&&n.createBlockLevelSortableForEditableOrBlockCollection(r)})},_disableUglyInternetExplorerDragHandles:function(){if(t.browser.msie){this.$element.get(0).onresizestart=function(){return!1};this.$element.get(0).oncontrolselect=function(){return!1};this.$element.get(0).onmovestart=function(){return!1}}},_hideDragHandlesIfDragDropDisabled:function(){this._dd_isDragdropEnabled()||this.$element.find(".aloha-block-draghandle").each(function(){var e=t(this);o(e)||e.removeClass("aloha-block-draghandle")})},_attachDropzoneHighlightEvents:function(){var e=this;this.$element.delegate(".aloha-block-draghandle","mousedown",function(){var n=e.$element.parents(".aloha-editable").first().data("block-dropzones")||[];t.each(n,function(e,n){var r=t(n);t(r).each(function(){t(this).data("block-dragdrop")&&t(this).addClass("aloha-block-dropzone")})});t(document).one("mouseup.aloha-block-dropzone",function(){var n=e.$element.parents(".aloha-editable").first().data("block-dropzones")||[];t.each(n,function(e,n){t(n).removeClass("aloha-block-dropzone")})})})},_setupDragDropForInlineElements:function(){var e=this,n=null,r=!1,i=null,s=null,o=function(){if(n){var o=t(n);if(o.is(".aloha-block-dropInlineElementIntoEmptyBlock")){o.children().remove();o.append(i)}else if(o.is(".aloha-block-droppable-right")){o.html(o.html()+" ");o.after(i)}else{o.prev("[data-i]").length>0&&o.prev("[data-i]").html(o.prev("[data-i]").html()+" ");o.html(" "+o.html());o.before(i)}i.removeClass("ui-draggable").css({left:0,top:0});e._fixScrollPositionBugsInIE()}t(".aloha-block-dropInlineElementIntoEmptyBlock").removeClass("aloha-block-dropInlineElementIntoEmptyBlock");s.droppable("destroy");s=null;r=!0},u=[];this.$element.draggable({handle:".aloha-block-draghandle",scope:"aloha-block-inlinedragdrop",disabled:!this._dd_isDragdropEnabled(),revert:function(){return n===null||!r},revertDuration:250,stop:function(){t.browser.msie&&7===parseInt(t.browser.version,10)&&o();t.each(u,function(){e._dd_traverseDomTreeAndRemoveSpans(this)});i=null;u=[]},start:function(){r=!1;u=[];t(".aloha-editable").children("p:empty").html("&nbsp;");var a={tolerance:"pointer",addClasses:!1,scope:"aloha-block-inlinedragdrop",over:function(r,s){t.inArray(this,u)===-1&&u.push(this);var o=1===t(this).contents().length&&1===t(this).children("br.aloha-end-br").length;i=s.draggable;if(t(this).is(":empty")||o||t(this).html()==="&nbsp;"){t(this).addClass("aloha-block-dropInlineElementIntoEmptyBlock");n=this}else{e._dd_traverseDomTreeAndWrapCharactersWithSpans(this);t("span[data-i]",this).droppable({tolerance:"pointer",addClasses:!1,scope:"aloha-block-inlinedragdrop",over:function(){n&&t(n).removeClass("aloha-block-droppable");n=this;t(this).addClass("aloha-block-droppable")},out:function(){t(this).removeClass("aloha-block-droppable");n===this&&(n=null)}});t.ui.ddmanager.prepareOffsets(s.draggable.data("draggable"),r)}},out:function(){t(this).removeClass("aloha-block-dropInlineElementIntoEmptyBlock")},drop:function(){t.browser.msie&&7===parseInt(t.browser.version,10)||o()}};s=t(".aloha-editable.aloha-block-dropzone").children(":not(.aloha-block)");s.droppable(a);t(".aloha-table-cell-editable").droppable(a)}})},_dd_traverseDomTreeAndWrapCharactersWithSpans:function(e){for(var t,n=0,r=e.childNodes.length;n<r;n++){t=e.childNodes[n];if(t.nodeType===1){if(!~t.className.indexOf("aloha-block")&&t.attributes["data-i"]===void 0)this._dd_traverseDomTreeAndWrapCharactersWithSpans(t);else if(t.attributes["data-i"])break}else if(t.nodeType===3){t=this._dd_insertSpans(t);n+=t;r+=t}}},_dd_splitText:function(e){for(var e=e.split(/(?=\b)/),t=[],n=!1,r=0,i=e.length;r<i;r++)if(/[^\t\n\r ]/.test(e[r]))if(n){t.push(" "+e[r]);n=!1}else t.push(e[r]);else n=!0;n&&(t[t.length-1]=t[t.length-1]+" ");return t},_dd_insertSpans:function(e){var n=e.nodeValue;if(!/[^\t\n\r ]/.test(n))return 0;for(var r=document.createDocumentFragment(),n=this._dd_splitText(n),i=n.length,s,o,u,a=0,f=0;f<i;f++){o=n[f];if(o.length!==0){u=Math.floor(o.length/2);s=parseInt(t.browser.version,10);t.browser.msie&&(7===s||8===s)&&(u=0);if(u>0){s=document.createElement("span");s.appendChild(document.createTextNode(o.substr(0,u)));s.setAttribute("data-i",f);r.appendChild(s);a++}s=document.createElement("span");o=o.substr(u);s.appendChild(document.createTextNode(o));s.setAttribute("data-i",f);s.setAttribute("class","aloha-block-droppable-right");r.appendChild(s);a++}}e.parentNode.replaceChild(r,e);return a-1},_dd_traverseDomTreeAndRemoveSpans:function(e){var t=[],n;n=function(e){for(var r=!1,i,s,o,u=0,a=e.childNodes.length;u<a;u++){o=e.childNodes[u];if(o.nodeType===1)if(o.attributes["data-i"]!==void 0){if(!r){r=!0;i="";s=void 0}if(r){i+=o.firstChild.nodeValue;s&&t.push(s);s=o}}else{if(r){r=!1;s.parentNode.replaceChild(document.createTextNode(i),s)}~o.className.indexOf("aloha-block")||n(o)}}r&&s.parentNode.replaceChild(document.createTextNode(i),s)};n(e);for(var e=0,r=t.length;e<r;e++)t[e].parentNode.removeChild(t[e])},_dd_isDragdropEnabled:function(){return o(this.$element.parent())},_setupDragDropForBlockElements:function(){this.$element.find(".aloha-block-draghandle").addClass("aloha-block-draghandle-blocklevel")},createEditablesIfNeeded:function(){this.$element.find(".aloha-editable").aloha()},renderBlockHandlesIfNeeded:function(){this.isDraggable()&&this.$element.children(".aloha-block-draghandle").length===0&&this.$element.prepend('<span class="aloha-block-handle aloha-block-draghandle"></span>')},attr:function(n,r,i){var s=this,o=!1;if(arguments.length>=2){if(n.substr(0,12)==="aloha-block-"){e.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+n+")");return}this._getAttribute(n)!==r&&(o=!0);this._setAttribute(n,r)}else{if(typeof n!="object")return typeof n=="string"?this._getAttribute(n):this._getAttributes();t.each(n,function(t,n){if(t.substr(0,12)==="aloha-block-")e.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+t+")");else{s._getAttribute(t)!==n&&(o=!0);s._setAttribute(t,n)}})}if(o&&!i){this._update();this.trigger("change")}return null},_setAttribute:function(e,t){this.$element.attr("data-"+e.toLowerCase(),t)},_getAttribute:function(e){return this.$element.attr("data-"+e.toLowerCase())},_getAttributes:function(){var e={};t.each(this.$element[0].attributes,function(t,n){n.name.substr(0,5)==="data-"&&(e[n.name.substr(5).toLowerCase()]=n.value)});return e}}),s=r.extend({update:function(e,t){t()}}),a=r.extend({title:"Debugging",init:function(e,t){this.update(e,t)},update:function(e,n){e.css({display:"block"});var r='<table class="debug-block">';t.each(this.attr(),function(e,t){r+="<tr><th>"+e+"</th><td>"+t+"</td></tr>"});r+="</table>";e.html(r);n()}}),f=r.extend({title:"EmptyBlock",init:function(){},activate:function(){},deactivate:function(){},renderBlockHandlesIfNeeded:function(){}});return{AbstractBlock:r,DefaultBlock:s,DebugBlock:a,EmptyBlock:f}});define("block/blockcontenthandler",["jquery","aloha/contenthandlermanager","block/blockmanager"],function(e,t,n){return t.createHandler({handleContent:function(t){"string"==typeof t?t=e("<div>"+t+"</div>"):t instanceof e&&(t=e("<div>").append(t));0<t.find('.aloha-block[data-aloha-block-copy-only-block="true"]').length&&(t.find(".aloha-block:not([id])").remove(),t.find(".aloha-block + span:empty").remove(),t.find("div:empty").remove(),t.find("br.Apple-interchange-newline").remove(),t.find(".aloha-block").prev("br").remove(),t.find("div > br:only-child").parent().remove());t.find(".aloha-block").each(function(){var t=e(this),r={},i={};e.each(t[0].attributes,function(e,t){t.nodeName!=="id"&&(t.nodeName.match(/^data-/)?i[t.nodeName.substr(5)]=t.nodeValue:r[t.nodeName]=t.nodeValue)});var s=GENTICS.Utils.guid(),o=e("<"+this.tagName+"/>").attr(r).attr("id",s).removeClass("aloha-block-active").removeClass("aloha-block").html(t.html());t.replaceWith(o);window.setTimeout(function(){n._blockify(e("#"+s),i)},50)});return t.html()}})});define("block/editor",["jquery","aloha/observable","util/class"],function(e,t,n){var t=n.extend(t,{schema:null,_constructor:function(e){this.schema=e},render:function(){},getValue:function(){},setValue:function(){},destroy:function(){},_deactivate:function(){this.trigger("change",this.getValue());this.destroy()}}),n=t.extend({formInputElementDefinition:null,_$formInputElement:null,render:function(){var t=e('<div class="aloha-block-editor" />'),n=GENTICS.Utils.guid();t.append(this.renderLabel().attr("id",n));t.append(this.renderFormElement().attr("id",n));return t},renderLabel:function(){var t=e("<label />");t.html(this.schema.label);return t},renderFormElement:function(){var t=this;this._$formInputElement=e(this.formInputElementDefinition);this.afterRenderFormElement(this._$formInputElement);this._$formInputElement.change(function(){t.trigger("change",t.getValue())});return this._$formInputElement},afterRenderFormElement:function(){},getValue:function(){return this._$formInputElement.val()},setValue:function(e){this._$formInputElement.val(e)},destroy:function(){this._$formInputElement.remove()}}),r=n.extend({formInputElementDefinition:'<input type="text" />'}),i=n.extend({formInputElementDefinition:'<input type="range" />',afterRenderFormElement:function(e){this.schema.range&&(this.schema.range.min&&e.attr("min",this.schema.range.min),this.schema.range.max&&e.attr("max",this.schema.range.max),this.schema.range.step&&e.attr("step",this.schema.range.step))}}),s=n.extend({formInputElementDefinition:'<input type="url" />'}),o=n.extend({formInputElementDefinition:'<input type="email" />'}),u=n.extend({formInputElementDefinition:"<select />",afterRenderFormElement:function(t){e.each(this.schema.values,function(){t.append(e("<option />").attr("value",this.key).html(this.label))})}}),a=n.extend({formInputElementDefinition:"<button />",afterRenderFormElement:function(e){var t=this;e.html(this.schema.buttonLabel);e.click(function(){t.schema.callback()})}});return{AbstractEditor:t,AbstractFormElementEditor:n,StringEditor:r,NumberEditor:i,UrlEditor:s,EmailEditor:o,SelectEditor:u,ButtonEditor:a}});define("block/nls/i18n",{root:{"button.toggledragdrop.tooltip":"Toggle Drag & Drop"},fr:!0,en:!0});define("block/block-plugin","aloha aloha/plugin jquery aloha/contenthandlermanager block/blockmanager block/sidebarattributeeditor block/block block/editormanager block/blockcontenthandler block/editor ui/ui ui/toggleButton i18n!block/nls/i18n i18n!aloha/nls/i18n jqueryui".split(" "),function(e,t,n,r,i,s,o,u,a,f,l,c,h){t=t.create("block",{config:[],settings:{},init:function(){var t=this;i.registerBlockType("DebugBlock",o.DebugBlock);i.registerBlockType("DefaultBlock",o.DefaultBlock);i.registerBlockType("EmptyBlock",o.EmptyBlock);u.register("string",f.StringEditor);u.register("number",f.NumberEditor);u.register("url",f.UrlEditor);u.register("email",f.EmailEditor);u.register("select",f.SelectEditor);u.register("button",f.ButtonEditor);r.register("block",a);i.setDragDropState(t.isDragDropEnabled());i.registerEventHandlers();i.initializeBlockLevelDragDrop();e.bind("aloha-ready",function(){t._createBlocks();t.settings.sidebarAttributeEditor!==!1&&s.init()});this.createButtons();e.bind("aloha-editable-created",function(e,n){t.setDropzones(n.obj)});e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable)})},applyButtonConfig:function(e){if(this._isDragdropToggleEnabled(e)){this._toggleDragDropButton.show();this._toggleDragDropButton.setState(this._getDragdropState(e))}else this._toggleDragDropButton.hide()},_isDragdropToggleEnabled:function(e){e=this.getEditableConfig(e.obj);return(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal||e[0]==="toggleDragdrop"||e.toggleDragdrop==1||e.toggleDragdrop=="true"||e.toggleDragdrop==1||e.toggleDragdrop=="1")&&this.isDragDropEnabled()},_getDragdropState:function(e){return this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal?i.getDragDropState():e.obj.data("block-dragdrop")},_toggleDragdropState:function(t){if(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal){var n=!i.getDragDropState();i.setDragDropState(n);for(var r=0;r<e.editables.length;r++){t=e.editables[r];this._setDragDropStateForEditable(t.obj,n)}}else{n=!t.obj.data("block-dragdrop");this._setDragDropStateForEditable(t.obj,n)}},createButtons:function(){var t=this;this._toggleDragDropButton=l.adopt("toggleDragDrop",c,{tooltip:h.t("button.toggledragdrop.tooltip"),icon:"aloha-icon aloha-icon-toggledragdrop",scope:"Aloha.continuoustext",click:function(){t._toggleDragdropState(e.activeEditable)}})},setDropzones:function(e){var t=this.getEditableConfig(e);(t=t&&t.dropzones||this.settings.dropzones)?e.data("block-dropzones",t):e.data("block-dropzones",[".aloha-editable"])},isDragDropEnabled:function(){return this.settings&&typeof this.settings.dragdrop!="undefined"?this.settings.dragdrop===!0||this.settings.dragdrop==="true"||this.settings.dragdrop===1||this.settings.dragdrop==="1":!0},_createBlocks:function(){this.settings.defaults||(this.settings.defaults={});n.each(this.settings.defaults,function(e,t){n(e).alohaBlock(t)})},_setDragDropStateForEditable:function(e,t){e.data("block-dragdrop",t);e.hasClass("ui-sortable")&&e.sortable("option","disabled",!t);e.find(".aloha-block.ui-draggable").each(function(){n(this).draggable("option","disabled",!t)});e.find(".aloha-block-handle").each(function(){t?n(this).addClass("aloha-block-draghandle"):n(this).removeClass("aloha-block-draghandle")})}});n.fn.alohaBlock=function(e){e=e||{};n(this).each(function(t,n){i._blockify(n,e)});return n(this)};n.fn.mahaloBlock=function(){n(this).each(function(e,t){i._unblockify(t)})};return t});define("align/nls/i18n",{root:{"button.alignright.tooltip":"Align to the right","button.alignleft.tooltip":"Align to the left","button.aligncenter.tooltip":"Center","button.alignjustify.tooltip":"Justify"},fr:!0,en:!0});define("align/align-plugin","aloha aloha/plugin ui/ui ui/toggleButton i18n!align/nls/i18n i18n!aloha/nls/i18n jquery PubSub".split(" "),function(e,t,n,r,i,s,o,u){var a=window.GENTICS;return t.create("align",{_constructor:function(){this._super("align")},languages:["en","fr"],config:{alignment:["right","left","center","justify"]},alignment:"",lastAlignment:"",init:function(){this.createButtons();var t=this;e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable.obj)});u.sub("aloha.selection.context-change",function(n){n=n.range;e.activeEditable&&t.buttonPressed(n)})},buttonPressed:function(t){var n=this;t.findMarkup(function(){n.alignment=o(this).css("text-align")},e.activeEditable.obj);if(this.alignment!=this.lastAlignment){this._alignRightButton.setState(!1);this._alignLeftButton.setState(!1);this._alignCenterButton.setState(!1);this._alignJustifyButton.setState(!1);switch(this.alignment){case"right":this._alignRightButton.setState(!0);break;case"center":this._alignCenterButton.setState(!0);break;case"justify":this._alignJustifyButton.setState(!0);break;default:this._alignLeftButton.setState(!0);this.alignment="left"}this.lastAlignment=this.alignment}},applyButtonConfig:function(e){e=this.getEditableConfig(e);if(!e||!e.alignment||this.settings.alignment)e[0]&&e[0].alignment?e=e[0]:this.settings.alignment&&(e.alignment=this.settings.alignment);typeof e.alignment=="undefined"&&(e=this.config);o.inArray("right",e.alignment)!=-1?this._alignRightButton.show(!0):this._alignRightButton.show(!1);o.inArray("left",e.alignment)!=-1?this._alignLeftButton.show(!0):this._alignLeftButton.show(!1);o.inArray("center",e.alignment)!=-1?this._alignCenterButton.show(!0):this._alignCenterButton.show(!1);o.inArray("justify",e.alignment)!=-1?this._alignJustifyButton.show(!0):this._alignJustifyButton.show(!1)},createButtons:function(){var e=this;this._alignLeftButton=n.adopt("alignLeft",r,{tooltip:i.t("button.alignleft.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-left",scope:"Aloha.continuoustext",click:function(){e.align("left")}});this._alignCenterButton=n.adopt("alignCenter",r,{tooltip:i.t("button.aligncenter.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-center",scope:"Aloha.continuoustext",click:function(){e.align("center")}});this._alignRightButton=n.adopt("alignRight",r,{tooltip:i.t("button.alignright.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-right",scope:"Aloha.continuoustext",click:function(){e.align("right")}});this._alignJustifyButton=n.adopt("alignJustify",r,{tooltip:i.t("button.alignjustify.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-justify",scope:"Aloha.continuoustext",click:function(){e.align("justify")}})},findAlignMarkup:function(t){var n=this;typeof t=="undefined"&&(t=e.Selection.getRangeObject());return e.activeEditable?t.findMarkup(function(){return o(this).css("text-align")==n.alignment},e.activeEditable.obj):null},align:function(t){var n=e.Selection.getRangeObject();this.lastAlignment=this.alignment;this.alignment=t;e.activeEditable&&(this.findAlignMarkup(n)?this.removeAlign():this.insertAlign())},insertAlign:function(){var t=this;if(!this.findAlignMarkup(n)){var n=e.Selection.getRangeObject();a.Utils.Dom.isEditingHost(n.getCommonAncestorContainer())?o.each(e.Selection.getRangeObject().getSelectionTree(),function(){this.selection!=="none"&&this.domobj.nodeType!==3&&o(this.domobj).css("text-align",t.alignment)}):o(n.getCommonAncestorContainer()).css("text-align",this.alignment);if(this.alignment!=this.lastAlignment)switch(this.lastAlignment){case"right":this._alignRightButton.setState(!1);break;case"left":this._alignLeftButton.setState(!1);break;case"center":this._alignCenterButton.setState(!1);break;case"justify":this._alignJustifyButton.setState(!1)}n.select()}},removeAlign:function(){var t=e.Selection.getRangeObject();if(this.findAlignMarkup(t)){t.findMarkup(function(){o(this).css("text-align","")},e.activeEditable.obj);t.select()}}})});define("abbr/nls/i18n",{root:{"floatingmenu.tab.abbr":"Abbreviation","button.addabbr.tooltip":"insert abbreviation","button.abbr.tooltip":"format as abbreviation","newabbr.defaulttext":"Abbr"},de:!0});define("abbr/abbr-plugin","aloha jquery aloha/plugin ui/ui ui/toggleButton ui/button ui/scopes ui/port-helper-attribute-field i18n!abbr/nls/i18n i18n!aloha/nls/i18n".split(" "),function(e,t,n,r,i,s,o,u,a){var f=window.GENTICS;return n.create("abbr",{languages:["en","de"],config:["abbr"],init:function(){this.createButtons();this.subscribeEvents();this.bindInteractions()},createButtons:function(){var e=this;this._formatAbbrButton=r.adopt("formatAbbr",i,{tooltip:a.t("button.abbr.tooltip"),icon:"aloha-icon aloha-icon-abbr",scope:"Aloha.continuoustext",click:function(){e.formatAbbr()}});this._insertAbbrButton=r.adopt("insertAbbr",s,{tooltip:a.t("button.addabbr.tooltip"),icon:"aloha-icon aloha-icon-abbr",scope:"Aloha.continuoustext",click:function(){e.insertAbbr(!1)}});o.createScope("abbr","Aloha.continuoustext");this.abbrField=u({width:320,name:"abbrText",scope:"abbr"})},bindInteractions:function(){var t=this;this.abbrField.addListener("blur",function(){this.getValue()==""&&t.removeAbbr()});for(var n=0;n<e.editables.length;n++)e.editables[n].obj.keydown(function(e){if(e.metaKey&&e.which==71){if(t.findAbbrMarkup()){t.abbrField.foreground();t.abbrField.focus()}else t.insertAbbr();e.stopPropagation();e.preventDefault();return!1}})},subscribeEvents:function(){var n=this,r={};e.bind("aloha-editable-activated",function(){if(e.activeEditable&&e.activeEditable.obj){var i=n.getEditableConfig(e.activeEditable.obj);r[e.activeEditable.getId()]=t.inArray("abbr",i)!==-1}});e.bind("aloha-editable-destroyed",function(){e.activeEditable&&e.activeEditable.obj&&delete r[e.activeEditable.getId()]});e.bind("aloha-selection-changed",function(t,i){if(e.activeEditable)if(r[e.activeEditable.getId()]){n._formatAbbrButton.show();n._insertAbbrButton.show();var s=n.findAbbrMarkup(i);if(s){n._insertAbbrButton.hide();n._formatAbbrButton.setState(!0);o.setScope("abbr");n.abbrField.setTargetObject(s,"title")}else{n._formatAbbrButton.setState(!1);n.abbrField.setTargetObject(null)}}else{n._formatAbbrButton.hide();n._insertAbbrButton.hide()}})},findAbbrMarkup:function(t){typeof t=="undefined"&&(t=e.Selection.getRangeObject());return e.activeEditable?t.findMarkup(function(){return this.nodeName.toLowerCase()=="abbr"},e.activeEditable.obj):null},formatAbbr:function(){var t=e.Selection.getRangeObject();e.activeEditable&&(this.findAbbrMarkup(t)?this.removeAbbr():this.insertAbbr())},insertAbbr:function(n){var r=e.Selection.getRangeObject();if(!this.findAbbrMarkup(r)){r.isCollapsed()&&n!=0&&f.Utils.Dom.extendToWord(r);if(r.isCollapsed()){var n=a.t("newabbr.defaulttext"),i=t('<abbr title="">'+n+"</abbr>");f.Utils.Dom.insertIntoDOM(i,r,t(e.activeEditable.obj));r.startContainer=r.endContainer=i.contents().get(0);r.startOffset=0;r.endOffset=n.length}else{i=t('<abbr title=""></abbr>');f.Utils.Dom.addMarkup(r,i,!1)}r.select();this.abbrField.foreground();this.abbrField.focus()}},removeAbbr:function(){var t=e.Selection.getRangeObject(),n=this.findAbbrMarkup();if(n){f
.Utils.Dom.removeFromDOM(n,t,!0);t.select()}},makeClean:function(){},toString:function(){return"abbr"}})});define("horizontalruler/nls/i18n",{root:{"button.addhr.tooltip":"Add a horizontal ruler"},de:!0});define("horizontalruler/horizontalruler-plugin","aloha jquery aloha/plugin ui/ui ui/button i18n!horizontalruler/nls/i18n i18n!aloha/nls/i18n".split(" "),function(e,t,n,r,i,s){var o=window.GENTICS;return n.create("horizontalruler",{_constructor:function(){this._super("horizontalruler")},languages:["en"],config:["hr"],init:function(){var n=this;this._insertHorizontalRuleButton=r.adopt("insertHorizontalRule",i,{tooltip:s.t("button.addhr.tooltip"),iconOnly:!0,icon:"aloha-icon-horizontalruler",scope:"Aloha.continuoustext",click:function(){n.insertHR()}});e.bind("aloha-editable-activated",function(){if(e.activeEditable){n.cfg=n.getEditableConfig(e.activeEditable.obj);t.inArray("hr",n.cfg)!=-1?n._insertHorizontalRuleButton.show(!0):n._insertHorizontalRuleButton.show(!1)}})},insertHR:function(){var n=e.Selection.getRangeObject();if(e.activeEditable){var r=t("<hr>");o.Utils.Dom.insertIntoDOM(r,n,t(e.activeEditable.obj),!0);n.select()}}})});define("paste/paste-plugin",["aloha/core","aloha/plugin","jquery","aloha/command","aloha/console"],function(e,t,n,r,i){function s(){a=e.getSelection().getRangeAt(0);f=e.activeEditable;l.css({top:u.scrollTop(),left:u.scrollLeft()-200});l.contents().remove();f&&f.obj.blur();e.getSelection().removeAllRanges();var t=e.createRange();t.setStart(l.get(0),0);t.setEnd(l.get(0),0);e.getSelection().addRange(t);l.focus()}function o(){var t;if(a&&f){f.obj.focus();e.getSelection().removeAllRanges();t=e.createRange();t.setStart(a.startContainer,a.startOffset);t.setEnd(a.endContainer,a.endOffset);e.getSelection().addRange(t);t=l.html();n.browser.msie&&/^&nbsp;/.test(t)&&(t=t.substring(6));var r=a.startContainer;3==r.nodeType&&"P"==r.parentNode.nodeName&&1==r.parentNode.childNodes.length&&/^(\s|%A0)$/.test(escape(r.data))&&(r.data="",a.startOffset=0,a.endContainer==r&&(a.endOffset=0));e.queryCommandSupported("insertHTML")?e.execCommand("insertHTML",!1,t):i.error("Common.Paste",'Command "insertHTML" not available. Enable the plugin "common/commands".')}f=a=void 0;l.contents().remove()}var u=n(window),a=null,f=null,l=n('<div id="pasteContainer" style="position:absolute; clip:rect(0px, 0px, 0px, 0px); width: 1px; height: 1px;"></div>').contentEditable(!0);return t.create("paste",{settings:{},init:function(){n("body").append(l);e.bind("aloha-editable-created",function(t,r){n.browser.msie?r.obj.bind("beforepaste",function(e){s();e.stopPropagation()}):r.obj.bind("paste",function(t){s();window.setTimeout(function(){o();e.activeEditable.smartContentChange(t)},10);t.stopPropagation()})});n.browser.msie&&l.bind("paste",function(t){window.setTimeout(function(){o();e.activeEditable.smartContentChange(t)},10);t.stopPropagation()})},register:function(){i.deprecated("Plugins.Paste","register() for pasteHandler is deprecated. Use the ContentHandler Plugin instead.")}})});define("toc/nls/i18n",{root:{"button.addtoc.tooltip":"Table of contents"},de:!0});define("toc/toc-plugin","aloha aloha/plugin jquery ui/ui ui/button i18n!toc/nls/i18n i18n!aloha/nls/i18n aloha/console".split(" "),function(e,t,n,r,i,s){function o(e,t){return u(e,function(e){return e===t})}function u(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n];return null}function a(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t(e[r]));return n}function f(e,t){a(e,t)}function l(){return n(a(e.editables,function(e){return document.getElementById(e.getId())}))}function c(e){var t;typeof e=="object"?t=n(e).text().replace(/[^a-zA-Z-]+/g,"-").replace(/^[^a-zA-Z]+/,""):e&&(t=e);for(var r=0;;r++){var i=t;r&&(i+="-"+r);var s=document.getElementById(i);if(!s||typeof e=="object"&&s===e)return i}}var h=window.GENTICS,p=null,d=[];return t.create("toc",{languages:["en","de"],minEntries:0,updateInterval:5e3,config:["toc"],init:function(){var t=this;typeof this.settings.minEntries=="undefined"&&(this.settings.minEntries=this.minEntries);typeof this.settings.updateInterval=="undefined"&&(this.settings.updateInterval=this.updateInterval);e.bind("aloha-editable-activated",function(){if(e.activeEditable){t.cfg=t.getEditableConfig(e.activeEditable.obj);n.inArray("toc",t.cfg)!=-1?t._insertTocButton.show(!0):t._insertTocButton.show(!1)}});this.initButtons();n(document).ready(function(){t.spawn()})},initButtons:function(){var e=this;this._insertTocButton=r.adopt("insertToc",i,{tooltip:s.t("button.addtoc.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",scope:"Aloha.continuoustext",click:function(){e.insertAtSelection(p)}})},register:function(e){p=e},insertAtSelection:function(t){var t=t||l(),r=c("toc"),i=n("<ol class='toc_root'></ol>").attr("id",r).attr("contentEditable","false"),s=e.Selection.getRangeObject(),o=n(document.getElementById(e.activeEditable.getId()));h.Utils.Dom.insertIntoDOM(i,s,o);this.create(r).register(t).update().tickTock()},spawn:function(e,t){e=e||n("body");t=t||l();e.find("ol.toc_root").each(function(){var e=n(this).attr("id");if(!e){e=c("toc");n(this).attr("id",e)}that.create(e).register(t).tickTock()})},create:function(e){d.push(this);return{id:e,$containers:n(),settings:this.settings,root:function(){return n(document.getElementById(this.id))},register:function(e){var t=this;t.$containers=t.$containers.add(e);t.$containers.filter(function(){return!n(this).data("toc."+t.id+".listening")}).each(function(){var e=n(this);e.data("toc."+t.id+".listening",!0);e.bind("blur",function(){t.cleanupIds(e.get(0));t.update(e)})});return t},tickTock:function(e){var t=this;if(e=e||this.settings.updateInterval){window.setInterval(function(){t.register(l());t.update()},e);return t}},cleanupIds:function(e){var t=[];this.headings(this.$containers).each(function(){var r=n(this).attr("id");(r&&-1!=n.inArray(r,t)||e&&(n.contains(e,this)||e===this))&&n(this).attr("id",c(this));t.push(r)});return this},update:function(){var e=this,t=this.outline(e.$containers),n=[e.root()];n[n.length-1].empty();(function r(t){var i=[];f(t,function(t){var s=e.linkSection(t[0],n,i);n.push(s);r(t.slice(1));n.pop();i.push(s)})})(t.slice(1));t=e.root().attr("data-TOC-minEntries")||this.settings.minEntries;e.root().find("li").length>=t?e.root().show():e.root().hide();return this},linkSection:function(e,t,r){var i=e.eq(0).attr("id");if(!i){i=c(e.get(0));e.eq(0).attr("id",i)}var s=this.root(),o=i?s.find('a[href $= "#'+i+'"]'):n();o.length||(o=n("<li><a/></li>"));o.find("a").attr("href","#"+i).text(e.eq(0).text());if(r[r.length-1])r[r.length-1].after(o);else if(t[t.length-1].get(0)==s.get(0))s.append(o);else{e=n("<ol/>").append(o);t[t.length-1].append(e)}return o},outline:function(e){var t=[n()],r=[t];this.headings(e).each(function(){var e=n(this),t=this.nodeName.toLowerCase(),i=["h6","h5","h4","h3","h2","h1"],t=n.inArray(t,i),i=i.slice(t).join(","),i=[e.nextUntil(i).andSelf()],t=u(r,function(t){t=t[0];return!t.length||u(t,function(t){return e.get(0)===t||n.contains(t,e.get(0))})});t.push(i);r.splice(0,o(r,t),i)});return t},headings:function(e){return e.find(":header").add(e.filter(":header"))}}}})});define("cite/nls/i18n",{de:!0,en:!0});define("cite/cite-plugin","aloha jquery aloha/plugin ui/ui ui/toggleButton format/format-plugin util/dom PubSub i18n!cite/nls/i18n i18n!aloha/nls/i18n".split(" "),function(e,t,n,r,i,s,o,u,a){function f(e,t){return e.replace(/\{([a-z0-9\-\_]+)\}/ig,function(e,n){var r=t[n]||e;return typeof r=="function"?r():r})}function l(){var e=[],n=h;t.each(arguments,function(){e.push("."+(""===this?n:n+"-"+this))});return t.trim(e.join(" "))}function c(){var e=[],n=h;t.each(arguments,function(){e.push(""===this?n:n+"-"+this)});return t.trim(e.join(" "))}var h="aloha-cite",p=(new Date).getTime(),d={quote:c("quote"),blockquote:c("blockquote"),"panel-label":c("panel-label"),"panel-field":c("panel-field"),"panel-btns":c("panel-btns"),"link-field":c("link-field"),"note-field":c("note-field"),references:c("references")};return n.create("cite",{citations:[],referenceContainer:null,settings:null,sidebar:null,config:["quote","blockquote"],init:function(){var n=this;if(e.settings&&e.settings.plugins&&e.settings.plugins.cite){var o=t(e.settings.plugins.cite.referenceContainer);o.length&&(n.referenceContainer=o);typeof e.settings.plugins.cite!="undefined"&&(n.settings=e.settings.plugins.cite);typeof n.settings.sidebar=="undefined"&&(n.settings.sidebar={});typeof n.settings.sidebar.open=="undefined"&&(n.settings.sidebar.open=!0);if(typeof n.settings.sidebar.open=="string"){n.settings.sidebar.open=n.settings.sidebar.open.toLowerCase();n.settings.sidebar.open=n.settings.sidebar.open==="false"||n.settings.sidebar.open==="0"?!1:!0}}this._quoteButton=r.adopt("quote",i,{tooltip:a.t("cite.button.add.quote"),icon:c("button","inline-button"),scope:"Aloha.continuoustext",click:function(){n.addInlineQuote()}});s.multiSplitButton.pushItem({name:"blockquote",tooltip:a.t("cite.button.add.blockquote"),icon:c("button","block-button"),click:function(){n.addBlockQuote()}});var h=this;e.ready(function(){h.sidebar=e.Sidebar.right.show();h.sidebar.addPanel({id:c("sidebar-panel"),title:"Citation",content:"",expanded:!0,activeOn:"q, blockquote",onInit:function(){var e=this,t="";h.referenceContainer&&(t='<div class="{panel-label}">Note:</div> <div class="{panel-field} {note-field}" style="margin: 5px;"><textarea></textarea></div>');this.setContent(typeof ('<div class="{panel-label}">Link:</div><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" /></div>'+t)=="string"?f('<div class="{panel-label}">Link:</div><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" /></div>'+t,d):'<div class="{panel-label}">Link:</div><div class="{panel-field} {link-field}" style="margin: 5px;"><input type="text" /></div>'+t).content.find("input, textarea").bind("keypress change",function(){h.addCiteDetails(e.content.attr("data-cite-id"),e.content.find(l("link-field input")).val(),e.content.find(l("note-field textarea")).val())})},onActivate:function(e){var t=e.attr("data-cite-id");if(!t){var t=++p,r=""+c("wrapper");e.addClass(r);e.attr("data-cite-id",t)}r=n.getIndexOfCitation(t);-1===r&&(r=n.citations.push({uid:t,link:null,notes:null})-1);this.content.attr("data-cite-id",t);this.content.find(l("link-field input")).val(e.attr("cite"));this.content.find(l("note-field textarea")).val(n.citations[r].note)}})});e.bind("aloha-editable-activated",function(e,r){var i=n.getEditableConfig(r.editable.obj);if(i){t.inArray("quote",i)!==-1?n._quoteButton.show(!0):n._quoteButton.show(!1);t.inArray("blockquote",i)!==-1?s.multiSplitButton.showItem("blockquote"):s.multiSplitButton.hideItem("blockquote")}});u.sub("aloha.selection.context-change",function(r){for(var i=r.range,r=t("button.aloha-cite-button"),o=!1,u,i=i.markupEffectiveAtStart,a=i.length;a;){u=i[--a].nodeName;if(u==="Q"||u==="BLOCKQUOTE"){o=!0;break}}r.filter(".aloha-cite-block-button").removeClass("aloha-cite-pressed");n._quoteButton.setState(!1);if(o){"Q"===u?n._quoteButton.setState(!0):r.filter(".aloha-cite-block-button").addClass("aloha-cite-pressed");return!1}u=[];e.activeEditable&&(u=n.getEditableConfig(e.activeEditable.obj));t.inArray("quote",u)!=-1?n._quoteButton.show(!0):n._quoteButton.show(!1);t.inArray("blockquote",u)!=-1?s.multiSplitButton.showItem("blockquote"):s.multiSplitButton.hideItem("blockquote")})},getIndexOfCitation:function(e){for(var t=this.citations,n=t.length,r=0,i,s;r<n;){i=r+n>>1;s=t[i].uid;if(s==e)return i;s>e?n=i:s<e&&(r=i+1)}return-1},addBlockQuote:function(){var n=[c("wrapper"),c(++p)].join(" "),n=t(f('<blockquote class="{classes}" data-cite-id="{uid}"></blockquote>',{uid:p,classes:n}));e.activeEditable&&t(e.activeEditable.obj[0]).click();e.Selection.changeMarkupOnSelection(n);this.referenceContainer&&this.addCiteToReferences(p);this.sidebar&&this.settings&&this.settings.sidebar&&this.settings.sidebar.open&&this.sidebar.open()},addInlineQuote:function(){var n=[c("wrapper"),c(++p)].join(" "),r=t(f('<q class="{classes}" data-cite-id="{uid}"></q>',{uid:p,classes:n})),n=e.Selection.rangeObject,i;e.activeEditable&&t(e.activeEditable.obj[0]).click();if(i=n.findMarkup(function(){return this.nodeName&&r.length&&typeof this.nodeName=="string"&&typeof r[0].nodeName=="string"?this.nodeName.toLowerCase()===r[0].nodeName.toLowerCase():!1},e.activeEditable.obj))n.isCollapsed()?o.removeFromDOM(i,n,!0):o.removeMarkup(n,r,e.activeEditable.obj);else{n.isCollapsed()&&o.extendToWord(n);o.addMarkup(n,r)}n.select();this.referenceContainer&&this.addCiteToReferences(p);this.sidebar&&this.settings&&this.settings.sidebar&&this.settings.sidebar.open&&this.sidebar.open();return!1},addCiteToReferences:function(e){var n=this.getIndexOfCitation(e);if(-1!==n){var r=t(".aloha-editable-active "+l(e)),i="cite-note-"+e,e="cite-ref-"+e;r.append(f('<sup id="{ref}" contenteditable="false"><a href="#{note}">[{count}]</a></sup>',{ref:e,note:i,count:n+1}));0===this.referenceContainer.find("ol.references").length&&this.referenceContainer.append("<h2>References</h2>").append('<ol class="references"></ol>');this.referenceContainer.find("ol.references").append(f('<li id="{note}"><a href="#{ref}">^</a> &nbsp; <span></span></li>',{ref:e,note:i}))}},addCiteDetails:function(e,n,r){this.citations[this.getIndexOfCitation(e)]={uid:e,link:n,note:r};n&&t(l(e)).attr("cite",n);this.referenceContainer&&t("li#cite-note-"+e+" span").html(f(n?'<a class="external" target="_blank" href="{url}">{url}</a>':"",{url:n})+(r?". "+r:""))},toString:function(){return"aloha-citiation-plugin"},makeClean:function(e){e.find("q, blockquote").each(function(){t.trim(t(this).attr("class"))===""&&t(this).removeAttr("class");if(!this.referenceContainer){t(this).removeClass("aloha-cite-"+t(this).attr("data-cite-id"));t(this).attr("data-cite-id")!=null&&t(this).removeAttr("data-cite-id")}t(this).removeClass("aloha-cite-wrapper")})}})});define("flag-icons/flag-icons-plugin",[],function(){return{path:Aloha.getPluginUrl("flag-icons")}});define("numerated-headers/nls/i18n",{root:{"button.numeratedHeaders.tooltip":"Toggle header numeration."},de:!0,en:!0});define("numerated-headers/numerated-headers-plugin","aloha/core jquery aloha/plugin ui/ui ui/toggleButton i18n!numerated-headers/nls/i18n i18n!aloha/nls/i18n".split(" "),function(e,t,n,r,i,s){var o={};e.bind("aloha-editable-destroyed",function(e,t){delete o[t.getId()]});return n.create("numerated-headers",{config:{numeratedactive:!0,headingselector:"h1, h2, h3, h4, h5, h6",trailingdot:!1},init:function(){var t=this;this._formatNumeratedHeadersButton=r.adopt("formatNumeratedHeaders",i,{tooltip:s.t("button.numeratedHeaders.tooltip"),icon:"aloha-icon aloha-icon-numerated-headers",scope:"Aloha.continuoustext",click:function(){t._formatNumeratedHeadersButton.getState()?t.createNumeratedHeaders():t.removeNumerations()}});e.bind("aloha-smart-content-changed",function(){t.cleanNumerations();t.showNumbers()&&t.createNumeratedHeaders()});e.bind("aloha-format-block",function(){t.cleanNumerations();t.showNumbers()&&t.createNumeratedHeaders()});e.bind("aloha-editable-activated",function(){if(t.isNumeratingOn()){t._formatNumeratedHeadersButton.show();t.initForEditable(e.activeEditable.obj)}else t._formatNumeratedHeadersButton.hide()})},initForEditable:function(e){var t=e.attr("aloha-numerated-headers");if(t!=="true"&&t!=="false"){t=!0===this.getCurrentConfig().numeratedactive?"true":"false";e.attr("aloha-numerated-headers",t)}if(t==="true"){this.createNumeratedHeaders();this._formatNumeratedHeadersButton.setState(!0)}else this._formatNumeratedHeadersButton.setState(!1)},getCurrentConfig:function(){var n=this.getEditableConfig(e.activeEditable.obj);n.numeratedactive=n.numeratedactive===!0||n.numeratedactive==="true"||n.numeratedactive==="1"?!0:!1;typeof n.headingselector!="string"&&(n.headingselector="h1, h2, h3, h4, h5, h6");n.headingselector=t.trim(n.headingselector);n.trailingdot=n.trailingdot===!0||n.trailingdot==="true"||n.trailingdot==="1"?!0:!1;return n},isNumeratingOn:function(){return this.getCurrentConfig().headingselector!==""},showNumbers:function(){return e.activeEditable&&this.isNumeratingOn()&&e.activeEditable.obj.attr("aloha-numerated-headers")==="true"},cleanNumerations:function(){var e=this.getBaseElement();e&&this._saveRemoveAnnotations(t(e).find("span[role=annotation]"))},_saveRemoveAnnotations:function(n){var r=this,i=e.Selection.getRangeObject(),s=!1;n.each(function(){if(i.startContainer===this||t.inArray(this,t(i.startContainer).parents())>-1){i.startContainer=r._prevNode(this);i.startOffset=0;s=!0}if(i.startContainer===this.parentNode&&i.startOffset>=t(this).index()&&i.startOffset>0){i.startOffset--;s=!0}if(i.endContainer===this||t.inArray(this,t(i.endContainer).parents())>-1){i.endContainer=r._prevNode(this);i.endOffset=0;s=!0}if(i.endContainer===this.parentNode&&i.endOffset>=t(this).index()&&i.endOffset>0){i.endOffset--;s=!0}t(this).remove()});if(s===!0){i.update();i.select()}},_prependAnnotation:function(n,r){var i=e.Selection.getRangeObject(),s=!1;if(i.startContainer===r){i.startOffset++;s=!0}if(i.endContainer===r){i.endOffset++;s=!0}t(r).prepend('<span role="annotation">'+n+"</span>");if(s===!0){i.update();i.select()}},_prevNode:function(e){var t=e.previousSibling;if(!t)return e.parentNode;for(;t.lastChild;)t=t.lastChild;return t},removeNumerations:function(){t(e.activeEditable.obj).attr("aloha-numerated-headers","false");this.cleanNumerations()},getBaseElement:function(){return typeof this.baseobjectSelector!="undefined"?t(this.baseobjectSelector).length>0?t(this.baseobjectSelector):null:e.activeEditable?e.activeEditable.obj:null},hasNote:function(e){return!e||t(e).length<=0?!1:t(e).find("span[role=annotation]").length>0},hasContent:function(e){if(!e||0===t(e).length)return!1;e=t(e).clone().find("span[role=annotation]").remove().end();return t.trim(e.text()).length>0},createNumeratedHeaders:function(){var n=this.getBaseElement();if(n){var r=this.getCurrentConfig(),n=n.find(r.headingselector);e.activeEditable.obj.attr("aloha-numerated-headers","true");if(typeof n!="undefined"&&n.length!==0){var i=7,s=this;n.each(function(){if(s.hasContent(this)){var e=parseInt(this.nodeName.substr(1),10);e<i&&(i=e)}});if(!(i>6)){var o=null,u=[],a=0,l;for(l=0;l<6-i+1;l++)u[l]=0;n.each(function(){if(s.hasContent(this)){var e=parseInt(this.nodeName.substr(1),10);if(o===null&&e!==i)s._saveRemoveAnnotations(t(this).find("span[role=annotation]"));else{if(o===null)u[a]++;else if(e>o)u[++a]++;else if(e===o)u[a]++;else if(e<o){var n=e-i,l;for(l=a;l>n;l--)u[l]=0;a=n;u[a]++}o=e;e="";if(r.trailingdot===!0){e="";for(n=0;n<u.length;n++)u[n]!==0&&(e+=u[n]+".")}else{e=u[0];for(n=1;n<u.length;n++)u[n]!==0&&(e+="."+u[n])}e+="&nbsp;";s.hasNote(this)?t(this).find("span[role=annotation]").html(e):s._prependAnnotation(e,this)}}else s.hasNote(this)&&s._saveRemoveAnnotations(t(this).find("span[role=annotation]"))})}}}}})});define("formatlesspaste/formatlesshandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){return n.createHandler({enabled:!1,handleContent:function(e){"string"==typeof e?e=t("<div>"+e+"</div>"):e instanceof t&&(e=t("<div>").append(e));if(!(0<e.find(".aloha-block").length))return this.enabled&&this.removeFormatting(e),e.html()},removeFormatting:function(e){e.find(this.strippedElements.join(",")).each(function(){t(this).contents().unwrap()})}})});define("formatlesspaste/nls/i18n",{root:{"button.formatlessPaste.tooltip":"Toggle Formatless Pasting"},de:!0,fr:!0,pl:!0,ru:!0});define("formatlesspaste/formatlesspaste-plugin","aloha/core aloha/plugin jquery ui/ui ui/toggleButton formatlesspaste/formatlesshandler aloha/contenthandlermanager i18n!formatlesspaste/nls/i18n i18n!aloha/nls/i18n".split(" "),function(e,t,n,r,i,s,o,u){return t.create("formatlesspaste",{formatlessPasteOption:!1,button:!0,strippedElements:["a","em","strong","small","s","cite","q","dfn","abbr","time","code","var","samp","kbd","sub","sup","i","b","u","mark","ruby","rt","rp","bdi","bdo","ins","del"],init:function(){var t=this;typeof this.settings.formatlessPasteOption!="undefined"&&(this.formatlessPasteOption=this.settings.formatlessPasteOption);typeof this.settings.strippedElements!="undefined"&&(this.strippedElements=this.settings.strippedElements);if(this.settings.config){this.settings.config.formatlessPasteOption&&(this.formatlessPasteOption=this.settings.config.formatlessPasteOption);this.settings.config.strippedElements&&(this.strippedElements=this.settings.config.strippedElements);this.settings.config.button===!1&&(this.button=!1)}this.registerFormatlessPasteHandler();e.bind("aloha-editable-activated",function(e,n){var r=t.getEditableConfig(n.editable.obj);if(r){if(typeof r.button=="string"){r.button=r.button.toLowerCase();r.button=r.button==="false"||r.button==="0"?!1:!0}if(typeof r.formatlessPasteOption=="string"){r.formatlessPasteOption=r.formatlessPasteOption.toLowerCase();r.formatlessPasteOption=r.formatlessPasteOption==="false"||r.formatlessPasteOption==="0"?!1:!0}r.strippedElements&&(s.strippedElements=r.strippedElements);if(r.formatlessPasteOption===!0){t._toggleFormatlessPasteButton.setState(!0);s.enabled=!0}else if(r.formatlessPasteOption===!1){t._toggleFormatlessPasteButton.setState(!1);s.enabled=!1}r.button===!1?t._toggleFormatlessPasteButton.show(!1):t._toggleFormatlessPasteButton.show(!0)}})},registerFormatlessPasteHandler:function(){o.register("formatless",s);s.strippedElements=this.strippedElements;this._toggleFormatlessPasteButton=r.adopt("toggleFormatlessPaste",i,{tooltip:u.t("button.formatlessPaste.tooltip"),icon:"aloha-icon aloha-icon-formatless-paste",scope:"Aloha.continuoustext",click:function(){s.enabled=!s.enabled}});if(this.formatlessPasteOption===!0){this._toggleFormatlessPasteButton.setState(!0);s.enabled=!0}this.button===!1&&this._toggleFormatlessPasteButton.show(!1)}})});(function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){function n(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var i=new this;e=!1;for(var s=0;s<arguments.length;s++){var o=arguments[s],u;for(u in o)i[u]="function"==typeof o[u]&&"function"==typeof r[u]&&t.test(o[u])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);this._super=n;return i}}(u,o[u]):o[u]}n.prototype=i;n.constructor=n;n.extend=arguments.callee;return n}})();"function"==typeof define&&define("Class",[],function(){return Class});define("jstree",["jquery"],function(e){(function(){if(!e||!e.jstree){var t=!1,n=!1,r=!1;(function(e){e.vakata={};e.vakata.css={get_css:function(e,t,n){var e=e.toLowerCase(),r=n.cssRules||n.rules,i=0;do{if(r.length&&i>r.length+5)break;if(r[i].selectorText&&r[i].selectorText.toLowerCase()==e)return!0===t?(n.removeRule&&n.removeRule(i),n.deleteRule&&n.deleteRule(i),!0):r[i]}while(r[++i]);return!1},add_css:function(t,n){if(e.jstree.css.get_css(t,!1,n))return!1;n.insertRule?n.insertRule(t+" { }",0):n.addRule(t,null,0);return e.vakata.css.get_css(t)},remove_css:function(t,n){return e.vakata.css.get_css(t,!0,n)},add_sheet:function(t){var n=!1,r=!0;if(t.str)return t.title&&(n=e("style[id='"+t.title+"-stylesheet']")[0]),n?r=!1:(n=document.createElement("style"),n.setAttribute("type","text/css"),t.title&&n.setAttribute("id",t.title+"-stylesheet")),n.styleSheet?r?(document.getElementsByTagName("head")[0].appendChild(n),n.styleSheet.cssText=t.str):n.styleSheet.cssText=n.styleSheet.cssText+" "+t.str:(n.appendChild(document.createTextNode(t.str)),document.getElementsByTagName("head")[0].appendChild(n)),n.sheet||n.styleSheet;if(t.url){if(!document.createStyleSheet)return n=document.createElement("link"),n.rel="stylesheet",n.type="text/css",n.media="all",n.href=t.url,document.getElementsByTagName("head")[0].appendChild(n),n.styleSheet;try{document.createStyleSheet(t.url)}catch(i){}}}};var i=[],s=-1,o={},u={};e.fn.jstree=function(t){var n="string"==typeof t,r=Array.prototype.slice.call(arguments,1),s=this;if(n){if("_"==t.substring(0,1))return s;this.each(function(){var n=i[e.data(this,"jstree-instance-id")],n=n&&e.isFunction(n[t])?n[t].apply(n,r):n;if("undefined"!=typeof n&&(0===t.indexOf("is_")||!0!==n&&!1!==n))return s=n,!1})}else this.each(function(){var n=e.data(this,"jstree-instance-id"),s=[],u=t?e.extend({},!0,t):{},f=e(this),h=!1,p=[],s=s.concat(r);f.data("jstree")&&s.push(f.data("jstree"));u=s.length?e.extend.apply(null,[!0,u].concat(s)):u;"undefined"!=typeof n&&i[n]&&i[n].destroy();n=parseInt(i.push({}),10)-1;e.data(this,"jstree-instance-id",n);u.plugins=e.isArray(u.plugins)?u.plugins:e.jstree.defaults.plugins.slice();u.plugins.unshift("core");u.plugins=u.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");h=e.extend(!0,{},e.jstree.defaults,u);h.plugins=u.plugins;e.each(o,function(t){-1===e.inArray(t,h.plugins)?(h[t]=null,delete h[t]):p.push(t)});h.plugins=p;i[n]=new e.jstree._instance(n,e(this).addClass("jstree jstree-"+n),h);e.each(i[n]._get_settings().plugins,function(e,t){i[n].data[t]={}});e.each(i[n]._get_settings().plugins,function(e,t){o[t]&&o[t].__init.apply(i[n])});setTimeout(function(){i[n].init()},0)});return s};e.jstree={defaults:{plugins:[]},_focused:function(){return i[s]||null},_reference:function(t){if(i[t])return i[t];var n=e(t);!n.length&&"string"==typeof t&&(n=e("#"+t));return n.length?i[n.closest(".jstree").data("jstree-instance-id")]||null:null},_instance:function(t,n,r){this.data={core:{}};this.get_settings=function(){return e.extend(!0,{},r)};this._get_settings=function(){return r};this.get_index=function(){return t};this.get_container=function(){return n};this.get_container_ul=function(){return n.children("ul:eq(0)")};this._set_settings=function(t){r=e.extend(!0,{},r,t)}},_fn:{},plugin:function(t,n){n=e.extend({},{__init:e.noop,__destroy:e.noop,_fn:{},defaults:!1},n);o[t]=n;e.jstree.defaults[t]=n.defaults;e.each(n._fn,function(n,r){r.plugin=t;r.old=e.jstree._fn[n];e.jstree._fn[n]=function(){var t,i=r,s=Array.prototype.slice.call(arguments);t=new e.Event("before.jstree");var o=!1;if(!0!==this.data.core.locked||"unlock"===n||"is_locked"===n){do{if(i&&i.plugin&&-1!==e.inArray(i.plugin,this._get_settings().plugins))break;i=i.old}while(i);if(i){if(0===n.indexOf("_"))t=i.apply(this,s);else{t=this.get_container().triggerHandler(t,{func:n,inst:this,args:s,plugin:i.plugin});if(!1===t)return;"undefined"!=typeof t&&(s=t);t=i.apply(e.extend({},this,{__callback:function(e){this.get_container().triggerHandler(n+".jstree",{inst:this,args:s,rslt:e,rlbk:o})},__rollback:function(){return o=this.get_rollback()},__call_old:function(e){return i.old.apply(this,e?Array.prototype.slice.call(arguments,1):s)}}),s)}return t}}};e.jstree._fn[n].old=r.old;e.jstree._fn[n].plugin=t})},rollback:function(t){t&&(e.isArray(t)||(t=[t]),e.each(t,function(e,t){i[t.i].set_rollback(t.h,t.d)}))}};e.jstree._fn=e.jstree._instance.prototype={};e(function(){var i=navigator.userAgent.toLowerCase(),s=(i.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],o=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(i)&&6==parseInt(s,10)){t=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(u){}o+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}/msie/.test(i)&&7==parseInt(s,10)&&(n=!0,o+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } ");!/compatible/.test(i)&&/mozilla/.test(i)&&1.9>parseFloat(s,10)&&(r=!0,o+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } ");e.vakata.css.add_sheet({str:o,title:"jstree"})});e.jstree.plugin("core",{__init:function(){this.data.core.locked=!1;this.data.core.to_open=this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:!1,animation:500,initially_open:[],initially_load:[],open_parents:!0,notify_plugins:!0,rtl:!1,load_open:!1,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl");this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",e.proxy(function(t){var n=e(t.target);n.is("ins")&&t.pageY-n.offset().top<this.data.core.li_height&&this.toggle_node(n)},this)).bind("mousedown.jstree",e.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(){var e;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(t){}}});this._get_settings().core.notify_plugins&&this.get_container().bind("load_node.jstree",e.proxy(function(t,n){var r=this._get_node(n.rslt.obj),i=this;-1===r&&(r=this.get_container_ul());r.length&&r.find("li").each(function(){var t=e(this);t.data("jstree")&&e.each(t.data("jstree"),function(n,r){i.data[n]&&e.isFunction(i["_"+n+"_notify"])&&i["_"+n+"_notify"].call(i,t,r)})})},this));this._get_settings().core.load_open&&this.get_container().bind("load_node.jstree",e.proxy(function(t,n){var r=this._get_node(n.rslt.obj),i=this;-1===r&&(r=this.get_container_ul());r.length&&r.find("li.jstree-open:not(:has(ul))").each(function(){i.load_node(this,e.noop,e.noop)})},this));this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var t,n=this.get_index(),r=this._get_settings(),u=this;e.each(r.plugins,function(e,t){try{o[t].__destroy.apply(u)}catch(n){}});this.__callback();if(this.is_focused())for(t in i)if(i.hasOwnProperty(t)&&t!=n){i[t].set_focus();break}n===s&&(s=-1);this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});e(document).unbind(".jstree-"+n).undelegate(".jstree-"+n);i[n]=null;delete i[n]},_core_notify:function(e,t){t.opened&&this.open_node(e,!1,!0)},lock:function(){this.data.core.locked=!0;this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7");this.__callback({})},unlock:function(){this.data.core.locked=!1;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var e=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){this.id&&e.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))});this.__callback(e.data.core.to_open)},save_loaded:function(){},reload_nodes:function(t){var n=this,r=!0,i=[],s=[];t||(this.data.core.reopen=!1,this.data.core.refreshing=!0,this.data.core.to_open=e.map(e.makeArray(this.data.core.to_open),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_load=e.map(e.makeArray(this.data
.core.to_load),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")}),this.data.core.to_open.length&&(this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)));this.data.core.to_load.length&&(e.each(this.data.core.to_load,function(t,n){if(n=="#")return!0;e(n).length?i.push(n):s.push(n)}),i.length&&(this.data.core.to_load=s,e.each(i,function(e,t){if(!n._is_loaded(t)){n.load_node(t,function(){n.reload_nodes(!0)},function(){n.reload_nodes(!0)});r=!1}})));this.data.core.to_open.length&&e.each(this.data.core.to_open,function(e,t){n.open_node(t,!1,!0)});r&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){n.__callback({},n)},50),this.data.core.refreshing=!1,this.reopen())},reopen:function(){var t=this;this.data.core.to_open.length&&e.each(this.data.core.to_open,function(e,n){t.open_node(n,!1,!0)});this.__callback({})},refresh:function(e){var t=this;this.save_opened();e||(e=-1);(e=this._get_node(e))||(e=-1);-1!==e?e.children("UL").remove():this.get_container_ul().empty();this.load_node(e,function(){t.__callback({obj:e});t.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(!this.is_focused()){var t=e.jstree._focused();t&&t.unset_focus();this.get_container().addClass("jstree-focused");s=this.get_index();this.__callback()}},is_focused:function(){return s==this.get_index()},unset_focus:function(){this.is_focused()&&(this.get_container().removeClass("jstree-focused"),s=-1);this.__callback()},_get_node:function(t){var n=e(t,this.get_container());if(n.is(".jstree")||-1==t)return-1;n=n.closest("li",this.get_container());return n.length?n:!1},_get_next:function(e,t){e=this._get_node(e);return-1===e?this.get_container().find("> ul > li:first-child"):e.length?t?0<e.nextAll("li").size()?e.nextAll("li:eq(0)"):!1:e.hasClass("jstree-open")?e.find("li:eq(0)"):0<e.nextAll("li").size()?e.nextAll("li:eq(0)"):e.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(e,t){e=this._get_node(e);if(-1===e)return this.get_container().find("> ul > li:last-child");if(!e.length)return!1;if(t)return 0<e.prevAll("li").length?e.prevAll("li:eq(0)"):!1;if(e.prev("li").length){for(e=e.prev("li").eq(0);e.hasClass("jstree-open");)e=e.children("ul:eq(0)").children("li:last");return e}var n=e.parentsUntil(".jstree","li:eq(0)");return n.length?n:!1},_get_parent:function(e){e=this._get_node(e);if(-1==e||!e.length)return!1;e=e.parentsUntil(".jstree","li:eq(0)");return e.length?e:-1},_get_children:function(e){e=this._get_node(e);return-1===e?this.get_container().children("ul:eq(0)").children("li"):e.length?e.children("ul:eq(0)").children("li"):!1},get_path:function(e,t){var n=[],r=this,e=this._get_node(e);if(-1===e||!e||!e.length)return!1;e.parentsUntil(".jstree","li").each(function(){n.push(t?this.id:r.get_text(this))});n.reverse();n.push(t?e.attr("id"):this.get_text(e));return n},_get_string:function(e){return this._get_settings().core.strings[e]||e},is_open:function(e){return(e=this._get_node(e))&&-1!==e&&e.hasClass("jstree-open")},is_closed:function(e){return(e=this._get_node(e))&&-1!==e&&e.hasClass("jstree-closed")},is_leaf:function(e){return(e=this._get_node(e))&&-1!==e&&e.hasClass("jstree-leaf")},correct_state:function(e){e=this._get_node(e);if(!e||-1===e)return!1;e.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:e})},open_node:function(e,n,r){e=this._get_node(e);if(!e.length)return!1;if(!e.hasClass("jstree-closed"))return n&&n.call(),!1;var i=r||t?0:this._get_settings().core.animation,s=this;this._is_loaded(e)?(this._get_settings().core.open_parents&&e.parentsUntil(".jstree",".jstree-closed").each(function(){s.open_node(this,!1,!0)}),i&&e.children("ul").css("display","none"),e.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),i?e.children("ul").stop(!0,!0).slideDown(i,function(){this.style.display="";s.after_open(e)}):s.after_open(e),this.__callback({obj:e}),n&&n.call()):(e.children("a").addClass("jstree-loading"),this.load_node(e,function(){s.open_node(e,n,r)},n))},after_open:function(e){this.__callback({obj:e})},close_node:function(e,n){var e=this._get_node(e),r=n||t?0:this._get_settings().core.animation,i=this;if(!e.length||!e.hasClass("jstree-open"))return!1;r&&e.children("ul").attr("style","display:block !important");e.removeClass("jstree-open").addClass("jstree-closed");r?e.children("ul").stop(!0,!0).slideUp(r,function(){this.style.display="";i.after_close(e)}):i.after_close(e);this.__callback({obj:e})},after_close:function(e){this.__callback({obj:e})},toggle_node:function(e){e=this._get_node(e);if(e.hasClass("jstree-closed"))return this.open_node(e);if(e.hasClass("jstree-open"))return this.close_node(e)},open_all:function(e,t,n){e=e?this._get_node(e):-1;if(!e||-1===e)e=this.get_container_ul();n?e=e.find("li.jstree-closed"):(n=e,e=e.is(".jstree-closed")?e.find("li.jstree-closed").andSelf():e.find("li.jstree-closed"));var r=this;e.each(function(){var e=this;r._is_loaded(this)?r.open_node(this,!1,!t):r.open_node(this,function(){r.open_all(e,t,n)},!t)});0===n.find("li.jstree-closed").length&&this.__callback({obj:n})},close_all:function(e,t){var n=this,e=e?this._get_node(e):this.get_container();if(!e||-1===e)e=this.get_container_ul();e.find("li.jstree-open").andSelf().each(function(){n.close_node(this,!t)});this.__callback({obj:e})},clean_node:function(t){t=t&&-1!=t?e(t):this.get_container_ul();t=t.is("li")?t.find("li").andSelf():t.find("li");t.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");t.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:t})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(e,t){this.get_container().empty().append(e);this.data=t;this.__callback()},load_node:function(e){this.__callback({obj:e})},_is_loaded:function(){return!0},create_node:function(t,n,r,i,s){var t=this._get_node(t),n="undefined"==typeof n?"last":n,o=e("<li />"),u=this._get_settings().core,a;if(-1!==t&&!t.length)return!1;if(!s&&!this._is_loaded(t))return this.load_node(t,function(){this.create_node(t,n,r,i,!0)}),!1;this.__rollback();"string"==typeof r&&(r={data:r});r||(r={});r.attr&&o.attr(r.attr);r.metadata&&o.data(r.metadata);r.state&&o.addClass("jstree-"+r.state);r.data||(r.data=this._get_string("new_node"));e.isArray(r.data)||(a=r.data,r.data=[],r.data.push(a));e.each(r.data,function(t,n){a=e("<a />");e.isFunction(n)&&(n=n.call(this,r));if(typeof n=="string")a.attr("href","#")[u.html_titles?"html":"text"](n);else{n.attr||(n.attr={});n.attr.href||(n.attr.href="#");a.attr(n.attr)[u.html_titles?"html":"text"](n.title);n.language&&a.addClass(n.language)}a.prepend("<ins class='jstree-icon'>&#160;</ins>");n.icon&&(n.icon.indexOf("/")===-1?a.children("ins").addClass(n.icon):a.children("ins").css("background","url('"+n.icon+"') center center no-repeat"));o.append(a)});o.prepend("<ins class='jstree-icon'>&#160;</ins>");-1===t&&(t=this.get_container(),"before"===n&&(n="first"),"after"===n&&(n="last"));switch(n){case"before":t.before(o);a=this._get_parent(t);break;case"after":t.after(o);a=this._get_parent(t);break;case"inside":case"first":t.children("ul").length||t.append("<ul />");t.children("ul").prepend(o);a=t;break;case"last":t.children("ul").length||t.append("<ul />");t.children("ul").append(o);a=t;break;default:t.children("ul").length||t.append("<ul />"),n||(n=0),a=t.children("ul").children("li").eq(n),a.length?a.before(o):t.children("ul").append(o),a=t}if(-1===a||a.get(0)===this.get_container().get(0))a=-1;this.clean_node(a);this.__callback({obj:o,parent:a});i&&i.call(this,o);return o},get_text:function(e){e=this._get_node(e);if(!e.length)return!1;var t=this._get_settings().core.html_titles,e=e.children("a:eq(0)");if(t)return e=e.clone(),e.children("INS").remove(),e.html();e=e.contents().filter(function(){return 3==this.nodeType})[0];return e.nodeValue},set_text:function(e,t){e=this._get_node(e);if(!e.length)return!1;e=e.children("a:eq(0)");if(this._get_settings().core.html_titles){var n=e.children("INS").clone();e.html(t).prepend(n);this.__callback({obj:e,name:t});return!0}e=e.contents().filter(function(){return 3==this.nodeType})[0];this.__callback({obj:e,name:t});return e.nodeValue=t},rename_node:function(e,t){e=this._get_node(e);this.__rollback();e&&e.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:e,name:t})},delete_node:function(t){t=this._get_node(t);if(!t.length)return!1;this.__rollback();var n=this._get_parent(t),r=e([]),i=this;t.each(function(){r=r.add(i._get_prev(this))});t=t.detach();-1!==n&&0===n.find("> ul > li").length&&n.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");this.clean_node(n);this.__callback({obj:t,prev:r,parent:n});return t},prepare_move:function(t,n,r,i,s){var o={};o.ot=e.jstree._reference(t)||this;o.o=o.ot._get_node(t);o.r=-1===n?-1:this._get_node(n);o.p="undefined"==typeof r||!1===r?"last":r;if(s||!u.o||u.o[0]!==o.o[0]||u.r[0]!==o.r[0]||u.p!==o.p){o.ot=e.jstree._reference(o.o)||this;o.rt=e.jstree._reference(o.r)||this;if(-1===o.r||!o.r)switch(o.cr=-1,o.p){case"first":case"before":case"inside":o.cp=0;break;case"after":case"last":o.cp=o.rt.get_container().find(" > ul > li").length;break;default:o.cp=o.p}else{if(!/^(before|after)$/.test(o.p)&&!this._is_loaded(o.r))return this.load_node(o.r,function(){this.prepare_move(t,n,r,i,!0)});switch(o.p){case"before":o.cp=o.r.index();o.cr=o.rt._get_parent(o.r);break;case"after":o.cp=o.r.index()+1;o.cr=o.rt._get_parent(o.r);break;case"inside":case"first":o.cp=0;o.cr=o.r;break;case"last":o.cp=o.r.find(" > ul > li").length;o.cr=o.r;break;default:o.cp=o.p,o.cr=o.r}}o.np=-1==o.cr?o.rt.get_container():o.cr;o.op=o.ot._get_parent(o.o);o.cop=o.o.index();-1===o.op&&(o.op=o.ot?o.ot.get_container():this.get_container());!/^(before|after)$/.test(o.p)&&o.op&&o.np&&o.op[0]===o.np[0]&&o.o.index()<o.cp&&o.cp++;o.or=o.np.find(" > ul > li:nth-child("+(o.cp+1)+")");u=o}this.__callback(u);i&&i.call(this,u)},check_move:function(){var e=u,t=!0,n=-1===e.r?this.get_container():e.r;if(!e||!e.o||e.or[0]===e.o[0]||e.op&&e.np&&e.op[0]===e.np[0]&&e.cp-1===e.o.index())return!1;e.o.each(function(){if(-1!==n.parentsUntil(".jstree","li").andSelf().index(this))return t=!1});return t},move_node:function(t,n,r,i,s,o){if(!s)return this.prepare_move(t,n,r,function(e){this.move_node(e,!1,!1,i,!0,o)});i&&(u.cy=!0);if(!o&&!this.check_move())return!1;this.__rollback();n=!1;i?(n=t.o.clone(!0),n.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)})):n=t.o;t.or.length?t.or.before(n):(t.np.children("ul").length||e("<ul />").appendTo(t.np),t.np.children("ul:eq(0)").append(n));try{t.ot.clean_node(t.op),t.rt.clean_node(t.np),t.op.find("> ul > li").length||t.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(a){}i&&(u.cy=!0,u.oc=n);this.__callback(u);return u},_get_move:function(){return u}}})})(e);(function(e){var t,n,r;e(function(){/msie/.test(navigator.userAgent.toLowerCase())?(n=e('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),r=e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body"),t=n.width()-r.width(),n.add(r).remove()):(n=e("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200}),t=100-n.width(),n.parent().remove())});e.jstree.plugin("ui",{__init:function(){this.data.ui.selected=e();this.data.ui.last_selected=!1;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",e.proxy(function(t){t.preventDefault();t.currentTarget.blur();e(t.currentTarget).hasClass("jstree-loading")||this.select_node(t.currentTarget,!0,t)},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.hover_node(t.target)},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){e(t.currentTarget).hasClass("jstree-loading")||this.dehover_node(t.target)},this)).bind("reopen.jstree",e.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",e.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",e.proxy(function(){this.reselect()},this)).bind("close_node.jstree",e.proxy(function(t,n){var r=this._get_settings().ui,i=this._get_node(n.rslt.obj),s=i&&i.length?i.children("ul").find("a.jstree-clicked"):e(),o=this;!1!==r.selected_parent_close&&s.length&&s.each(function(){o.deselect_node(this);"select_parent"===r.selected_parent_close&&o.select_node(i)})},this)).bind("delete_node.jstree",e.proxy(function(e,t){var n=this._get_settings().ui.select_prev_on_delete,r=this._get_node(t.rslt.obj),r=r&&r.length?r.find("a.jstree-clicked"):[],i=this;r.each(function(){i.deselect_node(this)});n&&r.length&&t.rslt.prev.each(function(){if(this.parentNode)return i.select_node(this),!1})},this)).bind("move_node.jstree",e.proxy(function(e,t){t.rslt.cy&&t.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:!0,select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(t,n){if("undefined"==typeof t||null===t)return n?this.data.ui.selected:this.data.ui.last_selected;var r=e(t,this.get_container());if(r.is(".jstree")||-1==t)return-1;r=r.closest("li",this.get_container());return r.length?r:!1},_ui_notify:function(e,t){t.selected&&this.select_node(e,!1)},save_selected:function(){var e=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){this.id&&e.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))});this.__callback(this.data.ui.to_select)},reselect:function(){var t=this,n=this.data.ui.to_select,n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});e.each(n,function(e,n){n&&"#"!==n&&t.select_node(n)});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(){this.save_selected();return this.__call_old()},hover_node:function(e){e=this._get_node(e);if(!e.length)return!1;e.hasClass("jstree-hovered")||this.dehover_node();this.data.ui.hovered=e.children("a").addClass("jstree-hovered").parent();this._fix_scroll(e);this.__callback({obj:e})},dehover_node:function(){var e=this.data.ui.hovered;if(!e||!e.length)return!1;this.data.ui.hovered[0]===e.children("a").removeClass("jstree-hovered").parent()[0]&&(this.data.ui.hovered=null);this.__callback({obj:e})},select_node:function(e,t,n){e=this._get_node(e);if(-1==e||!e||!e.length)return!1;var r=this._get_settings().ui,i="on"==r.select_multiple_modifier||!1!==r.select_multiple_modifier&&n&&n[r.select_multiple_modifier+"Key"],s=!1!==r.select_range_modifier&&n&&n[r.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==e[0]&&this.data.ui.last_selected.parent()[0]===e.parent()[0],o=this.is_selected(e),u=!0,a=this;if(t){if(r.disable_selecting_children&&i&&(e.parentsUntil(".jstree","li").children("a.jstree-clicked").length||e.children("ul").find("a.jstree-clicked:eq(0)").length))return!1;u=!1;switch(!0){case s:this.data.ui.last_selected.addClass("jstree-last-selected");e=e[e.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();-1==r.select_limit||e.length<r.select_limit?(this.data.ui.last_selected.removeClass("jstree-last-selected"),this.data.ui.selected.each(function(){this!==a.data.ui.last_selected[0]&&a.deselect_node(this)}),o=!1,u=!0):u=!1;break;case o&&!i:this.deselect_all();o=!1;u=!0;break;case!o&&!i:if(-1==r.select_limit||0<r.select_limit)this.deselect_all(),u=!0;break;case o&&i:this.deselect_node(e);break;case!o&&i:if(-1==r.select_limit||this.data.ui.selected.length+1<=r.select_limit)u=!0}}u&&!o&&(s||(this.data.ui.last_selected=e),e.children("a").addClass("jstree-clicked"),r.selected_parent_open&&e.parents(".jstree-closed").each(function(){a.open_node(this,!1,!0)}),this.data.ui.selected=this.data.ui.selected.add(e),this._fix_scroll(e.eq(0)),this.__callback({obj:e,e:n}))},_fix_scroll:function(e){var n=this.get_container()[0];n.scrollHeight>n.offsetHeight&&(e=this._get_node(e))&&-1!==e&&!!e.length&&!!e.is(":visible")&&(e=e.offset().top-this.get_container().offset().top,0>e&&(n.scrollTop=n.scrollTop+e-1),e+this.data.core.li_height+(n.scrollWidth>n.offsetWidth?t:0)>n.offsetHeight)&&(n.scrollTop+=e-n.offsetHeight+this.data.core.li_height+1+(n.scrollWidth>n.offsetWidth?t:0))},deselect_node:function(e){e=this._get_node(e);if(!e.length)return!1;this.is_selected(e)&&(e.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(e),this.data.ui.last_selected.get(0)===e.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:e}))},toggle_select:function(e){e=this._get_node(e);if(!e.length)return!1;this.is_selected(e)?this.deselect_node(e):this.select_node(e)},is_selected:function(e){return 0<=this.data.ui.selected.index(this._get_node(e))},get_selected:function(t){return t?e(t).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(t){t=t?e(t).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();t.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=e([]);this.data.ui.last_selected=!1;this.__callback({obj:t})}}});e.jstree.defaults.plugins.push("ui")})(e);(function(e){e.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",e.proxy(function(e,t){if(this._get_settings().crrm.move.open_onmove){var n=this;t.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){n.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(){return!0}}},_fn:{_show_input:function(t,n){var t=this._get_node(t),r=this._get_settings().core.rtl,i=this._get_settings().crrm.input_width_limit,s=t.children("ins").width(),o=t.find("> a:visible > ins").width()*t.find("> a:visible > ins").length,u=this.get_text(t),f=e("<div />",{css:{position:"absolute",top:"-200px",left:r?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),l=t.css("position","relative").append(e("<input />",{value:u,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:r?"auto":s+o+4+"px",right:r?s+o+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:e.proxy(function(){var e=t.children(".jstree-rename-input"),r=e.val();""===r&&(r=u);f.remove();e.remove();this.set_text(t,u);this.rename_node(t,r);n.call(this,t,r,u);t.css("position","")},this),keyup:function(e){e=e.keyCode||e.which;27==e?(this.value=u,this.blur()):13==e?this.blur():l.width(Math.min(f.text("pW"+this.value).width(),i))},keypress:function(e){if(13==(e.keyCode||e.which))return!1}})).children(".jstree-rename-input");this.set_text(t,"");f.css({fontFamily:l.css("fontFamily")||"",fontSize:l.css("fontSize")||"",fontWeight:l.css("fontWeight")||"",fontStyle:l.css("fontStyle")||"",fontStretch:l.css("fontStretch")||"",fontVariant:l.css("fontVariant")||"",letterSpacing:l.css("letterSpacing")||"",wordSpacing:l.css("wordSpacing")||""});l.width(Math.min(f.text("pW"+l[0].value).width(),i))[0].select()},rename:function(e){e=this._get_node(e);this.__rollback();var t=this.__callback;this._show_input(e,function(e,n,r){t.call(this,{obj:e,new_name:n,old_name:r})})},create:function(t,n,r,i,s){var o=this;(t=this._get_node(t))||(t=-1);this.__rollback();return this.create_node(t,n,r,function(t){var n=this._get_parent(t),r=e(t).index();i&&i.call(this,t);n.length&&n.hasClass("jstree-closed")&&this.open_node(n,!1,!0);s?o.__callback({obj:t,name:this.get_text(t),parent:n,position:r}):this._show_input(t,function(e,t){o.__callback({obj:e,name:t,parent:n,position:r})})})},remove:function(e){var e=this._get_node(e,!0),t=this._get_parent(e),n=this._get_prev(e);this.__rollback();e=this.delete_node(e);!1!==e&&this.__callback({obj:e,prev:n,parent:t})},check_move:function(){return!this.__call_old()||!this._get_settings().crrm.move.check_move.call(this,this._get_move())?!1:!0},move_node:function(e,t,n,r,i,s){var o=this._get_settings().crrm.move;if(!i)return"undefined"==typeof n&&(n=o.default_position),"inside"===n&&!o.default_position.match(/^(before|after)$/)&&(n=o.default_position),this.__call_old(!0,e,t,n,r,!1,s);if(!0===o.always_copy||"multitree"===o.always_copy&&e.rt.get_index()!==e.ot.get_index())r=!0;this.__call_old(!0,e,t,n,r,!0,s)},cut:function(e){e=this._get_node(e,!0);if(!e||!e.length)return!1;this.data.crrm.cp_nodes=!1;this.data.crrm.ct_nodes=e;this.__callback({obj:e})},copy:function(e){e=this._get_node(e,!0);if(!e||!e.length)return!1;this.data.crrm.ct_nodes=!1;this.data.crrm.cp_nodes=e;this.__callback({obj:e})},paste:function(e){e=this._get_node(e);if(!e||!e.length)return!1;var t=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&(this.move_node(this.data.crrm.ct_nodes,e),this.data.crrm.ct_nodes=!1);this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,e,!1,!0);this.__callback({obj:e,nodes:t})}}})})(e);(function(e){var t=[];e.jstree._themes=!1;e.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",e.proxy(function(){var e=this._get_settings().themes;this.data.themes.dots=e.dots;this.data.themes.icons=e.icons;this.set_theme(e.theme,e.url)},this)).bind("loaded.jstree",e.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(n,r){if(!n)return!1;r||(r=e.jstree._themes+n+"/style.css");-1==e.inArray(r,t)&&(e.vakata.css.add_sheet({url:r}),t.push(r));this.data.themes.theme!=n&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=n);this.get_container().addClass("jstree-"+n);this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons();this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}});e(function(){!1===e.jstree._themes&&e("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return e.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1});!1===e.jstree._themes&&(e.jstree._themes="themes/")});e.jstree.defaults.plugins.push("themes")})(e);(function(e){var t=[];e.jstree.plugin("hotkeys",{__init:function(){if("undefined"==typeof e.hotkeys)throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";e.each(this._get_settings().hotkeys,function(n,r){!1!==r&&-1==e.inArray(n,t)&&(e(document).bind("keydown",n,function(t){var r,i=e.jstree._focused(),s;i&&i.data&&i.data.hotkeys&&i.data.hotkeys.enabled&&(s=i._get_settings().hotkeys[n])&&(r=s.call(i,t));return r}),t.push(n))});this.get_container().bind("lock.jstree",e.proxy(function(){this.data.hotkeys.enabled&&(this.data.hotkeys.enabled=!1,this.data.hotkeys.revert=!0)},this)).bind("unlock.jstree",e.proxy(function(){this.data.hotkeys.revert&&(this.data.hotkeys.enabled=!0)},this));this.enable_hotkeys()},defaults:{up:function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+up":function(){this.hover_node(this._get_prev(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},down:function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"ctrl+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},"shift+down":function(){this.hover_node(this._get_next(this.data.ui.hovered||this.data.ui.last_selected||-1));return!1},left:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e)));return!1},"ctrl+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e)));return!1},"shift+left":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;e&&(e.hasClass("jstree-open")?this.close_node(e):this.hover_node(this._get_prev(e)));return!1},right:function(){var e=this.data.ui.hovered||this.data.ui.last_selected;e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e)));return!1},"ctrl+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e)));return!1},"shift+right":function(){var e=this.data.ui.hovered||this.data.ui.last_selected;e&&e.length&&(e.hasClass("jstree-closed")?this.open_node(e):this.hover_node(this._get_next(e)));return!1},space:function(){this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click();return!1},"ctrl+space":function(e){e.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e);return!1},"shift+space":function(e){e.type="click";this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(e);return!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})})(e);(function(e){e.jstree.plugin("json_data",{__init:function(){this._get_settings().json_data.progressive_unload&&this.get_container().bind("after_close.jstree",function(e,t){t.rslt.obj.children("ul").remove()})},defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1,progressive_unload:!1},_fn:{load_node:function(e,t,n){var r=this;this.load_node_json(e,function(){r.__callback({obj:r._get_node(e)});t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().json_data,t=this._get_node(t);return-1==t||!t||!n.ajax&&!n.progressive_render&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||0<t.children("ul").children("li").length},refresh:function(t){var t=this._get_node(t),n=this._get_settings().json_data;t&&-1!==t&&n.progressive_unload&&(e.isFunction(n.data)||n.ajax)&&t.removeData("jstree-children");return this.__call_old()},load_node_json:function(t,n,r){var i=this.get_settings().json_data,s,o=function(){};s=function(){};if((t=this._get_node(t))&&-1!==t&&(i.progressive_render||i.progressive_unload)&&!t.is(".jstree-open, .jstree-leaf")&&0===t.children("ul").children("li").length&&t.data("jstree-children")){if(s=this._parse_json(t.data("jstree-children"),t))t.append(s),i.progressive_unload||t.removeData("jstree-children");this.clean_node(t);n&&n.call(this)}else{if(t&&-1!==t){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(i.data):i.data.call(this,t,e.proxy(function(e){if(e=this._parse_json(e,t)){if(t===-1||!t)this.get_container().children("ul").empty().append(e.children());else{t.append(e).children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading")}this.clean_node(t);n&&n.call(this)}else{if(t===-1||!t)i.correct_state&&this.get_container().children("ul").empty();else{t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");i.correct_state&&this.correct_state(t)}r&&r.call(this)}},this));break;case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||-1===t):if(!t||-1==t)(s=this._parse_json(i.data,t))?(this.get_container().children("ul").empty().append(s.children()),this.clean_node()):i.correct_state&&this.get_container().children("ul").empty();n&&n.call(this);break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&-1!==t:o=function(e,n,s){var o=this.get_settings().json_data.ajax.error;o&&o.call(this,e,n,s);if(t!=-1&&t.length){t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");n==="success"&&i.correct_state&&this.correct_state(t)}else n==="success"&&i.correct_state&&this.get_container().children("ul").empty();r&&r.call(this)},s=function(r,s,u){var f=this.get_settings().json_data.ajax.success;f&&(r=f.call(this,r,s,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")===""||!e.isArray(r)&&!e.isPlainObject(r))return o.call(this,u,s,"");if(r=this._parse_json(r,t)){if(t===-1||!t)this.get_container().children("ul").empty().append(r.children());else{t.append(r).children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading")}this.clean_node(t);n&&n.call(this)}else if(t===-1||!t){if(i.correct_state){this.get_container().children("ul").empty();n&&n.call(this)}}else{t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");if(i.correct_state){this.correct_state(t);n&&n.call(this)}}},i.ajax.context=this,i.ajax.error=o,i.ajax.success=s,i.ajax.dataType||(i.ajax.dataType="json"),e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),e.ajax(i.ajax)}}},_parse_json:function(t,n,r){var i=!1,s=this._get_settings(),o=s.json_data,u=s.core.html_titles,f;if(!t)return i;o.progressive_unload&&n&&-1!==n&&n.data("jstree-children",i);if(e.isArray(t)){i=e();if(!t.length)return!1;s=0;for(o=t.length;s<o;s++)f=this._parse_json(t[s],n,!0),f.length&&(i=i.add(f))}else{"string"==typeof t&&(t={data:t});if(!t.data&&""!==t.data)return i;i=e("<li />");t.attr&&i.attr(t.attr);t.metadata&&i.data(t.metadata);t.state&&i.addClass("jstree-"+t.state);e.isArray(t.data)||(f=t.data,t.data=[],t.data.push(f));e.each(t.data,function(n,r){f=e("<a />");e.isFunction(r)&&(r=r.call(this,t));if(typeof r=="string")f.attr("href","#")[u?"html":"text"](r);else{r.attr||(r.attr={});r.attr.href||(r.attr.href="#");f.attr(r.attr)[u?"html":"text"](r.title);r.language&&f.addClass(r.language)}f.prepend("<ins class='jstree-icon'>&#160;</ins>");!r.icon&&t.icon&&(r.icon=t.icon);r.icon&&(r.icon.indexOf("/")===-1?f.children("ins").addClass(r.icon):f.children("ins").css("background","url('"+r.icon+"') center center no-repeat"));i.append(f)});i.prepend("<ins class='jstree-icon'>&#160;</ins>");t.children&&(o.progressive_render&&"open"!==t.state?i.addClass("jstree-closed").data("jstree-children",t.children):(o.progressive_unload&&i.data("jstree-children",t.children),e.isArray(t.children)&&t.children.length&&(f=this._parse_json(t.children,n,!0),f.length&&(n=e("<ul />"),n.append(f),i.append(n)))))}r||(r=e("<ul />"),r.append(i),i=r);return i},get_json:function(t,n,r,i){var s=[],o=this._get_settings(),u=this,f,l,c,h,p,d,t=this._get_node(t);if(!t||-1===t)t=this.get_container().find("> ul > li");n=e.isArray(n)?n:["id","class"];!i&&this.data.types&&n.push(o.types.type_attr);r=e.isArray(r)?r:[];t.each(function(){c=e(this);f={data:[]};n.length&&(f.attr={});e.each(n,function(e,t){(l=c.attr(t))&&l.length&&l.replace(/jstree[^ ]*/ig
,"").length&&(f.attr[t]=(" "+l).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))});c.hasClass("jstree-open")&&(f.state="open");c.hasClass("jstree-closed")&&(f.state="closed");c.data()&&(f.metadata=c.data());h=c.children("a");h.each(function(){p=e(this);if(r.length||e.inArray("languages",o.plugins)!==-1||p.children("ins").get(0).style.backgroundImage.length||p.children("ins").get(0).className&&p.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length){d=!1;e.inArray("languages",o.plugins)!==-1&&e.isArray(o.languages)&&o.languages.length&&e.each(o.languages,function(e,t){if(p.hasClass(t)){d=t;return!1}});l={attr:{},title:u.get_text(p,d)};e.each(r,function(e,t){l.attr[t]=(" "+(p.attr(t)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")});e.inArray("languages",o.plugins)!==-1&&e.isArray(o.languages)&&o.languages.length&&e.each(o.languages,function(e,t){if(p.hasClass(t)){l.language=t;return!0}});p.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(l.icon=p.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""));p.children("ins").get(0).style.backgroundImage.length&&(l.icon=p.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))}else l=u.get_text(p);h.length>1?f.data.push(l):f.data=l});c=c.find("> ul > li");c.length&&(f.children=u.get_json(c,n,r,!0));s.push(f)});return s}}})})(e);(function(e){e.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(t){var n=this._get_settings().languages,r=!1,i=".jstree-"+this.get_index()+" a";if(!e.isArray(n)||0===n.length)return!1;if(-1==e.inArray(t,n)){if(!n[t])return!1;t=n[t]}if(t==this.data.languages.current_language)return!0;r=e.vakata.css.get_css(i+"."+this.data.languages.current_language,!1,this.data.languages.language_css);!1!==r&&(r.style.display="none");r=e.vakata.css.get_css(i+"."+t,!1,this.data.languages.language_css);!1!==r&&(r.style.display="");this.data.languages.current_language=t;this.__callback(t);return!0},get_lang:function(){return this.data.languages.current_language},_get_string:function(t,n){var r=this._get_settings().languages,i=this._get_settings().core.strings;e.isArray(r)&&r.length&&(n=n&&-1!=e.inArray(n,r)?n:this.data.languages.current_language);return i[n]&&i[n][t]?i[n][t]:i[t]?i[t]:t},get_text:function(t,n){t=this._get_node(t)||this.data.ui.last_selected;if(!t.size())return!1;var r=this._get_settings().languages,i=this._get_settings().core.html_titles;e.isArray(r)&&r.length?(n=n&&-1!=e.inArray(n,r)?n:this.data.languages.current_language,t=t.children("a."+n)):t=t.children("a:eq(0)");if(i)return t=t.clone(),t.children("INS").remove(),t.html();t=t.contents().filter(function(){return this.nodeType==3})[0];return t.nodeValue},set_text:function(t,n,r){t=this._get_node(t)||this.data.ui.last_selected;if(!t.size())return!1;var i=this._get_settings().languages,s=this._get_settings().core.html_titles;e.isArray(i)&&i.length?(r=r&&-1!=e.inArray(r,i)?r:this.data.languages.current_language,t=t.children("a."+r)):t=t.children("a:eq(0)");if(s)return i=t.children("INS").clone(),t.html(n).prepend(i),this.__callback({obj:t,name:n,lang:r}),!0;t=t.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:t,name:n,lang:r});return t.nodeValue=n},_load_css:function(){var t=this._get_settings().languages,n="/* languages css */",r=".jstree-"+this.get_index()+" a",i;if(e.isArray(t)&&t.length){this.data.languages.current_language=t[0];for(i=0;i<t.length;i++)n+=r+"."+t[i]+" {",t[i]!=this.data.languages.current_language&&(n+=" display:none; "),n+=" } ";this.data.languages.language_css=e.vakata.css.add_sheet({str:n,title:"jstree-languages"})}},create_node:function(t,n,r,i){return this.__call_old(!0,t,n,r,function(t){var n=this._get_settings().languages,r=t.children("a"),s;if(e.isArray(n)&&n.length){for(s=0;s<n.length;s++)r.is("."+n[s])||t.append(r.eq(0).clone().removeClass(n.join(" ")).addClass(n[s]));r.not("."+n.join(", .")).remove()}i&&i.call(this,t)})}}})})(e);(function(e){e.jstree.plugin("cookies",{__init:function(){if("undefined"==typeof e.cookie)throw"jsTree cookie: jQuery cookie plugin not included.";var t=this._get_settings().cookies,n;t.save_loaded&&(n=e.cookie(t.save_loaded))&&n.length&&(this.data.core.to_load=n.split(","));t.save_opened&&(n=e.cookie(t.save_opened))&&n.length&&(this.data.core.to_open=n.split(","));t.save_selected&&(n=e.cookie(t.save_selected))&&n.length&&this.data.ui&&(this.data.ui.to_select=n.split(","));this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",e.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",e.proxy(function(e){this._get_settings().cookies.auto_save&&this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(t){if(!this.data.core.refreshing){var n=this._get_settings().cookies;if(t)switch(t){case"open_node":case"close_node":n.save_opened&&(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options));n.save_loaded&&(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options));break;case"select_node":case"deselect_node":n.save_selected&&this.data.ui&&(this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options))}else if(n.save_loaded&&(this.save_loaded(),e.cookie(n.save_loaded,this.data.core.to_load.join(","),n.cookie_options)),n.save_opened&&(this.save_opened(),e.cookie(n.save_opened,this.data.core.to_open.join(","),n.cookie_options)),n.save_selected&&this.data.ui)this.save_selected(),e.cookie(n.save_selected,this.data.ui.to_select.join(","),n.cookie_options)}}}})})(e);(function(e){e.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",e.proxy(function(e,t){var n=this._get_node(t.rslt.obj),n=-1===n?this.get_container().children("ul"):n.children("ul");this.sort(n)},this)).bind("rename_node.jstree create_node.jstree create.jstree",e.proxy(function(e,t){this.sort(t.rslt.obj.parent())},this)).bind("move_node.jstree",e.proxy(function(e,t){this.sort((-1==t.rslt.np?this.get_container():t.rslt.np).children("ul"))},this))},defaults:function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},_fn:{sort:function(t){var n=this._get_settings().sort,r=this;t.append(e.makeArray(t.children("li")).sort(e.proxy(n,r)));t.find("> li > ul").each(function(){r.sort(e(this))});this.clean_node(t)}}})})(e);(function(e){var t=!1,n=!1,r=!1,i=!1,s=!1,o=!1,u=!1,a=!1,f=!1;e.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(t,n,r){e.vakata.dnd.is_drag&&e.vakata.drag_stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.MozUserSelect="none")}catch(i){}e.vakata.dnd.init_x=t.pageX;e.vakata.dnd.init_y=t.pageY;e.vakata.dnd.user_data=n;e.vakata.dnd.is_down=!0;e.vakata.dnd.helper=e("<div id='vakata-dragged' />").html(r);e(document).bind("mousemove",e.vakata.dnd.drag);e(document).bind("mouseup",e.vakata.dnd.drag_stop);return!1},drag:function(t){if(e.vakata.dnd.is_down){if(!e.vakata.dnd.is_drag){if(!(5<Math.abs(t.pageX-e.vakata.dnd.init_x)||5<Math.abs(t.pageY-e.vakata.dnd.init_y)))return;e.vakata.dnd.helper.appendTo("body"),e.vakata.dnd.is_drag=!0,e(document).triggerHandler("drag_start.vakata",{event:t,data:e.vakata.dnd.user_data})}if("mousemove"===t.type){var n=e(document),r=n.scrollTop(),n=n.scrollLeft();if(20>t.pageY-r){if(o&&"down"===u&&(clearInterval(o),o=!1),!o)u="up",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()-e.vakata.dnd.scroll_spd)},150)}else o&&"up"===u&&(clearInterval(o),o=!1);if(20>e(window).height()-(t.pageY-r)){if(o&&"up"===u&&(clearInterval(o),o=!1),!o)u="down",o=setInterval(function(){e(document).scrollTop(e(document).scrollTop()+e.vakata.dnd.scroll_spd)},150)}else o&&"down"===u&&(clearInterval(o),o=!1);if(20>t.pageX-n){if(s&&"right"===a&&(clearInterval(s),s=!1),!s)a="left",s=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()-e.vakata.dnd.scroll_spd)},150)}else s&&"left"===a&&(clearInterval(s),s=!1);if(20>e(window).width()-(t.pageX-n)){if(s&&"left"===a&&(clearInterval(s),s=!1),!s)a="right",s=setInterval(function(){e(document).scrollLeft(e(document).scrollLeft()+e.vakata.dnd.scroll_spd)},150)}else s&&"right"===a&&(clearInterval(s),s=!1)}e.vakata.dnd.helper.css({left:t.pageX+e.vakata.dnd.helper_left+"px",top:t.pageY+e.vakata.dnd.helper_top+"px"});e(document).triggerHandler("drag.vakata",{event:t,data:e.vakata.dnd.user_data})}},drag_stop:function(t){s&&clearInterval(s);o&&clearInterval(o);e(document).unbind("mousemove",e.vakata.dnd.drag);e(document).unbind("mouseup",e.vakata.dnd.drag_stop);e(document).triggerHandler("drag_stop.vakata",{event:t,data:e.vakata.dnd.user_data});e.vakata.dnd.helper.remove();e.vakata.dnd.init_x=0;e.vakata.dnd.init_y=0;e.vakata.dnd.user_data={};e.vakata.dnd.is_down=!1;e.vakata.dnd.is_drag=!1}};e(function(){e.vakata.css.add_sheet({str:"#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ",title:"vakata"})});e.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1,mto:!1};this.get_container().bind("mouseenter.jstree",e.proxy(function(n){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.themes&&(r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target)&&(n=e.jstree._reference(n.target),n.data.dnd.foreign?(n=n._get_settings().dnd.drag_check.call(this,{o:t,r:n.get_container(),is_root:!0}),(!0===n||!0===n.inside||!0===n.before||!0===n.after)&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")):(n.prepare_move(t,n.get_container(),"last"),n.check_move()&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")))},this)).bind("mouseup.jstree",e.proxy(function(n){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&n.currentTarget===n.target&&e.vakata.dnd.user_data.obj&&e(e.vakata.dnd.user_data.obj).length&&e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==n.target){var r=e.jstree._reference(n.currentTarget);r.data.dnd.foreign?(n=r._get_settings().dnd.drag_check.call(this,{o:t,r:r.get_container(),is_root:!0}),(!0===n||!0===n.inside||!0===n.before||!0===n.after)&&r._get_settings().dnd.drag_finish.call(this,{o:t,r:r.get_container(),is_root:!0})):r.move_node(t,r.get_container(),"last",n[r._get_settings().dnd.copy_modifier+"Key"])}},this)).bind("mouseleave.jstree",e.proxy(function(t){if(t.relatedTarget&&t.relatedTarget.id&&"jstree-marker-line"===t.relatedTarget.id)return!1;e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"))},this)).bind("mousemove.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){var n=this.get_container()[0];t.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft+=e.vakata.dnd.scroll_spd},n),100)):t.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(e.proxy(function(){this.scrollLeft-=e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1);t.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop=this.scrollTop+e.vakata.dnd.scroll_spd},n),100)):t.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(e.proxy(function(){this.scrollTop=this.scrollTop-e.vakata.dnd.scroll_spd},n),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("scroll.jstree",e.proxy(function(){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&r&&i&&(r.hide(),i.hide())},this)).delegate("a","mousedown.jstree",e.proxy(function(e){if(1===e.which)return this.start_drag(e.currentTarget,e),!1},this)).delegate("a","mouseenter.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_enter(t.currentTarget)},this)).delegate("a","mousemove.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&((!n||!n.length||n.children("a")[0]!==t.currentTarget)&&this.dnd_enter(t.currentTarget),"undefined"==typeof this.data.dnd.off.top&&(this.data.dnd.off=e(t.target).offset()),this.data.dnd.w=(t.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,0>this.data.dnd.w&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",e.proxy(function(t){if(e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree){if(t.relatedTarget&&t.relatedTarget.id&&"jstree-marker-line"===t.relatedTarget.id)return!1;r&&r.hide();i&&i.hide();this.data.dnd.mto=setTimeout(function(e){return function(){e.dnd_leave(t)}}(this),0)}},this)).delegate("a","mouseup.jstree",e.proxy(function(t){e.vakata.dnd.is_drag&&e.vakata.dnd.user_data.jstree&&this.dnd_finish(t)},this));e(document).bind("drag_stop.vakata",e.proxy(function(){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1);this.data.dnd.to2&&clearTimeout(this.data.dnd.to2);this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i2&&clearInterval(this.data.dnd.i2);this.data.dnd.after=!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;this.data.dnd.off=!1;this.data.dnd.prepared=!1;this.data.dnd.w=!1;this.data.dnd.to1=!1;this.data.dnd.to2=!1;this.data.dnd.i1=!1;this.data.dnd.i2=!1;this.data.dnd.active=!1;this.data.dnd.foreign=!1;r&&r.css({top:"-2000px"});i&&i.css({top:"-2000px"})},this)).bind("drag_start.vakata",e.proxy(function(t,n){if(n.data.jstree){var r=e(n.event.target);r.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(r)}},this));var s=this._get_settings().dnd;s.drag_target&&e(document).delegate(s.drag_target,"mousedown.jstree-"+this.get_index(),e.proxy(function(n){t=n.target;e.vakata.dnd.drag_start(n,{jstree:!0,obj:n.target},"<ins class='jstree-icon'></ins>"+e(n.target).text());this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var s=this.get_container();this.data.dnd.cof=s.offset();this.data.dnd.cw=parseInt(s.width(),10);this.data.dnd.ch=parseInt(s.height(),10);this.data.dnd.foreign=!0;n.preventDefault()},this));s.drop_target&&e(document).delegate(s.drop_target,"mouseenter.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:t,r:e(n.target),e:n})&&e.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(s.drop_target,"mouseleave.jstree-"+this.get_index(),e.proxy(function(){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(s.drop_target,"mouseup.jstree-"+this.get_index(),e.proxy(function(n){this.data.dnd.active&&e.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:t,r:e(n.target),e:n})},this))},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(){return!0},drop_finish:e.noop,drag_target:".jstree-draggable",drag_finish:e.noop,drag_check:function(){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(n&&n.length){this.data.dnd.off=n.offset();this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+n.width());if(this.data.dnd.foreign){var e=this._get_settings().dnd.drag_check.call(this,{o:t,r:n});this.data.dnd.after=e.after;this.data.dnd.before=e.before;this.data.dnd.inside=e.inside;this.data.dnd.prepared=!0;return this.dnd_show()}this.prepare_move(t,n,"before");this.data.dnd.before=this.check_move();this.prepare_move(t,n,"after");this.data.dnd.after=this.check_move();this._is_loaded(n)?(this.prepare_move(t,n,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1;this.data.dnd.prepared=!0;return this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var t=["before","inside","after"],n=!1,s=this._get_settings().core.rtl,t=this.data.dnd.w<this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=2*this.data.core.li_height/3?this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"];e.each(t,e.proxy(function(t,r){if(this.data.dnd[r])return e.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),n=r,!1},this));!1===n&&e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");t=s?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(n){case"before":r.css({left:t+"px",top:this.data.dnd.off.top-6+"px"}).show();i&&i.css({left:t+8+"px",top:this.data.dnd.off.top-1+"px"}).show();break;case"after":r.css({left:t+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show();i&&i.css({left:t+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show();break;case"inside":r.css({left:t+(s?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();i&&i.hide();break;default:r.hide(),i&&i.hide()}return f=n}},dnd_open:function(){this.data.dnd.to2=!1;this.open_node(n,e.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(e){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:t,r:n,p:f}):(this.dnd_prepare(),this.move_node(t,n,f,e[this._get_settings().dnd.copy_modifier+"Key"]));n=t=!1;r.hide();i&&i.hide()},dnd_enter:function(t){this.data.dnd.mto&&(clearTimeout(this.data.dnd.mto),this.data.dnd.mto=!1);var r=this._get_settings().dnd;this.data.dnd.prepared=!1;n=this._get_node(t);r.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(e.proxy(this.dnd_prepare,this),r.check_timeout)):this.dnd_prepare();r.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),n&&n.length&&n.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout(e.proxy(this.dnd_open,this),r.open_timeout))):n&&n.length&&n.hasClass("jstree-closed")&&this.dnd_open()},dnd_leave:function(t){this.data.dnd.after=!1;this.data.dnd.before=!1;this.data.dnd.inside=!1;e.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");r.hide();i&&i.hide();n&&n[0]===t.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2)&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1)},start_drag:function(n,s){t=this._get_node(n);this.data.ui&&this.is_selected(t)&&(t=this._get_node(null,!0));var o=1<t.length?this._get_string("multiple_selection"):this.get_text(t),u=this.get_container();this._get_settings().core.html_titles||(o=o.replace(/</ig,"&lt;").replace(/>/ig,"&gt;"));e.vakata.dnd.drag_start(s,{jstree:!0,obj:t},"<ins class='jstree-icon'></ins>"+o);this.data.themes&&(r&&r.attr("class","jstree-"+this.data.themes.theme),i&&i.attr("class","jstree-"+this.data.themes.theme),e.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));this.data.dnd.cof=u.offset();this.data.dnd.cw=parseInt(u.width(),10);this.data.dnd.ch=parseInt(u.height(),10);this.data.dnd.active=!0}}});e(function(){e.vakata.css.add_sheet({str:"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }",title:"jstree"});r=e("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){r.hide();i.hide();e.preventDefault();e.stopImmediatePropagation();return!1}).appendTo("body");i=e("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){if(n&&n.length)return n.children("a").trigger(e),e.preventDefault(),e.stopImmediatePropagation(),!1}).bind("mouseleave",function(t){var s=e(t.relatedTarget);if((s.is(".jstree")||0===s.closest(".jstree").length)&&n&&n.length)return n.children("a").trigger(t),r.hide(),i.hide(),t.preventDefault(),t.stopImmediatePropagation(),!1}).appendTo("body");e(document).bind("drag_start.vakata",function(e,t){t.data.jstree&&(r.show(),i&&i.show())});e(document).bind("drag_stop.vakata",function(e,t){t.data.jstree&&(r.hide(),i&&i.hide())})})})(e);(function(e){e.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;this.data.ui&&this.data.checkbox.noui&&(this.select_node=this.deselect_node=this.deselect_all=e.noop,this.get_selected=this.get_checked);this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",e.proxy(function(e,t){this._prepare_checkboxes(t.rslt.obj)},this)).bind("loaded.jstree",e.proxy(function(){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",e.proxy(function(e){e.preventDefault();this._get_node(e.target).hasClass("jstree-checked")?this.uncheck_node(e.target):this.check_node(e.target);if(!this.data.ui||!this.data.checkbox.noui){e.stopImmediatePropagation();return!1}this.save_selected();this.data.cookies&&this.save_cookie("select_node")},this))},defaults:{override_ui:!1,two_state:!1,real_checkboxes:!1,checked_parent_open:!0,real_checkboxes_names:function(e){return["check_"+(e[0].id||Math.ceil(1e4*Math.random())),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(e,t){t.checked&&this.check_node(e,!1)},_prepare_checkboxes:function(t){t=!t||-1==t?this.get_container().find("> ul > li"):this._get_node(t);if(!1!==t){var n,r=this,i,s=this._get_settings().checkbox.two_state,o=this._get_settings().checkbox.real_checkboxes,u=this._get_settings().checkbox.real_checkboxes_names;t.each(function(){i=e(this);n=i.is("li")&&(i.hasClass("jstree-checked")||o&&i.children(":checked").length)?"jstree-checked":"jstree-unchecked";i.find("li").andSelf().each(function(){var t=e(this),i;t.children("a"+(r.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(s?"jstree-unchecked":n);o&&(t.children(":checkbox").length?t.children(":checkbox").addClass("jstree-real-checkbox"):(i=u.call(r,t),t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+i[0]+"' name='"+i[0]+"' value='"+i[1]+"' />")),"jstree-checked"===n&&t.children(":checkbox").attr("checked","checked"));"jstree-checked"===n&&!s&&t.find("li").addClass("jstree-checked")})});s||(1===t.length&&t.is("li")&&this._repair_state(t),t.is("li")?t.each(function(){r._repair_state(this)}):t.find("> ul > li").each(function(){r._repair_state(this)}),t.find(".jstree-checked").parent().parent().each(function(){r._repair_state(this)}))}},change_state:function(t,n){var t=this._get_node(t),r=!1,i=this._get_settings().checkbox.real_checkboxes;if(!t||-1===t)return!1;n=!1===n||!0===n?n:t.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state)n?(t.removeClass("jstree-checked").addClass("jstree-unchecked"),i&&t.children(":checkbox").removeAttr("checked")):(t.removeClass("jstree-unchecked").addClass("jstree-checked"),i&&t.children(":checkbox").attr("checked","checked"));else{if(n){r=t.find("li").andSelf();if(!r.filter(".jstree-checked, .jstree-undetermined").length)return!1;r.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");i&&r.children(":checkbox").removeAttr("checked")}else{r=t.find("li").andSelf();if(!r.filter(".jstree-unchecked, .jstree-undetermined").length)return!1;r.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");i&&r.children(":checkbox").attr("checked","checked");this.data.ui&&(this.data.ui.last_selected=t);this.data.checkbox.last_selected=t}t.parentsUntil(".jstree","li").each(function(){var t=e(this);if(n){if(t.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),i&&t.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"),!1;t.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");i&&t.children(":checkbox").removeAttr("checked")}else{if(t.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)return t.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),i&&t.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"),!1;t.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");i&&t.children(":checkbox").attr("checked","checked")}})}this.data.ui&&this.data.checkbox.noui&&(this.data.ui.selected=this.get_checked());this.__callback(t);return!0},check_node:function(e){if(this.change_state(e,!1)){e=this._get_node(e);if(this._get_settings().checkbox.checked_parent_open){var t=this;e.parents(".jstree-closed").each(function(){t.open_node(this,!1,!0)})}this.__callback({obj:e})}},uncheck_node:function(e){this.change_state(e,!0)&&this.__callback({obj:this._get_node(e)})},check_all:function(){var e=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){e.change_state(this,!1)});this.__callback()},uncheck_all:function(){var e=this;(this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li")).each(function(){e.change_state(this,!0)});this.__callback()},is_checked:function(e){e=this._get_node(e);return e.length?e.is(".jstree-checked"):!1},get_checked:function(e,t){e=!e||-1===e?this.get_container():this._get_node(e);return t||this._get_settings().checkbox.two_state?e.find(".jstree-checked"):e.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(e,t){e=!e||-1===e?this.get_container():this._get_node(e);return t||this._get_settings().checkbox.two_state?e.find(".jstree-unchecked"):e.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(e){e=this._get_node(e);if(e.length){var t=this._get_settings().checkbox.real_checkboxes,n=e.find("> ul > .jstree-checked").length,r=e.find("> ul > .jstree-undetermined").length,i=e.find("> ul > li").length;0===i?e.hasClass("jstree-undetermined")&&this.change_state(e,!1):0===n&&0===r?this.change_state(e,!0):n===i?this.change_state(e,!1):(e.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),t&&e.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked"))}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var t=this,n=this.data.ui.to_select,n=e.map(e.makeArray(n),function(e){return"#"+e.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.deselect_all();e.each(n,function(e,n){t.check_node(n)});this.__callback()}else this.__call_old()},save_loaded:function(){var e=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){this.id&&e.data.core.to_load.push("#"+this.id)})}}});e(function(){e.vakata.css.add_sheet({str:".jstree .jstree-real-checkbox { display:none; } ",title:"jstree"})})})(e);(function(e){e.vakata.xslt=function(t,n,r){var i="",s;if(document.recalc)return s=document.createElement("xml"),i=document.createElement("xml"),s.innerHTML=t,i.innerHTML=n,e("body").append(s).append(i),setTimeout(function(t,n,r){return function(){r.call(null,t.transformNode(n.XMLDocument));setTimeout(function(t,n){return function(){e(t).remove();e(n).remove()}}(t,n),200)}}(s,i,r),100),!0;"undefined"!=typeof window.DOMParser&&"undefined"!=typeof window.XMLHttpRequest&&"undefined"==typeof window.XSLTProcessor&&(t=(new DOMParser).parseFromString(t,"text/xml"),n=(new DOMParser).parseFromString(n,"text/xml"));if("undefined"!=typeof window.DOMParser&&"undefined"!=typeof window.XMLHttpRequest&&"undefined"!=typeof window.XSLTProcessor){s=new XSLTProcessor;i=e.isFunction(s.transformDocument)?"undefined"!=typeof window.XMLSerializer:!0;if(!i)return!1;t=(new DOMParser).parseFromString(t,"text/xml");n=(new DOMParser).parseFromString(n,"text/xml");e.isFunction(s.transformDocument)?(i=document.implementation.createDocument("","",null),s.transformDocument(t,n,i,null),r.call(null,(new XMLSerializer).serializeToString(i))):(s.importStylesheet(n),i=s.transformToFragment(t,document),r.call(null,e("<div />").append(i).html()));return!0}return!1};var t={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:copy-of select="./child::node()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>'
,flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:copy-of select="./child::node()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'},n=function(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};e.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0,get_skip_empty:!1,get_include_preamble:!0},_fn:{load_node:function(e,t,n){var r=this;this.load_node_xml(e,function(){r.__callback({obj:r._get_node(e)});t.call(this)},n)},_is_loaded:function(t){var n=this._get_settings().xml_data,t=this._get_node(t);return-1==t||!t||!n.ajax&&!e.isFunction(n.data)||t.is(".jstree-open, .jstree-leaf")||0<t.children("ul").children("li").size()},load_node_xml:function(t,n,r){var i=this.get_settings().xml_data,s=function(){},o=function(){};if((t=this._get_node(t))&&-1!==t){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case!i.data&&!i.ajax:throw"Neither data nor ajax settings supplied.";case e.isFunction(i.data):i.data.call(this,t,e.proxy(function(r){this.parse_xml(r,e.proxy(function(r){if(r){r=r.replace(/ ?xmlns="[^"]*"/ig,"");if(r.length>10){r=e(r);if(t===-1||!t)this.get_container().children("ul").empty().append(r.children());else{t.children("a.jstree-loading").removeClass("jstree-loading");t.append(r);t.removeData("jstree-is-loading")}i.clean_node&&this.clean_node(t);n&&n.call(this)}else if(t&&t!==-1){t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");if(i.correct_state){this.correct_state(t);n&&n.call(this)}}else if(i.correct_state){this.get_container().children("ul").empty();n&&n.call(this)}}},this))},this));break;case!!i.data&&!i.ajax||!!i.data&&!!i.ajax&&(!t||-1===t):(!t||-1==t)&&this.parse_xml(i.data,e.proxy(function(r){if(r){r=r.replace(/ ?xmlns="[^"]*"/ig,"");if(r.length>10){r=e(r);this.get_container().children("ul").empty().append(r.children());i.clean_node&&this.clean_node(t);n&&n.call(this)}}else if(i.correct_state){this.get_container().children("ul").empty();n&&n.call(this)}},this));break;case!i.data&&!!i.ajax||!!i.data&&!!i.ajax&&t&&-1!==t:s=function(e,n,s){var o=this.get_settings().xml_data.ajax.error;o&&o.call(this,e,n,s);if(t!==-1&&t.length){t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");n==="success"&&i.correct_state&&this.correct_state(t)}else n==="success"&&i.correct_state&&this.get_container().children("ul").empty();r&&r.call(this)},o=function(r,o,u){var r=u.responseText,f=this.get_settings().xml_data.ajax.success;f&&(r=f.call(this,r,o,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")==="")return s.call(this,u,o,"");this.parse_xml(r,e.proxy(function(r){if(r){r=r.replace(/ ?xmlns="[^"]*"/ig,"");if(r.length>10){r=e(r);if(t===-1||!t)this.get_container().children("ul").empty().append(r.children());else{t.children("a.jstree-loading").removeClass("jstree-loading");t.append(r);t.removeData("jstree-is-loading")}i.clean_node&&this.clean_node(t);n&&n.call(this)}else if(t&&t!==-1){t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");if(i.correct_state){this.correct_state(t);n&&n.call(this)}}else if(i.correct_state){this.get_container().children("ul").empty();n&&n.call(this)}}},this))},i.ajax.context=this,i.ajax.error=s,i.ajax.success=o,i.ajax.dataType||(i.ajax.dataType="xml"),e.isFunction(i.ajax.url)&&(i.ajax.url=i.ajax.url.call(this,t)),e.isFunction(i.ajax.data)&&(i.ajax.data=i.ajax.data.call(this,t)),e.ajax(i.ajax)}},parse_xml:function(n,r){var i=this._get_settings().xml_data;e.vakata.xslt(n,t[i.xsl],r)},get_xml:function(t,r,i,s,o){var u="",f=this._get_settings(),l=this,c,h,p,d,v;t||(t="flat");o||(o=0);r=this._get_node(r);if(!r||-1===r)r=this.get_container().find("> ul > li");i=e.isArray(i)?i:["id","class"];!o&&this.data.types&&-1===e.inArray(f.types.type_attr,i)&&i.push(f.types.type_attr);s=e.isArray(s)?s:[];o||(f.xml_data.get_include_preamble&&(u+='<?xml version="1.0" encoding="UTF-8"?>'),u+="<root>");r.each(function(){u+="<item";p=e(this);e.each(i,function(e,t){var r=p.attr(t);if(!f.xml_data.get_skip_empty||typeof r!="undefined")u+=" "+t+'="'+n((" "+(r||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'});p.hasClass("jstree-open")&&(u+=' state="open"');p.hasClass("jstree-closed")&&(u+=' state="closed"');t==="flat"&&(u+=' parent_id="'+n(o)+'"');u+=">";u+="<content>";d=p.children("a");d.each(function(){c=e(this);v=!1;u+="<name";e.inArray("languages",f.plugins)!==-1&&e.each(f.languages,function(e,t){if(c.hasClass(t)){u+=' lang="'+n(t)+'"';v=t;return!1}});s.length&&e.each(s,function(e,t){var r=c.attr(t);if(!f.xml_data.get_skip_empty||typeof r!="undefined")u+=" "+t+'="'+n((" "+r||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'});c.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(u+=' icon="'+n(c.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"');c.children("ins").get(0).style.backgroundImage.length&&(u+=' icon="'+n(c.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"');u+=">";u+="<![CDATA["+l.get_text(c,v)+"]]>";u+="</name>"});u+="</content>";h=p[0].id||!0;p=p.find("> ul > li");h=p.length?l.get_xml(t,p,i,s,h):"";t=="nest"&&(u+=h);u+="</item>";t=="flat"&&(u+=h)});o||(u+="</root>");return u}}})})(e);(function(e){e.expr[":"].jstree_contains=function(e,t,n){return 0<=(e.textContent||e.innerText||"").toLowerCase().indexOf(n[3].toLowerCase())};e.expr[":"].jstree_title_contains=function(e,t,n){return 0<=(e.getAttribute("title")||"").toLowerCase().indexOf(n[3].toLowerCase())};e.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=e();this._get_settings().search.show_only_matches&&this.get_container().bind("search.jstree",function(t,n){e(this).children("ul").find("li").hide().removeClass("jstree-last");n.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){e(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){e(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})},defaults:{ajax:!1,search_method:"jstree_contains",show_only_matches:!1},_fn:{search:function(t,n){if(""===e.trim(t))this.clear_search();else{var r=this.get_settings().search,i=this,s=function(){};this.data.search.str=t;if(!n&&!1!==r.ajax&&0<this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length){this.search.supress_callback=!0;s=function(e,t,n){var r=this.get_settings().search.ajax.success;r&&(e=r.call(this,e,t,n)||e);this.data.search.to_open=e;this._search_open()};r.ajax.context=this;r.ajax.error=function(){};r.ajax.success=s;e.isFunction(r.ajax.url)&&(r.ajax.url=r.ajax.url.call(this,t));e.isFunction(r.ajax.data)&&(r.ajax.data=r.ajax.data.call(this,t));r.ajax.data||(r.ajax.data={search_string:t});if(!r.ajax.dataType||/^json/.exec(r.ajax.dataType))r.ajax.dataType="json";e.ajax(r.ajax)}else this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+r.search_method+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){i.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:t})}},clear_search:function(){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=e()},_search_open:function(){var t=this,n=!0,r=[],i=[];this.data.search.to_open.length&&(e.each(this.data.search.to_open,function(t,n){if("#"==n)return!0;e(n).length&&e(n).is(".jstree-closed")?r.push(n):i.push(n)}),r.length&&(this.data.search.to_open=i,e.each(r,function(e,n){t.open_node(n,function(){t._search_open(!0)})}),n=!1));n&&this.search(this.data.search.str,!0)}}})})(e);(function(e){e.vakata.context={hide_on_mouseleave:!1,cnt:e("<div id='vakata-contextmenu' />"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,rtl:!1,show:function(t,n,r,i,s,o,u){e.vakata.context.rtl=!!u;if(t=e.vakata.context.parse(t)){e.vakata.context.vis=!0;e.vakata.context.tgt=n;e.vakata.context.par=o||n||null;e.vakata.context.data=s||null;e.vakata.context.cnt.html(t).css({visibility:"hidden",display:"block",left:0,top:0});e.vakata.context.hide_on_mouseleave&&e.vakata.context.cnt.one("mouseleave",function(){e.vakata.context.hide()});s=e.vakata.context.cnt.height();o=e.vakata.context.cnt.width();r+o>e(document).width()&&(r=e(document).width()-(o+5),e.vakata.context.cnt.find("li > ul").addClass("right"));i+s>e(document).height()&&(i-=s+n[0].offsetHeight,e.vakata.context.cnt.find("li > ul").addClass("bottom"));e.vakata.context.cnt.css({left:r,top:i}).find("li:has(ul)").bind("mouseenter",function(){var t=e(document).width(),n=e(document).height(),r=e(this).children("ul").show();t!==e(document).width()&&r.toggleClass("right");n!==e(document).height()&&r.toggleClass("bottom")}).bind("mouseleave",function(){e(this).children("ul").hide()}).end().css({visibility:"visible"}).show();e(document).triggerHandler("context_show.vakata")}},hide:function(){e.vakata.context.vis=!1;e.vakata.context.cnt.attr("class","").css({visibility:"hidden"});e(document).triggerHandler("context_hide.vakata")},parse:function(t,n){if(!t)return!1;var r="",i=!1,s=!0;n||(e.vakata.context.func={});r+="<ul>";e.each(t,function(t,n){if(!n)return!0;e.vakata.context.func[t]=n.action;!s&&n.separator_before&&(r+="<li class='vakata-separator vakata-separator-before'></li>");s=!1;r+="<li class='"+(n._class||"")+(n._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";n.icon&&n.icon.indexOf("/")===-1&&(r+=" class='"+n.icon+"' ");n.icon&&n.icon.indexOf("/")!==-1&&(r+=" style='background:url("+n.icon+") center center no-repeat;' ");r+=">&#160;</ins><a href='#' rel='"+t+"'>";n.submenu&&(r+="<span style='float:"+(e.vakata.context.rtl?"left":"right")+";'>&raquo;</span>");r+=n.label+"</a>";n.submenu&&(i=e.vakata.context.parse(n.submenu,!0))&&(r+=i);r+="</li>";if(n.separator_after){r+="<li class='vakata-separator vakata-separator-after'></li>";s=!0}});r=r.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");r+="</ul>";e(document).triggerHandler("context_parse.vakata");return 10<r.length?r:!1},exec:function(t){return e.isFunction(e.vakata.context.func[t])?(e.vakata.context.func[t].call(e.vakata.context.data,e.vakata.context.par),!0):!1}};e(function(){e.vakata.css.add_sheet({str:"#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ",title:"vakata"});e.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault()}).delegate("a","mouseup",function(){!e(this).parent().hasClass("jstree-contextmenu-disabled")&&e.vakata.context.exec(e(this).attr("rel"))?e.vakata.context.hide():e(this).blur()}).delegate("a","mouseover",function(){e.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");e(document).bind("mousedown",function(t){e.vakata.context.vis&&!e.contains(e.vakata.context.cnt[0],t.target)&&e.vakata.context.hide()});"undefined"!=typeof e.hotkeys&&e(document).bind("keydown","up",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last());n.addClass("vakata-hover");t.stopImmediatePropagation();t.preventDefault()}}).bind("keydown","down",function(t){if(e.vakata.context.vis){var n=e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();n.length||(n=e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first());n.addClass("vakata-hover");t.stopImmediatePropagation();t.preventDefault()}}).bind("keydown","right",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","left",function(t){e.vakata.context.vis&&(e.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),t.stopImmediatePropagation(),t.preventDefault())}).bind("keydown","esc",function(t){e.vakata.context.hide();t.preventDefault()}).bind("keydown","space",function(t){e.vakata.context.cnt.find(".vakata-hover").last().children("a").click();t.preventDefault()})});e.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",e.proxy(function(t){t.preventDefault();e(t.currentTarget).hasClass("jstree-loading")||this.show_contextmenu(t.currentTarget,t.pageX,t.pageY)},this)).delegate("a","click.jstree",e.proxy(function(){this.data.contextmenu&&e.vakata.context.hide()},this)).bind("destroy.jstree",e.proxy(function(){this.data.contextmenu&&e.vakata.context.hide()},this));e(document).bind("context_hide.vakata",e.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(e){this.create(e)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(e){this.rename(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(e){this.is_selected(e)?this.remove():this.remove(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){this.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){this.copy(e)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(e){this.paste(e)}}}}}},_fn:{show_contextmenu:function(t,n,r){var t=this._get_node(t),i=this.get_settings().contextmenu,s=t.children("a:visible:eq(0)"),o=!1,o=!1;i.select_node&&this.data.ui&&!this.is_selected(t)&&(this.deselect_all(),this.select_node(t,!0));if(i.show_at_node||"undefined"==typeof n||"undefined"==typeof r)o=s.offset(),n=o.left,r=o.top+this.data.core.li_height;o=t.data("jstree")&&t.data("jstree").contextmenu?t.data("jstree").contextmenu:i.items;e.isFunction(o)&&(o=o.call(this,t));this.data.contextmenu=!0;e.vakata.context.show(o,s,n,r,this,t,this._get_settings().core.rtl);this.data.themes&&e.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})})(e);(function(e){e.jstree.plugin("types",{__init:function(){var n=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",e.proxy(function(){var t=n.type_attr,r="",i=this;e.each(n.types,function(n,s){e.each(s,function(e){/^(max_depth|max_children|icon|valid_children)$/.test(e)||i.data.types.attach_to.push(e)});if(!s.icon)return!0;if(s.icon.image||s.icon.position)r="default"==n?r+(".jstree-"+i.get_index()+" a > .jstree-icon { "):r+(".jstree-"+i.get_index()+" li["+t+'="'+n+'"] > a > .jstree-icon { '),s.icon.image&&(r+=" background-image:url("+s.icon.image+"); "),r=s.icon.position?r+(" background-position:"+s.icon.position+"; "):r+" background-position:0 0; ",r+="} "});""!==r&&e.vakata.css.add_sheet({str:r,title:"jstree-types"})},this)).bind("before.jstree",e.proxy(function(t,n){var r,i;if((r=(r=this._get_settings().types.use_data?this._get_node(n.args[0]):!1)&&-1!==r&&r.length?r.data("jstree"):!1)&&r.types&&!1===r.types[n.func])return t.stopImmediatePropagation(),!1;if(-1!==e.inArray(n.func,this.data.types.attach_to)&&n.args[0]&&(n.args[0].tagName||n.args[0].jquery))if(r=this._get_settings().types.types,i=this._get_type(n.args[0]),(r[i]&&"undefined"!=typeof r[i][n.func]||r["default"]&&"undefined"!=typeof r["default"][n.func])&&!1===this._check(n.func,n.args[0]))return t.stopImmediatePropagation(),!1},this));t&&this.get_container().bind("load_node.jstree set_type.jstree",e.proxy(function(t,n){var r=n&&n.rslt&&n.rslt.obj&&-1!==n.rslt.obj?this._get_node(n.rslt.obj).parent():this.get_container_ul(),i=!1,s=this._get_settings().types;e.each(s.types,function(e,t){t.icon&&(t.icon.image||t.icon.position)&&(i="default"===e?r.find("li > a > .jstree-icon"):r.find("li["+s.type_attr+"='"+e+"'] > a > .jstree-icon"),t.icon.image&&i.css("backgroundImage","url("+t.icon.image+")"),i.css("backgroundPosition",t.icon.position||"0 0"))})},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:!1,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(e,t){t.type&&this._get_settings().types.use_data&&this.set_type(t.type,e)},_get_type:function(e){e=this._get_node(e);return!e||!e.length?!1:e.attr(this._get_settings().types.type_attr)||"default"},set_type:function(e,t){var t=this._get_node(t),n=!t.length||!e?!1:t.attr(this._get_settings().types.type_attr,e);n&&this.__callback({obj:t,type:e});return n},_check:function(t,n,r){var n=this._get_node(n),i=!1,s=this._get_type(n),o=0,u=this,f=this._get_settings().types,l=!1;if(-1===n){if(!f[t])return;i=f[t]}else{if(!1===s)return;(l=f.use_data?n.data("jstree"):!1)&&l.types&&"undefined"!=typeof l.types[t]?i=l.types[t]:f.types[s]&&"undefined"!=typeof f.types[s][t]?i=f.types[s][t]:f.types["default"]&&"undefined"!=typeof f.types["default"][t]&&(i=f.types["default"][t])}e.isFunction(i)&&(i=i.call(this,n));"max_depth"===t&&-1!==n&&!1!==r&&-2!==f.max_depth&&0!==i&&n.children("a:eq(0)").parentsUntil(".jstree","li").each(function(e){if(-1!==f.max_depth&&0>=f.max_depth-(e+1))return i=0,!1;o=0===e?i:u._check(t,this,!1);if(-1!==o&&0>=o-(e+1))return i=0,!1;0<=o&&(o-(e+1)<i||0>i)&&(i=o-(e+1));0<=f.max_depth&&(f.max_depth-(e+1)<i||0>i)&&(i=f.max_depth-(e+1))});return i},check_move:function(){if(!this.__call_old())return!1;var t=this._get_move(),n=t.rt._get_settings().types,r=t.rt._check("max_children",t.cr),i=t.rt._check("max_depth",t.cr),s=t.rt._check("valid_children",t.cr),o=0,u=1;if("none"===s||e.isArray(s)&&t.ot&&t.ot._get_type&&(t.o.each(function(){if(-1===e.inArray(t.ot._get_type(this),s))return u=!1}),!1===u)||-2!==n.max_children&&-1!==r&&(o=-1===t.cr?this.get_container().find("> ul > li").not(t.o).length:t.cr.find("> ul > li").not(t.o).length,o+t.o.length>r))return!1;if(-2!==n.max_depth&&-1!==i){u=0;if(0===i)return!1;if("undefined"==typeof t.o.d){for(n=t.o;0<n.length;)n=n.find("> ul > li"),u++;t.o.d=u}if(0>i-t.o.d)return!1}return!0},create_node:function(t,n,r,i,s,o){if(!o&&(s||this._is_loaded(t))){var u="string"==typeof n&&n.match(/^before|after$/i)&&-1!==t?this._get_parent(t):this._get_node(t),f=this._get_settings().types,l=this._check("max_children",u),c=this._check("max_depth",u),h=this._check("valid_children",u);"string"==typeof r&&(r={data:r});r||(r={});if("none"===h)return!1;if(e.isArray(h))if(!r.attr||!r.attr[f.type_attr])r.attr||(r.attr={}),r.attr[f.type_attr]=h[0];else if(-1===e.inArray(r.attr[f.type_attr],h))return!1;if(-2!==f.max_children&&-1!==l&&(u=-1===u?this.get_container().find("> ul > li").length:u.find("> ul > li").length,u+1>l)||-2!==f.max_depth&&-1!==c&&0>c-1)return!1}return this.__call_old(!0,t,n,r,i,s,o)}}})})(e);(function(e){e.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return 3==this.nodeType}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(e,t,n){var r=this;this.load_node_html(e,function(){r.__callback({obj:r._get_node(e)});t.call(this)},n)},_is_loaded:function(t){t=this._get_node(t);return-1==t||!t||!this._get_settings().html_data.ajax&&!e.isFunction(this._get_settings().html_data.data)||t.is(".jstree-open, .jstree-leaf")||0<t.children("ul").children("li").size()},load_node_html:function(t,n,r){var i,s=this.get_settings().html_data,o=function(){};i=function(){};if((t=this._get_node(t))&&-1!==t){if(t.data("jstree-is-loading"))return;t.data("jstree-is-loading",!0)}switch(!0){case e.isFunction(s.data):s.data.call(this,t,e.proxy(function(r){if(r&&r!==""&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")!==""){r=e(r);r.is("ul")||(r=e("<ul />").append(r));if(t==-1||!t)this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");else{t.children("a.jstree-loading").removeClass("jstree-loading");t.append(r).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");t.removeData("jstree-is-loading")}this.clean_node(t);n&&n.call(this)}else if(t&&t!==-1){t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");if(s.correct_state){this.correct_state(t);n&&n.call(this)}}else if(s.correct_state){this.get_container().children("ul").empty();n&&n.call(this)}},this));break;case!s.data&&!s.ajax:if(!t||-1==t)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();n&&n.call(this);break;case!!s.data&&!s.ajax||!!s.data&&!!s.ajax&&(!t||-1===t):if(!t||-1==t)i=e(s.data),i.is("ul")||(i=e("<ul />").append(i)),this.get_container().children("ul").empty().append(i.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();n&&n.call(this);break;case!s.data&&!!s.ajax||!!s.data&&!!s.ajax&&t&&-1!==t:t=this._get_node(t),o=function(e,n,i){var o=this.get_settings().html_data.ajax.error;o&&o.call(this,e,n,i);if(t!=-1&&t.length){t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");n==="success"&&s.correct_state&&this.correct_state(t)}else n==="success"&&s.correct_state&&this.get_container().children("ul").empty();r&&r.call(this)},i=function(r,i,u){var f=this.get_settings().html_data.ajax.success;f&&(r=f.call(this,r,i,u)||r);if(r===""||r&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")==="")return o.call(this,u,i,"");if(r){r=e(r);r.is("ul")||(r=e("<ul />").append(r));if(t==-1||!t)this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");else{t.children("a.jstree-loading").removeClass("jstree-loading");t.append(r).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");t.removeData("jstree-is-loading")}this.clean_node(t);n&&n.call(this)}else if(t&&t!==-1){t.children("a.jstree-loading").removeClass("jstree-loading");t.removeData("jstree-is-loading");if(s.correct_state){this.correct_state(t);n&&n.call(this)}}else if(s.correct_state){this.get_container().children("ul").empty();n&&n.call(this)}},s.ajax.context=this,s.ajax.error=o,s.ajax.success=i,s.ajax.dataType||(s.ajax.dataType="html"),e.isFunction(s.ajax.url)&&(s.ajax.url=s.ajax.url.call(this,t)),e.isFunction(s.ajax.data)&&(s.ajax.data=s.ajax.data.call(this,t)),e.ajax(s.ajax)}}}});e.jstree.defaults.plugins.push("html_data")})(e);(function(e){e.jstree.plugin("themeroller",{__init:function(){var t=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(n){e(n.currentTarget).hasClass("jstree-loading")||e(this).addClass(t.item_h)}).delegate("a","mouseleave.jstree",function(){e(this).removeClass(t.item_h)}).bind("init.jstree",e.proxy(function(e,t){t.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(t.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",e.proxy(function(){this._themeroller()},this)).bind("close_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.obj)},this)).bind("delete_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.parent)},this)).bind("correct_state.jstree",e.proxy(function(e,n){n.rslt.obj.children("ins.jstree-icon").removeClass(t.opened+" "+t.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return-1===this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")}).removeClass(t.item_open+" "+t.item_clsd).addClass(t.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").addClass(t.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",e.proxy(function(){this.get_container().find("a."+t.item_a).removeClass(t.item_a).end().find("a.jstree-clicked").addClass(t.item_a)},this)).bind("dehover_node.jstree",e.proxy(function(e,n){n.rslt.obj.children("a").removeClass(t.item_h)},this)).bind("hover_node.jstree",e.proxy(function(e,n){this.get_container().find("a."+t.item_h).not(n.rslt.obj).removeClass(t.item_h);n.rslt.obj.children("a").addClass(t.item_h)},this)).bind("move_node.jstree",e.proxy(function(e,t){this._themeroller(t.rslt.o);this._themeroller(t.rslt.op)},this))},__destroy:function(){var t=this._get_settings().themeroller,n=["ui-icon"];e.each(t,function(e,t){t=t.split(" ");t.length&&(n=n.concat(t))});this.get_container().removeClass("ui-widget-content").find("."+n.join(", .")).removeClass(n.join(" "))},_fn:{_themeroller:function(e){var t=this._get_settings().themeroller,e=!e||-1==e?this.get_container_ul():this._get_node(e).parent();e.find("li.jstree-closed").children("ins.jstree-icon").removeClass(t.opened).addClass("ui-icon "+t.closed).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")}).removeClass(t.item_leaf+" "+t.item_open).addClass(t.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(t.closed).addClass("ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")}).removeClass(t.item_leaf+" "+t.item_clsd).addClass(t.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(t.closed+" ui-icon "+t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return-1===this.className.toString().replace(t.item_clsd,"").replace(t.item_open,"").replace(t.item_leaf,"").indexOf("ui-icon-")}).removeClass(t.item_clsd+" "+t.item_open).addClass(t.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});e(function(){e.vakata.css.add_sheet({str:".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }",title:"jstree"})})})(e);(function(e){e.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",e.proxy(function(t,n){var r=[],i=!0,s;"move_node"==n.func&&!0===n.args[4]&&n.args[0].o&&n.args[0].o.length&&
(n.args[0].o.children("a").each(function(){r.push(e(this).text().replace(/^\s+/g,""))}),i=this._check_unique(r,n.args[0].np.find("> ul > li").not(n.args[0].o),"move_node"));if("create_node"==n.func&&(n.args[4]||this._is_loaded(n.args[0]))){i=this._get_node(n.args[0]);n.args[1]&&("before"===n.args[1]||"after"===n.args[1])&&(i=this._get_parent(n.args[0]),!i||-1===i)&&(i=this.get_container());"string"==typeof n.args[2]?r.push(n.args[2]):!n.args[2]||!n.args[2].data?r.push(this._get_string("new_node")):r.push(n.args[2].data);i=this._check_unique(r,i.find("> ul > li"),"create_node")}if("rename_node"==n.func){r.push(n.args[1]);s=this._get_node(n.args[0]);i=this._get_parent(s);if(!i||-1===i)i=this.get_container();i=this._check_unique(r,i.find("> ul > li").not(s),"rename_node")}if(!i)return t.stopPropagation(),!1},this))},defaults:{error_callback:e.noop},_fn:{_check_unique:function(t,n,r){var i=[];n.children("a").each(function(){i.push(e(this).text().replace(/^\s+/g,""))});if(!i.length||!t.length)return!0;i=i.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");return i.length+t.length!=i.concat(t).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?(this._get_settings().unique.error_callback.call(null,t,n,r),!1):!0},check_move:function(){if(!this.__call_old())return!1;var t=this._get_move(),n=[];return t.o&&t.o.length?(t.o.children("a").each(function(){n.push(e(this).text().replace(/^\s+/g,""))}),this._check_unique(n,t.np.find("> ul > li").not(t.o),"check_move")):!0}}})})(e);(function(e){e.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui)throw"jsTree wholerow: jsTree UI plugin not included.";this.data.wholerow.html=!1;this.data.wholerow.to=!1;this.get_container().bind("init.jstree",e.proxy(function(){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",e.proxy(function(e,t){this._prepare_wholerow_span(t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",e.proxy(function(e,t){this.data.to&&clearTimeout(this.data.to);this.data.to=setTimeout(function(e,t){return function(){e._prepare_wholerow_ul(t)}}(this,t&&t.rslt&&t.rslt.obj?t.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",e.proxy(function(){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",e.proxy(function(t,n){n.rslt.obj.each(function(){n.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((e(this).offset().top-n.inst.get_container().offset().top+n.inst.get_container()[0].scrollTop)/n.inst.data.core.li_height,10)+")").children("a").attr("class",n.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));"hover_node"===e.type&&this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((t.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")").children("a").attr("class",t.rslt.obj.children(".jstree-hovered").attr("class"))},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(t){var n=e(t.currentTarget);"A"===t.target.tagName||"INS"===t.target.tagName&&n.closest("li").is(".jstree-open, .jstree-closed")||(n.closest("li").children("a:visible:eq(0)").click(),t.stopImmediatePropagation())}).delegate("li","mouseover.jstree",e.proxy(function(t){t.stopImmediatePropagation();if(e(t.currentTarget).children(".jstree-hovered, .jstree-clicked").length)return!1;this.hover_node(t.currentTarget);return!1},this)).delegate("li","mouseleave.jstree",e.proxy(function(t){e(t.currentTarget).children("a").hasClass("jstree-hovered").length||this.dehover_node(t.currentTarget)},this));(n||t)&&e.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(t){t=!t||-1==t?this.get_container().find("> ul > li"):this._get_node(t);!1!==t&&t.each(function(){e(this).find("li").andSelf().each(function(){var t=e(this);if(t.children(".jstree-wholerow-span").length)return!0;t.prepend("<span class='jstree-wholerow-span' style='width:"+18*t.parentsUntil(".jstree","li").length+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var e=this.get_container().children("ul").eq(0),t=e.html();e.addClass("jstree-wholerow-real");this.data.wholerow.last_html!==t&&(this.data.wholerow.last_html=t,this.get_container().children(".jstree-wholerow").remove(),this.get_container().append(e.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(e.parent()[0].scrollWidth).css("top",-1*(e.height()+(n?5:0))).find("li[id]").each(function(){this.removeAttribute("id")}).end()))}}});e(function(){var i=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";r&&(i+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");if(n||t)i+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";e.vakata.css.add_sheet({str:i,title:"jstree"})})})(e);(function(e){var t=["getChildren","getChildrenCount","getAttr","getName","getProps"],n=function(t,n){var r=!0,t=t||{},n=[].concat(n);e.each(n,function(n,i){if(!e.isFunction(t[i]))return r=!1});return r};e.jstree.plugin("model",{__init:function(){if(!this.data.json_data)throw"jsTree model: jsTree json_data plugin not included.";this._get_settings().json_data.data=function(r,i){var s=-1==r?this._get_settings().model.object:r.data("jstree_model");if(!n(s,t))return i.call(null,!1);this._get_settings().model.async?s.getChildren(e.proxy(function(e){this.model_done(e,i)},this)):this.model_done(s.getChildren(),i)}},defaults:{object:!1,id_prefix:!1,async:!1},_fn:{model_done:function(t,n){var r=[],i=this._get_settings(),s=this;e.isArray(t)||(t=[t]);e.each(t,function(t,n){var o=n.getProps()||{};o.attr=n.getAttr()||{};n.getChildrenCount()&&(o.state="closed");o.data=n.getName();e.isArray(o.data)||(o.data=[o.data]);s.data.types&&e.isFunction(n.getType)&&(o.attr[i.types.type_attr]=n.getType());o.attr.id&&i.model.id_prefix&&(o.attr.id=i.model.id_prefix+o.attr.id);o.metadata||(o.metadata={});o.metadata.jstree_model=n;r.push(o)});n.call(null,r)}}})})(e)}})()});define("jqgrid",["jquery","jqgrid-locale-"+(window&&window.__DEPS__&&window.__DEPS__.lang||"en"),"jqueryui"],function(k){(function(a){a.jgrid=a.jgrid||{};a.extend(a.jgrid,{htmlDecode:function(e){return e&&("&nbsp;"==e||"&#160;"==e||1==e.length&&160==e.charCodeAt(0))?"":e?(""+e).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"'):e},htmlEncode:function(e){return e?(""+e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;"):e},format:function(e){var t=a.makeArray(arguments).slice(1);void 0===e&&(e="");return e.replace(/\{(\d+)\}/g,function(e,n){return t[n]})},getCellIndex:function(e){e=a(e);if(e.is("tr"))return-1;e=(!e.is("td")&&!e.is("th")?e.closest("td,th"):e)[0];return a.browser.msie?a.inArray(e,e.parentNode.cells):e.cellIndex},stripHtml:function(e){var e=e+"",t=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return e?(e=e.replace(t,""))&&"&nbsp;"!==e&&"&#160;"!==e?e.replace(/\"/g,"'"):"":e},stringToDoc:function(e){var t;if("string"!=typeof e)return e;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(n){t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e)}return t&&t.documentElement&&"parsererror"!=t.documentElement.tagName?t:null},parse:function(e){"while(1);"==e.substr(0,9)&&(e=e.substr(9));"/*"==e.substr(0,2)&&(e=e.substr(2,e.length-4));e||(e="{}");return!0===a.jgrid.useJSON&&"object"==typeof ka&&"function"==typeof ka.parse?ka.parse(e):eval("("+e+")")},parseDate:function(e,t){var n={m:1,d:1,y:1970,h:0,i:0,s:0},r,i,s;r=/[\\\/:_;.,\t\T\s-]/;if(t&&null!==t&&void 0!==t){var t=a.trim(t),t=t.split(r),e=e.split(r),o=a.jgrid.formatter.date.monthNames,u=a.jgrid.formatter.date.AmPm,f=function(e,t){0===e?12==t&&(t=0):12!=t&&(t+=12);return t};r=0;for(i=e.length;r<i;r++)"M"==e[r]&&(s=a.inArray(t[r],o),-1!==s&&12>s&&(t[r]=s+1)),"F"==e[r]&&(s=a.inArray(t[r],o),-1!==s&&11<s&&(t[r]=s+1-12)),"a"==e[r]&&(s=a.inArray(t[r],u),-1!==s&&2>s&&t[r]==u[s]&&(t[r]=s,n.h=f(t[r],n.h))),"A"==e[r]&&(s=a.inArray(t[r],u),-1!==s&&1<s&&t[r]==u[s]&&(t[r]=s-2,n.h=f(t[r],n.h))),void 0!==t[r]&&(n[e[r].toLowerCase()]=parseInt(t[r],10));n.m=parseInt(n.m,10)-1;r=n.y;70<=r&&99>=r?n.y=1900+n.y:0<=r&&69>=r&&(n.y=2e3+n.y)}return new Date(n.y,n.m,n.d,n.h,n.i,n.s,0)},jqID:function(e){return(e+"").replace(/([\.\:\[\]])/g,"\\$1")},guid:1,uidPref:"jqg",randId:function(e){return(e?e:a.jgrid.uidPref)+a.jgrid.guid++},getAccessor:function(e,t){var n,r,i=[],s;if("function"==typeof t)return t(e);n=e[t];if(void 0===n)try{if("string"==typeof t&&(i=t.split(".")),s=i.length)for(n=e;n&&s--;)r=i.shift(),n=n[r]}catch(o){}return n},ajaxOptions:{},from:function(e){return new function(c,b){"string"==typeof c&&(c=a.data(c));var e=this,f=c,g=!0,j=!1,d=b,k=/[\$,%]/g,o=null,q=null,p=!1,x="",t=[],v=!0;if("object"!=typeof c||!c.push)throw"data provides is not an array";0<c.length&&(v="object"!=typeof c[0]?!1:!0);this._hasData=function(){return null===f?!1:0===f.length?!1:!0};this._getStr=function(e){var t=[];j&&t.push("jQuery.trim(");t.push("String("+e+")");j&&t.push(")");g||t.push(".toLowerCase()");return t.join("")};this._strComp=function(e){return"string"==typeof e?".toString()":""};this._group=function(e,t){return{field:e.toString(),unique:t,items:[]}};this._toStr=function(e){j&&(e=a.trim(e));g||(e=e.toLowerCase());return e.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"')};this._funcLoop=function(e){var t=[];a.each(f,function(n,r){t.push(e(r))});return t};this._append=function(e){d=null===d?"":d+(""===x?" && ":x);p&&(d+="!");d+="("+e+")";p=!1;x=""};this._setCommand=function(e,t){o=e;q=t};this._resetNegate=function(){p=!1};this._repeatCommand=function(t,n){return null===o?e:null!==t&&null!==n?o(t,n):null===q||!v?o(t):o(q,t)};this._equals=function(t,n){return 0===e._compare(t,n,1)};this._compare=function(e,t,n){void 0===n&&(n=1);void 0===e&&(e=null);void 0===t&&(t=null);if(null===e&&null===t)return 0;if(null===e&&null!==t)return 1;if(null!==e&&null===t)return-1;!g&&"number"!=typeof e&&"number"!=typeof t&&(e=(""+e).toLowerCase(),t=(""+t).toLowerCase());return e<t?-n:e>t?n:0};this._performSort=function(){0!==t.length&&(f=e._doSort(f,0))};this._doSort=function(n,r){var i=t[r].by,s=t[r].dir,o=t[r].type,u=t[r].datefmt;if(r==t.length-1)return e._getOrder(n,i,s,o,u);r++;i=e._getGroup(n,i,s,o,u);s=[];for(o=0;o<i.length;o++)for(var u=e._doSort(i[o].items,r),a=0;a<u.length;a++)s.push(u[a]);return s};this._getOrder=function(t,n,r,i,s){var o=[],u=[],f="a"==r?1:-1,l,c;void 0===i&&(i="text");c="float"==i||"number"==i||"currency"==i||"numeric"==i?function(e){e=parseFloat((""+e).replace(k,""));return isNaN(e)?0:e}:"int"==i||"integer"==i?function(e){return e?parseFloat((""+e).replace(k,"")):0}:"date"==i||"datetime"==i?function(e){return a.jgrid.parseDate(s,e).getTime()}:a.isFunction(i)?i:function(e){e||(e="");return a.trim((""+e).toUpperCase())};a.each(t,function(e,t){l=""!==n?a.jgrid.getAccessor(t,n):t;void 0===l&&(l="");l=c(l,t);u.push({vSort:l,index:e})});u.sort(function(t,n){t=t.vSort;n=n.vSort;return e._compare(t,n,f)});for(var i=0,h=t.length;i<h;)r=u[i].index,o.push(t[r]),i++;return o};this._getGroup=function(t,n,r,i,s){var o=[],u=null,f=null,l;a.each(e._getOrder(t,n,r,i,s),function(t,r){l=a.jgrid.getAccessor(r,n);void 0===l&&(l="");e._equals(f,l)||(f=l,null!==u&&o.push(u),u=e._group(n,l));u.items.push(r)});null!==u&&o.push(u);return o};this.ignoreCase=function(){g=!1;return e};this.useCase=function(){g=!0;return e};this.trim=function(){j=!0;return e};this.noTrim=function(){j=!1;return e};this.execute=function(){var b=d,c=[];if(null===b)return e;a.each(f,function(){eval(b)&&c.push(this)});f=c;return e};this.data=function(){return f};this.select=function(t){e._performSort();if(!e._hasData())return[];e.execute();if(a.isFunction(t)){var n=[];a.each(f,function(e,r){n.push(t(r))});return n}return f};this.hasMatch=function(){if(!e._hasData())return!1;e.execute();return 0<f.length};this.andNot=function(t,n,r){p=!p;return e.and(t,n,r)};this.orNot=function(t,n,r){p=!p;return e.or(t,n,r)};this.not=function(t,n,r){return e.andNot(t,n,r)};this.and=function(t,n,r){x=" && ";return void 0===t?e:e._repeatCommand(t,n,r)};this.or=function(t,n,r){x=" || ";return void 0===t?e:e._repeatCommand(t,n,r)};this.isNot=function(t){p=!p;return e.is(t)};this.is=function(t){e._append("this."+t);e._resetNegate();return e};this._compareValues=function(t,n,r,i,s){var o;o=v?"jQuery.jgrid.getAccessor(this,'"+n+"')":"this";void 0===r&&(r=null);var u=r,f=void 0===s.stype?"text":s.stype;if(null!==r)switch(f){case"int":case"integer":u=isNaN(Number(u))||""===u?"0":u;o="parseInt("+o+",10)";u="parseInt("+u+",10)";break;case"float":case"number":case"numeric":u=(""+u).replace(k,"");u=isNaN(Number(u))||""===u?"0":u;o="parseFloat("+o+")";u="parseFloat("+u+")";break;case"date":case"datetime":u=""+a.jgrid.parseDate(s.newfmt||"Y-m-d",u).getTime();o='jQuery.jgrid.parseDate("'+s.srcfmt+'",'+o+").getTime()";break;default:o=e._getStr(o),u=e._getStr('"'+e._toStr(u)+'"')}e._append(o+" "+i+" "+u);e._setCommand(t,n);e._resetNegate();return e};this.equals=function(t,n,r){return e._compareValues(e.equals,t,n,"==",r)};this.notEquals=function(t,n,r){return e._compareValues(e.equals,t,n,"!==",r)};this.isNull=function(t,n,r){return e._compareValues(e.equals,t,null,"===",r)};this.greater=function(t,n,r){return e._compareValues(e.greater,t,n,">",r)};this.less=function(t,n,r){return e._compareValues(e.less,t,n,"<",r)};this.greaterOrEquals=function(t,n,r){return e._compareValues(e.greaterOrEquals,t,n,">=",r)};this.lessOrEquals=function(t,n,r){return e._compareValues(e.lessOrEquals,t,n,"<=",r)};this.startsWith=function(t,n){var r=void 0===n||null===n?t:n,r=j?a.trim(r.toString()).length:r.toString().length;v?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+t+"')")+".substr(0,"+r+") == "+e._getStr('"'+e._toStr(n)+'"')):(r=j?a.trim(n.toString()).length:n.toString().length,e._append(e._getStr("this")+".substr(0,"+r+") == "+e._getStr('"'+e._toStr(t)+'"')));e._setCommand(e.startsWith,t);e._resetNegate();return e};this.endsWith=function(t,n){var r=void 0===n||null===n?t:n,r=j?a.trim(r.toString()).length:r.toString().length;v?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+t+"')")+".substr("+e._getStr("jQuery.jgrid.getAccessor(this,'"+t+"')")+".length-"+r+","+r+') == "'+e._toStr(n)+'"'):e._append(e._getStr("this")+".substr("+e._getStr("this")+'.length-"'+e._toStr(t)+'".length,"'+e._toStr(t)+'".length) == "'+e._toStr(t)+'"');e._setCommand(e.endsWith,t);e._resetNegate();return e};this.contains=function(t,n){v?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+t+"')")+'.indexOf("'+e._toStr(n)+'",0) > -1'):e._append(e._getStr("this")+'.indexOf("'+e._toStr(t)+'",0) > -1');e._setCommand(e.contains,t);e._resetNegate();return e};this.groupBy=function(t,n,r,i){return e._hasData()?e._getGroup(f,t,n,r,i):null};this.orderBy=function(n,r,i,s){r=void 0===r||null===r?"a":a.trim(r.toString().toLowerCase());if(null===i||void 0===i)i="text";if(null===s||void 0===s)s="Y-m-d";if("desc"==r||"descending"==r)r="d";if("asc"==r||"ascending"==r)r="a";t.push({by:n,dir:r,type:i,datefmt:s});return e};return e}(e,null)},extend:function(e){a.extend(a.fn.jqGrid,e);this.no_legacy_api||a.fn.extend(e)}});a.fn.jqGrid=function(e){if("string"==typeof e){var t=a.jgrid.getAccessor(a.fn.jqGrid,e);if(!t)throw"jqGrid - No such method: "+e;var n=a.makeArray(arguments).slice(1);return t.apply(this,n)}return this.each(function(){if(!this.grid){var t=a.extend(!0,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:!0,pginput:!0,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:!1,selarrrow:[],savedRow:[],shrinkToFit:!0,xmlReader:{},jsonReader:{},subGrid:!1,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,onHeaderClick:null,viewrecords:!1,loadonce:!1,multiselect:!1,multikey:!1,editurl:null,search:!1,caption:"",hidegrid:!0,hiddengrid:!1,postData:{},userData:{},treeGrid:!1,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:!1,gridstate:"visible",cellEdit:!1,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[!1,""],scroll:!1,multiboxonly:!1,deselectAfterSort:!0,scrollrows:!1,autowidth:!1,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:!1,rownumWidth:25,rownumbers:!1,pagerpos:"center",recordpos:"right",footerrow:!1,userDataOnFooter:!1,hoverrows:!0,altclass:"ui-priority-secondary",viewsortcols:[!1,"vertical",!0],resizeclass:"",autoencode:!1,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:!1,headertitles:!1,scrollTimeout:40,data:[],_index:{},grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,sortitems:[],sortnames:[],groupDataSorted:!1,summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus"},ignoreCase:!1,cmTemplate:{}},a.jgrid.defaults,e||{}),n={headers:[],cols:[],footers:[],dragStart:function(e,n,r){this.resizing={idx:e,startX:n.clientX,sOL:r[0]};this.hDiv.style.cursor="col-resize";this.curGbox=a("#rs_m"+a.jgrid.jqID(t.id),"#gbox_"+a.jgrid.jqID(t.id));this.curGbox.css({display:"block",left:r[0],top:r[1],height:r[2]});a.isFunction(t.resizeStart)&&t.resizeStart.call(this,n,e);document.onselectstart=function(){return!1}},dragMove:function(e){if(this.resizing){var n=e.clientX-this.resizing.startX,e=this.headers[this.resizing.idx],r="ltr"===t.direction?e.width+n:e.width-n,i;33<r&&(this.curGbox.css({left:this.resizing.sOL+n}),!0===t.forceFit?(i=this.headers[this.resizing.idx+t.nv],n="ltr"===t.direction?i.width-n:i.width+n,33<n&&(e.newWidth=r,i.newWidth=n)):(this.newWidth="ltr"===t.direction?t.tblwidth+n:t.tblwidth-n,e.newWidth=r))}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var e=this.resizing.idx,n=this.headers[e].newWidth||this.headers[e].width,n=parseInt(n,10);this.resizing=!1;a("#rs_m"+a.jgrid.jqID(t.id)).css("display","none");t.colModel[e].width=n;this.headers[e].width=n;this.headers[e].el.style.width=n+"px";this.cols[e].style.width=n+"px";0<this.footers.length&&(this.footers[e].style.width=n+"px");!0===t.forceFit?(n=this.headers[e+t.nv].newWidth||this.headers[e+t.nv].width,this.headers[e+t.nv].width=n,this.headers[e+t.nv].el.style.width=n+"px",this.cols[e+t.nv].style.width=n+"px",0<this.footers.length&&(this.footers[e+t.nv].style.width=n+"px"),t.colModel[e+t.nv].width=n):(t.tblwidth=this.newWidth||t.tblwidth,a("table:first",this.bDiv).css("width",t.tblwidth+"px"),a("table:first",this.hDiv).css("width",t.tblwidth+"px"),this.hDiv.scrollLeft=this.bDiv.scrollLeft,t.footerrow&&(a("table:first",this.sDiv).css("width",t.tblwidth+"px"),this.sDiv.scrollLeft=this.bDiv.scrollLeft));a.isFunction(t.resizeStop)&&t.resizeStop.call(this,n,e)}this.curGbox=null;document.onselectstart=function(){return!0}},populateVisible:function(){n.timer&&clearTimeout(n.timer);n.timer=null;var e=a(n.bDiv).height();if(e){var r=a("table:first",n.bDiv),i,s;if(r[0].rows.length)try{s=(i=r[0].rows[1])?a(i).outerHeight()||n.prevRowHeight:n.prevRowHeight}catch(o){s=n.prevRowHeight}if(s){n.prevRowHeight=s;var u=t.rowNum;i=n.scrollTop=n.bDiv.scrollTop;var f=Math.round(r.position().top)-i,l=f+r.height();s*=u;var c,h,p;l<e&&0>=f&&(void 0===t.lastpage||parseInt((l+i+s-1)/s,10)<=t.lastpage)&&(h=parseInt((e-l+s-1)/s,10),0<=l||2>h||!0===t.scroll?(c=Math.round((l+i)/s)+1,f=-1):f=1);0<f&&(c=parseInt(i/s,10)+1,h=parseInt((i+e)/s,10)+2-c,p=!0);h&&!(t.lastpage&&c>t.lastpage||1==t.lastpage||c===t.page&&c===t.lastpage)&&(n.hDiv.loading?n.timer=setTimeout(n.populateVisible,t.scrollTimeout):(t.page=c,p&&(n.selectionPreserver(r[0]),n.emptyRows(n.bDiv,!1,!1)),n.populate(h)))}}},scrollGrid:function(e){if(t.scroll){var r=n.bDiv.scrollTop;void 0===n.scrollTop&&(n.scrollTop=0);r!=n.scrollTop&&(n.scrollTop=r,n.timer&&clearTimeout(n.timer),n.timer=setTimeout(n.populateVisible,t.scrollTimeout))}n.hDiv.scrollLeft=n.bDiv.scrollLeft;t.footerrow&&(n.sDiv.scrollLeft=n.bDiv.scrollLeft);e.stopPropagation()},selectionPreserver:function(e){var t=e.p,n=t.selrow,r=t.selarrrow?a.makeArray(t.selarrrow):null,i=e.grid.bDiv.scrollLeft,s=t.gridComplete;t.gridComplete=function(){t.selrow=null;t.selarrrow=[];if(t.multiselect&&r&&0<r.length)for(var o=0;o<r.length;o++)r[o]!=n&&a(e).jqGrid("setSelection",r[o],!1);n&&a(e).jqGrid("setSelection",n,!1);e.grid.bDiv.scrollLeft=i;t.gridComplete=s;t.gridComplete&&s()}}};if("TABLE"!=this.tagName)alert("Element is not a table");else{a(this).empty().attr("tabindex","1");this.p=t;var r,i,s;if(0===this.p.colNames.length)for(r=0;r<this.p.colModel.length;r++)this.p.colNames[r]=this.p.colModel[r].label||this.p.colModel[r].name;if(this.p.colNames.length!==this.p.colModel.length)alert(a.jgrid.errors.model);else{var o=a("<div class='ui-jqgrid-view'></div>"),u,f=a.browser.msie?!0:!1,l=a.browser.webkit||a.browser.safari?!0:!1;s=this;s.p.direction=a.trim(s.p.direction.toLowerCase());-1==a.inArray(s.p.direction,["ltr","rtl"])&&(s.p.direction="ltr");i=s.p.direction;a(o).insertBefore(this);a(this).appendTo(o).removeClass("scroll");var c=a("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");a(c).insertBefore(o).attr({id:"gbox_"+this.id,dir:i});a(o).appendTo(c).attr("id","gview_"+this.id);u=f&&6>=a.browser.version?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"";a("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(u).insertBefore(o);a("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(o);a(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var h=function(e,t){e=parseInt(e,10);return isNaN(e)?t?t:0:e},p=function(e,t,r,i,o,u){var f=s.p.colModel[e],l=f.align,c='style="',h=f.classes,p=f.name,d=[];l&&(c+="text-align:"+l+";");f.hidden===!0&&(c+="display:none;");if(t===0)c+="width: "+n.headers[e].width+"px;";else if(f.cellattr&&a.isFunction(f.cellattr)&&(e=f.cellattr.call(s,o,r,i,f,u))&&typeof e=="string"){e=e.replace(/style/i,"style").replace(/title/i,"title");e.indexOf("title")>-1&&(f.title=!1);e.indexOf("class")>-1&&(h=void 0);d=e.split("style");if(d.length===2){d[1]=a.trim(d[1].replace("=",""));if(d[1].indexOf("'")===0||d[1].indexOf('"')===0)d[1]=d[1].substring(1);c+=d[1].replace(/'/gi,'"')}else c+='"'}if(!d.length){d[0]="";c+='"'}c+=(h!==void 0?' class="'+h+'"':"")+(f.title&&r?' title="'+a.jgrid.stripHtml(r)+'"':"");c+=' aria-describedby="'+s.p.id+"_"+p+'"';return c+d[0]},d=function(e){return e===void 0||e===null||e===""?"&#160;":s.p.autoencode?a.jgrid.htmlEncode(e):e+""},v=function(e,t,n,r,i){var o=s.p.colModel[n];if(typeof o.formatter!="undefined"){e={rowId:e,colModel:o,gid:s.p.id,pos:n};t=a.isFunction(o.formatter)?o.formatter.call(s,t,e,r,i):a.fmatter?a.fn.fmatter(o.formatter,t,e,r,i):d(t)}else t=d(t);return t},m=function(e,t,n,r,i){t=v(e,t,n,i,"add");return'<td role="gridcell" '+p(n,r,t,i,e,!0)+">"+t+"</td>"},g=function(e,t,n){var r='<input role="checkbox" type="checkbox" id="jqg_'+s.p.id+"_"+e+'" class="cbox" name="jqg_'+s.p.id+"_"+e+'"/>';return'<td role="gridcell" '+p(t,n,"",null,e,!0)+">"+r+"</td>"},y=function(e,t,n,r){n=(parseInt(n,10)-1)*parseInt(r,10)+1+t;return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+p(e,t,n,null,t,!0)+">"+n+"</td>"},b=function(e){var t,n=[],r=0,i;for(i=0;i<s.p.colModel.length;i++){t=s.p.colModel[i];if(t.name!=="cb"&&t.name!=="subgrid"&&t.name!=="rn"){n[r]=e=="local"?t.name:e=="xml"?t.xmlmap||t.name:t.jsonmap||t.name;r++}}return n},w=function(e){var t=s.p.remapColumns;if(!t||!t.length)t=a.map(s.p.colModel,function(e,t){return t});e&&(t=a.map(t,function(t){return t<e?null:t-e}));return t},E=function(e,t,n){if(s.p.deepempty)a("#"+a.jgrid.jqID(s.p.id)+" tbody:first tr:gt(0)").remove();else{var r=a("#"+a.jgrid.jqID(s.p.id)+" tbody:first tr:first")[0];a("#"+a.jgrid.jqID(s.p.id)+" tbody:first").empty().append(r)}if(t&&s.p.scroll){a(">div:first",e).css({height:"auto"}).children("div:first").css({height:0,display:"none"});e.scrollTop=0}if(n===!0&&s.p.treeGrid===!0){s.p.data=[];s.p._index={}}},S=function(){var e=s.p.data.length,t,n,r;t=s.p.rownumbers===!0?1:0;n=s.p.multiselect===!0?1:0;r=s.p.subGrid===!0?1:0;t=s.p.keyIndex===!1||s.p.loadonce===!0?s.p.localReader.id:s.p.colModel[s.p.keyIndex+n+r+t].name;for(n=0;n<e;n++){r=a.jgrid.getAccessor(s.p.data[n],t);s.p._index[r]=n}},x=function(e,t,n,r,i){var o=new Date,u=s.p.datatype!="local"&&s.p.loadonce||s.p.datatype=="xmlstring",f=s.p.datatype=="local"?"local":"xml";if(u){s.p.data=[];s.p._index={};s.p.localReader.id="_id_"}s.p.reccount=0;if(a.isXMLDoc(e)){if(s.p.treeANode===-1&&!s.p.scroll){E(t,!1,!0);n=1}else n=n>1?n:1;var l,c,h=0,p,d=0,v=0,S=0,x,T=[],N,C={},k,L,A=[],O=s.p.altRows===!0?" "+s.p.altclass:"";s.p.xmlReader.repeatitems||(T=b(f));x=s.p.keyIndex===!1?s.p.xmlReader.id:s.p.keyIndex;if(T.length>0&&!isNaN(x)){s.p.remapColumns&&s.p.remapColumns.length&&(x=a.inArray(x,s.p.remapColumns));x=T[x]}f=(x+"").indexOf("[")===-1?T.length?function(e,t){return a(x,e).text()||t}:function(e,t){return a(s.p.xmlReader.cell,e).eq(x).text()||t}:function(e,t){return e.getAttribute(x.replace(/[\[\]]/g,""))||t};s.p.userData={};a(s.p.xmlReader.page,e).each(function(){s.p.page=this.textContent||this.text||0});a(s.p.xmlReader.total,e).each(function(){s.p.lastpage=this.textContent||this.text;s.p.lastpage===void 0&&(s.p.lastpage=1)});a(s.p.xmlReader.records,e).each(function(){s.p.records=this.textContent||this.text||0});a(s.p.xmlReader.userdata,e).each(function(){s.p.userData[this.getAttribute("name")]=this.textContent||this.text});(e=a(s.p.xmlReader.root+" "+s.p.xmlReader.row,e))||(e=[]);var M=e.length,_=0,D={},P;if(e&&M){P=parseInt(s.p.rowNum,10);var H=s.p.scroll?a.jgrid.randId():1;i&&(P*=i+1);var i=a.isFunction(s.p.afterInsertRow),B="";for(s.p.grouping&&s.p.groupingView.groupCollapse===!0&&(B=' style="display:none;"');_<M;){k=e[_];L=f(k,H+_);l=n===0?0:n+1;l=(l+_)%2==1?O:"";A.push("<tr"+B+' id="'+L+'" tabindex="-1" role="row" class ="ui-widget-content jqgrow ui-row-'+s.p.direction+""+l+'">');if(s.p.rownumbers===!0){A.push(y(0,_,s.p.page,s.p.rowNum));S=1}if(s.p.multiselect===!0){A.push(g(L,S,_));d=1}if(s.p.subGrid===!0){A.push(a(s).jqGrid("addSubGridCell",d+S,_+n));v=1}if(s.p.xmlReader.repeatitems){N||(N=w(d+v+S));var j=a(s.p.xmlReader.cell,k);a.each(N,function(e){var t=j[this];if(!t)return!1;p=t.textContent||t.text;C[s.p.colModel[e+d+v+S].name]=p;A.push(m(L,p,e+d+v+S,_+n,k))})}else for(l=0;l<T.length;l++){p=a(T[l],k).text();C[s.p.colModel[l+d+v+S].name]=p;A.push(m(L,p,l+d+v+S,_+n,k))}A.push("</tr>");if(s.p.grouping){l=s.p.groupingView.groupField.length;for(var F=[],I=0;I<l;I++)F.push(C[s.p.groupingView.groupField[I]]);D=a(s).jqGrid("groupingPrepare",A,F,D,C);A=[]}if(u||s.p.treeGrid===!0){C._id_=L;s.p.data.push(C);s.p._index[L]=s.p.data.length-1}if(s.p.gridview===!1){a("tbody:first",t).append(A.join(""));i&&s.p.afterInsertRow.call(s,L,C,k);A=[]}C={};h++;_++;if(h==P)break}}if(s.p.gridview===!0){c=s.p.treeANode>-1?s.p.treeANode:0;if(s.p.grouping){a(s).jqGrid("groupingRender",D,s.p.colModel.length);D=null}else s.p.treeGrid===!0&&c>0?a(s.rows[c]).after(A.join("")):a("tbody:first",t).append(A.join(""))}if(s.p.subGrid===!0)try{a(s).jqGrid("addSubGrid",d+S)}catch(q){}s.p.totaltime=new Date-o;h>0&&s.p.records===0&&(s.p.records=M);A=null;if(s.p.treeGrid===!0)try{a(s).jqGrid("setTreeNode",c+1,h+c+1)}catch(R){}!s.p.treeGrid&&!s.p.scroll&&(s.grid.bDiv.scrollTop=0);s.p.reccount=h;s.p.treeANode=-1;s.p.userDataOnFooter&&a(s).jqGrid("footerData","set",s.p.userData,!0);if(u){s.p.records=M;s.p.lastpage=Math.ceil(M/P)}r||s.updatepager(!1,!0);if(u)for(;h<M;){k=e[h];L=f(k,h);if(s.p.xmlReader.repeatitems){N||(N=w(d+v+S));var U=a(s.p.xmlReader.cell,k);a.each(N,function(e){var t=U[this];if(!t)return!1;p=t.textContent||t.text;C[s.p.colModel[e+d+v+S].name]=p})}else for(l=0;l<T.length;l++){p=a(T[l],k).text();C[s.p.colModel[l+d+v+S].name]=p}C._id_=L;s.p.data.push(C);s.p._index[L]=s.p.data.length-1;C={};h++}}},T=function(e,t,n,r,i){var o=new Date;if(e){if(s.p.treeANode===-1&&!s.p.scroll){E(t,!1,!0);n=1}else n=n>1?n:1;var u,f=s.p.datatype!="local"&&s.p.loadonce||s.p.datatype=="jsonstring";if(f){s.p.data=[];s.p._index={};s.p.localReader.id="_id_"}s.p.reccount=0;if(s.p.datatype=="local"){t=s.p.localReader;u="local"}else{t=s.p.jsonReader;u="json"}var l=0,c,h,p=[],d,v=0,S=0,x=0,T,N,C={},k,L,A=[],O=s.p.altRows===!0?" "+s.p.altclass:"";s.p.page=a.jgrid.getAccessor(e,t.page)||0;T=a.jgrid.getAccessor(e,t.total);s.p.lastpage=T===void 0?1:T;s.p.records=a.jgrid.getAccessor(e,t.records)||0;s.p.userData=a.jgrid.getAccessor(e,t.userdata)||{};t.repeatitems||(d=p=b(u));u=s.p.keyIndex===!1?t.id:s.p.keyIndex;if(p.length>0&&!isNaN(u)){s.p.remapColumns&&s.p.remapColumns.length&&(u=a.inArray(u,s.p.remapColumns));u=p[u]}(N=a.jgrid.getAccessor(e,t.root))||(N=[]);T=N.length;var e=0,M=parseInt(s.p.rowNum,10),_=s.p.scroll?a.jgrid.randId():1;i&&(M*=i+1);var D=a.isFunction(s.p.afterInsertRow),P={},H="";for(s.p.grouping&&s.p.groupingView.groupCollapse===!0&&(H=' style="display:none;"');e<T;){i=N[e];L=a.jgrid.getAccessor(i,u);if(L===void 0){L=_+e;p.length===0&&t.cell&&(L=a.jgrid.getAccessor(i,t.cell)[u]||L)}c=n===1?0:n;c=(c+e)%2==1?O:"";A.push("<tr"+H+' id="'+L+'" tabindex="-1" role="row" class= "ui-widget-content jqgrow ui-row-'+s.p.direction+""+c+'">');if(s.p.rownumbers===!0){A.push(y(0,e,s.p.page,s.p.rowNum));x=1}if(s.p.multiselect){A.push(g(L,x,e));v=1}if(s.p.subGrid){A.push(a(s).jqGrid("addSubGridCell",v+x,e+n));S=1}if(t.repeatitems){t.cell&&(i=a.jgrid.getAccessor(i,t.cell));d||(d=w(v+S+x))}for(h=0;h<d.length;h++){c=a.jgrid.getAccessor(i,d[h]);A.push(m(L,c,h+v+S+x,e+n,i));C[s.p.colModel[h+v+S+x].name]=c}A.push("</tr>");if(s.p.grouping){c=s.p.groupingView.groupField.length;h=[];for(var B=0;B<c;B++)h.push(C[s.p.groupingView.groupField[B]]);P=a(s).jqGrid("groupingPrepare",A,h,P,C);A=[]}if(f||s.p.treeGrid===!0){C._id_=L;s.p.data.push(C);s.p._index[L]=s.p.data.length-1}if(s.p.gridview===!1){a("#"+a.jgrid.jqID(s.p.id)+" tbody:first").append(A.join(""));D&&s.p.afterInsertRow
.call(s,L,C,i);A=[]}C={};l++;e++;if(l==M)break}if(s.p.gridview===!0){k=s.p.treeANode>-1?s.p.treeANode:0;s.p.grouping?a(s).jqGrid("groupingRender",P,s.p.colModel.length):s.p.treeGrid===!0&&k>0?a(s.rows[k]).after(A.join("")):a("#"+a.jgrid.jqID(s.p.id)+" tbody:first").append(A.join(""))}if(s.p.subGrid===!0)try{a(s).jqGrid("addSubGrid",v+x)}catch(j){}s.p.totaltime=new Date-o;l>0&&s.p.records===0&&(s.p.records=T);if(s.p.treeGrid===!0)try{a(s).jqGrid("setTreeNode",k+1,l+k+1)}catch(F){}!s.p.treeGrid&&!s.p.scroll&&(s.grid.bDiv.scrollTop=0);s.p.reccount=l;s.p.treeANode=-1;s.p.userDataOnFooter&&a(s).jqGrid("footerData","set",s.p.userData,!0);if(f){s.p.records=T;s.p.lastpage=Math.ceil(T/M)}r||s.updatepager(!1,!0);if(f)for(;l<T&&N[l];){i=N[l];L=a.jgrid.getAccessor(i,u);if(L===void 0){L=_+l;p.length===0&&t.cell&&(L=a.jgrid.getAccessor(i,t.cell)[u]||L)}if(i){if(t.repeatitems){t.cell&&(i=a.jgrid.getAccessor(i,t.cell));d||(d=w(v+S+x))}for(h=0;h<d.length;h++){c=a.jgrid.getAccessor(i,d[h]);C[s.p.colModel[h+v+S+x].name]=c}C._id_=L;s.p.data.push(C);s.p._index[L]=s.p.data.length-1;C={}}l++}}},N=function(){function e(t){var n=0,i,s,o;if(t.groups!==void 0)for(i=0;i<t.groups.length;i++){try{e(t.groups[i])}catch(u){alert(u)}n++}if(t.rules!==void 0){if(n>0){var f=p.select();p=a.jgrid.from(f)}try{for(i=0;i<t.rules.length;i++){o=t.rules[i];s=t.groupOp.toString().toUpperCase();if(h[o.op]&&o.field){n>0&&s&&s==="OR"&&(p=p.or());p=h[o.op](p,s)(o.field,o.data,r[o.field])}n++}}catch(l){alert(l)}}}var t,n=!1,r={},i=[],o=[],u,f,l;if(a.isArray(s.p.data)){var c=s.p.grouping?s.p.groupingView:!1;a.each(s.p.colModel,function(){f=this.sorttype||"text";if(f=="date"||f=="datetime"){if(this.formatter&&typeof this.formatter=="string"&&this.formatter=="date"){u=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:a.jgrid.formatter.date.srcformat;l=this.formatoptions&&this.formatoptions.newformat?this.formatoptions.newformat:a.jgrid.formatter.date.newformat}else u=l=this.datefmt||"Y-m-d";r[this.name]={stype:f,srcfmt:u,newfmt:l}}else r[this.name]={stype:f,srcfmt:"",newfmt:""};if(s.p.grouping&&this.name==c.groupField[0]){var e=this.name;typeof this.index!="undefined"&&(e=this.index);i[0]=r[e];o.push(e)}if(!n&&(this.index==s.p.sortname||this.name==s.p.sortname)){t=this.name;n=!0}});if(!s.p.treeGrid){var h={eq:function(e){return e.equals},ne:function(e){return e.notEquals},lt:function(e){return e.less},le:function(e){return e.lessOrEquals},gt:function(e){return e.greater},ge:function(e){return e.greaterOrEquals},cn:function(e){return e.contains},nc:function(e,t){return t==="OR"?e.orNot().contains:e.andNot().contains},bw:function(e){return e.startsWith},bn:function(e,t){return t==="OR"?e.orNot().startsWith:e.andNot().startsWith},en:function(e,t){return t==="OR"?e.orNot().endsWith:e.andNot().endsWith},ew:function(e){return e.endsWith},ni:function(e,t){return t==="OR"?e.orNot().equals:e.andNot().equals},"in":function(e){return e.equals},nu:function(e){return e.isNull},nn:function(e,t){return t==="OR"?e.orNot().isNull:e.andNot().isNull}},p=a.jgrid.from(s.p.data);s.p.ignoreCase&&(p=p.ignoreCase());if(s.p.search===!0){var d=s.p.postData.filters;if(d){typeof d=="string"&&(d=a.jgrid.parse(d));e(d)}else try{p=h[s.p.postData.searchOper](p)(s.p.postData.searchField,s.p.postData.searchString,r[s.p.postData.searchField])}catch(v){}}if(s.p.grouping){p.orderBy(o,c.groupOrder[0],i[0].stype,i[0].srcfmt);c.groupDataSorted=!0}t&&s.p.sortorder&&n&&(s.p.sortorder.toUpperCase()=="DESC"?p.orderBy(s.p.sortname,"d",r[t].stype,r[t].srcfmt):p.orderBy(s.p.sortname,"a",r[t].stype,r[t].srcfmt));var d=p.select(),m=parseInt(s.p.rowNum,10),g=d.length,y=parseInt(s.p.page,10),b=Math.ceil(g/m),w={},d=d.slice((y-1)*m,y*m),r=p=null;w[s.p.localReader.total]=b;w[s.p.localReader.page]=y;w[s.p.localReader.records]=g;w[s.p.localReader.root]=d;d=null;return w}a(s).jqGrid("SortTree",t,s.p.sortorder,r[t].stype,r[t].srcfmt)}},C=function(){s.grid.hDiv.loading=!0;if(!s.p.hiddengrid)switch(s.p.loadui){case"enable":a("#load_"+a.jgrid.jqID(s.p.id)).show();break;case"block":a("#lui_"+a.jgrid.jqID(s.p.id)).show();a("#load_"+a.jgrid.jqID(s.p.id)).show()}},k=function(){s.grid.hDiv.loading=!1;switch(s.p.loadui){case"enable":a("#load_"+a.jgrid.jqID(s.p.id)).hide();break;case"block":a("#lui_"+a.jgrid.jqID(s.p.id)).hide();a("#load_"+a.jgrid.jqID(s.p.id)).hide()}},L=function(e){if(!s.grid.hDiv.loading){var t=s.p.scroll&&e===!1,n={},r,i=s.p.prmNames;s.p.page<=0&&(s.p.page=1);i.search!==null&&(n[i.search]=s.p.search);i.nd!==null&&(n[i.nd]=(new Date).getTime());i.rows!==null&&(n[i.rows]=s.p.rowNum);i.page!==null&&(n[i.page]=s.p.page);i.sort!==null&&(n[i.sort]=s.p.sortname);i.order!==null&&(n[i.order]=s.p.sortorder);s.p.rowTotal!==null&&i.totalrows!==null&&(n[i.totalrows]=s.p.rowTotal);var o=s.p.loadComplete,u=a.isFunction(o);u||(o=null);var f=0,e=e||1;if(e>1)if(i.npage!==null){n[i.npage]=e;f=e-1;e=1}else o=function(t){s.p.page++;s.grid.hDiv.loading=!1;u&&s.p.loadComplete.call(s,t);L(e-1)};else i.npage!==null&&delete s.p.postData[i.npage];if(s.p.grouping){a(s).jqGrid("groupingSetup");s.p.groupingView.groupDataSorted===!0&&(n[i.sort]=s.p.groupingView.groupField[0]+" "+s.p.groupingView.groupOrder[0]+", "+n[i.sort])}a.extend(s.p.postData,n);var l=s.p.scroll?s.rows.length-1:1;if(a.isFunction(s.p.datatype))s.p.datatype.call(s,s.p.postData,"load_"+s.p.id);else{a.isFunction(s.p.beforeRequest)&&s.p.beforeRequest.call(s);r=s.p.datatype.toLowerCase();switch(r){case"json":case"jsonp":case"xml":case"script":a.ajax(a.extend({url:s.p.url,type:s.p.mtype,dataType:r,data:a.isFunction(s.p.serializeGridData)?s.p.serializeGridData.call(s,s.p.postData):s.p.postData,success:function(n){r==="xml"?x(n,s.grid.bDiv,l,e>1,f):T(n,s.grid.bDiv,l,e>1,f);o&&o.call(s,n);t&&s.grid.populateVisible();if(s.p.loadonce||s.p.treeGrid)s.p.datatype="local";k()},error:function(e,t,n){a.isFunction(s.p.loadError)&&s.p.loadError.call(s,e,t,n);k()},beforeSend:function(e){C();a.isFunction(s.p.loadBeforeSend)&&s.p.loadBeforeSend.call(s,e)}},a.jgrid.ajaxOptions,s.p.ajaxGridOptions));break;case"xmlstring":C();n=a.jgrid.stringToDoc(s.p.datastr);x(n,s.grid.bDiv);u&&s.p.loadComplete.call(s,n);s.p.datatype="local";s.p.datastr=null;k();break;case"jsonstring":C();n=typeof s.p.datastr=="string"?a.jgrid.parse(s.p.datastr):s.p.datastr;T(n,s.grid.bDiv);u&&s.p.loadComplete.call(s,n);s.p.datatype="local";s.p.datastr=null;k();break;case"local":case"clientside":C();s.p.datatype="local";n=N();T(n,s.grid.bDiv,l,e>1,f);o&&o.call(s,n);t&&s.grid.populateVisible();k()}}}};u=function(e,t){var n="",r="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",o="",u,f,l,c,p=function(e){var t;a.isFunction(s.p.onPaging)&&(t=s.p.onPaging.call(s,e));s.p.selrow=null;if(s.p.multiselect){s.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(s.p.id),s.grid.hDiv).attr("checked",!1)}s.p.savedRow=[];return t=="stop"?!1:!0},e=e.substr(1);u="pg_"+e;f=e+"_left";l=e+"_center";c=e+"_right";a("#"+a.jgrid.jqID(e)).append("<div id='"+u+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+f+"' align='left'></td><td id='"+l+"' align='center' style='white-space:pre;'></td><td id='"+c+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(s.p.rowList.length>0){o="<td dir='"+i+"'>";o+="<select class='ui-pg-selbox' role='listbox'>";for(f=0;f<s.p.rowList.length;f++)o+='<option role="option" value="'+s.p.rowList[f]+'"'+(s.p.rowNum==s.p.rowList[f]?' selected="selected"':"")+">"+s.p.rowList[f]+"</option>";o+="</select></td>"}i=="rtl"&&(r+=o);s.p.pginput===!0&&(n="<td dir='"+i+"'>"+a.jgrid.format(s.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1'></span>")+"</td>");if(s.p.pgbuttons===!0){f=["first"+t,"prev"+t,"next"+t,"last"+t];i=="rtl"&&f.reverse();r+="<td id='"+f[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>";r+="<td id='"+f[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>";r=r+(n!==""?"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>"+n+"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>":"")+("<td id='"+f[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>");r+="<td id='"+f[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>"}else n!==""&&(r+=n);i=="ltr"&&(r+=o);r+="</tr></tbody></table>";s.p.viewrecords===!0&&a("td#"+e+"_"+s.p.recordpos,"#"+u).append("<div dir='"+i+"' style='text-align:"+s.p.recordpos+"' class='ui-paging-info'></div>");a("td#"+e+"_"+s.p.pagerpos,"#"+u).append(r);o=a(".ui-jqgrid").css("font-size")||"11px";a(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+o+";visibility:hidden;' ></div>");r=a(r).clone().appendTo("#testpg").width();a("#testpg").remove();if(r>0){n!==""&&(r+=50);a("td#"+e+"_"+s.p.pagerpos,"#"+u).width(r)}s.p._nvtd=[];s.p._nvtd[0]=r?Math.floor((s.p.width-r)/2):Math.floor(s.p.width/3);s.p._nvtd[1]=0;r=null;a(".ui-pg-selbox","#"+u).bind("change",function(){s.p.page=Math.round(s.p.rowNum*(s.p.page-1)/this.value-.5)+1;s.p.rowNum=this.value;t?a(".ui-pg-selbox",s.p.pager).val(this.value):s.p.toppager&&a(".ui-pg-selbox",s.p.toppager).val(this.value);if(!p("records"))return!1;L();return!1});if(s.p.pgbuttons===!0){a(".ui-pg-button","#"+u).hover(function(){if(a(this).hasClass("ui-state-disabled"))this.style.cursor="default";else{a(this).addClass("ui-state-hover");this.style.cursor="pointer"}},function(){if(!a(this).hasClass("ui-state-disabled")){a(this).removeClass("ui-state-hover");this.style.cursor="default"}});a("#first"+t+", #prev"+t+", #next"+t+", #last"+t,"#"+e).click(function(){var e=h(s.p.page,1),n=h(s.p.lastpage,1),r=!1,i=!0,o=!0,u=!0,a=!0;if(n===0||n===1)a=u=o=i=!1;else if(n>1&&e>=1)e===1?o=i=!1:e>1&&e<n||e===n&&(a=u=!1);else if(n>1&&e===0){a=u=!1;e=n-1}if(this.id==="first"+t&&i){s.p.page=1;r=!0}if(this.id==="prev"+t&&o){s.p.page=e-1;r=!0}if(this.id==="next"+t&&u){s.p.page=e+1;r=!0}if(this.id==="last"+t&&a){s.p.page=n;r=!0}if(r){if(!p(this.id))return!1;L()}return!1})}s.p.pginput===!0&&a("input.ui-pg-input","#"+u).keypress(function(e){if((e.charCode?e.charCode:e.keyCode?e.keyCode:0)==13){s.p.page=a(this).val()>0?a(this).val():s.p.page;if(!p("user"))return!1;L();return!1}return this})};var A=function(e,t,n,r){if(s.p.colModel[t].sortable&&!(s.p.savedRow.length>0)){if(!n){s.p.lastsort==t?s.p.sortorder=="asc"?s.p.sortorder="desc":s.p.sortorder=="desc"&&(s.p.sortorder="asc"):s.p.sortorder=s.p.colModel[t].firstsortorder||"asc";s.p.page=1}if(r){if(s.p.lastsort==t&&s.p.sortorder==r&&!n)return;s.p.sortorder=r}n=a("thead:first",s.grid.hDiv).get(0);a("tr th:eq("+s.p.lastsort+") span.ui-grid-ico-sort",n).addClass("ui-state-disabled");a("tr th:eq("+s.p.lastsort+")",n).attr("aria-selected","false");a("tr th:eq("+t+") span.ui-icon-"+s.p.sortorder,n).removeClass("ui-state-disabled");a("tr th:eq("+t+")",n).attr("aria-selected","true");if(!s.p.viewsortcols[0]&&s.p.lastsort!=t){a("tr th:eq("+s.p.lastsort+") span.s-ico",n).hide();a("tr th:eq("+t+") span.s-ico",n).show()}e=e.substring(5);s.p.sortname=s.p.colModel[t].index||e;n=s.p.sortorder;if(a.isFunction(s.p.onSortCol)&&s.p.onSortCol.call(s,e,t,n)=="stop")s.p.lastsort=t;else{if(s.p.datatype=="local")s.p.deselectAfterSort&&a(s).jqGrid("resetSelection");else{s.p.selrow=null;s.p.multiselect&&a("#cb_"+a.jgrid.jqID(s.p.id),s.grid.hDiv).attr("checked",!1);s.p.selarrrow=[];s.p.savedRow=[]}if(s.p.scroll){n=s.grid.bDiv.scrollLeft;E(s.grid.bDiv,!0,!1);s.grid.hDiv.scrollLeft=n}s.p.subGrid&&s.p.datatype=="local"&&a("td.sgexpanded","#"+a.jgrid.jqID(s.p.id)).each(function(){a(this).trigger("click")});L();s.p.lastsort=t;s.p.sortname!=e&&t&&(s.p.lastsort=t)}}},O=function(e){var t,n={},r=l?0:s.p.cellLayout;for(t=n[0]=n[1]=n[2]=0;t<=e;t++)s.p.colModel[t].hidden===!1&&(n[0]=n[0]+(s.p.colModel[t].width+r));s.p.direction=="rtl"&&(n[0]=s.p.width-n[0]);n[0]=n[0]-s.grid.bDiv.scrollLeft;a(s.grid.cDiv).is(":visible")&&(n[1]=n[1]+(a(s.grid.cDiv).height()+parseInt(a(s.grid.cDiv).css("padding-top"),10)+parseInt(a(s.grid.cDiv).css("padding-bottom"),10)));s.p.toolbar[0]===!0&&(s.p.toolbar[1]=="top"||s.p.toolbar[1]=="both")&&(n[1]=n[1]+(a(s.grid.uDiv).height()+parseInt(a(s.grid.uDiv).css("border-top-width"),10)+parseInt(a(s.grid.uDiv).css("border-bottom-width"),10)));s.p.toppager&&(n[1]=n[1]+(a(s.grid.topDiv).height()+parseInt(a(s.grid.topDiv).css("border-bottom-width"),10)));n[2]=n[2]+(a(s.grid.bDiv).height()+a(s.grid.hDiv).height());return n};this.p.id=this.id;-1==a.inArray(s.p.multikey,["shiftKey","altKey","ctrlKey"])&&(s.p.multikey=!1);s.p.keyIndex=!1;for(r=0;r<s.p.colModel.length;r++)s.p.colModel[r]=a.extend(!0,{},s.p.cmTemplate,s.p.colModel[r].template||{},s.p.colModel[r]),!1===s.p.keyIndex&&!0===s.p.colModel[r].key&&(s.p.keyIndex=r);s.p.sortorder=s.p.sortorder.toLowerCase();!0===s.p.grouping&&(s.p.scroll=!1,s.p.rownumbers=!1,s.p.subGrid=!1,s.p.treeGrid=!1,s.p.gridview=!0);if(!0===this.p.treeGrid){try{a(this).jqGrid("setTreeGrid")}catch(M){}"local"!=s.p.datatype&&(s.p.localReader={id:"_id_"})}if(this.p.subGrid)try{a(s).jqGrid("setSubGrid")}catch(_){}this.p.multiselect&&(this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>"),this.p.colModel.unshift({name:"cb",width:l?s.p.multiselectWidth+s.p.cellLayout:s.p.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));this.p.rownumbers&&(this.p.colNames.unshift(""),this.p.colModel.unshift({name:"rn",width:s.p.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));s.p.xmlReader=a.extend(!0,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:!0,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:!0,cell:"cell"}},s.p.xmlReader);s.p.jsonReader=a.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!0,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},s.p.jsonReader);s.p.localReader=a.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},s.p.localReader);s.p.scroll&&(s.p.pgbuttons=!1,s.p.pginput=!1,s.p.rowList=[]);s.p.data.length&&S();var D="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",P,H,B,j,F,I,q,R;H=R="";if(!0===s.p.shrinkToFit&&!0===s.p.forceFit)for(r=s.p.colModel.length-1;0<=r;r--)if(!s.p.colModel[r].hidden){s.p.colModel[r].resizable=!1;break}"horizontal"==s.p.viewsortcols[1]&&(R=" ui-i-asc",H=" ui-i-desc");P=f?"class='ui-th-div-ie'":"";R="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+R+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+i+"'></span>"+("<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+H+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+i+"'></span></span>");for(r=0;r<this.p.colNames.length;r++)H=s.p.headertitles?' title="'+a.jgrid.stripHtml(s.p.colNames[r])+'"':"",D+="<th id='"+s.p.id+"_"+s.p.colModel[r].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+i+"'"+H+">",H=s.p.colModel[r].index||s.p.colModel[r].name,D+="<div id='jqgh_"+s.p.colModel[r].name+"' "+P+">"+s.p.colNames[r],s.p.colModel[r].width=s.p.colModel[r].width?parseInt(s.p.colModel[r].width,10):150,"boolean"!=typeof s.p.colModel[r].title&&(s.p.colModel[r].title=!0),H==s.p.sortname&&(s.p.lastsort=r),D+=R+"</div></th>";R=null;a(this).append(D+"</tr></thead>");a("thead tr:first th",this).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});if(this.p.multiselect){var U=[],z;a("#cb_"+a.jgrid.jqID(s.p.id),this).bind("click",function(){s.p.selarrrow=[];if(this.checked){a(s.rows).each(function(e){if(e>0&&!a(this).hasClass("subgrid")&&!a(this).hasClass("jqgroup")&&!a(this).hasClass("ui-state-disabled")){a("#jqg_"+a.jgrid.jqID(s.p.id)+"_"+a.jgrid.jqID(this.id)).attr("checked","checked");a(this).addClass("ui-state-highlight").attr("aria-selected","true");s.p.selarrrow.push(this.id);s.p.selrow=this.id}});z=!0;U=[]}else{a(s.rows).each(function(e){if(e>0&&!a(this).hasClass("subgrid")&&!a(this).hasClass("ui-state-disabled")){a("#jqg_"+a.jgrid.jqID(s.p.id)+"_"+a.jgrid.jqID(this.id)).removeAttr("checked");a(this).removeClass("ui-state-highlight").attr("aria-selected","false");U.push(this.id)}});s.p.selrow=null;z=!1}a.isFunction(s.p.onSelectAll)&&s.p.onSelectAll.call(s,z?s.p.selarrrow:U,z)})}!0===s.p.autowidth&&(D=a(c).innerWidth(),s.p.width=0<D?D:"nw");(function(){var e=0,t=l?0:s.p.cellLayout,r=0,i,o=s.p.scrollOffset,u,f=!1,c,p=0,d=0,v;a.each(s.p.colModel,function(){typeof this.hidden=="undefined"&&(this.hidden=!1);this.widthOrg=u=h(this.width,0);if(this.hidden===!1){e+=u+t;this.fixed?p+=u+t:r++;d++}});isNaN(s.p.width)?s.p.width=n.width=e:n.width=s.p.width;s.p.tblwidth=e;s.p.shrinkToFit===!1&&s.p.forceFit===!0&&(s.p.forceFit=!1);if(s.p.shrinkToFit===!0&&r>0){c=n.width-t*r-p;if(!isNaN(s.p.height)){c-=o;f=!0}e=0;a.each(s.p.colModel,function(n){if(this.hidden===!1&&!this.fixed){this.width=u=Math.round(c*this.width/(s.p.tblwidth-t*r-p));e+=u;i=n}});v=0;f?n.width-p-(e+t*r)!==o&&(v=n.width-p-(e+t*r)-o):!f&&Math.abs(n.width-p-(e+t*r))!==1&&(v=n.width-p-(e+t*r));s.p.colModel[i].width=s.p.colModel[i].width+v;s.p.tblwidth=e+v+t*r+p;if(s.p.tblwidth>s.p.width){s.p.colModel[i].width=s.p.colModel[i].width-(s.p.tblwidth-parseInt(s.p.width,10));s.p.tblwidth=s.p.width}}})();a(c).css("width",n.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+s.p.id+"'>&#160;</div>");a(o).css("width",n.width+"px");var D=a("thead:first",s).get(0),W="";s.p.footerrow&&(W+="<table role='grid' style='width:"+s.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+i+"'>");var o=a("tr:first",D),X="<tr class='jqgfirstrow' role='row' style='height:auto'>";s.p.disableClick=!1;a("th",o).each(function(e){B=s.p.colModel[e].width;typeof s.p.colModel[e].resizable=="undefined"&&(s.p.colModel[e].resizable=!0);if(s.p.colModel[e].resizable){j=document.createElement("span");a(j).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+i);a.browser.opera||a(j).css("cursor","col-resize");a(this).addClass(s.p.resizeclass)}else j="";a(this).css("width",B+"px").prepend(j);var t="";if(s.p.colModel[e].hidden){a(this).css("display","none");t="display:none;"}X+="<td role='gridcell' style='height:0px;width:"+B+"px;"+t+"'></td>";n.headers[e]={width:B,el:this};F=s.p.colModel[e].sortable;typeof F!="boolean"&&(F=s.p.colModel[e].sortable=!0);t=s.p.colModel[e].name;t=="cb"||t=="subgrid"||t=="rn"||s.p.viewsortcols[2]&&a("div",this).addClass("ui-jqgrid-sortable");if(F)if(s.p.viewsortcols[0]){a("div span.s-ico",this).show();e==s.p.lastsort&&a("div span.ui-icon-"+s.p.sortorder,this).removeClass("ui-state-disabled")}else if(e==s.p.lastsort){a("div span.s-ico",this).show();a("div span.ui-icon-"+s.p.sortorder,this).removeClass("ui-state-disabled")}s.p.footerrow&&(W+="<td role='gridcell' "+p(e,0,"",null,"",!1)+">&#160;</td>")}).mousedown(function(e){if(a(e.target).closest("th>span.ui-jqgrid-resize").length==1){var t=a.jgrid.getCellIndex(this);if(s.p.forceFit===!0){var r=s.p,i=t,o;for(o=t+1;o<s.p.colModel.length;o++)if(s.p.colModel[o].hidden!==!0){i=o;break}r.nv=i-t}n.dragStart(t,e,O(t));return!1}}).click(function(e){if(s.p.disableClick)return s.p.disableClick=!1;var t="th>div.ui-jqgrid-sortable",n,r;s.p.viewsortcols[2]||(t="th>div>span>span.ui-grid-ico-sort");e=a(e.target).closest(t);if(e.length==1){t=a.jgrid.getCellIndex(this);if(!s.p.viewsortcols[2]){n=!0;r=e.attr("sort")}A(a("div",this)[0].id,t,n,r);return!1}});if(s.p.sortable&&a.fn.sortable)try{a(s).jqGrid("sortableColumns",o)}catch(V){}s.p.footerrow&&(W+="</tr></tbody></table>");X+="</tr>";this.appendChild(document.createElement("tbody"));a(this).addClass("ui-jqgrid-btable").append(X);var X=null,o=a("<table class='ui-jqgrid-htable' style='width:"+s.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(D),$=s.p.caption&&!0===s.p.hiddengrid?!0:!1;r=a("<div class='ui-jqgrid-hbox"+("rtl"==i?"-rtl":"")+"'></div>");D=null;n.hDiv=document.createElement("div");a(n.hDiv).css({width:n.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(r);a(r).append(o);o=null;$&&a(n.hDiv).hide();s.p.pager&&("string"==typeof s.p.pager?"#"!=s.p.pager.substr(0,1)&&(s.p.pager="#"+s.p.pager):s.p.pager="#"+a(s.p.pager).attr("id"),a(s.p.pager).css({width:n.width+"px"}).appendTo(c).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom"),$&&a(s.p.pager).hide(),u(s.p.pager,""));!1===s.p.cellEdit&&!0===s.p.hoverrows&&a(s).bind("mouseover",function(e){q=a(e.target).closest("tr.jqgrow");a(q).attr("class")!=="subgrid"&&a(q).addClass("ui-state-hover");return!1}).bind("mouseout",function(e){q=a(e.target).closest("tr.jqgrow");a(q).removeClass("ui-state-hover");return!1});var J,K;a(s).before(n.hDiv).click(function(e){I=e.target;q=a(I,s.rows).closest("tr.jqgrow");if(a(q).length===0||q[0].className.indexOf("ui-state-disabled")>-1)return this;var t=a(I).hasClass("cbox"),n=!0;a.isFunction(s.p.beforeSelectRow)&&(n=s.p.beforeSelectRow.call(s,q[0].id,e));if(I.tagName=="A"||(I.tagName=="INPUT"||I.tagName=="TEXTAREA"||I.tagName=="OPTION"||I.tagName=="SELECT")&&!t||n!==!0)return this;if(s.p.cellEdit===!0)if(s.p.multiselect&&t)a(s).jqGrid("setSelection",q[0].id,!0);else{J=q[0].rowIndex;K=a.jgrid.getCellIndex(I);try{a(s).jqGrid("editCell",J,K,!0)}catch(r){}}else if(s.p.multikey){if(e[s.p.multikey])a(s).jqGrid("setSelection",q[0].id,!0);else if(s.p.multiselect&&t){t=a("[id^=jqg_"+a.jgrid.jqID(s.p.id)+"_]").attr("checked");a("[id^=jqg_"+a.jgrid.jqID(s.p.id)+"_]").attr("checked",!t)}}else{if(s.p.multiselect&&s.p.multiboxonly&&!t){a(s.p.selarrrow).each(function(e,t){var n=s.rows.namedItem(t);a(n).removeClass("ui-state-highlight");a("#jqg_"+a.jgrid.jqID(s.p.id)+"_"+a.jgrid.jqID(t)).attr("checked",!1)});s.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(s.p.id),s.grid.hDiv).attr("checked",!1)}a(s).jqGrid("setSelection",q[0].id,!0)}if(a.isFunction(s.p.onCellSelect)){J=q[0].id;K=a.jgrid.getCellIndex(I);s.p.onCellSelect.call(s,J,K,a(I).html(),e)}e.stopPropagation()}).bind("reloadGrid",function(e,t){s.p.treeGrid===!0&&(s.p.datatype=s.p.treedatatype);t&&t.current&&s.grid.selectionPreserver(s);if(s.p.datatype=="local"){a(s).jqGrid("resetSelection");s.p.data.length&&S()}else if(!s.p.treeGrid){s.p.selrow=null;if(s.p.multiselect){s.p.selarrrow=[];a("#cb_"+a.jgrid.jqID(s.p.id),s.grid.hDiv).attr("checked",!1)}s.p.savedRow=[]}s.p.scroll&&E(s.grid.bDiv,!0,!1);if(t&&t.page){var n=t.page;n>s.p.lastpage&&(n=s.p.lastpage);n<1&&(n=1);s.p.page=n;s.grid.bDiv.scrollTop=s.grid.prevRowHeight?(n-1)*s.grid.prevRowHeight*s.p.rowNum:0}if(s.grid.prevRowHeight&&s.p.scroll){delete s.p.lastpage;s.grid.populateVisible()}else s.grid.populate();return!1});a.isFunction(this.p.ondblClickRow)&&a(this).dblclick(function(e){I=e.target;q=a(I,s.rows).closest("tr.jqgrow");if(a(q).length===0)return!1;J=q[0].rowIndex;K=a.jgrid.getCellIndex(I);s.p.ondblClickRow.call(s,a(q).attr("id"),J,K,e);return!1});a.isFunction(this.p.onRightClickRow)&&a(this).bind("contextmenu",function(e){I=e.target;q=a(I,s.rows).closest("tr.jqgrow");if(a(q).length===0)return!1;s.p.multiselect||a(s).jqGrid("setSelection",q[0].id,!0);J=q[0].rowIndex;K=a.jgrid.getCellIndex(I);s.p.onRightClickRow.call(s,a(q).attr("id"),J,K,e);return!1});n.bDiv=document.createElement("div");f&&"auto"===(""+s.p.height).toLowerCase()&&(s.p.height="100%");a(n.bDiv).append(a('<div style="position:relative;'+(f&&8>a.browser.version?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:s.p.height+(isNaN(s.p.height)?"":"px"),width:n.width+"px"}).scroll(n.scrollGrid);a("table:first",n.bDiv).css({width:s.p.tblwidth+"px"});f?(2==a("tbody",this).size()&&a("tbody:gt(0)",this).remove(),s.p.multikey&&a(n.bDiv).bind("selectstart",function(){return!1})):s.p.multikey&&a(n.bDiv).bind("mousedown",function(){return!1});$&&a(n.bDiv).hide();n.cDiv=document.createElement("div");var Q=!0===s.p.hidegrid?a("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){Q.addClass("ui-state-hover")},function(){Q.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css("rtl"==i?"left":"right","0px"):"";a(n.cDiv).append(Q).append("<span class='ui-jqgrid-title"+("rtl"==i?"-rtl":"")+"'>"+s.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix");a(n.cDiv).insertBefore(n.hDiv);s.p.toolbar[0]&&(n.uDiv=document.createElement("div"),"top"==s.p.toolbar[1]?a(n.uDiv).insertBefore(n.hDiv):"bottom"==s.p.toolbar[1]&&a(n.uDiv).insertAfter(n.hDiv),"both"==s.p.toolbar[1]?(n.ubDiv=document.createElement("div"),a(n.uDiv).insertBefore(n.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),a(n.ubDiv).insertAfter(n.hDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id),$&&a(n.ubDiv).hide()):a(n.uDiv).width(n.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),$&&a(n.uDiv).hide());s.p.toppager&&(s.p.toppager=a.jgrid.jqID(s.p.id)+"_toppager",n.topDiv=a("<div id='"+s.p.toppager+"'></div>")[0],s.p.toppager="#"+s.p.toppager,a(n.topDiv).insertBefore(n.hDiv).addClass("ui-state-default ui-jqgrid-toppager").width(n.width),u(s.p.toppager,"_t"));s.p.footerrow&&(n.sDiv=a("<div class='ui-jqgrid-sdiv'></div>")[0],r=a("<div class='ui-jqgrid-hbox"+("rtl"==i?"-rtl":"")+"'></div>"),a(n.sDiv).append(r).insertAfter(n.hDiv).width(n.width),a(r).append(W),n.footers=a(".ui-jqgrid-ftable",n.sDiv)[0].rows[0].cells,s.p.rownumbers&&(n.footers[0].className="ui-state-default jqgrid-rownum"),$&&a(n.sDiv).hide());r=null;if(s.p.caption){var G=s.p.datatype;!0===s.p.hidegrid&&(a(".ui-jqgrid-titlebar-close",n.cDiv).click(function(e){var t=a.isFunction(s.p.onHeaderClick),r=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",i,o=this;if(s.p.toolbar[0]===!0){s.p.toolbar[1]=="both"&&(r+=", #"+a(n.ubDiv).attr("id"));r+=", #"+a(n.uDiv).attr("id")}i=a(r,"#gview_"+a.jgrid.jqID(s.p.id)).length;s.p.gridstate=="visible"?a(r,"#gbox_"+a.jgrid.jqID(s.p.id)).slideUp("fast",function(){i--;if(i===0){a("span",o).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");s.p.gridstate="hidden";a("#gbox_"+a.jgrid.jqID(s.p.id)).hasClass("ui-resizable")&&a(".ui-resizable-handle","#gbox_"+a.jgrid.jqID(s.p.id)).hide();t&&($||s.p.onHeaderClick.call(s,s.p.gridstate,e))}}):s.p.gridstate=="hidden"&&a(r,"#gbox_"+a.jgrid.jqID(s.p.id)).slideDown("fast",function(){i--;if(i===0){a("span",o).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if($){s.p.datatype=G;L();$=!1}s.p.gridstate="visible";a("#gbox_"+a.jgrid.jqID(s.p.id)).hasClass("ui-resizable")&&a(".ui-resizable-handle","#gbox_"+a.jgrid.jqID(s.p.id)).show();t&&($||s.p.onHeaderClick.call(s,s.p.gridstate,e))}});return!1}),$&&(s.p.datatype="local",a(".ui-jqgrid-titlebar-close",n.cDiv).trigger("click")))}else a(n.cDiv).hide();a(n.hDiv).after(n.bDiv).mousemove(function(e){if(n.resizing){n.dragMove(e);return!1}});a(".ui-jqgrid-labels",n.hDiv).bind("selectstart",function(){return!1});a(document).mouseup(function(){if(n.resizing){n.dragEnd();return!1}return!0});s.formatCol=p;s.sortData=A;s.updatepager=function(e,t){var n,r,i,o,u,f,l,c="";i=parseInt(s.p.page,10)-1;i<0&&(i=0);i*=parseInt(s.p.rowNum,10);u=i+s.p.reccount;if(s.p.scroll){n=a("tbody:first > tr:gt(0)",s.grid.bDiv);i=u-n.length;s.p.reccount=n.length;if(r=n.outerHeight()||s.grid.prevRowHeight){n=i*r;r*=parseInt(s.p.records,10);a(">div:first",s.grid.bDiv).css({height:r}).children("div:first").css({height:n,display:n?"":"none"})}s.grid.bDiv.scrollLeft=s.grid.hDiv.scrollLeft}c=s.p.pager?s.p.pager:"";if(c+=s.p.toppager?c?","+s.p.toppager:s.p.toppager:""){l=a.jgrid.formatter.integer||{};n=h(s.p.page);r=h(s.p.lastpage);a(".selbox",c).attr("disabled",!1);if(s.p.pginput===!0){a(".ui-pg-input",c).val(s.p.page);a("#sp_1",c).html(a.fmatter?a.fmatter.util.NumberFormat(s.p.lastpage,l):s.p.lastpage)}if(s.p.viewrecords)if(s.p.reccount===0)a(".ui-paging-info",c).html(s.p.emptyrecords);else{o=i+1;f=s.p.records;if(a.fmatter){o=a.fmatter.util.NumberFormat(o,l);u=a.fmatter.util.NumberFormat(u,l);f=a.fmatter.util.NumberFormat(f,l)}a(".ui-paging-info",c).html(a.jgrid.format(s.p.recordtext,o,u,f))}if(s.p.pgbuttons===!0){n<=0&&(n=r=0);if(n==1||n===0){a("#first, #prev",s.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");s.p.toppager&&a("#first_t, #prev_t",s.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}else{a("#first, #prev",s.p.pager).removeClass("ui-state-disabled");s.p.toppager&&a("#first_t, #prev_t",s.p.toppager).removeClass("ui-state-disabled")}if(n==r||n===0){a("#next, #last",s.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover");s.p.toppager&&a("#next_t, #last_t",s.p.toppager).addClass("ui-state-disabled").removeClass("ui-state-hover")}else{a("#next, #last",s.p.pager).removeClass("ui-state-disabled");s.p.toppager&&a("#next_t, #last_t",s.p.toppager).removeClass("ui-state-disabled")}}}e===!0&&s.p.rownumbers===!0&&a("td.jqgrid-rownum",s.rows).each(function(e){a(this).html(i+1+e)});t&&s.p.jqgdnd&&a(s).jqGrid("gridDnD","updateDnD");a.isFunction(s.p.gridComplete)&&s.p.gridComplete.call(s)};s.refreshIndex=S;s.formatter=function(e,t,n,r,i){return v(e,t,n,r,i)};a.extend(n,{populate:L,emptyRows:E});this.grid=n;s.addXmlData=function(e){x(e,s.grid.bDiv)};s.addJSONData=function(e){T(e,s.grid.bDiv)};this.grid.cols=this.rows[0].cells;L();s.p.hiddengrid=!1;a(window).unload(function(){s=null})}}}})};a.jgrid.extend({getGridParam:function(e){var t=this[0];if(t&&t.grid)return e?"undefined"!=typeof t.p[e]?t.p[e]:null:t.p},setGridParam:function(e){return this.each(function(){this.grid&&"object"==typeof e&&a.extend(!0,this.p,e)})},getDataIDs:function(){var e=[],t=0,n,r=0;this.each(function(){if((n=this.rows.length)&&0<n)for(;t<n;)a(this.rows[t]).hasClass("jqgrow")&&(e[r]=this.rows[t].id,r++),t++});return e},setSelection:function(e,t){return this.each(function(){var n,r,i;if(void 0!==e&&(t=!1===t?!1:!0,(r=this.rows.namedItem(e+""))&&!(-1<r.className.indexOf("ui-state-disabled")))){if(!0===this.p.scrollrows&&(n=this.rows.namedItem(e).rowIndex,0<=n)){i=a(this.grid.bDiv)[0].clientHeight;var s=a(this.grid.bDiv)[0].scrollTop,o=this.rows[n].offsetTop;n=this.rows[n].clientHeight;o+n>=i+s?a(this.grid.bDiv)[0].scrollTop=o-(i+s)+n+s:o<i+s&&o<s&&(a(this.grid.bDiv)[0].scrollTop=o)}this.p.multiselect?(this.p.selrow=r.id,i=a.inArray(this.p.selrow,this.p.selarrrow),-1===i?("ui-subgrid"!==r.className&&a(r).addClass("ui-state-highlight").attr("aria-selected","true"),n=!0,a("#jqg_"+a.jgrid.jqID(this.p.id)+"_"+a.jgrid.jqID(this.p.selrow)).attr("checked",n),this.p.selarrrow.push(this.p.selrow)):("ui-subgrid"!==r.className&&a(r).removeClass("ui-state-highlight").attr("aria-selected","false"),n=!1,a("#jqg_"+a.jgrid.jqID(this.p.id)+"_"+a.jgrid.jqID(this.p.selrow)).attr("checked",n),this.p.selarrrow.splice(i,1),i=this.p.selarrrow[0],this.p.selrow=void 0===i?null:i),this.p.onSelectRow&&t&&this.p.onSelectRow.call(this,r.id,n)):"ui-subgrid"!==r.className&&(this.p.selrow!=r.id?(a(this.rows.namedItem(this.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"}),a(r).addClass("ui-state-highlight").attr({"aria-selected":!0,tabindex:"0"}),n=!0):n=!1,this.p.selrow=r.id,this.p.onSelectRow&&t&&this.p.onSelectRow.call(this,r.id,n))}})},resetSelection:function(e){return this.each(function(){var t=this,n,r;"undefined"!=typeof e?(r=e===t.p.selrow?t.p.selrow:e,a("#"+a.jgrid.jqID(t.p.id)+" tbody:first tr#"+a.jgrid.jqID(r)).removeClass("ui-state-highlight").attr("aria-selected","false"),t.p.multiselect&&(a("#jqg_"+a.jgrid.jqID(t.p.id)+"_"+a.jgrid.jqID(r)).attr("checked",!1),a("#cb_"+a.jgrid.jqID(t.p.id)).attr("checked",!1)),r=null):t.p.multiselect?(a(t.p.selarrrow).each(function(e,r){n=t.rows.namedItem(r);a(n).removeClass("ui-state-highlight").attr("aria-selected","false");a("#jqg_"+a.jgrid.jqID(t.p.id)+"_"+a.jgrid.jqID(r)).attr("checked",!1)}),a("#cb_"+a.jgrid.jqID(t.p.id)).attr("checked",!1),t.p.selarrrow=[]):t.p.selrow&&(a("#"+a.jgrid.jqID(t.p.id)+" tbody:first tr#"+
a.jgrid.jqID(t.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false"),t.p.selrow=null);t.p.savedRow=[]})},getRowData:function(e){var t={},n,r=!1,i,s=0;this.each(function(){var o=this,u,h;if("undefined"==typeof e)r=!0,n=[],i=o.rows.length;else{h=o.rows.namedItem(e);if(!h)return t;i=2}for(;s<i;)r&&(h=o.rows[s]),a(h).hasClass("jqgrow")&&(a("td",h).each(function(e){u=o.p.colModel[e].name;if("cb"!==u&&"subgrid"!==u&&"rn"!==u)if(!0===o.p.treeGrid&&u==o.p.ExpandColumn)t[u]=a.jgrid.htmlDecode(a("span:first",this).html());else try{t[u]=a.unformat(this,{rowId:h.id,colModel:o.p.colModel[e]},e)}catch(n){t[u]=a.jgrid.htmlDecode(a(this).html())}}),r&&(n.push(t),t={})),s++});return n?n:t},delRowData:function(e){var t=!1,n,r;this.each(function(){if(!(n=this.rows.namedItem(e)))return!1;if(a(n).remove(),this.p.records--,this.p.reccount--,this.updatepager(!0,!1),t=!0,this.p.multiselect&&(r=a.inArray(e,this.p.selarrrow),-1!=r&&this.p.selarrrow.splice(r,1)),e==this.p.selrow)this.p.selrow=null;if("local"==this.p.datatype){var i=this.p._index[e];"undefined"!=typeof i&&(this.p.data.splice(i,1),this.refreshIndex())}if(!0===this.p.altRows&&t){var s=this.p.altclass;a(this.rows).each(function(e){1==e%2?a(this).addClass(s):a(this).removeClass(s)})}});return t},setRowData:function(e,t,n){var r,i=!0,s;this.each(function(){if(!this.grid)return!1;var o=this,u,h,p=typeof n,d={};h=o.rows.namedItem(e);if(!h)return!1;if(t)try{if(a(this.p.colModel).each(function(n){r=this.name;void 0!==t[r]&&(d[r]=this.formatter&&"string"==typeof this.formatter&&"date"==this.formatter?a.unformat.date(t[r],this):t[r],u=o.formatter(e,t[r],n,t,"edit"),s=this.title?{title:a.jgrid.stripHtml(u)}:{},!0===o.p.treeGrid&&r==o.p.ExpandColumn?a("td:eq("+n+") > span:first",h).html(u).attr(s):a("td:eq("+n+")",h).html(u).attr(s))}),"local"==o.p.datatype){var v=o.p._index[e];if(o.p.treeGrid)for(var m in o.p.treeReader)d.hasOwnProperty(o.p.treeReader[m])&&delete d[o.p.treeReader[m]];"undefined"!=typeof v&&(o.p.data[v]=a.extend(!0,o.p.data[v],d));d=null}}catch(y){i=!1}i&&("string"===p?a(h).addClass(n):"object"===p&&a(h).css(n))});return i},addRowData:function(e,t,n,r){n||(n="last");var i=!1,s,o,u,f,l,c,h,p,d="",v,m,g,y,b;t&&(a.isArray(t)?(v=!0,n="last",m=e):(t=[t],v=!1),this.each(function(){var w=t.length;l=this.p.rownumbers===!0?1:0;u=this.p.multiselect===!0?1:0;f=this.p.subGrid===!0?1:0;if(!v)if(typeof e!="undefined")e+="";else{e=a.jgrid.randId();if(this.p.keyIndex!==!1){m=this.p.colModel[this.p.keyIndex+u+f+l].name;typeof t[0][m]!="undefined"&&(e=t[0][m])}}g=this.p.altclass;for(var E=0,S="",T={},N=a.isFunction(this.p.afterInsertRow)?!0:!1;E<w;){y=t[E];o="";if(v){try{e=y[m]}catch(C){e=a.jgrid.randId()}S=this.p.altRows===!0?(this.rows.length-1)%2===0?g:"":""}if(l){d=this.formatCol(0,1,"",null,e,!0);o+='<td role="gridcell" aria-describedby="'+this.p.id+'_rn" class="ui-state-default jqgrid-rownum" '+d+">0</td>"}if(u){p='<input role="checkbox" type="checkbox" id="jqg_'+this.p.id+"_"+e+'" class="cbox"/>';d=this.formatCol(l,1,"",null,e,!0);o+='<td role="gridcell" aria-describedby="'+this.p.id+'_cb" '+d+">"+p+"</td>"}f&&(o+=a(this).jqGrid("addSubGridCell",u+l,1));for(h=u+f+l;h<this.p.colModel.length;h++){b=this.p.colModel[h];s=b.name;T[s]=b.formatter&&typeof b.formatter=="string"&&b.formatter=="date"?a.unformat.date(y[s],b):y[s];p=this.formatter(e,a.jgrid.getAccessor(y,s),h,y,"edit");d=this.formatCol(h,1,p,e,y,!0);o+='<td role="gridcell" aria-describedby="'+this.p.id+"_"+s+'" '+d+">"+p+"</td>"}o='<tr id="'+e+'" role="row" tabindex="-1" class="ui-widget-content jqgrow ui-row-'+this.p.direction+" "+S+'">'+o+"</tr>";if(this.p.subGrid===!0){o=a(o)[0];a(this).jqGrid("addSubGrid",o,u+l)}if(this.rows.length===0)a("table:first",this.grid.bDiv).append(o);else switch(n){case"last":a(this.rows[this.rows.length-1]).after(o);break;case"first":a(this.rows[0]).after(o);break;case"after":if(c=this.rows.namedItem(r))a(this.rows[c.rowIndex+1]).hasClass("ui-subgrid")?a(this.rows[c.rowIndex+1]).after(o):a(c).after(o);break;case"before":if(c=this.rows.namedItem(r)){a(c).before(o);c=c.rowIndex}}this.p.records++;this.p.reccount++;N&&this.p.afterInsertRow.call(this,e,y,y);E++;if(this.p.datatype=="local"){T[this.p.localReader.id]=e;this.p._index[e]=this.p.data.length;this.p.data.push(T);T={}}}this.p.altRows===!0&&!v&&(n=="last"?(this.rows.length-1)%2==1&&a(this.rows[this.rows.length-1]).addClass(g):a(this.rows).each(function(e){e%2==1?a(this).addClass(g):a(this).removeClass(g)}));this.updatepager(!0,!0);i=!0}));return i},footerData:function(e,t,n){function r(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var i,s=!1,o={},u;"undefined"==typeof e&&(e="get");"boolean"!=typeof n&&(n=!0);e=e.toLowerCase();this.each(function(){var h=this,p;if(!h.grid||!h.p.footerrow||"set"==e&&r(t))return!1;s=!0;a(this.p.colModel).each(function(r){i=this.name;"set"==e?void 0!==t[i]&&(p=n?h.formatter("",t[i],r,t,"edit"):t[i],u=this.title?{title:a.jgrid.stripHtml(p)}:{},a("tr.footrow td:eq("+r+")",h.grid.sDiv).html(p).attr(u),s=!0):"get"==e&&(o[i]=a("tr.footrow td:eq("+r+")",h.grid.sDiv).html())})});return"get"==e?o:s},showHideCol:function(e,t){return this.each(function(){var n=this,r=!1,i=a.browser.webkit||a.browser.safari?0:n.p.cellLayout,s;if(n.grid){"string"==typeof e&&(e=[e]);t="none"!=t?"":"none";var o=""===t?!0:!1;a(this.p.colModel).each(function(u){-1!==a.inArray(this.name,e)&&this.hidden===o&&(a("tr",n.grid.hDiv).each(function(){a(this).children("th:eq("+u+")").css("display",t)}),a(n.rows).each(function(){a(this).children("td:eq("+u+")").css("display",t)}),n.p.footerrow&&a(n.grid.sDiv).children("td:eq("+u+")").css("display",t),s=this.widthOrg?this.widthOrg:parseInt(this.width,10),n.p.tblwidth="none"===t?n.p.tblwidth-(s+i):n.p.tblwidth+(s+i),this.hidden=!o,r=!0)});!0===r&&n.grid.width!==n.p.tblwidth&&a(n).jqGrid("setGridWidth",!0===n.p.shrinkToFit?n.grid.width:n.p.tblwidth,!0)}})},hideCol:function(e){return this.each(function(){a(this).jqGrid("showHideCol",e,"none")})},showCol:function(e){return this.each(function(){a(this).jqGrid("showHideCol",e,"")})},remapColumns:function(e,t,n){function r(t){var n;n=t.length?a.makeArray(t):a.extend({},t);a.each(e,function(e){t[e]=n[this]})}function i(t,n){a(">tr"+(n||""),t).each(function(){var t=this,n=a.makeArray(t.cells);a.each(e,function(){var e=n[this];e&&t.appendChild(e)})})}var s=this.get(0);r(s.p.colModel);r(s.p.colNames);r(s.grid.headers);i(a("thead:first",s.grid.hDiv),n&&":not(.ui-jqgrid-labels)");t&&i(a("#"+a.jgrid.jqID(s.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot");s.p.footerrow&&i(a("tbody:first",s.grid.sDiv));s.p.remapColumns&&(s.p.remapColumns.length?r(s.p.remapColumns):s.p.remapColumns=a.makeArray(e));s.p.lastsort=a.inArray(s.p.lastsort,e);s.p.treeGrid&&(s.p.expColInd=a.inArray(s.p.expColInd,e))},setGridWidth:function(e,t){return this.each(function(){if(this.grid){var n=this,r,i=0,s=a.browser.webkit||a.browser.safari?0:n.p.cellLayout,o,u=0,f=!1,l=n.p.scrollOffset,h,p=0,d=0,v;"boolean"!=typeof t&&(t=n.p.shrinkToFit);if(!isNaN(e)&&(e=parseInt(e,10),n.grid.width=n.p.width=e,a("#gbox_"+a.jgrid.jqID(n.p.id)).css("width",e+"px"),a("#gview_"+a.jgrid.jqID(n.p.id)).css("width",e+"px"),a(n.grid.bDiv).css("width",e+"px"),a(n.grid.hDiv).css("width",e+"px"),n.p.pager&&a(n.p.pager).css("width",e+"px"),n.p.toppager&&a(n.p.toppager).css("width",e+"px"),!0===n.p.toolbar[0]&&(a(n.grid.uDiv).css("width",e+"px"),"both"==n.p.toolbar[1]&&a(n.grid.ubDiv).css("width",e+"px")),n.p.footerrow&&a(n.grid.sDiv).css("width",e+"px"),!1===t&&!0===n.p.forceFit&&(n.p.forceFit=!1),!0===t))if(a.each(n.p.colModel,function(){if(this.hidden===!1){r=this.widthOrg?this.widthOrg:parseInt(this.width,10);i+=r+s;this.fixed?p+=r+s:u++;d++}}),0!==u){n.p.tblwidth=i;h=e-s*u-p;!isNaN(n.p.height)&&(a(n.grid.bDiv)[0].clientHeight<a(n.grid.bDiv)[0].scrollHeight||1===n.rows.length)&&(f=!0,h-=l);var i=0,m=0<n.grid.cols.length;a.each(n.p.colModel,function(e){if(this.hidden===!1&&!this.fixed){r=this.widthOrg?this.widthOrg:parseInt(this.width,10);r=Math.round(h*r/(n.p.tblwidth-s*u-p));if(!(r<0)){this.width=r;i+=r;n.grid.headers[e].width=r;n.grid.headers[e].el.style.width=r+"px";n.p.footerrow&&(n.grid.footers[e].style.width=r+"px");m&&(n.grid.cols[e].style.width=r+"px");o=e}}});v=0;f?e-p-(i+s*u)!==l&&(v=e-p-(i+s*u)-l):1!==Math.abs(e-p-(i+s*u))&&(v=e-p-(i+s*u));n.p.colModel[o].width+=v;n.p.tblwidth=i+v+s*u+p;n.p.tblwidth>e?(f=n.p.tblwidth-parseInt(e,10),n.p.tblwidth=e,r=n.p.colModel[o].width-=f):r=n.p.colModel[o].width;n.grid.headers[o].width=r;n.grid.headers[o].el.style.width=r+"px";m&&(n.grid.cols[o].style.width=r+"px");a("table:first",n.grid.bDiv).css("width",n.p.tblwidth+"px");a("table:first",n.grid.hDiv).css("width",n.p.tblwidth+"px");n.grid.hDiv.scrollLeft=n.grid.bDiv.scrollLeft;n.p.footerrow&&(n.grid.footers[o].style.width=r+"px",a("table:first",n.grid.sDiv).css("width",n.p.tblwidth+"px"))}}})},setGridHeight:function(e){return this.each(function(){this.grid&&(a(this.grid.bDiv).css({height:e+(isNaN(e)?"":"px")}),this.p.height=e,this.p.scroll&&this.grid.populateVisible())})},setCaption:function(e){return this.each(function(){this.p.caption=e;a("span.ui-jqgrid-title",this.grid.cDiv).html(e);a(this.grid.cDiv).show()})},setLabel:function(e,t,n,r){return this.each(function(){var i=-1;if(this.grid&&(isNaN(e)?a(this.p.colModel).each(function(t){if(this.name==e)return i=t,!1}):i=parseInt(e,10),0<=i)){var s=a("tr.ui-jqgrid-labels th:eq("+i+")",this.grid.hDiv);if(t){var o=a(".s-ico",s);a("[id^=jqgh_]",s).empty().html(t).append(o);this.p.colNames[i]=t}n&&("string"==typeof n?a(s).addClass(n):a(s).css(n));"object"==typeof r&&a(s).attr(r)}})},setCell:function(e,t,n,r,i,s){return this.each(function(){var o=-1,u,h;if(this.grid&&(isNaN(t)?a(this.p.colModel).each(function(e){if(this.name==t)return o=e,!1}):o=parseInt(t,10),0<=o&&(u=this.rows.namedItem(e)))){var p=a("td:eq("+o+")",u);if(""!==n||!0===s)u=this.formatter(e,n,o,u,"edit"),h=this.p.colModel[o].title?{title:a.jgrid.stripHtml(u)}:{},this.p.treeGrid&&0<a(".tree-wrap",a(p)).length?a("span",a(p)).html(u).attr(h):a(p).html(u).attr(h),"local"==this.p.datatype&&(u=this.p.colModel[o],n=u.formatter&&"string"==typeof u.formatter&&"date"==u.formatter?a.unformat.date(n,u):n,h=this.p._index[e],"undefined"!=typeof h&&(this.p.data[h][u.name]=n));"string"==typeof r?a(p).addClass(r):r&&a(p).css(r);"object"==typeof i&&a(p).attr(i)}})},getCell:function(e,t){var n=!1;this.each(function(){var r=-1;if(this.grid&&(isNaN(t)?a(this.p.colModel).each(function(e){if(this.name===t)return r=e,!1}):r=parseInt(t,10),0<=r)){var i=this.rows.namedItem(e);if(i)try{n=a.unformat(a("td:eq("+r+")",i),{rowId:i.id,colModel:this.p.colModel[r]},r)}catch(s){n=a.jgrid.htmlDecode(a("td:eq("+r+")",i).html())}}});return n},getCol:function(e,t,n){var r=[],i,s=0,o=0,u=0,f,t="boolean"!=typeof t?!1:t;"undefined"==typeof n&&(n=!1);this.each(function(){var h=-1;if(this.grid&&(isNaN(e)?a(this.p.colModel).each(function(t){if(this.name===e)return h=t,!1}):h=parseInt(e,10),0<=h)){var p=this.rows.length,v=0;if(p&&0<p){for(;v<p;){if(a(this.rows[v]).hasClass("jqgrow")){try{i=a.unformat(a(this.rows[v].cells[h]),{rowId:this.rows[v].id,colModel:this.p.colModel[h]},h)}catch(m){i=a.jgrid.htmlDecode(this.rows[v].cells[h].innerHTML)}n?(f=parseFloat(i),s+=f,o=Math.min(o,f),u=Math.max(o,f)):t?r.push({id:this.rows[v].id,value:i}):r.push(i)}v++}if(n)switch(n.toLowerCase()){case"sum":r=s;break;case"avg":r=s/p;break;case"count":r=p;break;case"min":r=o;break;case"max":r=u}}}});return r},clearGridData:function(e){return this.each(function(){if(this.grid){"boolean"!=typeof e&&(e=!1);if(this.p.deepempty)a("#"+a.jgrid.jqID(this.p.id)+" tbody:first tr:gt(0)").remove();else{var t=a("#"+a.jgrid.jqID(this.p.id)+" tbody:first tr:first")[0];a("#"+a.jgrid.jqID(this.p.id)+" tbody:first").empty().append(t)}this.p.footerrow&&e&&a(".ui-jqgrid-ftable td",this.grid.sDiv).html("&#160;");this.p.selrow=null;this.p.selarrrow=[];this.p.savedRow=[];this.p.records=0;this.p.page=1;this.p.lastpage=0;this.p.reccount=0;this.p.data=[];this.p_index={};this.updatepager(!0,!1)}})},getInd:function(e,t){var n=!1,r;this.each(function(){if(r=this.rows.namedItem(e))n=!0===t?r:r.rowIndex});return n},bindKeys:function(e){var t=a.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:!0},e||{});return this.each(function(){var e=this;a("body").is("[role]")||a("body").attr("role","application");e.p.scrollrows=t.scrollingRows;a(e).keydown(function(n){var r=a(e).find("tr[tabindex=0]")[0],i,s,o,u=e.p.treeReader.expanded_field;if(r){o=e.p._index[r.id];if(37===n.keyCode||38===n.keyCode||39===n.keyCode||40===n.keyCode){if(38===n.keyCode){s=r.previousSibling;i="";if(s)if(a(s).is(":hidden")){for(;s;)if(s=s.previousSibling,!a(s).is(":hidden")&&a(s).hasClass("jqgrow")){i=s.id;break}}else i=s.id;a(e).jqGrid("setSelection",i)}if(40===n.keyCode){s=r.nextSibling;i="";if(s)if(a(s).is(":hidden")){for(;s;)if(s=s.nextSibling,!a(s).is(":hidden")&&a(s).hasClass("jqgrow")){i=s.id;break}}else i=s.id;a(e).jqGrid("setSelection",i)}37===n.keyCode&&(e.p.treeGrid&&e.p.data[o][u]&&a(r).find("div.treeclick").trigger("click"),a.isFunction(t.onLeftKey)&&t.onLeftKey.call(e,e.p.selrow));39===n.keyCode&&(e.p.treeGrid&&!e.p.data[o][u]&&a(r).find("div.treeclick").trigger("click"),a.isFunction(t.onRightKey)&&t.onRightKey.call(e,e.p.selrow));return!1}if(13===n.keyCode)return a.isFunction(t.onEnter)&&t.onEnter.call(e,e.p.selrow),!1;if(32===n.keyCode)return a.isFunction(t.onSpace)&&t.onSpace.call(e,e.p.selrow),!1}})})},unbindKeys:function(){return this.each(function(){a(this).unbind("keydown")})},getLocalRow:function(e){var t=!1,n;this.each(function(){"undefined"!=typeof e&&(n=this.p._index[e],0<=n&&(t=this.p.data[n]))});return t}})})(k);(function(e){e.fmatter={};e.extend(e.fmatter,{isBoolean:function(e){return"boolean"==typeof e},isObject:function(t){return t&&("object"==typeof t||e.isFunction(t))||!1},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isNull:function(e){return null===e},isUndefined:function(e){return"undefined"==typeof e},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isEmpty:function(t){if(!this.isString(t)&&this.isValue(t))return!1;if(!this.isValue(t))return!0;t=e.trim(t).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return""===t}});e.fn.fmatter=function(t,n,r,i,s){var o=n,r=e.extend({},e.jgrid.formatter,r);e.fn.fmatter[t]&&(o=e.fn.fmatter[t](n,r,i,s));return o};e.fmatter.util={NumberFormat:function(t,n){e.fmatter.isNumber(t)||(t*=1);if(e.fmatter.isNumber(t)){var r=0>t,i=t+"",s=n.decimalSeparator?n.decimalSeparator:".",o;if(e.fmatter.isNumber(n.decimalPlaces)){var u=n.decimalPlaces,i=Math.pow(10,u),i=Math.round(t*i)/i+"";o=i.lastIndexOf(".");if(0<u){0>o?(i+=s,o=i.length-1):"."!==s&&(i=i.replace(".",s));for(;i.length-1-o<u;)i+="0"}}if(n.thousandsSeparator){u=n.thousandsSeparator;o=i.lastIndexOf(s);o=-1<o?o:i.length;for(var s=i.substring(o),f=-1,l=o;0<l;l--){f++;0===f%3&&l!==o&&(!r||1<l)&&(s=u+s);s=i.charAt(l-1)+s}i=s}i=n.prefix?n.prefix+i:i;return n.suffix?i+n.suffix:i}return t},DateFormat:function(t,n,r,i){var s=/^\/Date\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\)\/$/,o="string"==typeof n?n.match(s):null,s=function(e,t){e=""+e;for(t=parseInt(t,10)||2;e.length<t;)e="0"+e;return e},u={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},f=0,l,c=["i18n"];c.i18n={dayNames:i.dayNames,monthNames:i.monthNames};t in i.masks&&(t=i.masks[t]);if(n.constructor===Number)"u"==(""+t).toLowerCase()&&(n*=1e3),f=new Date(n);else if(n.constructor===Date)f=n;else if(null!==o)f=new Date(parseInt(o[1],10)),o[3]&&(t=60*Number(o[5])+Number(o[6]),t*="-"==o[4]?1:-1,t-=f.getTimezoneOffset(),f.setTime(Number(Number(f)+6e4*t)));else{n=(""+n).split(/[\\\/:_;.,\t\T\s-]/);t=t.split(/[\\\/:_;.,\t\T\s-]/);o=0;for(l=t.length;o<l;o++)"M"==t[o]&&(f=e.inArray(n[o],c.i18n.monthNames),-1!==f&&12>f&&(n[o]=f+1)),"F"==t[o]&&(f=e.inArray(n[o],c.i18n.monthNames),-1!==f&&11<f&&(n[o]=f+1-12)),n[o]&&(u[t[o].toLowerCase()]=parseInt(n[o],10));u.f&&(u.m=u.f);if(0===u.m&&0===u.y&&0===u.d)return"&#160;";u.m=parseInt(u.m,10)-1;f=u.y;70<=f&&99>=f?u.y=1900+u.y:0<=f&&69>=f&&(u.y=2e3+u.y);f=new Date(u.y,u.m,u.d,u.h,u.i,u.s,u.u)}r in i.masks?r=i.masks[r]:r||(r="Y-m-d");t=f.getHours();n=f.getMinutes();u=f.getDate();o=f.getMonth()+1;l=f.getTimezoneOffset();var h=f.getSeconds(),p=f.getMilliseconds(),d=f.getDay(),v=f.getFullYear(),m=(d+6)%7+1,g=(new Date(v,o-1,u)-new Date(v,0,1))/864e5,y={d:s(u),D:c.i18n.dayNames[d],j:u,l:c.i18n.dayNames[d+7],N:m,S:i.S(u),w:d,z:g,W:5>m?Math.floor((g+m-1)/7)+1:Math.floor((g+m-1)/7)||(4>((new Date(v-1,0,1)).getDay()+6)%7?53:52),F:c.i18n.monthNames[o-1+12],m:s(o),M:c.i18n.monthNames[o-1],n:o,t:"?",L:"?",o:"?",Y:v,y:(""+v).substring(2),a:12>t?i.AmPm[0]:i.AmPm[1],A:12>t?i.AmPm[2]:i.AmPm[3],B:"?",g:t%12||12,G:t,h:s(t%12||12),H:s(t),i:s(n),s:s(h),u:p,e:"?",I:"?",O:(0<l?"-":"+")+s(100*Math.floor(Math.abs(l)/60)+Math.abs(l)%60,4),P:"?",T:((""+f).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),Z:"?",c:"?",r:"?",U:Math.floor(f/1e3)};return r.replace(/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,function(e){return e in y?y[e]:e.substring(1)})}};e.fn.fmatter.defaultFormat=function(t,n){return e.fmatter.isValue(t)&&""!==t?t:n.defaultValue?n.defaultValue:"&#160;"};e.fn.fmatter.email=function(t,n){return e.fmatter.isEmpty(t)?e.fn.fmatter.defaultFormat(t,n):'<a href="mailto:'+t+'">'+t+"</a>"};e.fn.fmatter.checkbox=function(t,n){var r=e.extend({},n.checkbox),i;e.fmatter.isUndefined(n.colModel.formatoptions)||(r=e.extend({},r,n.colModel.formatoptions));i=!0===r.disabled?'disabled="disabled"':"";if(e.fmatter.isEmpty(t)||e.fmatter.isUndefined(t))t=e.fn.fmatter.defaultFormat(t,r);t=(t+"").toLowerCase();return'<input type="checkbox" '+(0>t.search(/(false|0|no|off)/i)?" checked='checked' ":"")+' value="'+t+'" offval="no" '+i+"/>"};e.fn.fmatter.link=function(t,n){var r={target:n.target},i="";e.fmatter.isUndefined(n.colModel.formatoptions)||(r=e.extend({},r,n.colModel.formatoptions));r.target&&(i="target="+r.target);return e.fmatter.isEmpty(t)?e.fn.fmatter.defaultFormat(t,n):"<a "+i+' href="'+t+'">'+t+"</a>"};e.fn.fmatter.showlink=function(t,n){var r={baseLinkUrl:n.baseLinkUrl,showAction:n.showAction,addParam:n.addParam||"",target:n.target,idName:n.idName},i="";e.fmatter.isUndefined(n.colModel.formatoptions)||(r=e.extend({},r,n.colModel.formatoptions));r.target&&(i="target="+r.target);r=r.baseLinkUrl+r.showAction+"?"+r.idName+"="+n.rowId+r.addParam;return e.fmatter.isString(t)||e.fmatter.isNumber(t)?"<a "+i+' href="'+r+'">'+t+"</a>":e.fn.fmatter.defaultFormat(t,n)};e.fn.fmatter.integer=function(t,n){var r=e.extend({},n.integer);e.fmatter.isUndefined(n.colModel.formatoptions)||(r=e.extend({},r,n.colModel.formatoptions));return e.fmatter.isEmpty(t)?r.defaultValue:e.fmatter.util.NumberFormat(t,r)};e.fn.fmatter.number=function(t,n){var r=e.extend({},n.number);e.fmatter.isUndefined(n.colModel.formatoptions)||(r=e.extend({},r,n.colModel.formatoptions));return e.fmatter.isEmpty(t)?r.defaultValue:e.fmatter.util.NumberFormat(t,r)};e.fn.fmatter.currency=function(t,n){var r=e.extend({},n.currency);e.fmatter.isUndefined(n.colModel.formatoptions)||(r=e.extend({},r,n.colModel.formatoptions));return e.fmatter.isEmpty(t)?r.defaultValue:e.fmatter.util.NumberFormat(t,r)};e.fn.fmatter.date=function(t,n,r,i){r=e.extend({},n.date);e.fmatter.isUndefined(n.colModel.formatoptions)||(r=e.extend({},r,n.colModel.formatoptions));return!r.reformatAfterEdit&&"edit"==i?e.fn.fmatter.defaultFormat(t,n):e.fmatter.isEmpty(t)?e.fn.fmatter.defaultFormat(t,n):e.fmatter.util.DateFormat(r.srcformat,t,r.newformat,r)};e.fn.fmatter.select=function(t,n){var t=t+"",r=!1,i=[];e.fmatter.isUndefined(n.colModel.formatoptions)?e.fmatter.isUndefined(n.colModel.editoptions)||(r=n.colModel.editoptions.value):r=n.colModel.formatoptions.value;if(r){var s=!0===n.colModel.editoptions.multiple?!0:!1,o=[],u;s&&(o=t.split(","),o=e.map(o,function(t){return e.trim(t)}));if(e.fmatter.isString(r)){for(var f=r.split(";"),l=0,c=0;c<f.length;c++)if(u=f[c].split(":"),2<u.length&&(u[1]=k.map(u,function(e,t){if(t>0)return e}).join(":")),s)-1<k.inArray(u[0],o)&&(i[l]=u[1],l++);else if(e.trim(u[0])==e.trim(t)){i[0]=u[1];break}}else e.fmatter.isObject(r)&&(s?i=k.map(o,function(e){return r[e]}):i[0]=r[t]||"")}t=i.join(", ");return""===t?e.fn.fmatter.defaultFormat(t,n):t};e.fn.fmatter.rowactions=function(t,n,r,i){var s={keys:!1,editbutton:!0,delbutton:!0,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{}},i=e("#"+n)[0].p.colModel[i];e.fmatter.isUndefined(i.formatoptions)||(s=e.extend(s,i.formatoptions));var i=function(r){s.afterSave&&s.afterSave(r);e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).show();e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).hide()},o=function(r){s.afterRestore&&s.afterRestore(r);e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).show();e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).hide()};switch(r){case"edit":e("#"+n).jqGrid("editRow",t,s.keys,s.onEdit,s.onSuccess,s.url,s.extraparam,i,s.onError,o);e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).hide();e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).show();break;case"save":e("#"+n).jqGrid("saveRow",t,s.onSuccess,s.url,s.extraparam,i,s.onError,o)&&(e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).show(),e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).hide());break;case"cancel":e("#"+n).jqGrid("restoreRow",t,o);e("tr#"+t+" div.ui-inline-edit, tr#"+t+" div.ui-inline-del","#"+n).show();e("tr#"+t+" div.ui-inline-save, tr#"+t+" div.ui-inline-cancel","#"+n).hide();break;case"del":e("#"+n).jqGrid("delGridRow",t,s.delOptions)}};e.fn.fmatter.actions=function(t,n){var r={keys:!1,editbutton:!0,delbutton:!0};e.fmatter.isUndefined(n.colModel.formatoptions)||(r=e.extend(r,n.colModel.formatoptions));var i=n.rowId,s="",o;if("undefined"==typeof i||e.fmatter.isEmpty(i))return"";r.editbutton&&(o="onclick=$.fn.fmatter.rowactions('"+i+"','"+n.gid+"','edit',"+n.pos+");",s=s+"<div style='margin-left:8px;'><div title='"+e.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+o+"><span class='ui-icon ui-icon-pencil'></span></div>");r.delbutton&&(o="onclick=$.fn.fmatter.rowactions('"+i+"','"+n.gid+"','del',"+n.pos+");",s=s+"<div title='"+e.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+o+"><span class='ui-icon ui-icon-trash'></span></div>");o="onclick=$.fn.fmatter.rowactions('"+i+"','"+n.gid+"','save',"+n.pos+");";s=s+"<div title='"+e.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon ui-icon-disk' "+o+"></span></div>";o="onclick=$.fn.fmatter.rowactions('"+i+"','"+n.gid+"','cancel',"+n.pos+");";return s+"<div title='"+e.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon ui-icon-cancel' "+o+"></span></div></div>"};e.unformat=function(t,n,r,i){var s,o=n.colModel.formatter,u=n.colModel.formatoptions||{},f=/([\.\*\_\'\(\)\{\}\+\?\\])/g,l=n.colModel.unformat||e.fn.fmatter[o]&&e.fn.fmatter[o].unformat;if("undefined"!=typeof l&&e.isFunction(l))s=l(e(t).text(),n,t);else if(!e.fmatter.isUndefined(o)&&e.fmatter.isString(o))switch(s=e.jgrid.formatter||{},o){case"integer":u=e.extend({},s.integer,u);n=u.thousandsSeparator.replace(f,"\\$1");s=e(t).text().replace(RegExp(n,"g"),"");break;case"number":u=e.extend({},s.number,u);n=u.thousandsSeparator.replace(f,"\\$1");s=e(t).text().replace(RegExp(n,"g"),"").replace(u.decimalSeparator,".");break;case"currency":u=e.extend({},s.currency,u);n=u.thousandsSeparator.replace(f,"\\$1");s=e(t).text().replace(RegExp(n,"g"),"").replace(u.decimalSeparator,".").replace(u.prefix,"").replace(u.suffix,"");break;case"checkbox":u=n.colModel.editoptions?n.colModel.editoptions.value.split(":"):["Yes","No"];s=e("input",t).attr("checked")?u[0]:u[1];break;case"select":s=e.unformat.select(t,n,r,i);break;case"actions":return"";default:s=e(t).text()}return s?s:!0===i?e(t).text():e.jgrid.htmlDecode(e(t).html())};e.unformat.select=function(t,n,r,i){r=[];t=e(t).text();if(!0===i)return t;n=e.extend({},n.colModel.editoptions);if(n.value){var s=n.value,n=!0===n.multiple?!0:!1,i=[],o;n&&(i=t.split(","),i=e.map(i,function(t){return e.trim(t)}));if(e.fmatter.isString(s)){for(var u=s.split(";"),f=0,l=0;l<u.length;l++)if(o=u[l].split(":"),2<o.length&&(o[1]=k.map(o,function(e,t){if(t>0)return e}).join(":")),n)-1<k.inArray(o[1],i)&&(r[f]=o[0],f++);else if(e.trim(o[1])==e.trim(t)){r[0]=o[0];break}}else if(e.fmatter.isObject(s)||e.isArray(s))n||(i[0]=t),r=k.map(i,function(t){var n;e.each(s,function(e,r){if(r==t){n=e;return!1}});if(typeof n!="undefined")return n});return r.join(", ")}return t||""};e.unformat.date=function(t,n){var r=e.jgrid.formatter.date||{};e.fmatter.isUndefined(n.formatoptions)||(r=e.extend({},r,n.formatoptions));return e.fmatter.isEmpty(t)?e.fn.fmatter.defaultFormat(t,n):e.fmatter.util.DateFormat(r.newformat,t,r.srcformat,r)}})(k);(function(e){e.jgrid.extend({getColProp:function(e){var t={},n=this[0];if(!n.grid)return!1;for(var n=n.p.colModel,r=0;r<n.length;r++)if(n[r].name==e){t=n[r];break}return t},setColProp:function(t,n){return this.each(function(){if(this.grid&&n)for(var r=this.p.colModel,i=0;i<r.length;i++)if(r[i].name==t){e.extend(this.p.colModel[i],n);break}})},sortGrid:function(e,t,n){return this.each(function(){var r=-1;if(this.grid){e||(e=this.p.sortname);for(var i=0;i<this.p.colModel.length;i++)if(this.p.colModel[i].index==e||this.p.colModel[i].name==e){r=i;break}-1!=r&&(i=this.p.colModel[r].sortable,"boolean"!=typeof i&&(i=!0),"boolean"!=typeof t&&(t=!1),i&&this.sortData("jqgh_"+e,r,t,n))}})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&e(this.p.pager).remove();var t=this.id;try{e("#gbox_"+t).remove()}catch(n){}}})},GridUnload:function(){return this.each(function(){if(this.grid){var t={id:e(this).attr("id"),cl:e(this).attr("class")};this.p.pager&&e(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom");var n=document.createElement("table");e(n).attr({id:t.id});n.className=t.cl;t=this.id;e(n).removeClass("ui-jqgrid-btable");1===e(this.p.pager).parents("#gbox_"+t).length?(e(n).insertBefore("#gbox_"+t).show(),e(this.p.pager).insertBefore("#gbox_"+t)):e(n).insertBefore("#gbox_"+t).show();e("#gbox_"+t).remove()}})},setGridState:function(t){return this.each(function(){this.grid&&("hidden"==t?(e(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+this.p.id).slideUp("fast"),this.p.pager&&e(this.p.pager).slideUp("fast"),this.p.toppager&&e(this.p.toppager).slideUp("fast"),!0===this.p.toolbar[0]&&("both"==this.p.toolbar[1]&&e(this.grid.ubDiv).slideUp("fast"),e(this.grid.uDiv).slideUp("fast")),this.p.footerrow&&e(".ui-jqgrid-sdiv","#gbox_"+this.p.id).slideUp("fast"),e(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),this.p.gridstate="hidden"):"visible"==t&&(e(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+this.p.id).slideDown("fast"),this.p.pager&&e(this.p.pager).slideDown("fast"),this.p.toppager&&e(this.p.toppager).slideDown("fast"),!0===this.p.toolbar[0]&&("both"==this.p.toolbar[1]&&e(this.grid.ubDiv).slideDown("fast"),e(this.grid.uDiv).slideDown("fast")),this.p.footerrow&&e(".ui-jqgrid-sdiv","#gbox_"+this.p.id).slideDown("fast"),e(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),this.p.gridstate="visible"))})},filterToolbar:function(t){t=e.extend({autosearch:!0,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw"},t||{});return this.each(function(){function n(t,n){var r=e(t);r[0]&&k.each(n,function(){void 0!==this.data?r.bind(this.type,this.data,this.fn):r.bind(this.type,this.fn)})}var r=this;if(!this.ftoolbar){var i=function(){var n={},i=0,s,o,u={},f;e.each(r.p.colModel,function(){o=this.index||this.name;switch(this.stype){case"select":f=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"eq";if(s=e("#gs_"+e.jgrid.jqID(o),r.grid.hDiv).val())n[o]=s,u[o]=f,i++;else try{delete r.p.postData[o]}catch(l){}break;case"text":if(f=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:t.defaultSearch,s=e("#gs_"+e.jgrid.jqID(o),r.grid.hDiv).val())n[o]=s,u[o]=f,i++;else try{delete r.p.postData[o]}catch(c){}}});var l=0<i?!0:!1;if(!0===t.stringResult||"local"==r.p.datatype){var c='{"groupOp":"'+t.groupOp+'","rules":[',h=0;e.each(n,function(e,t){0<h&&(c+=",");c+='{"field":"'+e+'",';c+='"op":"'+u[e]+'",';c+='"data":"'+(t+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';h++});c+="]}";e.extend(r.p.postData,{filters:c});e.each(["searchField","searchString","searchOper"],function(e,t){r.p.postData.hasOwnProperty(t)&&delete r.p.postData[t]})}else e.extend(r.p.postData,n);var p;r.p.searchurl&&(p=r.p.url,e(r).jqGrid("setGridParam",{url:r.p.searchurl}));var d=!1;e.isFunction(t.beforeSearch)&&(d=t.beforeSearch.call(r));d||e(r).jqGrid("setGridParam",{search:l}).trigger("reloadGrid",[{page:1}]);p&&e(r).jqGrid("setGridParam",{url:p});e.isFunction(t.afterSearch)&&t.afterSearch()},s=e("<tr class='ui-search-toolbar' role='rowheader'></tr>"),o;e.each(r.p.colModel,function(){var u=this,h,p,d,v;p=e("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+r.p.direction+"'></th>");h=e("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");!0===this.hidden&&e(p).css("display","none");this.search=!1===this.search?!1:!0;"undefined"==typeof this.stype&&(this.stype="text");d=e.extend({},this.searchoptions||{});if(this.search)switch(this.stype){case"select":if(v=this.surl||d.dataUrl)e.ajax(e.extend({url:v,dataType:"html",complete:function(r){d.buildSelect!==void 0?(r=d.buildSelect(r))&&e(h).append(r):e(h).append(r.responseText);d.defaultValue&&e("select",h).val(d.defaultValue);e("select",h).attr({name:u.index||u.name,id:"gs_"+u.name});d.attr&&e("select",h).attr(d.attr);e("select",h).css({width:"100%"});d.dataInit!==void 0&&d.dataInit(e("select",h)[0]);d.dataEvents!==void 0&&n(e("select",h)[0],d.dataEvents);t.autosearch===!0&&e("select",h).change(function(){i();return!1});r=null}},e.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}));else{var m;u.searchoptions&&u.searchoptions.value?m=u.searchoptions.value:u.editoptions&&u.editoptions.value&&(m=u.editoptions.value);if(m){v=document.createElement("select");v.style.width="100%";e(v).attr({name:u.index||u.name,id:"gs_"+u.name});var y,w;if("string"==typeof m){m=m.split(";");for(var E=0;E<m.length;E++)y=m[E].split(":"),w=document.createElement("option"),w.value=y[0],w.innerHTML=y[1],v.appendChild(w)}else if("object"==typeof m)for(y in m)m.hasOwnProperty(y)&&(w=document.createElement("option"),w.value=y,w.innerHTML=m[y],v.appendChild(w));d.defaultValue&&e(v).val(d.defaultValue);d.attr&&e(v).attr(d.attr);void 0!==d.dataInit&&d.dataInit(v);void 0!==d.dataEvents&&n(v,d.dataEvents);e(h).append(v);!0===t.autosearch&&e(v).change(function(){i();return!1})}}break;case"text":v=d.defaultValue?d.defaultValue:"",e(h).append("<input type='text' style='width:95%;padding:0px;' name='"+(u.index||u.name)+"' id='gs_"+u.name+"' value='"+v+"'/>"),d.attr&&e("input",h).attr(d.attr),void 0!==d.dataInit&&d.dataInit(e("input",h)[0]),void 0!==d.dataEvents&&n(e("input",h)[0],d.dataEvents),!0===t.autosearch&&(t.searchOnEnter?e("input",h).keypress(function(e){if((e.charCode?e.charCode:e.keyCode?e.keyCode:0)==13){i();return!1}return this}):e("input",h).keydown(function(e){switch(e.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:o&&clearTimeout(o);o=setTimeout(function(){i()},500)}}))}e(p).append(h);e(s).append(p)});e("table thead",r.grid.hDiv).append(s);this.ftoolbar=!0;this.triggerToolbar=i;this.clearToolbar=function(n){var i={},s,o=0,u,n="boolean"!=typeof n?!0:n;e.each(r.p.colModel,function(){s=this.searchoptions&&this.searchoptions.defaultValue?this.searchoptions.defaultValue:"";u=this.index||this.name;switch(this.stype){case"select":var t;e("#gs_"+e.jgrid.jqID(u)+" option",r.grid.hDiv).each(function(n){0===n&&(this.selected=!0);if(e(this).text()==s)return this.selected=!0,t=e(this).val(),!1});if(t)i[u]=t,o++;else try{delete r.p.postData[u]}catch(n){}break;case"text":if(e("#gs_"+
e.jgrid.jqID(u),r.grid.hDiv).val(s),s)i[u]=s,o++;else try{delete r.p.postData[u]}catch(f){}}});var f=0<o?!0:!1;if(!0===t.stringResult||"local"==r.p.datatype){var l='{"groupOp":"'+t.groupOp+'","rules":[',c=0;e.each(i,function(e,t){0<c&&(l+=",");l+='{"field":"'+e+'",';l+='"op":"eq",';l+='"data":"'+(t+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';c++});l+="]}";e.extend(r.p.postData,{filters:l});e.each(["searchField","searchString","searchOper"],function(e,t){r.p.postData.hasOwnProperty(t)&&delete r.p.postData[t]})}else e.extend(r.p.postData,i);var h;r.p.searchurl&&(h=r.p.url,e(r).jqGrid("setGridParam",{url:r.p.searchurl}));var p=!1;e.isFunction(t.beforeClear)&&(p=t.beforeClear.call(r));p||n&&e(r).jqGrid("setGridParam",{search:f}).trigger("reloadGrid",[{page:1}]);h&&e(r).jqGrid("setGridParam",{url:h});e.isFunction(t.afterClear)&&t.afterClear()};this.toggleToolbar=function(){var t=e("tr.ui-search-toolbar",r.grid.hDiv);"none"==t.css("display")?t.show():t.hide()}}})}})})(k);(function(e){e.extend(e.jgrid,{showModal:function(e){e.w.show()},closeModal:function(e){e.w.hide().attr("aria-hidden","true");e.o&&e.o.remove()},hideModal:function(t,n){n=e.extend({jqm:!0,gb:""},n||{});if(n.onClose){var r=n.onClose(t);if("boolean"==typeof r&&!r)return}if(e.fn.jqm&&!0===n.jqm)e(t).attr("aria-hidden","true").jqmHide();else{if(""!==n.gb)try{e(".jqgrid-overlay:first",n.gb).hide()}catch(i){}e(t).hide().attr("aria-hidden","true")}},findPos:function(e){var t=0,n=0;if(e.offsetParent)do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return[t,n]},createModal:function(t,n,r,i,s,o,u){var f=document.createElement("div"),l,c=this,u=e.extend({},u||{});l="rtl"==e(r.gbox).attr("dir")?!0:!1;f.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";f.id=t.themodal;var h=document.createElement("div");h.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";h.id=t.modalhead;e(h).append("<span class='ui-jqdialog-title'>"+r.caption+"</span>");var p=e("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){p.addClass("ui-state-hover")},function(){p.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");e(h).append(p);l?(f.dir="rtl",e(".ui-jqdialog-title",h).css("float","right"),e(".ui-jqdialog-titlebar-close",h).css("left","0.3em")):(f.dir="ltr",e(".ui-jqdialog-title",h).css("float","left"),e(".ui-jqdialog-titlebar-close",h).css("right","0.3em"));var d=document.createElement("div");e(d).addClass("ui-jqdialog-content ui-widget-content").attr("id",t.modalcontent);e(d).append(n);f.appendChild(d);e(f).prepend(h);!0===o?e("body").append(f):"string"==typeof o?e(o).append(f):e(f).insertBefore(i);e(f).css(u);"undefined"==typeof r.jqModal&&(r.jqModal=!0);n={};if(e.fn.jqm&&!0===r.jqModal)0===r.left&&0===r.top&&r.overlay&&(u=[],u=this.findPos(s),r.left=u[0]+4,r.top=u[1]+4),n.top=r.top+"px",n.left=r.left;else if(0!==r.left||0!==r.top)n.left=r.left,n.top=r.top+"px";e("a.ui-jqdialog-titlebar-close",h).click(function(){var n=e("#"+t.themodal).data("onClose")||r.onClose,i=e("#"+t.themodal).data("gbox")||r.gbox;c.hideModal("#"+t.themodal,{gb:i,jqm:r.jqModal,onClose:n});return!1});if(0===r.width||!r.width)r.width=300;if(0===r.height||!r.height)r.height=200;r.zIndex||(i=e(i).parents("*[role=dialog]").filter(":first").css("z-index"),r.zIndex=i?parseInt(i,10)+1:950);i=0;l&&n.left&&!o&&(i=e(r.gbox).width()-(isNaN(r.width)?0:parseInt(r.width,10))-8,n.left=parseInt(n.left,10)+parseInt(i,10));n.left&&(n.left+="px");e(f).css(e.extend({width:isNaN(r.width)?"auto":r.width+"px",height:isNaN(r.height)?"auto":r.height+"px",zIndex:r.zIndex,overflow:"hidden"},n)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":t.modalhead,"aria-hidden":"true"});"undefined"==typeof r.drag&&(r.drag=!0);"undefined"==typeof r.resize&&(r.resize=!0);if(r.drag)if(e(h).css("cursor","move"),e.fn.jqDrag)e(f).jqDrag(h);else try{e(f).draggable({handle:e("#"+h.id)})}catch(v){}if(r.resize)if(e.fn.jqResize)e(f).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>"),e("#"+t.themodal).jqResize(".jqResize",t.scrollelm?"#"+t.scrollelm:!1);else try{e(f).resizable({handles:"se, sw",alsoResize:t.scrollelm?"#"+t.scrollelm:!1})}catch(m){}!0===r.closeOnEscape&&e(f).keydown(function(n){if(n.which==27){n=e("#"+t.themodal).data("onClose")||r.onClose;c.hideModal(this,{gb:r.gbox,jqm:r.jqModal,onClose:n})}})},viewModal:function(t,n){n=e.extend({toTop:!0,overlay:10,modal:!1,onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:!0,jqM:!0},n||{});if(e.fn.jqm&&!0===n.jqm)n.jqM?e(t).attr("aria-hidden","false").jqm(n).jqmShow():e(t).attr("aria-hidden","false").jqmShow();else{""!==n.gbox&&(e(".jqgrid-overlay:first",n.gbox).show(),e(t).data("gbox",n.gbox));e(t).show().attr("aria-hidden","false");try{e(":input:visible",t)[0].focus()}catch(r){}}},info_dialog:function(t,n,r,i){var s={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,caption:"<b>"+t+"</b>",left:250,top:170,zIndex:1e3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]};e.extend(s,i||{});var o=s.jqModal,u=this;e.fn.jqm&&!o&&(o=!1);t="";if(0<s.buttons.length)for(i=0;i<s.buttons.length;i++)"undefined"==typeof s.buttons[i].id&&(s.buttons[i].id="info_button_"+i),t+="<a href='javascript:void(0)' id='"+s.buttons[i].id+"' class='fm-button ui-state-default ui-corner-all'>"+s.buttons[i].text+"</a>";i=isNaN(s.dataheight)?s.dataheight:s.dataheight+"px";n="<div id='info_id'>"+("<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+i+";"+("text-align:"+s.align+";")+"'>"+n+"</div>");n+=r?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+s.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+r+"</a>"+t+"</div>":""!==t?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+s.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+t+"</div>":"";n+="</div>";try{"false"==e("#info_dialog").attr("aria-hidden")&&this.hideModal("#info_dialog",{jqm:o}),e("#info_dialog").remove()}catch(f){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},n,s,"","",!0);t&&e.each(s.buttons,function(t){e("#"+this.id,"#info_id").bind("click",function(){s.buttons[t].onClick.call(e("#info_dialog"));return!1})});e("#closedialog","#info_id").click(function(){u.hideModal("#info_dialog",{jqm:o});return!1});e(".fm-button","#info_dialog").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});e.isFunction(s.beforeOpen)&&s.beforeOpen();this.viewModal("#info_dialog",{onHide:function(e){e.w.hide().remove();e.o&&e.o.remove()},modal:s.modal,jqm:o});e.isFunction(s.afterOpen)&&s.afterOpen();try{e("#info_dialog").focus()}catch(l){}},createEl:function(t,n,r,i,s){function o(t,n){e.isFunction(n.dataInit)&&n.dataInit(t);n.dataEvents&&e.each(n.dataEvents,function(){void 0!==this.data?e(t).bind(this.type,this.data,this.fn):e(t).bind(this.type,this.fn)});return n}function u(t,n){var r="dataInit dataEvents dataUrl buildSelect sopt searchhidden defaultValue attr".split(" ");e.each(n,function(n,i){-1===e.inArray(n,r)&&e(t).attr(n,i)});n.hasOwnProperty("id")||e(t).attr("id",e.jgrid.randId())}var f="";switch(t){case"textarea":f=document.createElement("textarea");i?n.cols||e(f).css({width:"98%"}):n.cols||(n.cols=20);n.rows||(n.rows=2);if("&nbsp;"==r||"&#160;"==r||1==r.length&&160==r.charCodeAt(0))r="";f.value=r;u(f,n);n=o(f,n);e(f).attr({role:"textbox",multiline:"true"});break;case"checkbox":f=document.createElement("input");f.type="checkbox";n.value?(t=n.value.split(":"),r===t[0]&&(f.checked=!0,f.defaultChecked=!0),f.value=t[0],e(f).attr("offval",t[1])):(t=r.toLowerCase(),0>t.search(/(false|0|no|off|undefined)/i)&&""!==t?(f.checked=!0,f.defaultChecked=!0,f.value=r):f.value="on",e(f).attr("offval","off"));u(f,n);n=o(f,n);e(f).attr("role","checkbox");break;case"select":f=document.createElement("select");f.setAttribute("role","select");i=[];!0===n.multiple?(t=!0,f.multiple="multiple",e(f).attr("aria-multiselectable","true")):t=!1;if("undefined"!=typeof n.dataUrl)e.ajax(e.extend({url:n.dataUrl,type:"GET",dataType:"html",context:{elem:f,options:n,vl:r},success:function(t){var n=[],r=this.elem,i=this.vl,s=e.extend({},this.options),f=s.multiple===!0;typeof s.buildSelect!="undefined"&&(t=s.buildSelect(t));if(t=e(t).html()){e(r).append(t);u(r,s);s=o(r,s);typeof s.size=="undefined"&&(s.size=f?3:1);if(f){n=i.split(",");n=e.map(n,function(t){return e.trim(t)})}else n[0]=e.trim(i);setTimeout(function(){e("option",r).each(function(){e(this).attr("role","option");if(e.inArray(e.trim(e(this).text()),n)>-1||e.inArray(e.trim(e(this).val()),n)>-1)this.selected="selected"})},0)}}},s||{}));else if(n.value){var l;t?(i=r.split(","),i=e.map(i,function(t){return e.trim(t)}),"undefined"==typeof n.size&&(n.size=3)):n.size=1;"function"==typeof n.value&&(n.value=n.value());var c,h;if("string"==typeof n.value){c=n.value.split(";");for(l=0;l<c.length;l++){h=c[l].split(":");2<h.length&&(h[1]=e.map(h,function(e,t){if(t>0)return e}).join(":"));s=document.createElement("option");s.setAttribute("role","option");s.value=h[0];s.innerHTML=h[1];!t&&(e.trim(h[0])==e.trim(r)||e.trim(h[1])==e.trim(r))&&(s.selected="selected");t&&(-1<e.inArray(e.trim(h[1]),i)||-1<e.inArray(e.trim(h[0]),i))&&(s.selected="selected");f.appendChild(s)}}else if("object"==typeof n.value)for(l in c=n.value,c)if(c.hasOwnProperty(l)){s=document.createElement("option");s.setAttribute("role","option");s.value=l;s.innerHTML=c[l];!t&&(e.trim(l)==e.trim(r)||e.trim(c[l])==e.trim(r))&&(s.selected="selected");t&&(-1<e.inArray(e.trim(c[l]),i)||-1<e.inArray(e.trim(l),i))&&(s.selected="selected");f.appendChild(s)}u(f,n);n=o(f,n)}break;case"text":case"password":case"button":l="button"==t?"button":"textbox";f=document.createElement("input");f.type=t;f.value=r;u(f,n);n=o(f,n);"button"!=t&&(i?n.size||e(f).css({width:"98%"}):n.size||(n.size=20));e(f).attr("role",l);break;case"image":case"file":f=document.createElement("input");f.type=t;u(f,n);n=o(f,n);break;case"custom":f=document.createElement("span");try{if(!e.isFunction(n.custom_element))throw"e1";if(!(c=n.custom_element.call(this,r,n)))throw"e2";c=e(c).addClass("customelement").attr({id:n.id,name:n.name}),e(f).empty().append(c)}catch(p){"e1"==p&&this.info_dialog(e.jgrid.errors.errcap,"function 'custom_element' "+e.jgrid.edit.msg.nodefined,e.jgrid.edit.bClose),"e2"==p?this.info_dialog(e.jgrid.errors.errcap,"function 'custom_element' "+e.jgrid.edit.msg.novalue,e.jgrid.edit.bClose):this.info_dialog(e.jgrid.errors.errcap,"string"==typeof p?p:p.message,e.jgrid.edit.bClose)}}return f},checkDate:function(e,t){var n={},r,e=e.toLowerCase();r=-1!=e.indexOf("/")?"/":-1!=e.indexOf("-")?"-":-1!=e.indexOf(".")?".":"/";e=e.split(r);t=t.split(r);if(3!=t.length)return!1;r=-1;for(var i,s=-1,o=-1,u=0;u<e.length;u++)i=isNaN(t[u])?0:parseInt(t[u],10),n[e[u]]=i,i=e[u],-1!=i.indexOf("y")&&(r=u),-1!=i.indexOf("m")&&(o=u),-1!=i.indexOf("d")&&(s=u);i="y"==e[r]||"yyyy"==e[r]?4:"yy"==e[r]?2:-1;var u=function(e){for(var t=1;t<=e;t++){this[t]=31;if(4==t||6==t||9==t||11==t)this[t]=30;2==t&&(this[t]=29)}return this}(12),a;if(-1===r)return!1;a=n[e[r]].toString();2==i&&1==a.length&&(i=1);if(a.length!=i||0===n[e[r]]&&"00"!=t[r]||-1===o)return!1;a=n[e[o]].toString();if(1>a.length||1>n[e[o]]||12<n[e[o]]||-1===s)return!1;a=n[e[s]].toString();return 1>a.length||1>n[e[s]]||31<n[e[s]]||2==n[e[o]]&&n[e[s]]>(0!==n[e[r]]%4||0===n[e[r]]%100&&0!==n[e[r]]%400?28:29)||n[e[s]]>u[n[e[o]]]?!1:!0},isEmpty:function(e){return e.match(/^\s+$/)||""===e?!0:!1},checkTime:function(e){var t=/^(\d{1,2}):(\d{2})([ap]m)?$/;if(!this.isEmpty(e)){if(!(e=e.match(t)))return!1;if(e[3]){if(1>e[1]||12<e[1])return!1}else if(23<e[1])return!1;if(59<e[2])return!1}return!0},checkValues:function(t,n,r,i,s){var o,u;if("undefined"==typeof i)if("string"==typeof n){i=0;for(s=r.p.colModel.length;i<s;i++)if(r.p.colModel[i].name==n){o=r.p.colModel[i].editrules;n=i;try{u=r.p.colModel[i].formoptions.label}catch(f){}break}}else 0<=n&&(o=r.p.colModel[n].editrules);else o=i,u=void 0===s?"_":s;if(o){u||(u=r.p.colNames[n]);if(!0===o.required&&this.isEmpty(t))return[!1,u+": "+e.jgrid.edit.msg.required,""];i=!1===o.required?!1:!0;if(!0===o.number&&(!1!==i||!this.isEmpty(t))&&isNaN(t))return[!1,u+": "+e.jgrid.edit.msg.number,""];if("undefined"!=typeof o.minValue&&!isNaN(o.minValue)&&parseFloat(t)<parseFloat(o.minValue))return[!1,u+": "+e.jgrid.edit.msg.minValue+" "+o.minValue,""];if("undefined"!=typeof o.maxValue&&!isNaN(o.maxValue)&&parseFloat(t)>parseFloat(o.maxValue))return[!1,u+": "+e.jgrid.edit.msg.maxValue+" "+o.maxValue,""];if(!0===o.email&&(!1!==i||!this.isEmpty(t))&&(s=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,!s.test(t)))return[!1,u+": "+e.jgrid.edit.msg.email,""];if(!(!0!==o.integer||!1===i&&!!this.isEmpty(t)||!isNaN(t)&&0===t%1&&-1==t.indexOf(".")))return[!1,u+": "+e.jgrid.edit.msg.integer,""];if(!0===o.date&&(!1!==i||!this.isEmpty(t))&&(n=r.p.colModel[n].formatoptions&&r.p.colModel[n].formatoptions.newformat?r.p.colModel[n].formatoptions.newformat:r.p.colModel[n].datefmt||"Y-m-d",!this.checkDate(n,t)))return[!1,u+": "+e.jgrid.edit.msg.date+" - "+n,""];if(!0===o.time&&(!1!==i||!this.isEmpty(t))&&!this.checkTime(t))return[!1,u+": "+e.jgrid.edit.msg.date+" - hh:mm (am/pm)",""];if(!0===o.url&&(!1!==i||!this.isEmpty(t))&&(s=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,!s.test(t)))return[!1,u+": "+e.jgrid.edit.msg.url,""];if(!0===o.custom&&(!1!==i||!this.isEmpty(t)))return e.isFunction(o.custom_func)?(t=o.custom_func.call(r,t,u),e.isArray(t)?t:[!1,e.jgrid.edit.msg.customarray,""]):[!1,e.jgrid.edit.msg.customfcheck,""]}return[!0,"",""]}})})(k);(function(e){var t=null;e.jgrid.extend({searchGrid:function(t){t=e.extend({recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!1,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,toTop:!0,overlay:10,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null},e.jgrid.search,t||{});return this.each(function(){function n(){e.isFunction(t.beforeShowSearch)&&(s=t.beforeShowSearch(e("#"+i)),"undefined"==typeof s&&(s=!0));s&&(e.jgrid.viewModal("#"+o.themodal,{gbox:"#gbox_"+i,jqm:t.jqModal,modal:t.modal,overlay:t.overlay,toTop:t.toTop}),e.isFunction(t.afterShowSearch)&&t.afterShowSearch(e("#"+i)))}var r=this;if(r.grid){var i="fbox_"+r.p.id,s=!0,o={themodal:"searchmod"+i,modalhead:"searchhd"+i,modalcontent:"searchcnt"+i,scrollelm:i},u=r.p.postData[t.sFilter];"string"==typeof u&&(u=e.jgrid.parse(u));!0===t.recreateFilter&&e("#"+o.themodal).remove();if(null!==e("#"+o.themodal).html())n();else{var l=e("<span><div id='"+i+"' class='searchFilter' style='overflow:auto'></div></span>").insertBefore("#gview_"+r.p.id);e.isFunction(t.onInitializeSearch)&&t.onInitializeSearch(e("#"+i));var h=e.extend([],r.p.colModel),p="<a href='javascript:void(0)' id='"+i+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+t.Find+"</a>",d="<a href='javascript:void(0)' id='"+i+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+t.Reset+"</a>",v="",m="",g,y=!1;t.showQuery&&(v="<a href='javascript:void(0)' id='"+i+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>");t.columns.length?h=t.columns:e.each(h,function(e,t){t.label||(t.label=r.p.colNames[e]);if(!y){var n="undefined"==typeof t.search?!0:t.search,i=!0===t.hidden;if(t.searchoptions&&!0===t.searchoptions.searchhidden&&n||n&&!i)y=!0,g=t.index||t.name}});if(!u&&g||!1===t.multipleSearch)u={groupOp:"AND",rules:[{field:g,op:"eq",data:""}]};y=!1;t.tmplNames&&t.tmplNames.length&&(y=!0,m=t.tmplLabel,m+="<select class='ui-template'>",m+="<option value='default'>Default</option>",e.each(t.tmplNames,function(e,t){m+="<option value='"+e+"'>"+t+"</option>"}),m+="</select>");p="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+i+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:left'>"+d+m+"</td><td class='EditButton'>"+v+p+"</td></tr></tbody></table>";e("#"+i).jqFilter({columns:h,filter:t.loadDefaults?u:null,showQuery:t.showQuery,errorcheck:t.errorcheck,sopt:t.sopt,groupButton:t.multipleGroup,_gridsopt:e.jgrid.search.odata,onChange:function(){this.p.showQuery&&e(".query",this).html(this.toUserFriendlyString())}});l.append(p);y&&t.tmplFilters&&t.tmplFilters.length&&e(".ui-template",l).bind("change",function(){var n=e(this).val();n=="default"?e("#"+i).jqFilter("addFilter",u):e("#"+i).jqFilter("addFilter",t.tmplFilters[parseInt(n,10)]);return!1});!1===t.multipleSearch&&(e(".add-rule","#"+i).hide(),e(".delete-rule","#"+i).hide());e.isFunction(t.onInitializeSearch)&&t.onInitializeSearch(e("#"+i));t.layer?e.jgrid.createModal(o,l,t,"#gview_"+r.p.id,e("#gbox_"+r.p.id)[0],"#"+t.layer,{position:"relative"}):e.jgrid.createModal(o,l,t,"#gview_"+r.p.id,e("#gbox_"+r.p.id)[0]);v&&e("#"+i+"_query").bind("click",function(){e(".queryresult",l).toggle();return!1});void 0===t.stringResult&&(t.stringResult=t.multipleSearch);e("#"+i+"_search").bind("click",function(){var n=e("#"+i),s={},u,l=n.jqFilter("filterData");if(t.errorcheck){n[0].hideError();t.showQuery||n.jqFilter("toSQLString");if(n[0].p.error){n[0].showError();return!1}}if(t.stringResult){try{u=f.toJson(l,"","",!1)}catch(h){try{u=ka.stringify(l)}catch(p){}}if(typeof u=="string"){s[t.sFilter]=u;e.each([t.sField,t.sValue,t.sOper],function(){s[this]=""})}}else if(t.multipleSearch){s[t.sFilter]=l;e.each([t.sField,t.sValue,t.sOper],function(){s[this]=""})}else{s[t.sField]=l.rules[0].field;s[t.sValue]=l.rules[0].data;s[t.sOper]=l.rules[0].op;s[t.sFilter]=""}r.p.search=!0;e.extend(r.p.postData,s);e.isFunction(t.onSearch)&&t.onSearch();e(r).trigger("reloadGrid",[{page:1}]);t.closeAfterSearch&&e.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+r.p.id,jqm:t.jqModal,onClose:t.onClose});return!1});e("#"+i+"_reset").bind("click",function(){var n={},s=e("#"+i);r.p.search=!1;t.multipleSearch===!1?n[t.sField]=n[t.sValue]=n[t.sOper]="":n[t.sFilter]="";s[0].resetFilter();y&&e(".ui-template",l).val("default");e.extend(r.p.postData,n);e.isFunction(t.onReset)&&t.onReset();e(r).trigger("reloadGrid",[{page:1}]);return!1});n();e(".fm-button:not(.ui-state-disabled)",l).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")})}}})},editGridRow:function(n,r){t=r=e.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0},e.jgrid.edit,r||{});return this.each(function(){function s(){e(".FormElement","#"+E).each(function(){var t=e(".customelement",this);if(t.length){var n=e(t[0]).attr("name");e.each(g.p.colModel,function(){if(this.name===n&&this.editoptions&&e.isFunction(this.editoptions.custom_value)){try{if(M[n]=this.editoptions.custom_value(e("#"+e.jgrid.jqID(n),"#"+E),"get"),void 0===M[n])throw"e1"}catch(t){"e1"===t?e.jgrid.info_dialog(k.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.novalue,k.jgrid.edit.bClose):e.jgrid.info_dialog(k.jgrid.errors.errcap,t.message,k.jgrid.edit.bClose)}return!0}})}else{switch(e(this).get(0).type){case"checkbox":e(this).attr("checked")?M[this.name]=e(this).val():(t=e(this).attr("offval"),M[this.name]=t);break;case"select-one":M[this.name]=e("option:selected",this).val();_[this.name]=e("option:selected",this).text();break;case"select-multiple":M[this.name]=e(this).val();M[this.name]=M[this.name]?M[this.name].join(","):"";var r=[];e("option:selected",this).each(function(t,n){r[t]=e(n).text()});_[this.name]=r.join(",");break;case"password":case"text":case"textarea":case"button":M[this.name]=e(this).val()}g.p.autoencode&&(M[this.name]=e.jgrid.htmlEncode(M[this.name]))}});return!0}function o(n,r,i,s){var o,u,f=0,l,c,h,p=[],d=!1,v="",m;for(m=1;m<=s;m++)v+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!=n&&(d=e(r).jqGrid("getInd",n));e(r.p.colModel).each(function(m){o=this.name;c=(this.editrules&&!0===this.editrules.edithidden?0:!0===this.hidden)?"style='display:none'":"";if("cb"!==o&&"subgrid"!==o&&!0===this.editable&&"rn"!==o){if(!1===d)l="";else if(o==r.p.ExpandColumn&&!0===r.p.treeGrid)l=e("td:eq("+m+")",r.rows[d]).text();else try{l=e.unformat(e("td:eq("+m+")",r.rows[d]),{rowId:n,colModel:this},m)}catch(y){l=e("td:eq("+m+")",r.rows[d]).text()}var w=e.extend({},this.editoptions||{},{id:o,name:o}),E=e.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),S=parseInt(E.rowpos,10)||f+1,x=parseInt(2*(parseInt(E.colpos,10)||1),10);"_empty"==n&&w.defaultValue&&(l=e.isFunction(w.defaultValue)?w.defaultValue():w.defaultValue);this.edittype||(this.edittype="text");g.p.autoencode&&(l=e.jgrid.htmlDecode(l));h=e.jgrid.createEl(this.edittype,w,l,!1,e.extend({},e.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}));""===l&&"checkbox"==this.edittype&&(l=e(h).attr("offval"));""===l&&"select"==this.edittype&&(l=e("option:eq(0)",h).text());if(t.checkOnSubmit||t.checkOnUpdate)t._savedData[o]=l;e(h).addClass("FormElement");("text"==this.edittype||"textarea"==this.edittype)&&e(h).addClass("ui-widget-content ui-corner-all");u=e(i).find("tr[rowpos="+S+"]");E.rowabove&&(w=e("<tr><td class='contentinfo' colspan='"+2*s+"'>"+E.rowcontent+"</td></tr>"),e(i).append(w),w[0].rp=S);0===u.length&&(u=e("<tr "+c+" rowpos='"+S+"'></tr>").addClass("FormData").attr("id","tr_"+o),e(u).append(v),e(i).append(u),u[0].rp=S);e("td:eq("+(x-2)+")",u[0]).html("undefined"==typeof E.label?r.p.colNames[m]:E.label);e("td:eq("+(x-1)+")",u[0]).append(E.elmprefix).append(h).append(E.elmsuffix);p[f]=m;f++}});0<f&&(m=e("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*s-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+r.p.id+"_id' value='"+n+"'/></td></tr>"),m[0].rp=f+999,e(i).append(m),t.checkOnSubmit||t.checkOnUpdate)&&(t._savedData[r.p.id+"_id"]=n);return p}function u(n,r,i){var s,o=0,u,f,l,c,h;if(t.checkOnSubmit||t.checkOnUpdate)t._savedData={},t._savedData[r.p.id+"_id"]=n;var p=r.p.colModel;if("_empty"==n)e(p).each(function(){s=this.name;l=e.extend({},this.editoptions||{});(f=e("#"+e.jgrid.jqID(s),"#"+i))&&null!==f[0]&&(c="",l.defaultValue?(c=e.isFunction(l.defaultValue)?l.defaultValue():l.defaultValue,"checkbox"==f[0].type?(h=c.toLowerCase(),0>h.search(/(false|0|no|off|undefined)/i)&&""!==h?(f[0].checked=!0,f[0].defaultChecked=!0,f[0].value=c):f.attr({checked:"",defaultChecked:""})):f.val(c)):"checkbox"==f[0].type?(f[0].checked=!1,f[0].defaultChecked=!1,c=e(f).attr("offval")):f[0].type&&"select"==f[0].type.substr(0,6)?f[0].selectedIndex=0:f.val(c),!0===t.checkOnSubmit||t.checkOnUpdate)&&(t._savedData[s]=c)}),e("#id_g","#"+i).val(n);else{var d=e(r).jqGrid("getInd",n,!0);d&&(e("td",d).each(function(f){s=p[f].name;if("cb"!==s&&"subgrid"!==s&&"rn"!==s&&!0===p[f].editable){if(s==r.p.ExpandColumn&&!0===r.p.treeGrid)u=e(this).text();else try{u=e.unformat(e(this),{rowId:n,colModel:p[f]},f)}catch(l){u=e(this).text()}g.p.autoencode&&(u=e.jgrid.htmlDecode(u));if(!0===t.checkOnSubmit||t.checkOnUpdate)t._savedData[s]=u;s=e.jgrid.jqID(s);switch(p[f].edittype){case"password":case"text":case"button":case"image":e("#"+s,"#"+i).val(u);break;case"textarea":if("&nbsp;"==u||"&#160;"==u||1==u.length&&160==u.charCodeAt(0))u="";e("#"+s,"#"+i).val(u);break;case"select":var c=u.split(","),c=e.map(c,function(t){return e.trim(t)});e("#"+s+" option","#"+i).each(function(){this.selected=!!p[f].editoptions.multiple||c[0]!=e.trim(e(this).text())&&c[0]!=e.trim(e(this).val())?p[f].editoptions.multiple?-1<e.inArray(e.trim(e(this).text()),c)||-1<e.inArray(e.trim(e(this).val()),c)?!0:!1:!1:!0});break;case"checkbox":u+="";p[f].editoptions&&p[f].editoptions.value?p[f].editoptions.value.split(":")[0]==u?(e("#"+s,"#"+i).attr("checked",!0),e("#"+s,"#"+i).attr("defaultChecked",!0)):(e("#"+s,"#"+i).attr("checked",!1),e("#"+s,"#"+i).attr("defaultChecked","")):(u=u.toLowerCase(),0>u.search(/(false|0|no|off|undefined)/i)&&""!==u?(e("#"+s,"#"+i).attr("checked",!0),e("#"+s,"#"+i).attr("defaultChecked",!0)):(e("#"+s,"#"+i).attr("checked",!1),e("#"+s,"#"+i).attr("defaultChecked","")));break;case"custom":try{if(!p[f].editoptions||!e.isFunction(p[f].editoptions.custom_value))throw"e1";p[f].editoptions.custom_value(e("#"+s,"#"+i),"set",u)}catch(h){"e1"==h?e.jgrid.info_dialog(k.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.nodefined,k.jgrid.edit.bClose):e.jgrid.info_dialog(k.jgrid.errors.errcap,h.message,k.jgrid.edit.bClose)}}o++}}),0<o&&e("#id_g","#"+E).val(n))}}function f(){var n,s=[!0,"",""],o={},f=g.p.prmNames,l,c,h,p;if(e.isFunction(t.beforeCheckValues)){var d=t.beforeCheckValues(M,e("#"+w),"_empty"==M[g.p.id+"_id"]?f.addoper:f.editoper);d&&"object"==typeof d&&(M=d)}for(h in M)if(M.hasOwnProperty(h)&&(s=e.jgrid.checkValues(M[h],h,g),!1===s[0]))break;s[0]&&(e.isFunction(t.onclickSubmit)&&(o=t.onclickSubmit(t,M)||{}),e.isFunction(t.beforeSubmit)&&(s=t.beforeSubmit(M,e("#"+w))));if(s[0]&&!t.processing){t.processing=!0;e("#sData","#"+E+"_2").addClass("ui-state-active");c=f.oper;l=f.id;M[c]="_empty"==e.trim(M[g.p.id+"_id"])?f.addoper:f.editoper;M[c]!=f.addoper?M[l]=M[g.p.id+"_id"]:void 0===M[l]&&(M[l]=M[g.p.id+"_id"]);delete M[g.p.id+"_id"];M=e.extend(M,t.editData,o);if(!0===g.p.treeGrid)for(i in M[c]==f.addoper&&(p=e(g).jqGrid("getGridParam","selrow"),M["adjacency"==g.p.treeGridModel?g.p.treeReader.parent_id_field:"parent_id"]=p),g.p.treeReader)o=g.p.treeReader[i],M.hasOwnProperty(o)&&(M[c]==f.addoper&&"parent_id_field"===i||delete M[o]);o=e.extend({url:t.url?t.url:e(g).jqGrid("getGridParam","editurl"),type:t.mtype,data:e.isFunction(t.serializeEditData)?t.serializeEditData(M):M,complete:function(i,o){if(o!="success"){s[0]=!1;s[1]=e.isFunction(t.errorTextFormat)?t.errorTextFormat(i):o+" Status: '"+i.statusText+"'. Error code: "+i.status}else e.isFunction(t.afterSubmit)&&(s=t.afterSubmit(i,M));if(s[0]===!1){e("#FormError>td","#"+E).html(s[1]);e("#FormError","#"+E).show()}else{e.each(g.p.colModel,function(){if(_[this.name]&&this.formatter&&this.formatter=="select")try{delete _[this.name]}catch(e){}});M=e.extend(M,_);g.p.autoencode&&e.each(M,function(t,n){M[t]=e.jgrid.htmlDecode(n)});t.reloadAfterSubmit=t.reloadAfterSubmit&&g.p.datatype!="local";if(M[c]==f.addoper){s[2]||(s[2]=e.jgrid.randId());M[l]=s[2];if(t.closeAfterAdd){if(t.reloadAfterSubmit)e(g).trigger("reloadGrid");else if(g.p.treeGrid===!0)e(g).jqGrid("addChildNode",s[2],p,M);else{e(g).jqGrid("addRowData",s[2],M,r.addedrow);e(g).jqGrid("setSelection",s[2])}e.jgrid.hideModal("#"+S.themodal,{gb:"#gbox_"+y,jqm:r.jqModal,onClose:t.onClose})}else if(t.clearAfterAdd){t.reloadAfterSubmit?e(g).trigger("reloadGrid"):g.p.treeGrid===!0?e(g).jqGrid("addChildNode",s[2],p,M):e(g).jqGrid("addRowData",s[2],M,r.addedrow);u("_empty",g,w)}else t.reloadAfterSubmit?e(g).trigger("reloadGrid"):g.p.treeGrid===!0?e(g).jqGrid("addChildNode",s[2],p,M):e(g).jqGrid("addRowData",s[2],M,r.addedrow)}else{if(t.reloadAfterSubmit){e(g).trigger("reloadGrid");t.closeAfterEdit||setTimeout(function(){e(g).jqGrid("setSelection",M[l])},1e3)}else g.p.treeGrid===!0?e(g).jqGrid("setTreeRow",M[l],M):e(g).jqGrid("setRowData",M[l],M);t.closeAfterEdit&&e.jgrid.hideModal("#"+S.themodal,{gb:"#gbox_"+y,jqm:r.jqModal,onClose:t.onClose})}if(e.isFunction(t.afterComplete)){n=i;setTimeout(function(){t.afterComplete(n,M,e("#"+w));n=null},500)}if(t.checkOnSubmit||t.checkOnUpdate){e("#"+w).data("disabled",!1);if(t._savedData[g.p.id+"_id"]!="_empty")for(var h in t._savedData)M[h]&&(t._savedData[h]=M[h])}}t.processing=!1;e("#sData","#"+E+"_2").removeClass("ui-state-active");try{e(":input:visible","#"+w)[0].focus()}catch(d){}}},e.jgrid.ajaxOptions,t.ajaxEditOptions);!o.url&&!t.useDataProxy&&(e.isFunction(g.p.dataProxy)?t.useDataProxy=!0:(s[0]=!1,s[1]+=" "+e.jgrid.errors.nourl));s[0]&&(t.useDataProxy?g.p.dataProxy.call(g,o,"set_"+g.p.id):e.ajax(o))}!1===s[0]&&(e("#FormError>td","#"+E).html(s[1]),e("#FormError","#"+E).show())}function l(e,t){var n=!1,r;for(r in e)if(e[r]!=t[r]){n=!0;break}return n}function h(){e.each(g.p.colModel,function(e,t){t.editoptions&&!0===t.editoptions.NullIfEmpty&&M.hasOwnProperty(t.name)&&""==M[t.name]&&(M[t.name]="null")})}function p(){var n=!0;e("#FormError","#"+E).hide();t.checkOnUpdate&&(M={},_={},s(),D=e.extend({},M,_),l(D,t._savedData)?(e("#"+w).data("disabled",!0),e(".confirm","#"+S.themodal).show(),n=!1):h());return n}function d(){if("_empty"!==n&&"undefined"!=typeof g.p.savedRow&&0<g.p.savedRow.length&&e.isFunction(e.fn.jqGrid.restoreRow))for(var t=0;t<g.p.savedRow.length;t++)if(g.p.savedRow[t].id==n){e(g).jqGrid("restoreRow",n);break}}function v(t,n){0===t?e("#pData","#"+E+"_2").addClass("ui-state-disabled"):e("#pData","#"+E+"_2").removeClass("ui-state-disabled");t==n?e("#nData","#"+E+"_2").addClass("ui-state-disabled"):e("#nData","#"+E+"_2").removeClass("ui-state-disabled")}function m(){var t=e(g).jqGrid("getDataIDs"),n=e("#id_g","#"+E).val();return[e.inArray(n,t),t]}var g=this;if(g.grid&&n){var y=g.p.id,w="FrmGrid_"+y,E="TblGrid_"+y,S={themodal:"editmod"+y,modalhead:"edithd"+y,modalcontent:"editcnt"+y,scrollelm:w},x=e.isFunction(t.beforeShowForm)?t.beforeShowForm:!1,T=e.isFunction(t.afterShowForm)?t.afterShowForm:!1,N=e.isFunction(t.beforeInitData)?t.beforeInitData:!1,C=e.isFunction(t.onInitializeForm)?t.onInitializeForm:!1,L=!0,A=1,O=0,M,_,D;"new"===n?(n="_empty",r.caption=t.addCaption):r.caption=t.editCaption;!0===r.recreateForm&&null!==e("#"+S.themodal).html()&&e("#"+S.themodal).remove();var P=!0;r.checkOnUpdate&&r.jqModal&&!r.modal&&(P=!1);if(null!==e("#"+S.themodal).html()){N&&(L=N(e("#"+w)),"undefined"==typeof L&&(L=!0));if(!1===L)return;d();e(".ui-jqdialog-title","#"+S.modalhead).html(r.caption);e("#FormError","#"+E).hide();t.topinfo?(e(".topinfo","#"+E+"_2").html(t.topinfo),e(".tinfo","#"+E+"_2").show()):e(".tinfo","#"+E+"_2").hide();t.bottominfo?(e(".bottominfo","#"+E+"_2").html(t.bottominfo),e(".binfo","#"+E+"_2").show()):e(".binfo","#"+E+"_2").hide();u(n,g,w);"_empty"==n||!t.viewPagerButtons?e("#pData, #nData","#"+E+"_2").hide():e("#pData, #nData","#"+E+"_2").show();!0===t.processing&&(t.processing=!1,e("#sData","#"+E+"_2").removeClass("ui-state-active"));!0===e("#"+w).data("disabled")&&(e(".confirm","#"+S.themodal).hide(),e("#"+w).data("disabled",!1));x&&x(e("#"+w));e("#"+S.themodal).data("onClose",t.onClose);e.jgrid.viewModal("#"+S.themodal,{gbox:"#gbox_"+
y,jqm:r.jqModal,jqM:!1,overlay:r.overlay,modal:r.modal});P||e(".jqmOverlay").click(function(){if(!p())return!1;e.jgrid.hideModal("#"+S.themodal,{gb:"#gbox_"+y,jqm:r.jqModal,onClose:t.onClose});return!1});T&&T(e("#"+w))}else{var H=isNaN(r.dataheight)?r.dataheight:r.dataheight+"px",H=e("<form name='FormPost' id='"+w+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+H+";'></form>").data("disabled",!1),B=e("<table id='"+E+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");N&&(L=N(e("#"+w)),"undefined"==typeof L&&(L=!0));if(!1===L)return;d();e(g.p.colModel).each(function(){var e=this.formoptions;A=Math.max(A,e?e.colpos||0:0);O=Math.max(O,e?e.rowpos||0:0)});e(H).append(B);N=e("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+2*A+"'></td></tr>");N[0].rp=0;e(B).append(N);N=e("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*A+"'>"+t.topinfo+"</td></tr>");N[0].rp=0;e(B).append(N);var L=(N="rtl"==g.p.direction?!0:!1)?"nData":"pData",j=N?"pData":"nData";o(n,g,B,A);var L="<a href='javascript:void(0)' id='"+L+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",j="<a href='javascript:void(0)' id='"+j+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>",F="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+r.bSubmit+"</a>",I="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+r.bCancel+"</a>",L="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+E+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(N?j+L:L+j)+"</td><td class='EditButton'>"+F+I+"</td></tr>"+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+t.bottominfo+"</td></tr>"),L=L+"</tbody></table>";if(0<O){var q=[];e.each(e(B)[0].rows,function(e,t){q[e]=t});q.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0});e.each(q,function(t,n){e("tbody",B).append(n)})}r.gbox="#gbox_"+y;var R=!1;!0===r.closeOnEscape&&(r.closeOnEscape=!1,R=!0);H=e("<span></span>").append(H).append(L);e.jgrid.createModal(S,H,r,"#gview_"+g.p.id,e("#gbox_"+g.p.id)[0]);N&&(e("#pData, #nData","#"+E+"_2").css("float","right"),e(".EditButton","#"+E+"_2").css("text-align","left"));t.topinfo&&e(".tinfo","#"+E+"_2").show();t.bottominfo&&e(".binfo","#"+E+"_2").show();L=H=null;e("#"+S.themodal).keydown(function(n){var i=n.target;if(e("#"+w).data("disabled")===!0)return!1;if(t.savekey[0]===!0&&n.which==t.savekey[1]&&i.tagName!="TEXTAREA"){e("#sData","#"+E+"_2").trigger("click");return!1}if(n.which===27){if(!p())return!1;R&&e.jgrid.hideModal(this,{gb:r.gbox,jqm:r.jqModal,onClose:t.onClose});return!1}if(t.navkeys[0]===!0){if(e("#id_g","#"+E).val()=="_empty")return!0;if(n.which==t.navkeys[1]){e("#pData","#"+E+"_2").trigger("click");return!1}if(n.which==t.navkeys[2]){e("#nData","#"+E+"_2").trigger("click");return!1}}});r.checkOnUpdate&&(e("a.ui-jqdialog-titlebar-close span","#"+S.themodal).removeClass("jqmClose"),e("a.ui-jqdialog-titlebar-close","#"+S.themodal).unbind("click").click(function(){if(!p())return!1;e.jgrid.hideModal("#"+S.themodal,{gb:"#gbox_"+y,jqm:r.jqModal,onClose:t.onClose});return!1}));r.saveicon=e.extend([!0,"left","ui-icon-disk"],r.saveicon);r.closeicon=e.extend([!0,"left","ui-icon-close"],r.closeicon);!0===r.saveicon[0]&&e("#sData","#"+E+"_2").addClass("right"==r.saveicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.saveicon[2]+"'></span>");!0===r.closeicon[0]&&e("#cData","#"+E+"_2").addClass("right"==r.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.closeicon[2]+"'></span>");if(t.checkOnSubmit||t.checkOnUpdate)F="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bYes+"</a>",j="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bNo+"</a>",I="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+r.bExit+"</a>",H=r.zIndex||999,H++,e("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+H+";display:none;'>&#160;"+(e.browser.msie&&6==e.browser.version?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"")+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(H+1)+"'>"+r.saveData+"<br/><br/>"+F+j+I+"</div>").insertAfter("#"+w),e("#sNew","#"+S.themodal).click(function(){f();e("#"+w).data("disabled",!1);e(".confirm","#"+S.themodal).hide();return!1}),e("#nNew","#"+S.themodal).click(function(){e(".confirm","#"+S.themodal).hide();e("#"+w).data("disabled",!1);setTimeout(function(){e(":input","#"+w)[0].focus()},0);return!1}),e("#cNew","#"+S.themodal).click(function(){e(".confirm","#"+S.themodal).hide();e("#"+w).data("disabled",!1);e.jgrid.hideModal("#"+S.themodal,{gb:"#gbox_"+y,jqm:r.jqModal,onClose:t.onClose});return!1});C&&C(e("#"+w));"_empty"==n||!t.viewPagerButtons?e("#pData,#nData","#"+E+"_2").hide():e("#pData,#nData","#"+E+"_2").show();x&&x(e("#"+w));e("#"+S.themodal).data("onClose",t.onClose);e.jgrid.viewModal("#"+S.themodal,{gbox:"#gbox_"+y,jqm:r.jqModal,overlay:r.overlay,modal:r.modal});P||e(".jqmOverlay").click(function(){if(!p())return!1;e.jgrid.hideModal("#"+S.themodal,{gb:"#gbox_"+y,jqm:r.jqModal,onClose:t.onClose});return!1});T&&T(e("#"+w));e(".fm-button","#"+S.themodal).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});e("#sData","#"+E+"_2").click(function(){M={};_={};e("#FormError","#"+E).hide();s();h();if(M[g.p.id+"_id"]=="_empty")f();else if(r.checkOnSubmit===!0){D=e.extend({},M,_);if(l(D,t._savedData)){e("#"+w).data("disabled",!0);e(".confirm","#"+S.themodal).show()}else f()}else f();return!1});e("#cData","#"+E+"_2").click(function(){if(!p())return!1;e.jgrid.hideModal("#"+S.themodal,{gb:"#gbox_"+y,jqm:r.jqModal,onClose:t.onClose});return!1});e("#nData","#"+E+"_2").click(function(){if(!p())return!1;e("#FormError","#"+E).hide();var t=m();t[0]=parseInt(t[0],10);if(t[0]!=-1&&t[1][t[0]+1]){e.isFunction(r.onclickPgButtons)&&r.onclickPgButtons("next",e("#"+w),t[1][t[0]]);u(t[1][t[0]+1],g,w);e(g).jqGrid("setSelection",t[1][t[0]+1]);e.isFunction(r.afterclickPgButtons)&&r.afterclickPgButtons("next",e("#"+w),t[1][t[0]+1]);v(t[0]+1,t[1].length-1)}return!1});e("#pData","#"+E+"_2").click(function(){if(!p())return!1;e("#FormError","#"+E).hide();var t=m();if(t[0]!=-1&&t[1][t[0]-1]){e.isFunction(r.onclickPgButtons)&&r.onclickPgButtons("prev",e("#"+w),t[1][t[0]]);u(t[1][t[0]-1],g,w);e(g).jqGrid("setSelection",t[1][t[0]-1]);e.isFunction(r.afterclickPgButtons)&&r.afterclickPgButtons("prev",e("#"+w),t[1][t[0]-1]);v(t[0]-1,t[1].length-1)}return!1})}x=m();v(x[0],x[1].length-1)}})},viewGridRow:function(t,n){n=e.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0},e.jgrid.view,n||{});return this.each(function(){function r(){(!0===n.closeOnEscape||!0===n.navkeys[0])&&setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+d.modalhead).focus()},0)}function i(t,r,i,s){for(var o,u,f,l=0,c,h,p=[],d=!1,v="<td class='CaptionTD form-view-label ui-widget-content' width='"+n.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",m="",g=["integer","number","currency"],y=0,w=0,E,S,x,T=1;T<=s;T++)m+=1==T?v:"<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>";e(r.p.colModel).each(function(){u=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1;!u&&"right"===this.align&&(this.formatter&&-1!==e.inArray(this.formatter,g)?y=Math.max(y,parseInt(this.width,10)):w=Math.max(w,parseInt(this.width,10)))});E=0!==y?y:0!==w?w:0;d=e(r).jqGrid("getInd",t);e(r.p.colModel).each(function(t){o=this.name;S=!1;h=(u=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";x="boolean"!=typeof this.viewable?!0:this.viewable;if("cb"!==o&&"subgrid"!==o&&"rn"!==o&&x){c=!1===d?"":o==r.p.ExpandColumn&&!0===r.p.treeGrid?e("td:eq("+t+")",r.rows[d]).text():e("td:eq("+t+")",r.rows[d]).html();S="right"===this.align&&0!==E?!0:!1;e.extend({},this.editoptions||{},{id:o,name:o});var n=e.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),v=parseInt(n.rowpos,10)||l+1,g=parseInt(2*(parseInt(n.colpos,10)||1),10);if(n.rowabove){var y=e("<tr><td class='contentinfo' colspan='"+2*s+"'>"+n.rowcontent+"</td></tr>");e(i).append(y);y[0].rp=v}f=e(i).find("tr[rowpos="+v+"]");0===f.length&&(f=e("<tr "+h+" rowpos='"+v+"'></tr>").addClass("FormData").attr("id","trv_"+o),e(f).append(m),e(i).append(f),f[0].rp=v);e("td:eq("+(g-2)+")",f[0]).html("<b>"+("undefined"==typeof n.label?r.p.colNames[t]:n.label)+"</b>");e("td:eq("+(g-1)+")",f[0]).append("<span>"+c+"</span>").attr("id","v_"+o);S&&e("td:eq("+(g-1)+") span",f[0]).css({"text-align":"right",width:E+"px"});p[l]=t;l++}});0<l&&(t=e("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*s-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>"),t[0].rp=l+99,e(i).append(t));return p}function s(t,n){var r,i,s=0,o,u;if(u=e(n).jqGrid("getInd",t,!0))e("td",u).each(function(t){r=n.p.colModel[t].name;i=n.p.colModel[t].editrules&&!0===n.p.colModel[t].editrules.edithidden?!1:!0===n.p.colModel[t].hidden?!0:!1;"cb"!==r&&"subgrid"!==r&&"rn"!==r&&(o=r==n.p.ExpandColumn&&!0===n.p.treeGrid?e(this).text():e(this).html(),e.extend({},n.p.colModel[t].editoptions||{}),r=e.jgrid.jqID("v_"+r),e("#"+r+" span","#"+p).html(o),i&&e("#"+r,"#"+p).parents("tr:first").hide(),s++)}),0<s&&e("#id_g","#"+p).val(t)}function o(t,n){0===t?e("#pData","#"+p+"_2").addClass("ui-state-disabled"):e("#pData","#"+p+"_2").removeClass("ui-state-disabled");t==n?e("#nData","#"+p+"_2").addClass("ui-state-disabled"):e("#nData","#"+p+"_2").removeClass("ui-state-disabled")}function u(){var t=e(f).jqGrid("getDataIDs"),n=e("#id_g","#"+p).val();return[e.inArray(n,t),t]}var f=this;if(f.grid&&t){n.imgpath||(n.imgpath=f.p.imgpath);var l=f.p.id,h="ViewGrid_"+l,p="ViewTbl_"+l,d={themodal:"viewmod"+l,modalhead:"viewhd"+l,modalcontent:"viewcnt"+l,scrollelm:h},v=e.isFunction(n.beforeInitData)?n.beforeInitData:!1,m=!0,g=1,y=0;if(null!==e("#"+d.themodal).html()){v&&(m=v(e("#"+h)),"undefined"==typeof m&&(m=!0));if(!1===m)return;e(".ui-jqdialog-title","#"+d.modalhead).html(n.caption);e("#FormError","#"+p).hide();s(t,f);e.isFunction(n.beforeShowForm)&&n.beforeShowForm(e("#"+h));e.jgrid.viewModal("#"+d.themodal,{gbox:"#gbox_"+l,jqm:n.jqModal,jqM:!1,overlay:n.overlay,modal:n.modal});r()}else{var w=isNaN(n.dataheight)?n.dataheight:n.dataheight+"px",w=e("<form name='FormPost' id='"+h+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+w+";'></form>"),E=e("<table id='"+p+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");v&&(m=v(e("#"+h)),"undefined"==typeof m&&(m=!0));if(!1===m)return;e(f.p.colModel).each(function(){var e=this.formoptions;g=Math.max(g,e?e.colpos||0:0);y=Math.max(y,e?e.rowpos||0:0)});e(w).append(E);i(t,f,E,g);var v="rtl"==f.p.direction?!0:!1,m="<a href='javascript:void(0)' id='"+(v?"nData":"pData")+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",S="<a href='javascript:void(0)' id='"+(v?"pData":"nData")+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",x="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+n.bClose+"</a>";if(0<y){var T=[];e.each(e(E)[0].rows,function(e,t){T[e]=t});T.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0});e.each(T,function(t,n){e("tbody",E).append(n)})}n.gbox="#gbox_"+l;var N=!1;!0===n.closeOnEscape&&(n.closeOnEscape=!1,N=!0);w=e("<span></span>").append(w).append("<table border='0' class='EditTable' id='"+p+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+n.labelswidth+"'>"+(v?S+m:m+S)+"</td><td class='EditButton'>"+x+"</td></tr></tbody></table>");e.jgrid.createModal(d,w,n,"#gview_"+f.p.id,e("#gview_"+f.p.id)[0]);v&&(e("#pData, #nData","#"+p+"_2").css("float","right"),e(".EditButton","#"+p+"_2").css("text-align","left"));n.viewPagerButtons||e("#pData, #nData","#"+p+"_2").hide();w=null;e("#"+d.themodal).keydown(function(t){if(t.which===27){N&&e.jgrid.hideModal(this,{gb:n.gbox,jqm:n.jqModal,onClose:n.onClose});return!1}if(n.navkeys[0]===!0){if(t.which===n.navkeys[1]){e("#pData","#"+p+"_2").trigger("click");return!1}if(t.which===n.navkeys[2]){e("#nData","#"+p+"_2").trigger("click");return!1}}});n.closeicon=e.extend([!0,"left","ui-icon-close"],n.closeicon);!0===n.closeicon[0]&&e("#cData","#"+p+"_2").addClass("right"==n.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+n.closeicon[2]+"'></span>");e.isFunction(n.beforeShowForm)&&n.beforeShowForm(e("#"+h));e.jgrid.viewModal("#"+d.themodal,{gbox:"#gbox_"+l,jqm:n.jqModal,modal:n.modal});e(".fm-button:not(.ui-state-disabled)","#"+p+"_2").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});r();e("#cData","#"+p+"_2").click(function(){e.jgrid.hideModal("#"+d.themodal,{gb:"#gbox_"+l,jqm:n.jqModal,onClose:n.onClose});return!1});e("#nData","#"+p+"_2").click(function(){e("#FormError","#"+p).hide();var t=u();t[0]=parseInt(t[0],10);if(t[0]!=-1&&t[1][t[0]+1]){e.isFunction(n.onclickPgButtons)&&n.onclickPgButtons("next",e("#"+h),t[1][t[0]]);s(t[1][t[0]+1],f);e(f).jqGrid("setSelection",t[1][t[0]+1]);e.isFunction(n.afterclickPgButtons)&&n.afterclickPgButtons("next",e("#"+h),t[1][t[0]+1]);o(t[0]+1,t[1].length-1)}r();return!1});e("#pData","#"+p+"_2").click(function(){e("#FormError","#"+p).hide();var t=u();if(t[0]!=-1&&t[1][t[0]-1]){e.isFunction(n.onclickPgButtons)&&n.onclickPgButtons("prev",e("#"+h),t[1][t[0]]);s(t[1][t[0]-1],f);e(f).jqGrid("setSelection",t[1][t[0]-1]);e.isFunction(n.afterclickPgButtons)&&n.afterclickPgButtons("prev",e("#"+h),t[1][t[0]-1]);o(t[0]-1,t[1].length-1)}r();return!1})}w=u();o(w[0],w[1].length-1)}})},delGridRow:function(n,r){t=r=e.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},e.jgrid.del,r||{});return this.each(function(){var i=this;if(i.grid&&n){var s="function"==typeof r.beforeShowForm?!0:!1,o="function"==typeof r.afterShowForm?!0:!1,u=e.isFunction(r.beforeInitData)?r.beforeInitData:!1,f=i.p.id,l={},h=!0,p="DelTbl_"+f,d,v,m,g,y={themodal:"delmod"+f,modalhead:"delhd"+f,modalcontent:"delcnt"+f,scrollelm:p};k.isArray(n)&&(n=n.join());if(null!==e("#"+y.themodal).html()){u&&(h=u(e("#"+p)),"undefined"==typeof h&&(h=!0));if(!1===h)return;e("#DelData>td","#"+p).text(n);e("#DelError","#"+p).hide();!0===t.processing&&(t.processing=!1,e("#dData","#"+p).removeClass("ui-state-active"));s&&r.beforeShowForm(e("#"+p));e.jgrid.viewModal("#"+y.themodal,{gbox:"#gbox_"+f,jqm:r.jqModal,jqM:!1,overlay:r.overlay,modal:r.modal})}else{var w=isNaN(r.dataheight)?r.dataheight:r.dataheight+"px",w="<div id='"+p+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+w+";'><table class='DelTable'><tbody><tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>"+("<tr id='DelData' style='display:none'><td >"+n+"</td></tr>"),w=w+('<tr><td class="delmsg" style="white-space:pre;">'+r.msg+"</td></tr><tr><td >&#160;</td></tr>"),w=w+"</tbody></table></div>"+("<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+p+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr></tr><tr><td class='DelButton EditButton'>"+("<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+r.bSubmit+"</a>")+"&#160;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+r.bCancel+"</a>")+"</td></tr></tbody></table>");r.gbox="#gbox_"+f;e.jgrid.createModal(y,w,r,"#gview_"+i.p.id,e("#gview_"+i.p.id)[0]);u&&(h=u(e("#"+p)),"undefined"==typeof h&&(h=!0));if(!1===h)return;e(".fm-button","#"+p+"_2").hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")});r.delicon=e.extend([!0,"left","ui-icon-scissors"],r.delicon);r.cancelicon=e.extend([!0,"left","ui-icon-cancel"],r.cancelicon);!0===r.delicon[0]&&e("#dData","#"+p+"_2").addClass("right"==r.delicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.delicon[2]+"'></span>");!0===r.cancelicon[0]&&e("#eData","#"+p+"_2").addClass("right"==r.cancelicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+r.cancelicon[2]+"'></span>");e("#dData","#"+p+"_2").click(function(){var n=[!0,""];l={};var s=e("#DelData>td","#"+p).text();typeof r.onclickSubmit=="function"&&(l=r.onclickSubmit(t,s)||{});typeof r.beforeSubmit=="function"&&(n=r.beforeSubmit(s));if(n[0]&&!t.processing){t.processing=!0;e(this).addClass("ui-state-active");m=i.p.prmNames;d=e.extend({},t.delData,l);g=m.oper;d[g]=m.deloper;v=m.id;d[v]=s;var o=e.extend({url:t.url?t.url:e(i).jqGrid("getGridParam","editurl"),type:r.mtype,data:e.isFunction(r.serializeDelData)?r.serializeDelData(d):d,complete:function(o,u){if(u!="success"){n[0]=!1;n[1]=e.isFunction(t.errorTextFormat)?t.errorTextFormat(o):u+" Status: '"+o.statusText+"'. Error code: "+o.status}else typeof t.afterSubmit=="function"&&(n=t.afterSubmit(o,d));if(n[0]===!1){e("#DelError>td","#"+p).html(n[1]);e("#DelError","#"+p).show()}else{if(t.reloadAfterSubmit&&i.p.datatype!="local")e(i).trigger("reloadGrid");else{var l=[],l=s.split(",");if(i.p.treeGrid===!0)try{e(i).jqGrid("delTreeNode",l[0])}catch(h){}else for(var v=0;v<l.length;v++)e(i).jqGrid("delRowData",l[v]);i.p.selrow=null;i.p.selarrrow=[]}e.isFunction(t.afterComplete)&&setTimeout(function(){t.afterComplete(o,s)},500)}t.processing=!1;e("#dData","#"+p+"_2").removeClass("ui-state-active");n[0]&&e.jgrid.hideModal("#"+y.themodal,{gb:"#gbox_"+f,jqm:r.jqModal,onClose:t.onClose})}},e.jgrid.ajaxOptions,r.ajaxDelOptions);if(!o.url&&!t.useDataProxy)if(e.isFunction(i.p.dataProxy))t.useDataProxy=!0;else{n[0]=!1;n[1]=n[1]+(" "+e.jgrid.errors.nourl)}n[0]&&(t.useDataProxy?i.p.dataProxy.call(i,o,"del_"+i.p.id):e.ajax(o))}if(n[0]===!1){e("#DelError>td","#"+p).html(n[1]);e("#DelError","#"+p).show()}return!1});e("#eData","#"+p+"_2").click(function(){e.jgrid.hideModal("#"+y.themodal,{gb:"#gbox_"+f,jqm:r.jqModal,onClose:t.onClose});return!1});s&&r.beforeShowForm(e("#"+p));e.jgrid.viewModal("#"+y.themodal,{gbox:"#gbox_"+f,jqm:r.jqModal,overlay:r.overlay,modal:r.modal})}o&&r.afterShowForm(e("#"+p));!0===r.closeOnEscape&&setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+y.modalhead).focus()},0)}})},navGrid:function(t,n,r,i,s,o,u){n=e.extend({edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",del:!0,delicon:"ui-icon-trash",search:!0,searchicon:"ui-icon-search",refresh:!0,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:!1,viewicon:"ui-icon-document",position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1},e.jgrid.nav,n||{});return this.each(function(){if(!this.nav){var l={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},h=this,p,v,m;if(h.grid&&"string"==typeof t){null===e("#"+l.themodal).html()&&("undefined"!=typeof window.innerWidth?(p=window.innerWidth,v=window.innerHeight):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(p=document.documentElement.clientWidth,v=document.documentElement.clientHeight):(p=1024,v=768),e.jgrid.createModal(l,"<div>"+n.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+h.p.id,jqModal:!0,drag:!0,resize:!0,caption:n.alertcap,top:v/2-25,left:p/2-100,width:200,height:"auto",closeOnEscape:n.closeOnEscape},"","",!0));p=1;n.cloneToTop&&h.p.toppager&&(p=2);for(v=0;v<p;v++){var y=e("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),w,E;0===v?(w=t,E=h.p.id,w==h.p.toppager&&(E+="_top",p=1)):(w=h.p.toppager,E=h.p.id+"_top");"rtl"==h.p.direction&&e(y).attr("dir","rtl").css("float","right");n.add&&(i=i||{},m=e("<td class='ui-pg-button ui-corner-all'></td>"),e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.addicon+"'></span>"+n.addtext+"</div>"),e("tr",y).append(m),e(m,y).attr({title:n.addtitle||"",id:i.id||"add_"+E}).click(function(){e(this).hasClass("ui-state-disabled")||(typeof n.addfunc=="function"?n.addfunc():e(h).jqGrid("editGridRow","new",i));return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),m=null);n.edit&&(m=e("<td class='ui-pg-button ui-corner-all'></td>"),r=r||{},e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.editicon+"'></span>"+n.edittext+"</div>"),e("tr",y).append(m),e(m,y).attr({title:n.edittitle||"",id:r.id||"edit_"+E}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t=h.p.selrow;if(t)typeof n.editfunc=="function"?n.editfunc(t):e(h).jqGrid("editGridRow",t,r);else{e.jgrid.viewModal("#"+l.themodal,{gbox:"#gbox_"+h.p.id,jqm:!0});e("#jqg_alrt").focus()}}return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),m=null);n.view&&(m=e("<td class='ui-pg-button ui-corner-all'></td>"),u=u||{},e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.viewicon+"'></span>"+n.viewtext+"</div>"),e("tr",y).append(m),e(m,y).attr({title:n.viewtitle||"",id:u.id||"view_"+E}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t=h.p.selrow;if(t)e(h).jqGrid("viewGridRow",t,u);else{e.jgrid.viewModal("#"+l.themodal,{gbox:"#gbox_"+h.p.id,jqm:!0});e("#jqg_alrt").focus()}}return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),m=null);n.del&&(m=e("<td class='ui-pg-button ui-corner-all'></td>"),s=s||{},e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.delicon+"'></span>"+n.deltext+"</div>"),e("tr",y).append(m),e(m,y).attr({title:n.deltitle||"",id:s.id||"del_"+E}).click(function(){if(!e(this).hasClass("ui-state-disabled")){var t;if(h.p.multiselect){t=h.p.selarrrow;t.length===0&&(t=null)}else t=h.p.selrow;if(t)"function"==typeof n.delfunc?n.delfunc(t):e(h).jqGrid("delGridRow",t,s);else{e.jgrid.viewModal("#"+l.themodal,{gbox:"#gbox_"+h.p.id,jqm:!0});e("#jqg_alrt").focus()}}return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),m=null);(n.add||n.edit||n.del||n.view)&&e("tr",y).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>");n.search&&(m=e("<td class='ui-pg-button ui-corner-all'></td>"),o=o||{},e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.searchicon+"'></span>"+n.searchtext+"</div>"),e("tr",y).append(m),e(m,y).attr({title:n.searchtitle||"",id:o.id||"search_"+E}).click(function(){e(this).hasClass("ui-state-disabled")||e(h).jqGrid("searchGrid",o);return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),o.showOnLoad&&!0===o.showOnLoad&&e(m,y).click(),m=null);n.refresh&&(m=e("<td class='ui-pg-button ui-corner-all'></td>"),e(m).append("<div class='ui-pg-div'><span class='ui-icon "+n.refreshicon+"'></span>"+n.refreshtext+"</div>"),e("tr",y).append(m),e(m,y).attr({title:n.refreshtitle||"",id:"refresh_"+E}).click(function(){if(!e(this).hasClass("ui-state-disabled")){e.isFunction(n.beforeRefresh)&&n.beforeRefresh();h.p.search=!1;try{var t=h.p.id;h.p.postData.filters="";e("#fbox_"+t).jqFilter("resetFilter");e.isFunction(h.clearToolbar)&&h.clearToolbar(!1)}catch(r){}switch(n.refreshstate){case"firstpage":e(h).trigger("reloadGrid",[{page:1}]);break;case"current":e(h).trigger("reloadGrid",[{current:!0}])}e.isFunction(n.afterRefresh)&&n.afterRefresh()}return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}),m=null);m=e(".ui-jqgrid").css("font-size")||"11px";e("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+m+";visibility:hidden;' ></div>");m=e(y).clone().appendTo("#testpg2").width();e("#testpg2").remove();e(w+"_"+n.position,w).append(y);h.p._nvtd&&(m>h.p._nvtd[0]&&(e(w+"_"+n.position,w).width(m),h.p._nvtd[0]=m),h.p._nvtd[1]=m);y=m=m=null;this.nav=!0}}}})},navButtonAdd:function(t,n){n=e.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},n||{});return this.each(function(){if(this.grid){0!==t.indexOf("#")&&(t="#"+t);var r=e(".navtable",t)[0],i=this;if(r&&(!n.id||null===e("#"+n.id,r).html())){var s=e("<td></td>");"NONE"==n.buttonicon.toString().toUpperCase()?e(s).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+n.caption+"</div>"):e(s).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+n.buttonicon+"'></span>"+n.caption+"</div>");n.id&&e(s).attr("id",n.id);"first"==n.position?0===r.rows[0].cells.length?e("tr",r).append(s):e("tr td:eq(0)",r).before(s):e("tr",r).append(s);e(s,r).attr("title",n.title||"").click(function(t){e(this).hasClass("ui-state-disabled")||e.isFunction(n.onClickButton)&&n.onClickButton.call(i,t);return!1}).hover(function(){e(this).hasClass("ui-state-disabled")||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(t,n){n=e.extend({sepclass:"ui-separator",sepcontent:""},n||{});return this.each(function(){if(this.grid){0!==t.indexOf("#")&&(t="#"+t);var r=e(".navtable",t)[0];if(r){var i="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+n.sepclass+"'></span>"+n.sepcontent+"</td>";e("tr",r).append(i)}}})},GridToForm:function(t,n){return this.each(function(){if(this.grid){var r=e(this).jqGrid("getRowData",t);if(r)for(var i in r)e("[name="+e.jgrid.jqID(i)+"]",n).is("input:radio")||e("[name="+e.jgrid.jqID(i)+"]",n).is("input:checkbox")?e("[name="+e.jgrid.jqID(i)+"]",n).each(function(){e(this).val()==r[i]?e(this).attr("checked","checked"):e(this).attr("checked","")}):e("[name="+e.jgrid.jqID(i)+"]",n).val(r[i])}})},FormToGrid:function(t,n,r,i){return this.each(function(){if(this.grid){r||(r="set");i||(i="first");var s=e(n).serializeArray(),o={};e.each(s,function(e,t){o[t.name]=t.value});"add"==r?e(this).jqGrid("addRowData",t,o,i):"set"==r&&e(this).jqGrid("setRowData",t,o)}})}})})(k);(function(e){e.fn.jqFilter=function(t){if("string"==typeof t){var n=e.fn.jqFilter[t];if(!n)throw"jqFilter - No such method: "+t;var r=e.makeArray(arguments).slice(1);return n.apply(this,r)}var i=e.extend(!0,{filter:null,columns:[],onChange:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,sopt:null,ops:[{name:"eq",description:"equal",operator:"="},{name:"ne",description:"not equal",operator:"<>"},{name:"lt",description:"less",operator:"<"},{name:"le",description:"less or equal",operator:"<="},{name:"gt",description:"greater",operator:">"},{name:"ge",description:"greater or equal",operator:">="},{name:"bw",description:"begins with",operator:"LIKE"},{name:"bn",description:"does not begin with",operator:"NOT LIKE"},{name:"in",description:"in",operator:"IN"},{name:"ni",description:"not in",operator:"NOT IN"},{name:"ew",description:"ends with",operator:"LIKE"},{name:"en",description:"does not end with",operator:"NOT LIKE"},{name:"cn",description:"contains",operator:"LIKE"},{name:"nc",description:"does not contain",operator:"NOT LIKE"},{name:"nu",description:"is null",operator:"IS NULL"},{name:"nn",description:"is not null",operator:"IS NOT NULL"}],numopts:"eq ne lt le gt ge nu nn in ni".split(" "),stropts:"eq ne bw bn ew en cn nc nu nn in ni".split(" "),_gridsopt:[],groupOps:["AND","OR"],groupButton:!0},t||{});return this.each(function(){if(!this.filter){this.p=i;if(null===this.p.filter||void 0===this.p.filter)this.p.filter={groupOp:this.p.groupOps[0],rules:[],groups:[]};var t,n=this.p.columns.length,r,s=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p._gridsopt.length)for(t=0;t<this.p._gridsopt.length;t++)this.p.ops[t].description=this.p._gridsopt[t];this.p.initFilter=e.extend(!0,{},this.p.filter);if(n){for(t=0;t<n;t++)if(r=this.p.columns[t],r.stype?r.inputtype=r.stype:r.inputtype||(r.inputtype="text"),r.sorttype?r.searchtype=r.sorttype:r.searchtype||(r.searchtype="string"),void 0===r.hidden&&(r.hidden=!1),r.label||(r.label=r.name),r.index&&(r.name=r.index),r.hasOwnProperty("searchoptions")||(r.searchoptions={}),!r.hasOwnProperty("searchrules"))r.searchrules={};this.p.showQuery&&e(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;'><tbody><tr><td class='query'></td></tr></tbody></table>");var o=function(t,n){var r=[!0,""];if(e.isFunction(n.searchrules))r=n.searchrules(t,n);else if(e.jgrid&&e.jgrid.checkValues)try{r=e.jgrid.checkValues(t,-1,null,n.searchrules,n.label)}catch(s){}r&&r.length&&!1===r[0]&&(i.error=!r[0],i.errmsg=r[1])};this.onchange=function(){this.p.error=!1;this.p.errmsg="";return e.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1};this.reDraw=function(){e("table.group:first",this).remove();var t=this.createTableForGroup(i.filter,null);e(this).append(t)};this.createTableForGroup=function(t,n){var r=this,s,o=e("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>");null===n&&e(o).append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='left'></th></tr>");var u=e("<tr></tr>");e(o).append(u);var l=e("<th colspan='5' align='left'></th>");u.append(l);var c=e("<select class='opsel'></select>");l.append(c);var u="",h;for(s=0;s<i.groupOps.length;s++)h=t.groupOp===r.p.groupOps[s]?" selected='selected'":"",u+="<option value='"+r.p.groupOps[s]+"'"+h+">"+r.p.groupOps[s]+"</option>";c.append(u).bind("change",function(){t.groupOp=e(c).val();r.onchange()});u="<span></span>";this.p.groupButton&&(u=e("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>"),u.bind("click",function(){void 0===t.groups&&(t.groups=[]);t.groups.push({groupOp:i.groupOps[0],rules:[],groups:[]});r.reDraw();r.onchange();return!1}));l.append(u);var u=e("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"),p;u.bind("click",function(){t.rules===void 0&&(t.rules=[]);for(s=0;s<r.p.columns.length;s++){var e=typeof r.p.columns[s].search=="undefined"?!0:r.p.columns[s].search,n=r.p.columns[s].hidden===!0;if(r.p.columns[s].searchoptions.searchhidden===!0&&e||e&&!n){p=r.p.columns[s];break}}t.rules.push({field:p.name,op:(p.searchoptions.sopt?p.searchoptions.sopt:r.p.sopt?r.p.sopt:p.searchtype==="string"?r.p.stropts:r.p.numopts)[0],data:""});r.reDraw();return!1});l.append(u);null!==n&&(u=e("<input type='button' value='-' title='Delete group' class='delete-group'/>"),l.append(u),u.bind("click",function(){for(s=0;s<n.groups.length;s++)if(n.groups[s]===t){n.groups.splice(s,1);break}r.reDraw();r.onchange();return!1}));if(void 0!==t.groups)for(s=0;s<t.groups.length;s++)l=e("<tr></tr>"),o.append(l),u=e("<td class='first'></td>"),l.append(u),u=e("<td colspan='4'></td>"),u.append(this.createTableForGroup(t.groups[s],t)),l.append(u);void 0===t.groupOp&&(t.groupOp=r.p.groupOps[0]);if(void 0!==t.rules)for(s=0;s<t.rules.length;s++)o.append(this.createTableRowForRule(t.rules[s],t));return o};this.createTableRowForRule=function(
t,n){var r=this,o=e("<tr></tr>"),u,l,c,h,p="",v;o.append("<td class='first'></td>");var m=e("<td class='columns'></td>");o.append(m);var g=e("<select></select>");m.append(g);g.bind("change",function(){t.field=e(g).val();c=e(this).parents("tr:first");for(u=0;u<r.p.columns.length;u++)if(r.p.columns[u].name===t.field){h=r.p.columns[u];break}if(h){h.searchoptions.id=e.jgrid.randId();s&&"text"===h.inputtype&&!h.searchoptions.size&&(h.searchoptions.size=10);var n=e.jgrid.createEl(h.inputtype,h.searchoptions,"",!0,r.p.ajaxSelectOptions,!0);e(n).addClass("input-elm");l=h.searchoptions.sopt?h.searchoptions.sopt:r.p.sopt?r.p.sopt:"string"===h.searchtype?r.p.stropts:r.p.numopts;var i="",o="";for(u=0;u<r.p.ops.length;u++)-1!==e.inArray(r.p.ops[u].name,l)&&(o=t.op===r.p.ops[u].name?" selected=selected":"",i+="<option value='"+r.p.ops[u].name+"'"+o+">"+r.p.ops[u].description+"</option>");e(".selectopts",c).empty().append(i);e(".data",c).empty().append(n);e(".input-elm",c).bind("change",function(){t.data=e(this).val();e.isArray(t.data)&&(t.data=t.data.join(","));r.onchange()});setTimeout(function(){t.data=e(n).val();r.onchange()},0)}});for(u=m=0;u<r.p.columns.length;u++){v="undefined"==typeof r.p.columns[u].search?!0:r.p.columns[u].search;var y=!0===r.p.columns[u].hidden;if(!0===r.p.columns[u].searchoptions.searchhidden&&v||v&&!y)v="",t.field===r.p.columns[u].name&&(v=" selected='selected'",m=u),p+="<option value='"+r.p.columns[u].name+"'"+v+">"+r.p.columns[u].label+"</option>"}g.append(p);p=e("<td class='operators'></td>");o.append(p);h=i.columns[m];h.searchoptions.id=e.jgrid.randId();s&&"text"===h.inputtype&&!h.searchoptions.size&&(h.searchoptions.size=10);var m=e.jgrid.createEl(h.inputtype,h.searchoptions,t.data,!0,r.p.ajaxSelectOptions,!0),b=e("<select class='selectopts'></select>");p.append(b);b.bind("change",function(){t.op=e(b).val();c=e(this).parents("tr:first");var n=e(".input-elm",c)[0];if(t.op==="nu"||t.op==="nn"){t.data="";n.value="";n.setAttribute("readonly","true");n.setAttribute("disabled","true")}else{n.removeAttribute("readonly");n.removeAttribute("disabled")}r.onchange()});l=h.searchoptions.sopt?h.searchoptions.sopt:r.p.sopt?r.p.sopt:"string"===h.searchtype?i.stropts:r.p.numopts;p="";for(u=0;u<r.p.ops.length;u++)-1!==e.inArray(r.p.ops[u].name,l)&&(v=t.op===r.p.ops[u].name?" selected='selected'":"",p+="<option value='"+r.p.ops[u].name+"'"+v+">"+r.p.ops[u].description+"</option>");b.append(p);p=e("<td class='data'></td>");o.append(p);p.append(m);e(m).addClass("input-elm").bind("change",function(){t.data=e(this).val();e.isArray(t.data)&&(t.data=t.data.join(","));r.onchange()});p=e("<td></td>");o.append(p);m=e("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>");p.append(m);m.bind("click",function(){for(u=0;u<n.rules.length;u++)if(n.rules[u]===t){n.rules.splice(u,1);break}r.reDraw();r.onchange();return!1});return o};this.getStringForGroup=function(e){var t="(",n;if(void 0!==e.groups)for(n=0;n<e.groups.length;n++){1<t.length&&(t+=" "+e.groupOp+" ");try{t+=this.getStringForGroup(e.groups[n])}catch(r){alert(r)}}if(void 0!==e.rules)try{for(n=0;n<e.rules.length;n++)1<t.length&&(t+=" "+e.groupOp+" "),t+=this.getStringForRule(e.rules[n])}catch(i){alert(i)}t+=")";return"()"===t?"":t};this.getStringForRule=function(t){var n="",r="",s,u;for(s=0;s<this.p.ops.length;s++)if(this.p.ops[s].name===t.op){n=this.p.ops[s].operator;r=this.p.ops[s].name;break}for(s=0;s<this.p.columns.length;s++)if(this.p.columns[s].name===t.field){u=this.p.columns[s];break}s=t.data;if("bw"===r||"bn"===r)s+="%";if("ew"===r||"en"===r)s="%"+s;if("cn"===r||"nc"===r)s="%"+s+"%";if("in"===r||"ni"===r)s=" ("+s+")";i.errorcheck&&o(t.data,u);return-1!==e.inArray(u.searchtype,["int","integer","float","number","currency"])||"nn"===r||"nu"===r?t.field+" "+n+" "+s:t.field+" "+n+' "'+s+'"'};this.resetFilter=function(){this.p.filter=e.extend(!0,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){e("th.ui-state-error",this).html("");e("tr.error",this).hide()};this.showError=function(){e("th.ui-state-error",this).html(this.p.errmsg);e("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(i.filter)};this.toString=function(){function e(n){var r="(",i;if(void 0!==n.groups)for(i=0;i<n.groups.length;i++)1<r.length&&(r+="OR"===n.groupOp?" || ":" && "),r+=e(n.groups[i]);if(void 0!==n.rules)for(i=0;i<n.rules.length;i++){1<r.length&&(r+="OR"===n.groupOp?" || ":" && ");var s=n.rules[i];if(t.p.errorcheck){for(var u=void 0,f=void 0,u=0;u<t.p.columns.length;u++)if(t.p.columns[u].name===s.field){f=t.p.columns[u];break}f&&o(s.data,f)}r+=s.op+"(item."+s.field+",'"+s.data+"')"}r+=")";return"()"===r?"":r}var t=this;return e(this.p.filter)};this.reDraw();this.p.showQuery&&this.onchange();this.filter=!0}}})};e.extend(e.fn.jqFilter,{toSQLString:function(){var e="";this.each(function(){e=this.toUserFriendlyString()});return e},filterData:function(){var e;this.each(function(){e=this.p.filter});return e},getParameter:function(e){return void 0!==e&&this.p.hasOwnProperty(e)?this.p[e]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(e){"string"==typeof e&&(e=k.jgrid.parse(e));this.each(function(){this.p.filter=e;this.reDraw();this.onchange()})}})})(k);(function(e){e.jgrid.extend({editRow:function(t,n,r,i,s,o,u,f,l){var c={keys:n||!1,oneditfunc:r||null,successfunc:i||null,url:s||null,extraparam:o||{},aftersavefunc:u||null,errorfunc:f||null,afterrestorefunc:l||null,restoreAfterErorr:!0},h=e.makeArray(arguments).slice(1),p;p=h[0]&&"object"==typeof h[0]&&!e.isFunction(h[0])?e.extend(c,h[0]):c;return this.each(function(){var n=this,r,i,s=0,o=null,u={},f,c;n.grid&&(f=e(n).jqGrid("getInd",t,!0),!1!==f&&"0"==(e(f).attr("editable")||"0")&&!e(f).hasClass("not-editable-row"))&&(c=n.p.colModel,e("td",f).each(function(f){r=c[f].name;var l=!0===n.p.treeGrid&&r==n.p.ExpandColumn;if(l)i=e("span:first",this).html();else try{i=e.unformat(this,{rowId:t,colModel:c[f]},f)}catch(h){i=e(this).html()}if("cb"!=r&&"subgrid"!=r&&"rn"!=r&&(n.p.autoencode&&(i=e.jgrid.htmlDecode(i)),u[r]=i,!0===c[f].editable)){null===o&&(o=f);l?e("span:first",this).html(""):e(this).html("");var p=e.extend({},c[f].editoptions||{},{id:t+"_"+r,name:r});c[f].edittype||(c[f].edittype="text");p=e.jgrid.createEl(c[f].edittype,p,i,!0,e.extend({},e.jgrid.ajaxOptions,n.p.ajaxSelectOptions||{}));e(p).addClass("editable");l?e("span:first",this).append(p):e(this).append(p);"select"==c[f].edittype&&!0===c[f].editoptions.multiple&&e.browser.msie&&e(p).width(e(p).width());s++}}),0<s&&(u.id=t,n.p.savedRow.push(u),e(f).attr("editable","1"),e("td:eq("+o+") input",f).focus(),!0===p.keys&&e(f).bind("keydown",function(r){27===r.keyCode&&e(n).jqGrid("restoreRow",t,l);if(13===r.keyCode){if("TEXTAREA"==r.target.tagName)return!0;e(n).jqGrid("saveRow",t,p);return!1}r.stopPropagation()}),e.isFunction(p.oneditfunc)&&p.oneditfunc.call(n,t)))})},saveRow:function(t,n,r,i,s,o,u){var f={successfunc:n||null,url:r||null,extraparam:i||{},aftersavefunc:s||null,errorfunc:o||null,afterrestorefunc:u||null,restoreAfterErorr:!0},l=e.makeArray(arguments).slice(1),c;c=l[0]&&"object"==typeof l[0]&&!e.isFunction(l[0])?e.extend(f,l[0]):f;var h=!1,p=this[0],d,v={},m={},g={},y,b,w;if(!p.grid)return h;w=e(p).jqGrid("getInd",t,!0);if(!1===w)return h;f=e(w).attr("editable");c.url=c.url?c.url:p.p.editurl;if("1"===f){var E;e("td",w).each(function(t){E=p.p.colModel[t];d=E.name;if("cb"!=d&&"subgrid"!=d&&!0===E.editable&&"rn"!=d&&!e(this).hasClass("not-editable-cell")){switch(E.edittype){case"checkbox":var n=["Yes","No"];E.editoptions&&(n=E.editoptions.value.split(":"));v[d]=e("input",this).attr("checked")?n[0]:n[1];break;case"text":case"password":case"textarea":case"button":v[d]=e("input, textarea",this).val();break;case"select":if(E.editoptions.multiple){var n=e("select",this),r=[];v[d]=e(n).val();v[d]=v[d]?v[d].join(","):"";e("select > option:selected",this).each(function(t,n){r[t]=e(n).text()});m[d]=r.join(",")}else v[d]=e("select>option:selected",this).val(),m[d]=e("select>option:selected",this).text();E.formatter&&"select"==E.formatter&&(m={});break;case"custom":try{if(!E.editoptions||!e.isFunction(E.editoptions.custom_value))throw"e1";if(v[d]=E.editoptions.custom_value.call(p,e(".customelement",this),"get"),void 0===v[d])throw"e2"}catch(i){"e1"==i&&e.jgrid.info_dialog(k.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.nodefined,k.jgrid.edit.bClose),"e2"==i?e.jgrid.info_dialog(k.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.novalue,k.jgrid.edit.bClose):e.jgrid.info_dialog(k.jgrid.errors.errcap,i.message,k.jgrid.edit.bClose)}}b=e.jgrid.checkValues(v[d],t,p);if(!1===b[0])return b[1]=v[d]+" "+b[1],!1;p.p.autoencode&&(v[d]=e.jgrid.htmlEncode(v[d]));"clientArray"!==c.url&&E.editoptions&&!0===E.editoptions.NullIfEmpty&&""==v[d]&&(g[d]="null")}});if(!1===b[0]){try{var S=e.jgrid.findPos(e("#"+e.jgrid.jqID(t),p.grid.bDiv)[0]);e.jgrid.info_dialog(e.jgrid.errors.errcap,b[1],e.jgrid.edit.bClose,{left:S[0],top:S[1]})}catch(x){alert(b[1])}return h}v&&(f=p.p.prmNames,l=f.oper,S=f.id,v[l]=f.editoper,v[S]=t,"undefined"==typeof p.p.inlineData&&(p.p.inlineData={}),v=e.extend({},v,p.p.inlineData,c.extraparam));if("clientArray"==c.url){v=e.extend({},v,m);p.p.autoencode&&e.each(v,function(t,n){v[t]=e.jgrid.htmlDecode(n)});S=e(p).jqGrid("setRowData",t,v);e(w).attr("editable","0");for(f=0;f<p.p.savedRow.length;f++)if(p.p.savedRow[f].id==t){y=f;break}0<=y&&p.p.savedRow.splice(y,1);e.isFunction(c.aftersavefunc)&&c.aftersavefunc.call(p,t,S);h=!0}else e("#lui_"+p.p.id).show(),g=e.extend({},v,g),e.ajax(e.extend({url:c.url,data:e.isFunction(p.p.serializeRowData)?p.p.serializeRowData.call(p,g):g,type:"POST",async:!1,complete:function(n,r){e("#lui_"+p.p.id).hide();if(r==="success")if((e.isFunction(c.succesfunc)?c.succesfunc.call(p,n):!0)===!0){p.p.autoencode&&e.each(v,function(t,n){v[t]=e.jgrid.htmlDecode(n)});v=e.extend({},v,m);e(p).jqGrid("setRowData",t,v);e(w).attr("editable","0");for(var i=0;i<p.p.savedRow.length;i++)if(p.p.savedRow[i].id==t){y=i;break}y>=0&&p.p.savedRow.splice(y,1);e.isFunction(c.aftersavefunc)&&c.aftersavefunc.call(p,t,n);h=!0}else{e.isFunction(c.errorfunc)&&c.errorfunc.call(p,t,n,r);c.restoreAfterError===!0&&e(p).jqGrid("restoreRow",t,c.afterrestorefunc)}},error:function(n,r){e("#lui_"+p.p.id).hide();if(e.isFunction(c.errorfunc))c.errorfunc.call(p,t,n,r);else try{k.jgrid.info_dialog(k.jgrid.errors.errcap,'<div class="ui-state-error">'+n.responseText+"</div>",k.jgrid.edit.bClose,{buttonalign:"right"})}catch(i){alert(n.responseText)}c.restoreAfterError===!0&&e(p).jqGrid("restoreRow",t,c.afterrestorefunc)}},e.jgrid.ajaxOptions,p.p.ajaxRowOptions||{}));e(w).unbind("keydown")}return h},restoreRow:function(t,n){return this.each(function(){var r=this,i,s,o={};if(r.grid&&(s=e(r).jqGrid("getInd",t,!0),!1!==s)){for(var u=0;u<r.p.savedRow.length;u++)if(r.p.savedRow[u].id==t){i=u;break}if(0<=i){if(e.isFunction(e.fn.datepicker))try{e("input.hasDatepicker","#"+e.jgrid.jqID(s.id)).datepicker("hide")}catch(f){}e.each(r.p.colModel,function(){!0===this.editable&&this.name in r.p.savedRow[i]&&!e(this).hasClass("not-editable-cell")&&(o[this.name]=r.p.savedRow[i][this.name])});e(r).jqGrid("setRowData",t,o);e(s).attr("editable","0").unbind("keydown");r.p.savedRow.splice(i,1)}e.isFunction(n)&&n.call(r,t)}})}})})(k);(function(e){e.jgrid.extend({editCell:function(t,n,r){return this.each(function(){var i=this,s,o,u;if(i.grid&&!0===i.p.cellEdit){n=parseInt(n,10);i.p.selrow=i.rows[t].id;i.p.knv||e(i).jqGrid("GridNav");if(0<i.p.savedRow.length){if(!0===r&&t==i.p.iRow&&n==i.p.iCol)return;e(i).jqGrid("saveCell",i.p.savedRow[0].id,i.p.savedRow[0].ic)}else window.setTimeout(function(){e("#"+i.p.knv).attr("tabindex","-1").focus()},0);s=i.p.colModel[n].name;if("subgrid"!=s&&"cb"!=s&&"rn"!=s){u=e("td:eq("+n+")",i.rows[t]);if(!0===i.p.colModel[n].editable&&!0===r&&!u.hasClass("not-editable-cell")){0<=parseInt(i.p.iCol,10)&&0<=parseInt(i.p.iRow,10)&&(e("td:eq("+i.p.iCol+")",i.rows[i.p.iRow]).removeClass("edit-cell ui-state-highlight"),e(i.rows[i.p.iRow]).removeClass("selected-row ui-state-hover"));e(u).addClass("edit-cell ui-state-highlight");e(i.rows[t]).addClass("selected-row ui-state-hover");try{o=e.unformat(u,{rowId:i.rows[t].id,colModel:i.p.colModel[n]},n)}catch(f){o=e(u).html()}i.p.autoencode&&(o=e.jgrid.htmlDecode(o));i.p.colModel[n].edittype||(i.p.colModel[n].edittype="text");i.p.savedRow.push({id:t,ic:n,name:s,v:o});if(e.isFunction(i.p.formatCell)){var l=i.p.formatCell.call(i,i.rows[t].id,s,o,t,n);void 0!==l&&(o=l)}var l=e.extend({},i.p.colModel[n].editoptions||{},{id:t+"_"+s,name:s}),h=e.jgrid.createEl(i.p.colModel[n].edittype,l,o,!0,e.extend({},e.jgrid.ajaxOptions,i.p.ajaxSelectOptions||{}));e.isFunction(i.p.beforeEditCell)&&i.p.beforeEditCell.call(i,i.rows[t].id,s,o,t,n);e(u).html("").append(h).attr("tabindex","0");window.setTimeout(function(){e(h).focus()},0);e("input, select, textarea",u).bind("keydown",function(r){r.keyCode===27&&(e("input.hasDatepicker",u).length>0?e(".ui-datepicker").is(":hidden")?e(i).jqGrid("restoreCell",t,n):e("input.hasDatepicker",u).datepicker("hide"):e(i).jqGrid("restoreCell",t,n));r.keyCode===13&&e(i).jqGrid("saveCell",t,n);if(r.keyCode==9){if(i.grid.hDiv.loading)return!1;r.shiftKey?e(i).jqGrid("prevCell",t,n):e(i).jqGrid("nextCell",t,n)}r.stopPropagation()});e.isFunction(i.p.afterEditCell)&&i.p.afterEditCell.call(i,i.rows[t].id,s,o,t,n)}else if(0<=parseInt(i.p.iCol,10)&&0<=parseInt(i.p.iRow,10)&&(e("td:eq("+i.p.iCol+")",i.rows[i.p.iRow]).removeClass("edit-cell ui-state-highlight"),e(i.rows[i.p.iRow]).removeClass("selected-row ui-state-hover")),u.addClass("edit-cell ui-state-highlight"),e(i.rows[t]).addClass("selected-row ui-state-hover"),e.isFunction(i.p.onSelectCell))o=u.html().replace(/\&#160\;/ig,""),i.p.onSelectCell.call(i,i.rows[t].id,s,o,t,n);i.p.iCol=n;i.p.iRow=t}}})},saveCell:function(t,n){return this.each(function(){var r=this,i;if(r.grid&&!0===r.p.cellEdit){i=1<=r.p.savedRow.length?0:null;if(null!==i){var s=e("td:eq("+n+")",r.rows[t]),o,u,f=r.p.colModel[n],l=f.name,h=e.jgrid.jqID(l);switch(f.edittype){case"select":if(f.editoptions.multiple){var h=e("#"+t+"_"+h,r.rows[t]),p=[];(o=e(h).val())?o.join(","):o="";e("option:selected",h).each(function(t,n){p[t]=e(n).text()});u=p.join(",")}else o=e("#"+t+"_"+h+">option:selected",r.rows[t]).val(),u=e("#"+t+"_"+h+">option:selected",r.rows[t]).text();f.formatter&&(u=o);break;case"checkbox":var d=["Yes","No"];f.editoptions&&(d=f.editoptions.value.split(":"));u=o=e("#"+t+"_"+h,r.rows[t]).attr("checked")?d[0]:d[1];break;case"password":case"text":case"textarea":case"button":u=o=e("#"+t+"_"+h,r.rows[t]).val();break;case"custom":try{if(!f.editoptions||!e.isFunction(f.editoptions.custom_value))throw"e1";o=f.editoptions.custom_value.call(r,e(".customelement",s),"get");if(void 0===o)throw"e2";u=o}catch(v){"e1"==v&&e.jgrid.info_dialog(k.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.nodefined,k.jgrid.edit.bClose),"e2"==v?e.jgrid.info_dialog(k.jgrid.errors.errcap,"function 'custom_value' "+e.jgrid.edit.msg.novalue,k.jgrid.edit.bClose):e.jgrid.info_dialog(k.jgrid.errors.errcap,v.message,k.jgrid.edit.bClose)}}if(u!=r.p.savedRow[i].v){e.isFunction(r.p.beforeSaveCell)&&(i=r.p.beforeSaveCell.call(r,r.rows[t].id,l,o,t,n))&&(u=o=i);var m=e.jgrid.checkValues(o,n,r);if(!0===m[0]){i={};e.isFunction(r.p.beforeSubmitCell)&&((i=r.p.beforeSubmitCell.call(r,r.rows[t].id,l,o,t,n))||(i={}));0<e("input.hasDatepicker",s).length&&e("input.hasDatepicker",s).datepicker("hide");if("remote"==r.p.cellsubmit)if(r.p.cellurl){var g={};r.p.autoencode&&(o=e.jgrid.htmlEncode(o));g[l]=o;d=r.p.prmNames;f=d.id;h=d.oper;g[f]=r.rows[t].id;g[h]=d.editoper;g=e.extend(i,g);e("#lui_"+r.p.id).show();r.grid.hDiv.loading=!0;e.ajax(e.extend({url:r.p.cellurl,data:e.isFunction(r.p.serializeCellData)?r.p.serializeCellData.call(r,g):g,type:"POST",complete:function(i,f){e("#lui_"+r.p.id).hide();r.grid.hDiv.loading=!1;if("success"==f)if(e.isFunction(r.p.afterSubmitCell)){var h=r.p.afterSubmitCell.call(r,i,g.id,l,o,t,n);!0===h[0]?(e(s).empty(),e(r).jqGrid("setCell",r.rows[t].id,n,u,!1,!1,!0),e(s).addClass("dirty-cell"),e(r.rows[t]).addClass("edited"),e.isFunction(r.p.afterSaveCell)&&r.p.afterSaveCell.call(r,r.rows[t].id,l,o,t,n),r.p.savedRow.splice(0,1)):(e.jgrid.info_dialog(e.jgrid.errors.errcap,h[1],e.jgrid.edit.bClose),e(r).jqGrid("restoreCell",t,n))}else e(s).empty(),e(r).jqGrid("setCell",r.rows[t].id,n,u,!1,!1,!0),e(s).addClass("dirty-cell"),e(r.rows[t]).addClass("edited"),e.isFunction(r.p.afterSaveCell)&&r.p.afterSaveCell.call(r,r.rows[t].id,l,o,t,n),r.p.savedRow.splice(0,1)},error:function(i,s){e("#lui_"+r.p.id).hide();r.grid.hDiv.loading=!1;e.isFunction(r.p.errorCell)?r.p.errorCell.call(r,i,s):e.jgrid.info_dialog(e.jgrid.errors.errcap,i.status+" : "+i.statusText+"<br/>"+s,e.jgrid.edit.bClose);e(r).jqGrid("restoreCell",t,n)}},e.jgrid.ajaxOptions,r.p.ajaxCellOptions||{}))}else try{e.jgrid.info_dialog(e.jgrid.errors.errcap,e.jgrid.errors.nourl,e.jgrid.edit.bClose),e(r).jqGrid("restoreCell",t,n)}catch(y){}"clientArray"==r.p.cellsubmit&&(e(s).empty(),e(r).jqGrid("setCell",r.rows[t].id,n,u,!1,!1,!0),e(s).addClass("dirty-cell"),e(r.rows[t]).addClass("edited"),e.isFunction(r.p.afterSaveCell)&&r.p.afterSaveCell.call(r,r.rows[t].id,l,o,t,n),r.p.savedRow.splice(0,1))}else try{window.setTimeout(function(){e.jgrid.info_dialog(e.jgrid.errors.errcap,o+" "+m[1],e.jgrid.edit.bClose)},100),e(r).jqGrid("restoreCell",t,n)}catch(b){}}else e(r).jqGrid("restoreCell",t,n)}e.browser.opera?e("#"+r.p.knv).attr("tabindex","-1").focus():window.setTimeout(function(){e("#"+r.p.knv).attr("tabindex","-1").focus()},0)}})},restoreCell:function(t,n){return this.each(function(){var r=this,i;if(r.grid&&!0===r.p.cellEdit){i=1<=r.p.savedRow.length?0:null;if(null!==i){var s=e("td:eq("+n+")",r.rows[t]);if(e.isFunction(e.fn.datepicker))try{e("input.hasDatepicker",s).datepicker("hide")}catch(o){}e(s).empty().attr("tabindex","-1");e(r).jqGrid("setCell",r.rows[t].id,n,r.p.savedRow[i].v,!1,!1,!0);e.isFunction(r.p.afterRestoreCell)&&r.p.afterRestoreCell.call(r,r.rows[t].id,r.p.savedRow[i].v,t,n);r.p.savedRow.splice(0,1)}window.setTimeout(function(){e("#"+r.p.knv).attr("tabindex","-1").focus()},0)}})},nextCell:function(t,n){return this.each(function(){var r=!1;if(this.grid&&!0===this.p.cellEdit){for(var i=n+1;i<this.p.colModel.length;i++)if(!0===this.p.colModel[i].editable){r=i;break}!1!==r?e(this).jqGrid("editCell",t,r,!0):0<this.p.savedRow.length&&e(this).jqGrid("saveCell",t,n)}})},prevCell:function(t,n){return this.each(function(){var r=!1;if(this.grid&&!0===this.p.cellEdit){for(var i=n-1;0<=i;i--)if(!0===this.p.colModel[i].editable){r=i;break}!1!==r?e(this).jqGrid("editCell",t,r,!0):0<this.p.savedRow.length&&e(this).jqGrid("saveCell",t,n)}})},GridNav:function(){return this.each(function(){function t(t,n,i){if("v"==i.substr(0,1)){var s=e(r.grid.bDiv)[0].clientHeight,o=e(r.grid.bDiv)[0].scrollTop,u=r.rows[t].offsetTop+r.rows[t].clientHeight,f=r.rows[t].offsetTop;"vd"==i&&u>=s&&(e(r.grid.bDiv)[0].scrollTop=e(r.grid.bDiv)[0].scrollTop+r.rows[t].clientHeight);"vu"==i&&f<o&&(e(r.grid.bDiv)[0].scrollTop=e(r.grid.bDiv)[0].scrollTop-r.rows[t].clientHeight)}"h"==i&&(i=e(r.grid.bDiv)[0].clientWidth,s=e(r.grid.bDiv)[0].scrollLeft,o=r.rows[t].cells[n].offsetLeft,r.rows[t].cells[n].offsetLeft+r.rows[t].cells[n].clientWidth>=i+parseInt(s,10)?e(r.grid.bDiv)[0].scrollLeft=e(r.grid.bDiv)[0].scrollLeft+r.rows[t].cells[n].clientWidth:o<s&&(e(r.grid.bDiv)[0].scrollLeft=e(r.grid.bDiv)[0].scrollLeft-r.rows[t].cells[n].clientWidth))}function n(e,t){var n,i;if("lft"==t){n=e+1;for(i=e;0<=i;i--)if(!0!==r.p.colModel[i].hidden){n=i;break}}if("rgt"==t){n=e-1;for(i=e;i<r.p.colModel.length;i++)if(!0!==r.p.colModel[i].hidden){n=i;break}}return n}var r=this;if(r.grid&&!0===r.p.cellEdit){r.p.knv=r.p.id+"_kn";var i=e("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+r.p.knv+"'></span></span>"),s,o;e(i).insertBefore(r.grid.cDiv);e("#"+r.p.knv).focus().keydown(function(i){o=i.keyCode;"rtl"==r.p.direction&&(37==o?o=39:39==o&&(o=37));switch(o){case 38:0<r.p.iRow-1&&(t(r.p.iRow-1,r.p.iCol,"vu"),e(r).jqGrid("editCell",r.p.iRow-1,r.p.iCol,!1));break;case 40:r.p.iRow+1<=r.rows.length-1&&(t(r.p.iRow+1,r.p.iCol,"vd"),e(r).jqGrid("editCell",r.p.iRow+1,r.p.iCol,!1));break;case 37:0<=r.p.iCol-1&&(s=n(r.p.iCol-1,"lft"),t(r.p.iRow,s,"h"),e(r).jqGrid("editCell",r.p.iRow,s,!1));break;case 39:r.p.iCol+1<=r.p.colModel.length-1&&(s=n(r.p.iCol+1,"rgt"),t(r.p.iRow,s,"h"),e(r).jqGrid("editCell",r.p.iRow,s,!1));break;case 13:0<=parseInt(r.p.iCol,10)&&0<=parseInt(r.p.iRow,10)&&e(r).jqGrid("editCell",r.p.iRow,r.p.iCol,!0)}return!1})}})},getChangedCells:function(t){var n=[];t||(t="all");this.each(function(){var r=this,i;!r.grid||!0!==r.p.cellEdit||e(r.rows).each(function(s){var o={};e(this).hasClass("edited")&&(e("td",this).each(function(n){i=r.p.colModel[n].name;if("cb"!==i&&"subgrid"!==i)if("dirty"==t){if(e(this).hasClass("dirty-cell"))try{o[i]=e.unformat(this,{rowId:r.rows[s].id,colModel:r.p.colModel[n]},n)}catch(u){o[i]=e.jgrid.htmlDecode(e(this).html())}}else try{o[i]=e.unformat(this,{rowId:r.rows[s].id,colModel:r.p.colModel[n]},n)}catch(c){o[i]=e.jgrid.htmlDecode(e(this).html())}}),o.id=this.id,n.push(o))})});return n}})})(k);(function(e){e.fn.jqm=function(r){var i={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:s,ajaxText:"",target:s,modal:s,toTop:s,onShow:s,onHide:s,onLoad:s};return this.each(function(){if(this._jqm)return n[this._jqm].c=e.extend({},n[this._jqm].c,r);t++;this._jqm=t;n[t]={c:e.extend(i,e.jqm.params,r),a:s,w:e(this).addClass("jqmID"+t),s:t};i.trigger&&e(this).jqmAddTrigger(i.trigger)})};e.fn.jqmAddClose=function(e){return l(this,e,"jqmHide")};e.fn.jqmAddTrigger=function(e){return l(this,e,"jqmShow")};e.fn.jqmShow=function(t){return this.each(function(){e.jqm.open(this._jqm,t)})};e.fn.jqmHide=function(t){return this.each(function(){e.jqm.close(this._jqm,t)})};e.jqm={hash:{},open:function(t,u){var f=n[t],l=f.c,h="."+l.closeClass,p=parseInt(f.w.css("z-index")),p=0<p?p:3e3,v=e("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":p-1,opacity:l.overlay/100});if(f.a)return s;f.t=u;f.a=!0;f.w.css("z-index",p);l.modal?(r[0]||setTimeout(function(){a("bind")},1),r.push(t)):0<l.overlay?l.closeoverlay&&f.w.jqmAddClose(v):v=s;f.o=v?v.addClass(l.overlayClass).prependTo("body"):s;if(i&&(e("html,body").css({height:"100%",width:"100%"}),v)){var v=v.css({position:"absolute"})[0],m;for(m in{Top:1,Left:1})v.style.setExpression(m.toLowerCase(),"(_=(document.documentElement.scroll"+m+" || document.body.scroll"+m+"))+'px'")}l.ajax?(p=l.target||f.w,v=l.ajax,p="string"==typeof p?e(p,f.w):e(p),v="@"==v.substr(0,1)?e(u).attr(v.substring(1)):v,p.html(l.ajaxText).load(v,function(){l.onLoad&&l.onLoad.call(this,f);h&&f.w.jqmAddClose(e(h,f.w));o(f)})):h&&f.w.jqmAddClose(e(h,f.w));l.toTop&&f.o&&f.w.before('<span id="jqmP'+f.w[0]._jqm+'"></span>').insertAfter(f.o);l.onShow?l.onShow(f):f.w.show();o(f);return s},close:function(t){t=n[t];if(!t.a)return s;t.a=s;r[0]&&(r.pop(),r[0]||a("unbind"));t.c.toTop&&t.o&&e("#jqmP"+t.w[0]._jqm).after(t.w).remove();t.c.onHide?t.c.onHide(t):(t.w.hide(),t.o&&t.o.remove());return s},params:{}};var t=0,n=e.jqm.hash,r=[],i=e.browser.msie&&"6.0"==e.browser.version,s=!1,o=function(t){var n=e('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0});i&&(t.o?t.o.html('<p style="width:100%;height:100%"/>').prepend(n):e("iframe.jqm",t.w)[0]||t.w.prepend(n));u(t)},u=function(t){try{e(":input:visible",t.w)[0].focus()}catch(n){}},a=function(t){e(document)[t]("keypress",f)[t]("keydown",f)[t]("mousedown",f)},f=function(t){var i=n[r[r.length-1]];(t=!e(t.target).parents(".jqmID"+i.s)[0])&&u(i);return!t},l=function(t,r,i){return t.each(function(){var t=this._jqm;e(r).each(function(){this[i]||(this[i]=[],e(this).click(function(){for(var e in{jqmShow:1,jqmHide:1})for(var t in this[e])n[this[e][t]]&&n[this[e][t]].w[e](this);return s}));this[i].push(t)})})}})(k);(function(e){e.fn.jqDrag=function(e){return s(this,e,"d")};e.fn.jqResize=function(e,t){return s(this,e,"r",t)};e.jqDnR={dnr:{},e:0,drag:function(e){"d"==n.k?r.css({left:n.X+e.pageX-n.pX,top:n.Y+e.pageY-n.pY}):(r.css({width:Math.max(e.pageX-n.pX+n.W,0),height:Math.max(e.pageY-n.pY+n.H,0)}),M1&&i.css({width:Math.max(e.pageX-M1.pX+M1.W,0),height:Math.max(e.pageY-M1.pY+M1.H,0)}));return!1},stop:function(){e(document).unbind("mousemove",t.drag).unbind("mouseup",t.stop)}};var t=e.jqDnR,n=t.dnr,r=t.e,i,s=function(t,s,u,l){return t.each(function(){s=s?e(s,t):t;s.bind("mousedown",{e:t,k:u},function(t){var s=t.data,u={};r=s.e;i=l?e(l):!1;if("relative"!=r.css("position"))try{r.position(u)}catch(h){}n={X:u.left||o("left")||0,Y:u.top||o("top")||0,W:o("width")||r[0].scrollWidth||0,H:o("height")||r[0].scrollHeight||0,pX:t.pageX,pY:t.pageY,k:s.k};M1=i&&"d"!=s.k?{X:u.left||f1("left")||0,Y:u.top||f1("top")||0,W:i[0].offsetWidth||f1("width")||0,H:i[0].offsetHeight||f1("height")||0,pX:t.pageX,pY:t.pageY,k:s.k}:!1;if(e("input.hasDatepicker",r[0])[0])try{e("input.hasDatepicker",r[0]).datepicker("hide")}catch(p){}e(document).mousemove(e.jqDnR.drag).mouseup(e.jqDnR.stop);return!1})})},o=function(e){return parseInt(r.css(e))||!1};f1=function(e){return parseInt(i.css(e))||!1}})(k);(function(e){e.jgrid.extend({setSubGrid:function(){return this.each(function(){var t;this.p.subGridOptions=e.extend({plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:!1,delayOnLoad:50,selectOnExpand:!1,reloadOnExpand:!0},this.p.subGridOptions||{});this.p.colNames.unshift("");this.p.colModel.unshift({name:"subgrid",width:e.browser.safari?this.p.subGridWidth+this.p.cellLayout:this.p.subGridWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,fixed:!0});t=this.p.subGridModel;if(t[0]){t[0].align=e.extend([],t[0].align||[]);for(var n=0;n<t[0].name.length;n++)t[0].align[n]=t[0].align[n]||"left"}})},addSubGridCell:function(e,t){var n="",r,i;this.each(function(){n=this.formatCol(e,t);i=this.p.id;r=this.p.subGridOptions.plusicon});return'<td role="grid" aria-describedby="'+i+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+n+"><a href='javascript:void(0);'><span class='ui-icon "+r+"'></span></a></td>"},addSubGrid:function(t){return this.each(function(){var n=this;if(n.grid){var r=function(t,r,i){r=e("<td align='"+n.p.subGridModel[0].align[i]+"'></td>").html(r);e(t).append(r)},i=function(t,i){var s,o,u,f=e("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),l=e("<tr></tr>");for(o=0;o<n.p.subGridModel[0].name.length;o++)s=e("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+n.p.direction+"'></th>"),e(s).html(n.p.subGridModel[0].name[o]),e(s).width(n.p.subGridModel[0].width[o]),e(l).append(s);e(f).append(l);t&&(u=n.p.xmlReader.subgrid,e(u.root+" "+u.row,t).each(function(){l=e("<tr class='ui-widget-content ui-subtblcell'></tr>");if(!0===u.repeatitems)e(u.cell,this).each(function(t){r(l,e(this).text()||"&#160;",t)});else{var t=n.p.subGridModel[0].mapping||n.p.subGridModel[0].name;if(t)for(o=0;o<t.length;o++)r(l,e(t[o],this).text()||"&#160;",o)}e(f).append(l)}));s=e("table:first",n.grid.bDiv).attr("id")+"_";e("#"+s+i).append(f);n.grid.hDiv.loading=!1;e("#load_"+n.p.id).hide();return!1},s=function(t,i){var s,o,u,f,l,c=e("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),h=e("<tr></tr>");for(o=0;o<n.p.subGridModel[0].name.length;o++)s=e("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+n.p.direction+"'></th>"),e(s).html(n.p.subGridModel[0].name[o]),e(s).width(n.p.subGridModel[0].width[o]),e(h).append(s);e(c).append(h);if(t&&(f=n.p.jsonReader.subgrid,s=t[f.root],"undefined"!=typeof s))for(o=0;o<s.length;o++){u=s[o];h=e("<tr class='ui-widget-content ui-subtblcell'></tr>");if(!0===f.repeatitems){f.cell&&(u=u[f.cell]);for(l=0;l<u.length;l++)r(h,u[l]||"&#160;",l)}else{var p=n.p.subGridModel[0].mapping||n.p.subGridModel[0].name;if(p.length)for(l=0;l<p.length;l++)r(h,u[p[l]]||"&#160;",l)}e(c).append(h)}o=e("table:first",n.grid.bDiv).attr("id")+"_";e("#"+o+i).append(c);n.grid.hDiv.loading=!1;e("#load_"+n.p.id).hide();return!1},o=function(t){var r,o,u,f;r=e(t).attr("id");o={nd_:(new Date).getTime()};o[n.p.prmNames.subgridid]=r;if(!n.p.subGridModel[0])return!1;if(n.p.subGridModel[0].params)for(f=0;f<n.p.subGridModel[0].params.length;f++)for(u=0;u<n.p.colModel.length;u++)n.p.colModel[u].name==n.p.subGridModel[0].params[f]&&(o[n.p.colModel[u].name]=e("td:eq("+u+")",t).text().replace(/\&#160\;/ig,""));if(!n.grid.hDiv.loading)switch(n.grid.hDiv.loading=!0,e("#load_"+n.p.id).show(),n.p.subgridtype||(n.p.subgridtype=n.p.datatype),e.isFunction(n.p.subgridtype)?n.p.subgridtype.call(n,o):n.p.subgridtype=n.p.subgridtype.toLowerCase(),n.p.subgridtype){case"xml":case"json":e.ajax(e.extend({type:n.p.mtype,url:n.p.subGridUrl,dataType:n.p.subgridtype,data:e.isFunction(n.p.serializeSubGridData)?n.p.serializeSubGridData.call(n,o):o,complete:function(t){n.p.subgridtype=="xml"?i(t.responseXML,r):s(e.jgrid.parse(t.responseText),r)}},e.jgrid.ajaxOptions,n.p.ajaxSubgridOptions||{}))}return!1},u,f,l,c=0,h,p;e.each(n.p.colModel,function(){(!0===this.hidden||"rn"==this.name||"cb"==this.name)&&c++});e(n.rows).each(function(r){var i=this;e(i).hasClass("jqgrow")&&(e(this.cells[t]).bind("click",function(){p=i.nextSibling;if(e(this).hasClass("sgcollapsed")){f=n.p.id;u=i.id;if(!0===n.p.subGridOptions.reloadOnExpand||!1===n.p.subGridOptions.reloadOnExpand&&!e(p).hasClass("ui-subgrid")){l=1<=t?"<td colspan='"+t+"'>&#160;</td>":"";h=!0;e.isFunction(n.p.subGridBeforeExpand)&&(h=n.p.subGridBeforeExpand.call(n,f+"_"+u,u));if(!1===h)return!1;e(i).after("<tr role='row' class='ui-subgrid'>"+l+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+n.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(n.p.colNames.length-1-c,10)+"' class='ui-widget-content subgrid-data'><div id="+f+"_"+u+" class='tablediv'></div></td></tr>");e.isFunction(n.p.subGridRowExpanded)?n.p.subGridRowExpanded.call(n,f+"_"+u,u):o(i)}else e(p).show();e(this).html("<a href='javascript:void(0);'><span class='ui-icon "+n.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded");n.p.subGridOptions.selectOnExpand&&e(n).jqGrid("setSelection",u)}else if(e(this).hasClass("sgexpanded")){h=!0;e.isFunction(n.p.subGridRowColapsed)&&(u=i.id,h=n.p.subGridRowColapsed.call(n,f+"_"+u,u));if(!1===h)return!1;!0===n.p.subGridOptions.reloadOnExpand?e(p).remove(".ui-subgrid"):e(p).hasClass("ui-subgrid")&&e(p).hide();e(this).html("<a href='javascript:void(0);'><span class='ui-icon "+n.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}return!1}),!0===n.p.subGridOptions.expandOnLoad&&setTimeout(function(){e(i.cells[t]).trigger("click")},r*n.p.subGridOptions.delayOnLoad))});n.subGridXml=function(e,t){i(e,t)};n.subGridJson=function(e,t){s(e,t)}}})},expandSubGridRow:function(t){return this.each(function(){if((this.grid||t)&&!0===this.p.subGrid){var n=e(this).jqGrid("getInd",t,!0);n&&(n=e("td.sgcollapsed",n)[0])&&e(n).trigger("click")}})},collapseSubGridRow:function(t){return this.each(function(){if((this.grid||t)&&!0===this.p.subGrid){var n=e(this).jqGrid("getInd",t,!0);n&&(n=e("td.sgexpanded",n)[0])&&e(n).trigger("click")}})},toggleSubGridRow:function(t){return this.each(function(){if((this.grid||t)&&!0===this.p.subGrid){var n=e(this).jqGrid("getInd",t,!0);if(n){var r=e("td.sgcollapsed",n)[0];r?e(r).trigger("click"):(r=e("td.sgexpanded",n)[0])&&e(r).trigger("click")}}})}})})(k);(function(e){e.jgrid.extend({groupingSetup:function(){return this.each(function(){var t=this.p.groupingView;if(null===t||"object"!=typeof t&&!e.isFunction(t))this.p.grouping=!1;else if(t.groupField.length){"undefined"==typeof t.visibiltyOnNextGrouping&&(t.visibiltyOnNextGrouping=[]);for(var n=0;n<t.groupField.length;n++)if(t.groupOrder[n]||(t.groupOrder[n]="asc"),t.groupText[n]||(t.groupText[n]="{0}"),"boolean"!=typeof t.groupColumnShow[n]&&(t.groupColumnShow[n]=!0),"boolean"!=typeof t.groupSummary[n]&&(t.groupSummary[n]=!1),!0===t.groupColumnShow[n]?(t.visibiltyOnNextGrouping[n]=!0,e(this).jqGrid("showCol",t.groupField[n])):(t.visibiltyOnNextGrouping[n]=e("#"+this.p.id+"_"+t.groupField[n]).is(":visible"),e(this).jqGrid("hideCol",t.groupField[n])),t.sortitems[n]=[],t.sortnames[n]=[],t.summaryval[n]=[],t.groupSummary[n]){t.summary[n]=[];for(var r=this.p.colModel,i=0,s=r.length;i<s;i++)r[i].summaryType&&t.summary[n].push({nm:r[i].name,st
:r[i].summaryType,v:""})}this.p.scroll=!1;this.p.rownumbers=!1;this.p.subGrid=!1;this.p.treeGrid=!1;this.p.gridview=!0}else this.p.grouping=!1})},groupingPrepare:function(t,n,r,i){this.each(function(){n[0]+="";var s=n[0].toString().split(" ").join(""),o=this.p.groupingView,u=this;r.hasOwnProperty(s)?r[s].push(t):(r[s]=[],r[s].push(t),o.sortitems[0].push(s),o.sortnames[0].push(e.trim(n[0].toString())),o.summaryval[0][s]=e.extend(!0,[],o.summary[0]));o.groupSummary[0]&&e.each(o.summaryval[0][s],function(){this.v=e.isFunction(this.st)?this.st.call(u,this.v,this.nm,i):e(u).jqGrid("groupingCalculations."+this.st,this.v,this.nm,i)})});return r},groupingToggle:function(t){this.each(function(){var n=this.p.groupingView,r=t.lastIndexOf("_"),i=t.substring(0,r+1),r=parseInt(t.substring(r+1),10)+1,s=n.minusicon,o=n.plusicon,u=e("#"+t)[0].nextSibling,f=e("#"+t+" span.tree-wrap-"+this.p.direction),l=!1;if(f.hasClass(s)){if(n.showSummaryOnHide&&n.groupSummary[0]){if(u)for(;u&&!e(u).hasClass("jqfoot");)e(u).hide(),u=u.nextSibling}else if(u)for(;u&&e(u).attr("id")!=i+(""+r);)e(u).hide(),u=u.nextSibling;f.removeClass(s).addClass(o);l=!0}else{if(u)for(;u&&e(u).attr("id")!=i+(""+r);)e(u).show(),u=u.nextSibling;f.removeClass(o).addClass(s);l=!1}e.isFunction(this.p.onClickGroup)&&this.p.onClickGroup.call(this,t,l)});return!1},groupingRender:function(t,n){return this.each(function(){var r=this,i=r.p.groupingView,s="",o="",u,f="",l,h,p;i.groupDataSorted||(i.sortitems[0].sort(),i.sortnames[0].sort(),"desc"==i.groupOrder[0].toLowerCase()&&(i.sortitems[0].reverse(),i.sortnames[0].reverse()));f=i.groupCollapse?i.plusicon:i.minusicon;f+=" tree-wrap-"+r.p.direction;for(p=0;p<n;){if(r.p.colModel[p].name==i.groupField[0]){h=p;break}p++}e.each(i.sortitems[0],function(p,v){u=r.p.id+"ghead_"+p;o="<span style='cursor:pointer;' class='ui-icon "+f+"' onclick=\"jQuery('#"+r.p.id+"').jqGrid('groupingToggle','"+u+"');return false;\"></span>";try{l=r.formatter(u,i.sortnames[0][p],h,i.sortitems[0])}catch(m){l=i.sortnames[0][p]}s+='<tr id="'+u+'" role="row" class= "ui-widget-content jqgroup ui-row-'+r.p.direction+'"><td colspan="'+n+'">'+o+e.jgrid.format(i.groupText[0],l,t[v].length)+"</td></tr>";for(var y=0;y<t[v].length;y++)s+=t[v][y].join("");if(i.groupSummary[0]){y="";i.groupCollapse&&!i.showSummaryOnHide&&(y=' style="display:none;"');s+="<tr"+y+' role="row" class="ui-widget-content jqfoot ui-row-'+r.p.direction+'">';for(var y=i.summaryval[0][v],w=r.p.colModel,E,S=t[v].length,x=0;x<n;x++){var T="<td "+r.formatCol(x,1,"")+">&#160;</td>",N="{0}";e.each(y,function(){if(this.nm==w[x].name){w[x].summaryTpl&&(N=w[x].summaryTpl);this.st=="avg"&&this.v&&S>0&&(this.v=this.v/S);try{E=r.formatter("",this.v,x,this)}catch(t){E=this.v}T="<td "+r.formatCol(x,1,"")+">"+e.jgrid.format(N,E)+"</td>";return!1}});s+=T}s+="</tr>"}});e("#"+r.p.id+" tbody:first").append(s);s=null})},groupingGroupBy:function(t,n){return this.each(function(){"string"==typeof t&&(t=[t]);var r=this.p.groupingView;this.p.grouping=!0;for(var i=0;i<r.groupField.length;i++)!r.groupColumnShow[i]&&r.visibiltyOnNextGrouping[i]&&e(this).jqGrid("showCol",r.groupField[i]);for(i=0;i<t.length;i++)r.visibiltyOnNextGrouping[i]=e("#"+this.p.id+"_"+t[i]).is(":visible");this.p.groupingView=e.extend(this.p.groupingView,n||{});r.groupField=t;e(this).trigger("reloadGrid")})},groupingRemove:function(t){return this.each(function(){"undefined"==typeof t&&(t=!0);this.p.grouping=!1;if(!0===t){for(var n=this.p.groupingView,r=0;r<n.groupField.length;r++)!n.groupColumnShow[r]&&n.visibiltyOnNextGrouping[r]&&e(this).jqGrid("showCol",n.groupField);e("tr.jqgroup, tr.jqfoot","#"+this.p.id+" tbody:first").remove();e("tr.jqgrow:hidden","#"+this.p.id+" tbody:first").show()}else e(this).trigger("reloadGrid")})},groupingCalculations:{sum:function(e,t,n){return parseFloat(e||0)+parseFloat(n[t]||0)},min:function(e,t,n){return""===e?parseFloat(n[t]||0):Math.min(parseFloat(e),parseFloat(n[t]||0))},max:function(e,t,n){return""===e?parseFloat(n[t]||0):Math.max(parseFloat(e),parseFloat(n[t]||0))},count:function(e,t,n){""===e&&(e=0);return n.hasOwnProperty(t)?e+1:0},avg:function(e,t,n){return parseFloat(e||0)+parseFloat(n[t]||0)}}})})(k);(function(e){e.jgrid.extend({setTreeNode:function(t,n){return this.each(function(){var r=this;if(r.grid&&r.p.treeGrid)for(var i=r.p.expColInd,s=r.p.treeReader.expanded_field,o=r.p.treeReader.leaf_field,u=r.p.treeReader.level_field,f=r.p.treeReader.icon_field,l=r.p.treeReader.loaded,h,p,d,v;t<n;)v=r.p.data[r.p._index[r.rows[t].id]],"nested"==r.p.treeGridModel&&!v[o]&&(h=parseInt(v[r.p.treeReader.left_field],10),p=parseInt(v[r.p.treeReader.right_field],10),v[o]=p===h+1?"true":"false",r.rows[t].cells[r.p._treeleafpos].innerHTML=v[o]),h=parseInt(v[u],10),0===r.p.tree_root_level?(d=h+1,p=h):(d=h,p=h-1),d="<div class='tree-wrap tree-wrap-"+r.p.direction+"' style='width:"+18*d+"px;'>",d+="<div style='"+("rtl"==r.p.direction?"right:":"left:")+18*p+"px;' class='ui-icon ",void 0!==v[l]&&(v[l]="true"==v[l]||!0===v[l]?!0:!1),"true"==v[o]||!0===v[o]?(d+=(void 0!==v[f]&&""!==v[f]?v[f]:r.p.treeIcons.leaf)+" tree-leaf treeclick'",v[o]=!0,p="leaf"):(v[o]=!1,p=""),v[s]=("true"==v[s]||!0===v[s]?!0:!1)&&v[l],d+=!0===v[s]?r.p.treeIcons.minus+" tree-minus treeclick'":r.p.treeIcons.plus+" tree-plus treeclick'",d+="</div></div>",e(r.rows[t].cells[i]).wrapInner("<span class='cell-wrapper"+p+"'></span>").prepend(d),h!==parseInt(r.p.tree_root_level,10)&&((v=(v=e(r).jqGrid("getNodeParent",v))&&v.hasOwnProperty(s)?v[s]:!0)||e(r.rows[t]).css("display","none")),e(r.rows[t].cells[i]).find("div.treeclick").bind("click",function(t){t=e(t.target||t.srcElement,r.rows).closest("tr.jqgrow")[0].id;t=r.p._index[t];if(!r.p.data[t][o])if(r.p.data[t][s]){e(r).jqGrid("collapseRow",r.p.data[t]);e(r).jqGrid("collapseNode",r.p.data[t])}else{e(r).jqGrid("expandRow",r.p.data[t]);e(r).jqGrid("expandNode",r.p.data[t])}return!1}),!0===r.p.ExpandColClick&&e(r.rows[t].cells[i]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(t){var t=e(t.target||t.srcElement,r.rows).closest("tr.jqgrow")[0].id,n=r.p._index[t];if(!r.p.data[n][o])if(r.p.data[n][s]){e(r).jqGrid("collapseRow",r.p.data[n]);e(r).jqGrid("collapseNode",r.p.data[n])}else{e(r).jqGrid("expandRow",r.p.data[n]);e(r).jqGrid("expandNode",r.p.data[n])}e(r).jqGrid("setSelection",t);return!1}),t++})},setTreeGrid:function(){return this.each(function(){var t=this,n=0,r=!1,i,s,o=[];if(t.p.treeGrid){t.p.treedatatype||e.extend(t.p,{treedatatype:t.p.datatype});t.p.subGrid=!1;t.p.altRows=!1;t.p.pgbuttons=!1;t.p.pginput=!1;t.p.gridview=!0;t.p.multiselect=!1;t.p.rowList=[];t.p.expColInd=0;t.p.treeIcons=e.extend({plus:"ui-icon-triangle-1-"+("rtl"==t.p.direction?"w":"e"),minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},t.p.treeIcons||{});"nested"==t.p.treeGridModel?t.p.treeReader=e.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},t.p.treeReader):"adjacency"==t.p.treeGridModel&&(t.p.treeReader=e.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},t.p.treeReader));for(s in t.p.colModel)if(t.p.colModel.hasOwnProperty(s)){i=t.p.colModel[s].name;i==t.p.ExpandColumn&&!r&&(r=!0,t.p.expColInd=n);n++;for(var u in t.p.treeReader)t.p.treeReader[u]==i&&o.push(i)}e.each(t.p.treeReader,function(r,i){if(i&&e.inArray(i,o)===-1){r==="leaf_field"&&(t.p._treeleafpos=n);n++;t.p.colNames.push(i);t.p.colModel.push({name:i,width:1,hidden:!0,sortable:!1,resizable:!1,hidedlg:!0,editable:!0,search:!1})}})}})},expandRow:function(t){this.each(function(){var n=this;if(n.grid&&n.p.treeGrid){var r=e(n).jqGrid("getNodeChildren",t),i=n.p.treeReader.expanded_field;e(r).each(function(){var t=e.jgrid.getAccessor(this,n.p.localReader.id);e("#"+t,n.grid.bDiv).css("display","");this[i]&&e(n).jqGrid("expandRow",this)})}})},collapseRow:function(t){this.each(function(){var n=this;if(n.grid&&n.p.treeGrid){var r=e(n).jqGrid("getNodeChildren",t),i=n.p.treeReader.expanded_field;e(r).each(function(){var t=e.jgrid.getAccessor(this,n.p.localReader.id);e("#"+t,n.grid.bDiv).css("display","none");this[i]&&e(n).jqGrid("collapseRow",this)})}})},getRootNodes:function(){var t=[];this.each(function(){var n=this;if(n.grid&&n.p.treeGrid)switch(n.p.treeGridModel){case"nested":var r=n.p.treeReader.level_field;e(n.p.data).each(function(){parseInt(this[r],10)===parseInt(n.p.tree_root_level,10)&&t.push(this)});break;case"adjacency":var i=n.p.treeReader.parent_id_field;e(n.p.data).each(function(){(null===this[i]||"null"==(""+this[i]).toLowerCase())&&t.push(this)})}});return t},getNodeDepth:function(t){var n=null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case"nested":n=parseInt(t[this.p.treeReader.level_field],10)-parseInt(this.p.tree_root_level,10);break;case"adjacency":n=e(this).jqGrid("getNodeAncestors",t).length}});return n},getNodeParent:function(t){var n=null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case"nested":var r=this.p.treeReader.left_field,i=this.p.treeReader.right_field,s=this.p.treeReader.level_field,o=parseInt(t[r],10),u=parseInt(t[i],10),f=parseInt(t[s],10);e(this.p.data).each(function(){if(parseInt(this[s],10)===f-1&&parseInt(this[r],10)<o&&parseInt(this[i],10)>u)return n=this,!1});break;case"adjacency":var l=this.p.treeReader.parent_id_field,h=this.p.localReader.id;e(this.p.data).each(function(){if(this[h]==t[l])return n=this,!1})}});return n},getNodeChildren:function(t){var n=[];this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case"nested":var r=this.p.treeReader.left_field,i=this.p.treeReader.right_field,s=this.p.treeReader.level_field,o=parseInt(t[r],10),u=parseInt(t[i],10),f=parseInt(t[s],10);e(this.p.data).each(function(){parseInt(this[s],10)===f+1&&parseInt(this[r],10)>o&&parseInt(this[i],10)<u&&n.push(this)});break;case"adjacency":var l=this.p.treeReader.parent_id_field,h=this.p.localReader.id;e(this.p.data).each(function(){this[l]==t[h]&&n.push(this)})}});return n},getFullTreeNode:function(t){var n=[];this.each(function(){var r;if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case"nested":var i=this.p.treeReader.left_field,s=this.p.treeReader.right_field,o=this.p.treeReader.level_field,u=parseInt(t[i],10),f=parseInt(t[s],10),l=parseInt(t[o],10);e(this.p.data).each(function(){parseInt(this[o],10)>=l&&parseInt(this[i],10)>=u&&parseInt(this[i],10)<=f&&n.push(this)});break;case"adjacency":if(t){n.push(t);var h=this.p.treeReader.parent_id_field,p=this.p.localReader.id;e(this.p.data).each(function(e){r=n.length;for(e=0;e<r;e++)if(n[e][p]==this[h]){n.push(this);break}})}}});return n},getNodeAncestors:function(t){var n=[];this.each(function(){if(this.grid&&this.p.treeGrid)for(var r=e(this).jqGrid("getNodeParent",t);r;)n.push(r),r=e(this).jqGrid("getNodeParent",r)});return n},isVisibleNode:function(t){var n=!0;this.each(function(){if(this.grid&&this.p.treeGrid){var r=e(this).jqGrid("getNodeAncestors",t),i=this.p.treeReader.expanded_field;e(r).each(function(){n=n&&this[i];if(!n)return!1})}});return n},isNodeLoaded:function(t){var n;this.each(function(){if(this.grid&&this.p.treeGrid){var r=this.p.treeReader.leaf_field;n=void 0!==t?void 0!==t.loaded?t.loaded:t[r]||0<e(this).jqGrid("getNodeChildren",t).length?!0:!1:!1}});return n},expandNode:function(t){return this.each(function(){if(this.grid&&this.p.treeGrid){var n=this.p.treeReader.expanded_field,r=this.p.treeReader.parent_id_field,i=this.p.treeReader.loaded,s=this.p.treeReader.level_field,o=this.p.treeReader.left_field,u=this.p.treeReader.right_field;if(!t[n]){var f=e.jgrid.getAccessor(t,this.p.localReader.id),l=e("#"+f,this.grid.bDiv)[0],c=this.p._index[f];e(this).jqGrid("isNodeLoaded",this.p.data[c])?(t[n]=!0,e("div.treeclick",l).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")):(t[n]=!0,e("div.treeclick",l).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus"),this.p.treeANode=l.rowIndex,this.p.datatype=this.p.treedatatype,"nested"==this.p.treeGridModel?e(this).jqGrid("setGridParam",{postData:{nodeid:f,n_left:t[o],n_right:t[u],n_level:t[s]}}):e(this).jqGrid("setGridParam",{postData:{nodeid:f,parentid:t[r],n_level:t[s]}}),e(this).trigger("reloadGrid"),t[i]=!0,"nested"==this.p.treeGridModel?e(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):e(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}}))}}})},collapseNode:function(t){return this.each(function(){if(this.grid&&this.p.treeGrid&&t.expanded){t.expanded=!1;var n=e.jgrid.getAccessor(t,this.p.localReader.id),n=e("#"+n,this.grid.bDiv)[0];e("div.treeclick",n).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(t,n,r,i){return this.each(function(){if(this.grid&&this.p.treeGrid){var s,o,u,l=[],h=this,p;s=e(this).jqGrid("getRootNodes");s=e.jgrid.from(s);s.orderBy(t,n,r,i);p=s.select();s=0;for(o=p.length;s<o;s++)u=p[s],l.push(u),e(this).jqGrid("collectChildrenSortTree",l,u,t,n,r,i);e.each(l,function(t){var n=e.jgrid.getAccessor(this,h.p.localReader.id);e("#"+h.p.id+" tbody tr:eq("+t+")").after(e("tr#"+n,h.grid.bDiv))});l=p=s=null}})},collectChildrenSortTree:function(t,n,r,i,s,o){return this.each(function(){if(this.grid&&this.p.treeGrid){var u,l,h,p;u=e(this).jqGrid("getNodeChildren",n);u=e.jgrid.from(u);u.orderBy(r,i,s,o);p=u.select();u=0;for(l=p.length;u<l;u++)h=p[u],t.push(h),e(this).jqGrid("collectChildrenSortTree",t,h,r,i,s,o)}})},setTreeRow:function(t,n){var r=!1;this.each(function(){this.grid&&this.p.treeGrid&&(r=e(this).jqGrid("setRowData",t,n))});return r},delTreeNode:function(t){return this.each(function(){var n=this.p.localReader.id,r=this.p.treeReader.left_field,i=this.p.treeReader.right_field,s,o,u;if(this.grid&&this.p.treeGrid){var f=this.p._index[t];if(void 0!==f){s=parseInt(this.p.data[f][i],10);o=s-parseInt(this.p.data[f][r],10)+1;f=e(this).jqGrid("getFullTreeNode",this.p.data[f]);if(0<f.length)for(var l=0;l<f.length;l++)e(this).jqGrid("delRowData",f[l][n]);if("nested"===this.p.treeGridModel){n=e.jgrid.from(this.p.data).greater(r,s,{stype:"integer"}).select();if(n.length)for(u in n)n[u][r]=parseInt(n[u][r],10)-o;n=e.jgrid.from(this.p.data).greater(i,s,{stype:"integer"}).select();if(n.length)for(u in n)n[u][i]=parseInt(n[u][i],10)-o}}}})},addChildNode:function(t,n,r){var i=this[0];if(r){var s=i.p.treeReader.expanded_field,o=i.p.treeReader.leaf_field,u=i.p.treeReader.level_field,f=i.p.treeReader.parent_id_field,l=i.p.treeReader.left_field,c=i.p.treeReader.right_field,h=i.p.treeReader.loaded,p,d,v,m,g;p=0;var y=n,b;if(!t){g=i.p.data.length-1;if(0<=g)for(;0<=g;)p=Math.max(p,parseInt(i.p.data[g][i.p.localReader.id],10)),g--;t=p+1}var w=e(i).jqGrid("getInd",n);b=!1;if(void 0===n||null===n||""===n)y=n=null,p="last",m=i.p.tree_root_level,g=i.p.data.length+1;else if(p="after",d=i.p._index[n],v=i.p.data[d],n=v[i.p.localReader.id],m=parseInt(v[u],10)+1,g=e(i).jqGrid("getFullTreeNode",v),g.length?(y=g[g.length-1][i.p.localReader.id],g=e(i).jqGrid("getInd",y)+1):g=e(i).jqGrid("getInd",n)+1,v[o])b=!0,v[s]=!0,e(i.rows[w]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(i.p.treeIcons.leaf+" tree-leaf").addClass(i.p.treeIcons.minus+" tree-minus"),i.p.data[d][o]=!1,v[h]=!0;d=g+1;r[s]=!1;r[h]=!0;r[u]=m;r[o]=!0;"adjacency"===i.p.treeGridModel&&(r[f]=n);if("nested"===i.p.treeGridModel){var E;if(null!==n){o=parseInt(v[c],10);u=e.jgrid.from(i.p.data);u=u.greaterOrEquals(c,o,{stype:"integer"});u=u.select();if(u.length)for(E in u)u[E][l]=u[E][l]>o?parseInt(u[E][l],10)+2:u[E][l],u[E][c]=u[E][c]>=o?parseInt(u[E][c],10)+2:u[E][c];r[l]=o;r[c]=o+1}else{o=parseInt(e(i).jqGrid("getCol",c,!1,"max"),10);u=e.jgrid.from(i.p.data).greater(l,o,{stype:"integer"}).select();if(u.length)for(E in u)u[E][l]=parseInt(u[E][l],10)+2;u=e.jgrid.from(i.p.data).greater(c,o,{stype:"integer"}).select();if(u.length)for(E in u)u[E][c]=parseInt(u[E][c],10)+2;r[l]=o+1;r[c]=o+2}}if(null===n||e(i).jqGrid("isNodeLoaded",v)||b)e(i).jqGrid("addRowData",t,r,p,y),e(i).jqGrid("setTreeNode",g,d);v&&!v[s]&&e(i.rows[w]).find("div.treeclick").click()}}})})(k);(function(e){e.jgrid.extend({jqGridImport:function(t){t=e.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},t||{});return this.each(function(){var n=this,r=function(t,r){var i=e(r.xmlGrid.config,t)[0],s=e(r.xmlGrid.data,t)[0],o;if(f.xml2json&&e.jgrid.parse){var i=f.xml2json(i," "),i=e.jgrid.parse(i),u;for(u in i)i.hasOwnProperty(u)&&(o=i[u]);s?(s=i.grid.datatype,i.grid.datatype="xmlstring",i.grid.datastr=t,e(n).jqGrid(o).jqGrid("setGridParam",{datatype:s})):e(n).jqGrid(o)}else alert("xml2json or parse are not present")},i=function(t,r){if(t&&"string"==typeof t){var i=e.jgrid.parse(t),s=i[r.jsonGrid.config];if(i=i[r.jsonGrid.data]){var o=s.datatype;s.datatype="jsonstring";s.datastr=i;e(n).jqGrid(s).jqGrid("setGridParam",{datatype:o})}else e(n).jqGrid(s)}};switch(t.imptype){case"xml":e.ajax(e.extend({url:t.impurl,type:t.mtype,data:t.impData,dataType:"xml",complete:function(n,i){"success"==i&&(r(n.responseXML,t),e.isFunction(t.importComplete)&&t.importComplete(n))}},t.ajaxOptions));break;case"xmlstring":if(t.impstring&&"string"==typeof t.impstring){var s=e.jgrid.stringToDoc(t.impstring);s&&(r(s,t),e.isFunction(t.importComplete)&&t.importComplete(s),t.impstring=null);s=null}break;case"json":e.ajax(e.extend({url:t.impurl,type:t.mtype,data:t.impData,dataType:"json",complete:function(n,r){"success"==r&&(i(n.responseText,t),e.isFunction(t.importComplete)&&t.importComplete(n))}},t.ajaxOptions));break;case"jsonstring":t.impstring&&"string"==typeof t.impstring&&(i(t.impstring,t),e.isFunction(t.importComplete)&&t.importComplete(t.impstring),t.impstring=null)}})},jqGridExport:function(t){var t=e.extend({exptype:"xmlstring",root:"grid",ident:"	"},t||{}),n=null;this.each(function(){if(this.grid){var r=e.extend({},e(this).jqGrid("getGridParam"));r.rownumbers&&(r.colNames.splice(0,1),r.colModel.splice(0,1));r.multiselect&&(r.colNames.splice(0,1),r.colModel.splice(0,1));r.subGrid&&(r.colNames.splice(0,1),r.colModel.splice(0,1));r.knv=null;if(r.treeGrid)for(var i in r.treeReader)r.treeReader.hasOwnProperty(i)&&(r.colNames.splice(r.colNames.length-1),r.colModel.splice(r.colModel.length-1));switch(t.exptype){case"xmlstring":n="<"+t.root+">"+f.json2xml(r,t.ident)+"</"+t.root+">";break;case"jsonstring":n="{"+f.toJson(r,t.root,t.ident)+"}",void 0!==r.postData.filters&&(n=n.replace(/filters":"/,'filters":'),n=n.replace(/}]}"/,"}]}"))}}});return n},excelExport:function(t){t=e.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},t||{});return this.each(function(){if(this.grid){var n;"remote"==t.exptype&&(n=e.extend({},this.p.postData),n[t.oper]=t.tag,n=k.param(n),n=-1!=t.url.indexOf("?")?t.url+"&"+n:t.url+"?"+n,window.location=n)}})}})})(k);var f={xml2json:function(e,t){9===e.nodeType&&(e=e.documentElement);var n=this.toJson(this.toObj(this.removeWhite(e)),e.nodeName,"	");return"{\n"+t+(t?n.replace(/\t/g,t):n.replace(/\t|\n/g,""))+"\n}"},json2xml:function(e,t){var n=function(e,t,r){var i="",s,o;if(e instanceof Array)if(0===e.length)i+=r+"<"+t+">__EMPTY_ARRAY_</"+t+">\n";else{s=0;for(o=e.length;s<o;s+=1)var u=r+n(e[s],t,r+"	")+"\n",i=i+u}else if("object"==typeof e){s=!1;i+=r+"<"+t;for(o in e)e.hasOwnProperty(o)&&("@"===o.charAt(0)?i+=" "+o.substr(1)+'="'+e[o].toString()+'"':s=!0);i+=s?">":"/>";if(s){for(o in e)e.hasOwnProperty(o)&&("#text"===o?i+=e[o]:"#cdata"===o?i+="<![CDATA["+e[o]+"]]>":"@"!==o.charAt(0)&&(i+=n(e[o],o,r+"	")));i+=("\n"===i.charAt(i.length-1)?r:"")+"</"+t+">"}}else i+="function"==typeof e?r+"<"+t+"><![CDATA["+e+"]]></"+t+">":'""'===e.toString()||0===e.toString().length?r+"<"+t+">__EMPTY_STRING_</"+t+">":r+"<"+t+">"+e.toString()+"</"+t+">";return i},r="",i;for(i in e)e.hasOwnProperty(i)&&(r+=n(e[i],i,""));return t?r.replace(/\t/g,t):r.replace(/\t|\n/g,"")},toObj:function(e){var t={},n=/function/i;if(1===e.nodeType){if(e.attributes.length){var r;for(r=0;r<e.attributes.length;r+=1)t["@"+e.attributes[r].nodeName]=(e.attributes[r].nodeValue||"").toString()}if(e.firstChild){var i=r=0,s=!1,o;for(o=e.firstChild;o;o=o.nextSibling)1===o.nodeType?s=!0:3===o.nodeType&&o.nodeValue.match(/[^ \f\n\r\t\v]/)?r+=1:4===o.nodeType&&(i+=1);if(s)if(2>r&&2>i){this.removeWhite(e);for(o=e.firstChild;o;o=o.nextSibling)3===o.nodeType?t["#text"]=this.escape(o.nodeValue):4===o.nodeType?n.test(o.nodeValue)?t[o.nodeName]=[t[o.nodeName],o.nodeValue]:t["#cdata"]=this.escape(o.nodeValue):t[o.nodeName]?t[o.nodeName]instanceof Array?t[o.nodeName][t[o.nodeName].length]=this.toObj(o):t[o.nodeName]=[t[o.nodeName],this.toObj(o)]:t[o.nodeName]=this.toObj(o)}else e.attributes.length?t["#text"]=this.escape(this.innerXml(e)):t=this.escape(this.innerXml(e));else if(r)e.attributes.length?t["#text"]=this.escape(this.innerXml(e)):(t=this.escape(this.innerXml(e)),"__EMPTY_ARRAY_"===t?t="[]":"__EMPTY_STRING_"===t&&(t=""));else if(i)if(1<i)t=this.escape(this.innerXml(e));else for(o=e.firstChild;o;o=o.nextSibling){if(n.test(e.firstChild.nodeValue)){t=e.firstChild.nodeValue;break}t["#cdata"]=this.escape(o.nodeValue)}}!e.attributes.length&&!e.firstChild&&(t=null)}else 9===e.nodeType?t=this.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,n,r){void 0===r&&(r=!0);var i=t?'"'+t+'"':"",s="	",o="\n";r||(o=s="");if("[]"===e)i+=t?":[]":"[]";else if(e instanceof Array){var u,a,f=[];a=0;for(u=e.length;a<u;a+=1)f[a]=this.toJson(e[a],"",n+s,r);i+=(t?":[":"[")+(1<f.length?o+n+s+f.join(","+o+n+s)+o+n:f.join(""))+"]"}else if(null===e)i+=(t&&":")+"null";else if("object"==typeof e){u=[];for(a in e)e.hasOwnProperty(a)&&(u[u.length]=this.toJson(e[a],a,n+s,r));i+=(t?":{":"{")+(1<u.length?o+n+s+u.join(","+o+n+s)+o+n:u.join(""))+"}"}else i+="string"==typeof e?(t&&":")+'"'+e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"':(t&&":")+'"'+e.toString()+'"';return i},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var n=function(e){var t="",r;if(1===e.nodeType){t+="<"+e.nodeName;for(r=0;r<e.attributes.length;r+=1)t+=" "+e.attributes[r].nodeName+'="'+(e.attributes[r].nodeValue||"").toString()+'"';if(e.firstChild){t+=">";for(r=e.firstChild;r;r=r.nextSibling)t+=n(r);t+="</"+e.nodeName+">"}else t+="/>"}else 3===e.nodeType?t+=e.nodeValue:4===e.nodeType&&(t+="<![CDATA["+e.nodeValue+"]]>");return t},e=e.firstChild;e;e=e.nextSibling)t+=n(e);return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();var t;for(t=e.firstChild;t;)if(3===t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var n=t.nextSibling;e.removeChild(t);t=n}else 1===t.nodeType&&this.removeWhite(t),t=t.nextSibling;return e}};(function(a){a.browser.msie&&8==a.browser.version&&(a.expr[":"].hidden=function(e){return 0===e.offsetWidth||0===e.offsetHeight||"none"==e.style.display});a.jgrid._multiselect=!1;if(a.ui&&a.ui.multiselect){if(a.ui.multiselect.prototype._setSelected){var e=a.ui.multiselect.prototype._setSelected;a.ui.multiselect.prototype._setSelected=function(t,n){var r=e.call(this,t,n);if(n&&this.selectedList){var i=this.element;this.selectedList.find("li").each(function(){a(this).data("optionLink")&&a(this).data("optionLink").remove().appendTo(i)})}return r}}a.ui.multiselect.prototype.destroy&&(a.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();a.Widget===void 0?a.widget.prototype.destroy.apply(this,arguments):a.Widget.prototype.destroy.apply(this,arguments)});a.jgrid._multiselect=!0}a.jgrid.extend({sortableColumns:function(e){return this.each(function(){function t(){n.p.disableClick=!0}var n=this,r={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_cb,#jqgh_rn,#jqgh_subgrid),:hidden)",placeholder:{element:function(e){return a(document.createElement(e[0].nodeName)).addClass(e[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(e,t){t.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10));t.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}},update:function(e,t){var r=a(t.item).parent(),r=a(">th",r),i={};a.each(n.p.colModel,function(e){i[this.name]=e});var s=[];r.each(function(){var e=a(">div",this).get(0).id.replace(/^jqgh_/,"");e in i&&s.push(i[e])});a(n).jqGrid("remapColumns",s,!0,!0);a.isFunction(n.p.sortable.update)&&n.p.sortable.update(s);setTimeout(function(){n.p.disableClick=!1},50)}};n.p.sortable.options?a.extend(r,n.p.sortable.options):a.isFunction(n.p.sortable)&&(n.p.sortable={update:n.p.sortable});if(r.start){var i=r.start;r.start=function(e,n){t();i.call(this,e,n)}}else r.start=t;n.p.sortable.exclude&&(r.items=r.items+(":not("+n.p.sortable.exclude+")"));e.sortable(r).data("sortable").floating=!0})},columnChooser:function(e){function t(e,t){e&&(typeof e=="string"?a.fn[e]&&a.fn[e].apply(t,a.makeArray(arguments).slice(2)):a.isFunction(e)&&e.apply(t,a.makeArray(arguments).slice(2)))}var n=this;if(!a("#colchooser_"+n[0].p.id).length){var r=a('<div id="colchooser_'+n[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),i=a("select",r),e=a.extend({width:420,height:240,classname:null,done:function(e){e&&n.jqGrid("remapColumns",e,!0)},msel:"multiselect",dlog:"dialog",dlog_opts:function(e){var t={};t[e.bSubmit]=function(){e.apply_perm();e.cleanup(!1)};t[e.bCancel]=function(){e.cleanup(!0)};return{buttons:t,close:function(){e.cleanup(!0)},modal:e.modal?e.modal:!1,resizable:e.resizable?e.resizable:!0,width:e.width+20}},apply_perm:function(){a("option",i).each(function(){this.selected?n.jqGrid("showCol",s[this.value].name):n.jqGrid("hideCol",s[this.value].name)});var t=[];a("option[selected]",i).each(function(){t.push(parseInt(this.value,10))});a.each(t,function(){delete u[s[parseInt(this,10)].name]});a.each(u,function(){var e=parseInt(this,10),n=t,r=e;if(r>=0){var i=n.slice(),s=i.splice(r,Math.max(n.length-r,r));r>n.length&&(r=n.length);i[r]=e;t=i.concat(s)}else t=void 0});e.done&&e.done.call(n,t)},cleanup:function(s){t(e.dlog,r,"destroy");t(e.msel,i,"destroy");r.remove();s&&e.done&&e.done.call(n)},msel_opts:{}},a.jgrid.col,e||{});if(a.ui&&a.ui.multiselect&&e.msel=="multiselect"){if(!a.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}e.msel_opts=a.extend(a.ui.multiselect.defaults,e.msel_opts)}e.caption&&r.attr("title",e.caption);if(e.classname){r.addClass(e.classname);i.addClass(e.classname)}if(e.width){a(">div",r).css({width:e.width,margin:"0 auto"});i.css("width",e.width)}if(e.height){a(">div",r).css("height",e.height);i.css("height",e.height-10)}var s=n.jqGrid("getGridParam","colModel"),o=n.jqGrid("getGridParam","colNames"),u={},f=[];i.empty();a.each(s,function(e){u[this.name]=e;this.hidedlg?this.hidden||f.push(e):i.append("<option value='"+e+"' "+(this.hidden?"":"selected='selected'")+">"+o[e]+"</option>")});var l=a.isFunction(e.dlog_opts)?e.dlog_opts.call(n,e):e.dlog_opts;t(e.dlog,r,l);l=a.isFunction(e.msel_opts)?e.msel_opts.call(n,e):e.msel_opts;t(e.msel,i,l)}},sortableRows:function(e){return this.each(function(){var t=this;if(t.grid&&!t.p.treeGrid&&a.fn.sortable){e=a.extend({cursor:"move",axis:"y",items:".jqgrow"},e||{});if(e.start&&a.isFunction(e.start)){e._start_=e.start;delete e.start}else e._start_=!1;if(e.update&&a.isFunction(e.update)){e._update_=e.update;delete e.update}else e._update_=!1;e.start=function(n,r){a(r.item).css("border-width","0px");a("td",r.item).each(function(e){this.style.width=t.grid.cols[e].style.width});if(t.p.subGrid){var i=a(r.item).attr("id");try{a(t).jqGrid("collapseSubGridRow",i)}catch(s){}}e._start_&&e._start_.apply(this,[n,r])};e.update=function(n,r){a(r.item).css("border-width","");t.p.rownumbers===!0&&a("td.jqgrid-rownum",t.rows).each(function(e){a(this).html(e+1)});e._update_&&e._update_.apply(this,[n,r])};a("tbody:first",t).sortable(e);a("tbody:first",t).disableSelection()}})},gridDnD:function(e){return this.each(function(){function t(){var e=a.data(n,"dnd");a("tr.jqgrow:not(.ui-draggable)",n).draggable(a.isFunction(e.drag)?e.drag.call(a(n),e):e.drag)}var n=this;if(n.grid&&!n.p.treeGrid&&a.fn.draggable&&a.fn.droppable){a("#jqgrid_dnd").html()===null&&a("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>");if(typeof e=="string"&&e=="updateDnD"&&n.p.jqgdnd===!0)t();else{e=a.extend({drag:function(e){return a.extend({start:function(t,r){if(n.p.subGrid){var i=a(r.helper).attr("id");try{a(n).jqGrid("collapseSubGridRow",i)}catch(s){}}for(i=0;i<a.data(n,"dnd").connectWith.length;i++)a(a.data(n,"dnd").connectWith[i]).jqGrid("getGridParam","reccount")=="0"&&a(a.data(n,"dnd").connectWith[i]).jqGrid("addRowData","jqg_empty_row",{});r.helper.addClass("ui-state-highlight");a("td",r.helper).each(function(e){this.style.width=n.grid.headers[e].width+"px"});e.onstart&&a.isFunction(e.onstart)&&e.onstart.call(a(n),t,r)},stop:function(t,r){if(r.helper.dropped){var i=a(r.helper).attr("id");a(n).jqGrid("delRowData",i)}for(i=0;i<a.data(n,"dnd").connectWith.length;i++)a(a.data(n,"dnd").connectWith[i]).jqGrid("delRowData","jqg_empty_row");e.onstop&&a.isFunction(e.onstop)&&e.onstop.call(a(n),t,r)}},e.drag_opts||{})},drop:function(e){return a.extend({accept:function(e){if(!a(e).hasClass("jqgrow"))return e;var t=a(e).closest("table.ui-jqgrid-btable");if(t.length>0&&a.data(t[0],"dnd")!==void 0){e=a.data(t[0],"dnd").connectWith;return a.inArray("#"+this.id,e)!=-1?!0:!1}return e},drop:function(t,r){if(a(r.draggable).hasClass("jqgrow")){var i=a(r.draggable).attr("id"),i=r.draggable.parent().parent().jqGrid("getRowData",i);if(!e.dropbyname){var s=0,o={},u,f=a("#"+this.id).jqGrid("getGridParam","colModel");try{for(var l in i){if(i.hasOwnProperty(l)&&f[s]){u=f[s].name;o[u]=i[l]}s++}i=o}catch(c){}}r.helper.dropped=!0;if(e.beforedrop&&a.isFunction(e.beforedrop)){u=e.beforedrop.call(this,t,r,i,a("#"+n.id),a(this));typeof u!="undefined"&&u!==null&&typeof u=="object"&&(i=u)}if(r.helper.dropped){var h;if(e.autoid)if(a.isFunction(e.autoid))h=e.autoid.call(this,i);else{h=Math.ceil(Math.random()*1e3);h=e.autoidprefix+h}a("#"+this.id).jqGrid("addRowData",h,i,e.droppos)}e.ondrop&&a.isFunction(e.ondrop)&&e.ondrop.call(this,t,r,i)}}},e.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5e3},dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},e||{});if(e.connectWith){e.connectWith=e.connectWith.split(",");e.connectWith=a.map(e.connectWith,function(e){return a.trim(e)});a.data(n,"dnd",e);n.p.reccount!="0"&&!n.p.jqgdnd&&t();n.p.jqgdnd=!0;for(var r=0;r<e.connectWith.length;r++)a(e.connectWith[r]).droppable(a.isFunction(e.drop)?e.drop.call(a(n),e):e.drop)}}}})},gridResize:function(c){return this.each(function(){var b=this;if(b.grid&&a.fn.resizable){c=a.extend({},c||{});if(c.alsoResize){c._alsoResize_=c.alsoResize;delete c.alsoResize}else c._alsoResize_=!1;if(c.stop&&a.isFunction(c.stop)){c._stop_=c.stop;delete c.stop}else c._stop_=!1;c.stop=function(e,t){a(b).jqGrid("setGridParam",{height:a("#gview_"+b.p.id+" .ui-jqgrid-bdiv").height()});a(b).jqGrid("setGridWidth",t.size.width,c.shrinkToFit);c._stop_&&c._stop_.call(b,e,t)};c.alsoResize=c._alsoResize_?eval("("+("{'#gview_"+b.p.id+" .ui-jqgrid-bdiv':true,'"+c._alsoResize_+"':true}")+")"):a(".ui-jqgrid-bdiv","#gview_"+b.p.id);delete c._alsoResize_;a("#gbox_"+b.p.id).resizable(c)}})}})})(k)});define("jquery-layout",["jquery"],function(k){(function(f){function a(e){return"string"===f.type(e)}function e(b,c){if(f.isArray(c))for(var d=0,e=c.length;d<e;d++){var k=c[d];try{a(k)&&(k=eval(k)),f.isFunction(k)&&k(b)}catch(l){}}}var c=Math.min,b=Math.max,k=Math.floor;f.layout={version:"1.3.rc30.51",revision:.033005,language:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpenTip:"Not enough room to show this pane.",minSizeWarning:"Panel has reached its minimum size",maxSizeWarning:"Panel has reached its maximum size",pane:"pane",selector:"selector",errButton:"Error Adding Button \n\nInvalid ",errContainerMissing
:"UI Layout Initialization Error\n\nThe specified layout-container does not exist.",errCenterPaneMissing:"UI Layout Initialization Error\n\nThe center-pane element does not exist.\n\nThe center-pane is a required element.",errContainerHeight:"UI Layout Initialization Warning\n\nThe layout-container \"CONTAINER\" has no height.\n\nTherefore the layout is 0-height and hence 'invisible'!"},browser:{mozilla:!!f.browser.mozilla,webkit:!!f.browser.webkit||!!f.browser.safari,msie:!!f.browser.msie,isIE6:!!f.browser.msie&&6==f.browser.version,version:f.browser.version},effects:{slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}},blind:{},clip:{},explode:{},fade:{},fold:{},puff:{},size:{all:{easing:"swing"}}},config:{optionRootKeys:"effects panes north south west east center".split(" "),allPanes:["north","south","west","east","center"],borderPanes:["north","south","west","east"],oppositeEdge:{north:"south",south:"north",east:"west",west:"east"},offscreenCSS:{left:"-99999px",right:"auto"},offscreenReset:"offscreenReset",hidden:{visibility:"hidden"},visible:{visibility:"visible"},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"Top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{side:"Bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{side:"Right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{side:"Left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},callbacks:{},getParentPaneElem:function(e){e=f(e);if(e=e.data("layout")||e.data("parentLayout")){e=e.container;if(e.data("layoutPane"))return e;e=e.closest("."+f.layout.defaults.panes.paneClass);if(e.data("layoutPane"))return e}return null},getParentPaneInstance:function(e){return(e=f.layout.getParentPaneElem(e))?e.data("layoutPane"):null},getParentLayoutInstance:function(e){return(e=f.layout.getParentPaneElem(e))?e.data("parentLayout"):null},getEventObject:function(e){return"object"==typeof e&&e.stopPropagation?e:null},parsePaneName:function(e){var t=f.layout.getEventObject(e);return t?(t.stopPropagation(),f(this).data("layoutEdge")):e},plugins:{draggable:!!f.fn.draggable,effects:{core:!!f.effects,slide:f.effects&&f.effects.slide}},onCreate:[],onLoad:[],onReady:[],onDestroy:[],onUnload:[],afterOpen:[],afterClose:[],scrollbarWidth:function(){return window.scrollbarWidth||f.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||f.layout.getScrollbarSize("height")},getScrollbarSize:function(e){var t=f('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};t.remove();window.scrollbarWidth=n.width;window.scrollbarHeight=n.height;return e.match(/^(width|height)$/)?n[e]:n},showInvisibly:function(e,t){if(!e)return{};e.jquery||(e=f(e));var n={display:e.css("display"),visibility:e.css("visibility")};return t||"none"===n.display?(e.css({display:"block",visibility:"hidden"}),n):{}},getElementDimensions:function(e){var t={},n=t.css={},r={},i,s,o=f.layout.cssNum,u=e.offset();t.offsetLeft=u.left;t.offsetTop=u.top;f.each(["Left","Right","Top","Bottom"],function(o,u){i=n["border"+u]=f.layout.borderWidth(e,u);s=n["padding"+u]=f.layout.cssNum(e,"padding"+u);r[u]=i+s;t["inset"+u]=s});t.offsetWidth=e.innerWidth();t.offsetHeight=e.innerHeight();t.outerWidth=e.outerWidth();t.outerHeight=e.outerHeight();t.innerWidth=b(0,t.outerWidth-r.Left-r.Right);t.innerHeight=b(0,t.outerHeight-r.Top-r.Bottom);n.width=e.width();n.height=e.height();n.top=o(e,"top",!0);n.bottom=o(e,"bottom",!0);n.left=o(e,"left",!0);n.right=o(e,"right",!0);return t},getElementCSS:function(e,t){var n={},r=e[0].style,i=t.split(","),s=["Top","Bottom","Left","Right"],o=["Color","Style","Width"],u,a,f,l,c,h;for(l=0;l<i.length;l++)if(u=i[l],u.match(/(border|padding|margin)$/))for(c=0;4>c;c++)if(a=s[c],"border"===u)for(h=0;3>h;h++)f=o[h],n[u+a+f]=r[u+a+f];else n[u+a]=r[u+a];else n[u]=r[u];return n},cssWidth:function(e,t){var n=f.layout.borderWidth,r=f.layout.cssNum;if(0>=t)return 0;if(!f.support.boxModel)return t;n=t-n(e,"Left")-n(e,"Right")-r(e,"paddingLeft")-r(e,"paddingRight");return b(0,n)},cssHeight:function(e,t){var n=f.layout.borderWidth,r=f.layout.cssNum;if(0>=t)return 0;if(!f.support.boxModel)return t;n=t-n(e,"Top")-n(e,"Bottom")-r(e,"paddingTop")-r(e,"paddingBottom");return b(0,n)},cssNum:function(e,t,n){e.jquery||(e=f(e));var r=f.layout.showInvisibly(e),t=f.curCSS(e[0],t,!0),n=n&&"auto"==t?t:parseInt(t,10)||0;e.css(r);return n},borderWidth:function(e,t){e.jquery&&(e=e[0]);var n="border"+t.substr(0,1).toUpperCase()+t.substr(1);return"none"===f.curCSS(e,n+"Style",!0)?0:parseInt(f.curCSS(e,n+"Width",!0),10)||0},isMouseOverElem:function(e,t){var n=f(t||this),r=n.offset(),i=r.top,r=r.left,s=r+n.outerWidth(),n=i+n.outerHeight(),o=e.pageX,u=e.pageY;return f.layout.browser.msie&&0>o&&0>u||o>=r&&o<=s&&u>=i&&u<=n},msg:function(e,t,n,r){f.isPlainObject(e)&&window.debugData?("string"==typeof t?(r=n,n=t):"object"==typeof n&&(r=n,n=null),n=n||"log( <object> )",r=f.extend({sort:!1,returnHTML:!1,display:!1},r),!0===t||r.display?debugData(e,n,r):window.console&&console.log(debugData(e,n,r))):t?alert(e):window.console?console.log(e):(t=f("#layoutLogger"),t.length||(t=f('<div id="layoutLogger" style="position: '+(f.support.fixedPosition?"fixed":"absolute")+'; top: 5px; z-index: 999999; max-width: 25%; overflow: hidden; border: 1px solid #000; border-radius: 5px; background: #FBFBFB; box-shadow: 0 2px 10px rgba(0,0,0,0.3);"><div style="font-size: 13px; font-weight: bold; padding: 5px 10px; background: #F6F6F6; border-radius: 5px 5px 0 0; cursor: move;"><span style="float: right; padding-left: 7px; cursor: pointer;" title="Remove Console" onclick="$(this).closest(\'#layoutLogger\').remove()">X</span>Layout console.log</div><ul style="font-size: 13px; font-weight: none; list-style: none; margin: 0; padding: 0 0 2px;"></ul></div>').appendTo("body"),t.css("left",f(window).width()-t.outerWidth()-5),f.ui.draggable&&t.draggable({handle:":first-child"})),t.children("ul").append('<li style="padding: 4px 10px; margin: 0; border-top: 1px solid #CCC;">'+e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</li>"))}};var l=f.layout.language;f.layout.defaults={name:"",containerSelector:"",containerClass:"ui-layout-container",scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,autoBindCustomButtons:!1,initPanes:!0,showErrorMessages:!0,showDebugMessages:!1,zIndex:null,zIndexes:{pane_normal:0,content_mask:1,resizer_normal:2,pane_sliding:100,pane_animate:1e3,resizer_drag:1e4},panes:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:l.Close,togglerTip_closed:l.Open,togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskContents:!1,maskObjects:!1,maskZindex:null,resizingGrid:!1,livePaneResizing:!1,liveContentResizing:!1,liveResizingTolerance:1,noRoomToOpenTip:l.noRoomToOpenTip,resizerTip:l.Resize,sliderTip:l.Slide,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:f.layout.browser.webkit,preventPrematureSlideClose:!1,showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,animatePaneSizing:!1,childOptions:null,initChildLayout:!0,destroyChildLayout:!0,resizeChildLayout:!0,triggerEventsOnLoad:!1,triggerEventsDuringLiveResize:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}};f.layout.optionsMap={layout:"stateManagement effects zIndexes name zIndex scrollToBookmarkOnLoad showErrorMessages resizeWithWindow resizeWithWindowDelay resizeWithWindowMaxDelay onresizeall onresizeall_start onresizeall_end onload onunload autoBindCustomButtons".split(" "),center:"paneClass contentSelector contentIgnoreSelector findNestedContent applyDemoStyles triggerEventsOnLoad showOverflowOnHover maskContents maskObjects liveContentResizing childOptions initChildLayout resizeChildLayout destroyChildLayout onresize onresize_start onresize_end onsizecontent onsizecontent_start onsizecontent_end".split(" "),noDefault:["paneSelector","resizerCursor","customHotkey"]};f.layout.transformData=function(e){var t={panes:{},center:{}},n,r,i,s,o,u,a;if("object"!=typeof e)return t;for(r in e){n=t;o=e[r];i=r.split("__");a=i.length-1;for(u=0;u<=a;u++)s=i[u],u===a?n[s]=o:n[s]||(n[s]={}),n=n[s]}return t};f.layout.backwardCompatibility={map:{applyDefaultStyles:"applyDemoStyles",resizeNestedLayout:"resizeChildLayout",resizeWhileDragging:"livePaneResizing",resizeContentWhileDragging:"liveContentResizing",triggerEventsWhileDragging:"triggerEventsDuringLiveResize",maskIframesOnResize:"maskContents",useStateCookie:"stateManagement.enabled","cookie.autoLoad":"stateManagement.autoLoad","cookie.autoSave":"stateManagement.autoSave","cookie.keys":"stateManagement.stateKeys","cookie.name":"stateManagement.cookie.name","cookie.domain":"stateManagement.cookie.domain","cookie.path":"stateManagement.cookie.path","cookie.expires":"stateManagement.cookie.expires","cookie.secure":"stateManagement.cookie.secure"},renameOptions:function(e){function t(t,n){for(var r=t.split("."),i=r.length-1,s={branch:e,key:r[i]},o=0,u;o<i;o++)u=r[o],s.branch=void 0==s.branch[u]?n?s.branch[u]={}:{}:s.branch[u];return s}var n=f.layout.backwardCompatibility.map,r,i,s,o;for(o in n)r=t(o),s=r.branch[r.key],void 0!==s&&(i=t(n[o],!0),i.branch[i.key]=s,delete r.branch[r.key])},renameAllOptions:function(e){var t=f.layout.backwardCompatibility.renameOptions;t(e);e.defaults&&("object"!=typeof e.panes&&(e.panes={}),f.extend(!0,e.panes,e.defaults),delete e.defaults);e.panes&&t(e.panes);f.each(f.layout.config.allPanes,function(n,r){e[r]&&t(e[r])});return e}};f.fn.layout=function(g){function j(e){if(!e)return!0;var t=e.keyCode;if(33>t)return!0;var n={38:"north",40:"south",37:"west",39:"east"},r=e.shiftKey,i=e.ctrlKey,s,o,u,a;i&&37<=t&&40>=t&&B[n[t]].enableCursorHotkey?a=n[t]:(i||r)&&f.each(p.borderPanes,function(e,n){s=B[n];o=s.customHotkey;u=s.customHotkeyModifier;if(r&&"SHIFT"==u||i&&"CTRL"==u||i&&r)if(o&&t===(isNaN(o)||9>=o?o.toUpperCase().charCodeAt(0):o))return a=n,!1});if(!a||!O[a]||!B[a].closable||A[a].isHidden)return!0;Qa(a);e.stopPropagation();return e.returnValue=!1}function d(e){if(C()){this&&this.tagName&&(e=this);var t;a(e)?t=O[e]:f(e).data("layoutRole")?t=f(e):f(e).parents().each(function(){if(f(this).data("layoutRole"))return t=f(this),!1});if(t&&t.length){var n=t.data("layoutEdge"),e=A[n];e.cssSaved&&l(n);if(e.isSliding||e.isResizing||e.isClosed)e.cssSaved=!1;else{var r={zIndex:B.zIndexes.resizer_normal+1},i={},s=t.css("overflow"),o=t.css("overflowX"),u=t.css("overflowY");"visible"!=s&&(i.overflow=s,r.overflow="visible");o&&!o.match(/visible|auto/)&&(i.overflowX=o,r.overflowX="visible");u&&!u.match(/visible|auto/)&&(i.overflowY=o,r.overflowY="visible");e.cssSaved=i;t.css(r);f.each(p.allPanes,function(e,t){t!=n&&l(t)})}}}}function l(e){if(C()){this&&this.tagName&&(e=this);var t;a(e)?t=O[e]:f(e).data("layoutRole")?t=f(e):f(e).parents().each(function(){if(f(this).data("layoutRole"))return t=f(this),!1});if(t&&t.length){var e=t.data("layoutEdge"),e=A[e],n=e.cssSaved||{};!e.isSliding&&!e.isResizing&&t.css("zIndex",B.zIndexes.pane_normal);t.css(n);e.cssSaved=!1}}}var o=f.layout.browser,q=f.layout.language,p=f.layout.config,x=f.layout.cssWidth,t=f.layout.cssHeight,v=f.layout.getElementDimensions,y=f.layout.getElementCSS,u=f.layout.getEventObject,z=f.layout.parsePaneName,B=f.extend(!0,{},f.layout.defaults);B.effects=f.extend(!0,{},f.layout.effects);var A={id:"layout"+f.now(),initialized:!1,container:{},north:{},south:{},east:{},west:{},center:{}},F={north:null,south:null,east:null,west:null,center:null},M={data:{},set:function(e,t,n){M.clear(e);M.data[e]=setTimeout(t,n)},clear:function(e){var t=M.data;t[e]&&(clearTimeout(t[e]),delete t[e])}},K=function(e,t){f.layout.msg(B.name+" / "+e,t&&B.showErrorMessages)},H=function(b,c,d){var e=c?B[c]:B,g=b+(b.match(/_/)?"":"_end"),j=g.match(/_end$/)?g.substr(0,g.length-4):"",k=e[g],l="NC",m=[];!k&&j&&(k=e[j]);k&&(a(k)&&(k.match(/,/)?(m=k.split(","),k=eval(m[0])):k=eval(k)),f.isFunction(k)&&(l=m.length?k(m[1]):c&&O[c]?k(c,O[c],A[c],B[c],B.name):k(ea,A,B,B.name)));!d&&!1!==l&&(c?(O[c].triggerHandler("layoutpane"+g,[c,O[c],A[c],B[c],B.name]),j&&O[c].triggerHandler("layoutpane"+j,[c,O[c],A[c],B[c],B.name])):T.triggerHandler("layout"+g,[c,O[c],A[c],B[c],B.name]));("onresize_end"===b||"onsizecontent_end"===b)&&Za(c);return l},R=function(e){if(!o.mozilla){var t=O[e];"IFRAME"===A[e].tagName?t.css(p.hidden).css(p.visible):t.find("IFRAME").css(p.hidden).css(p.visible)}},E=function(e){var n=O[e],e=p[e].dir,n={minWidth:1001-x(n,1e3),minHeight:1001-t(n,1e3)};"horz"===e&&(n.minSize=n.minHeight);"vert"===e&&(n.minSize=n.minWidth);return n},aa=function(e,n,r){var i=e;a(e)?i=O[e]:e.jquery||(i=f(e));e=t(i,n);i.css({height:e,visibility:"visible"});0<e&&0<i.innerWidth()?r&&i.data("autoHidden")&&(i.show().data("autoHidden",!1),o.mozilla||i.css(p.hidden).css(p.visible)):r&&!i.data("autoHidden")&&i.hide().data("autoHidden",!0)},V=function(e,t,n){n||(n=p[e].dir);a(t)&&t.match(/%/)&&(t="100%"===t?-1:parseInt(t,10)/100);if(0===t)return 0;if(1<=t)return parseInt(t,10);var r=B,i=0;"horz"==n?i=U.innerHeight-(O.north?r.north.spacing_open:0)-(O.south?r.south.spacing_open:0):"vert"==n&&(i=U.innerWidth-(O.west?r.west.spacing_open:0)-(O.east?r.east.spacing_open:0));if(-1===t)return i;if(0<t)return k(i*t);if("center"==e)return 0;var n="horz"===n?"height":"width",r=O[e],e="height"===n?Ca[e]:!1,i=f.layout.showInvisibly(r),s=r.css(n),o=e?e.css(n):0;r.css(n,"auto");e&&e.css(n,"auto");t="height"===n?r.outerHeight():r.outerWidth();r.css(n,s).css(i);e&&e.css(n,o);return t},Z=function(e,t){var n=O[e],r=B[e],i=A[e],s=t?r.spacing_open:0,r=t?r.spacing_closed:0;return!n||i.isHidden?0:i.isClosed||i.isSliding&&t?r:"horz"===p[e].dir?n.outerHeight()+s:n.outerWidth()+s},D=function(e,t){if(C()){var n=B[e],r=A[e],i=p[e],s=i.dir;i.side.toLowerCase();i.sizeType.toLowerCase();var i=void 0!=t?t:r.isSliding,o=n.spacing_open,u=p.oppositeEdge[e],a=A[u],f=O[u],l=!f||!1===a.isVisible||a.isSliding?0:"horz"==s?f.outerHeight():f.outerWidth(),u=(!f||a.isHidden?0:B[u][!1!==a.isClosed?"spacing_closed":"spacing_open"])||0,a="horz"==s?U.innerHeight:U.innerWidth,f=E("center"),f="horz"==s?b(B.center.minHeight,f.minHeight):b(B.center.minWidth,f.minWidth),i=a-o-(i?0:V("center",f,s)+l+u),s=r.minSize=b(V(e,n.minSize),E(e).minSize),i=r.maxSize=c(n.maxSize?V(e,n.maxSize):1e5,i),r=r.resizerPosition={},o=U.insetTop,l=U.insetLeft,u=U.innerWidth,a=U.innerHeight,n=n.spacing_open;switch(e){case"north":r.min=o+s;r.max=o+i;break;case"west":r.min=l+s;r.max=l+i;break;case"south":r.min=o+a-i-n;r.max=o+a-s-n;break;case"east":r.min=l+u-i-n,r.max=l+u-s-n}}},J=function(e,t){var n=f(e),r=n.data("layoutRole"),i=n.data("layoutEdge"),s=B[i][r+"Class"],i="-"+i,o=n.hasClass(s+"-closed")?"-closed":"-open",u="-closed"===o?"-open":"-closed",o=s+"-hover "+(s+i+"-hover ")+(s+o+"-hover ")+(s+i+o+"-hover ");t&&(o+=s+u+"-hover "+(s+i+u+"-hover "));"resizer"==r&&n.hasClass(s+"-sliding")&&(o+=s+"-sliding-hover "+(s+i+"-sliding-hover "));return f.trim(o)},G=function(e,t){var n=f(t||this);e&&"toggler"===n.data("layoutRole")&&e.stopPropagation();n.addClass(J(n))},N=function(e,t){var n=f(t||this);n.removeClass(J(n,!0))},L=function(){f.fn.disableSelection&&f("body").disableSelection()},P=function(e,t){var n=t||this,r=f(n).data("layoutEdge"),i=r+"ResizerLeave";M.clear(r+"_openSlider");M.clear(i);t?!A[r].isResizing&&f.fn.enableSelection&&f("body").enableSelection():M.set(i,function(){P(e,n)},200)},C=function(){return A.initialized||A.creatingLayout?!0:Y()},Y=function(t){var n=B;if(!T.is(":visible"))return!t&&o.webkit&&"BODY"===T[0].tagName&&setTimeout(function(){Y(!0)},50),!1;if(!ia("center").length)return B.showErrorMessages&&K(q.errCenterPaneMissing,!0),!1;A.creatingLayout=!0;f.extend(U,v(T));pa();n.scrollToBookmarkOnLoad&&(t=self.location,t.hash&&t.replace(t.hash));ea.hasParentLayout?n.resizeWithWindow=!1:n.resizeWithWindow&&f(window).bind("resize."+$,ba);delete A.creatingLayout;A.initialized=!0;e(ea,f.layout.onReady);H("onload_end");return!0},ha=function(e,t){var n=z.call(this,e),r=O[n];if(r){var i=Ca[n],s=t||B[n].childOptions,r=s.containerSelector?r.find(s.containerSelector):i||r,o=(i=r.length)?F[n]=r.data("layout")||null:null;!o&&i&&s&&(o=F[n]=r.eq(0).layout(s)||null);o&&(o.hasParentLayout=!0)}ea[n].child=F[n]},ba=function(){var e=Number(B.resizeWithWindowDelay);10>e&&(e=100);M.clear("winResize");M.set("winResize",function(){M.clear("winResize");M.clear("winResizeRepeater");var e=v(T);(e.innerWidth!==U.innerWidth||e.innerHeight!==U.innerHeight)&&Pa()},e);M.data.winResizeRepeater||X()},X=function(){var e=Number(B.resizeWithWindowMaxDelay);0<e&&M.set("winResizeRepeater",function(){X();Pa()},e)},S=function(){H("onunload_start");e(ea,f.layout.onUnload);H("onunload_end")},W=function(e){e=e?e.split(","):p.borderPanes;f.each(e,function(e,t){var n=B[t];if(n.enableCursorHotkey||n.customHotkey)return f(document).bind("keydown."+$,j),!1})},ka=function(){function e(e){var t=B[e],n=B.panes;t.fxSettings||(t.fxSettings={});n.fxSettings||(n.fxSettings={});f.each(["_open","_close","_size"],function(r,i){var s="fxName"+i,o="fxSpeed"+i,u="fxSettings"+i,a=t[s]=t[s]||n[s]||t.fxName||n.fxName||"none";if(a==="none"||!f.effects||!f.effects[a]||!B.effects[a])a=t[s]="none";a=B.effects[a]||{};s=a.all||null;a=a[e]||null;t[o]=t[o]||n[o]||t.fxSpeed||n.fxSpeed||null;t[u]=f.extend({},s,a,n.fxSettings,t.fxSettings,n[u],t[u])});delete t.fxName;delete t.fxSpeed;delete t.fxSettings}var t,n,r,i,s,o;g=f.layout.transformData(g);g=f.layout.backwardCompatibility.renameAllOptions(g);if(!f.isEmptyObject(g.panes)){t=f.layout.optionsMap.noDefault;i=0;for(s=t.length;i<s;i++)r=t[i],delete g.panes[r];t=f.layout.optionsMap.layout;i=0;for(s=t.length;i<s;i++)r=t[i],delete g.panes[r]}t=f.layout.optionsMap.layout;var u=f.layout.config.optionRootKeys;for(r in g)i=g[r],0>f.inArray(r,u)&&0>f.inArray(r,t)&&(g.panes[r]||(g.panes[r]=f.isPlainObject(i)?f.extend(!0,{},i):i),delete g[r]);f.extend(!0,B,g);f.each(p.allPanes,function(i,u){p[u]=f.extend(!0,{},p.panes,p[u]);n=B.panes;o=B[u];if("center"===u){t=f.layout.optionsMap.center;i=0;for(s=t.length;i<s;i++)if(r=t[i],!g.center[r]&&(g.panes[r]||!o[r]))o[r]=n[r]}else if(o=B[u]=f.extend({},n,o),e(u),o.resizerClass||(o.resizerClass="ui-layout-resizer"),!o.togglerClass)o.togglerClass="ui-layout-toggler";o.paneClass||(o.paneClass="ui-layout-pane")});i=g.zIndex;u=B.zIndexes;0<i&&(u.pane_normal=i,u.content_mask=b(i+1,u.content_mask),u.resizer_normal=b(i+2,u.resizer_normal));delete B.panes},ia=function(e){e=B[e].paneSelector;if("#"===e.substr(0,1))return T.find(e).eq(0);var t=T.children(e).eq(0);return t.length?t:T.children("form:first").children(e).eq(0)},pa=function(){f.each(p.allPanes,function(e,t){qa(t,!0)});ua();f.each(p.borderPanes,function(e,t){O[t]&&A[t].isVisible&&(D(t),Ea(t))});Na("center");f.each(p.allPanes,function(e,t){var n=B[t];O[t]&&(A[t].isVisible&&(Ba(t),n.triggerEventsOnLoad?H("onresize_end",t):Za(t)),n.initChildLayout&&n.childOptions&&ha(t))})},qa=function(e,n){if(n||C()){var r=B[e],i=A[e],s=p[e],o=s.dir,u="center"===e,a={},f=O[e],h,v;f?Oa(e,!1,!0,!1):Ca[e]=!1;f=O[e]=ia(e);if(f.length){f.data("layoutCSS")||f.data("layoutCSS",y(f,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"));ea[e]={name:e,pane:O[e],content:Ca[e],options:B[e],state:A[e],child:F[e]};f.data({parentLayout:ea,layoutPane:ea[e],layoutEdge:e,layoutRole:"pane"}).css(s.cssReq).css("zIndex",B.zIndexes.pane_normal).css(r.applyDemoStyles?s.cssDemo:{}).addClass(r.paneClass+" "+r.paneClass+"-"+e).bind("mouseenter."+$,G).bind("mouseleave."+$,N);s={hide:"",show:"",toggle:"",close:"",open:"",slideOpen:"",slideClose:"",slideToggle:"",size:"manualSizePane",sizePane:"manualSizePane",sizeContent:"",sizeHandles:"",enableClosable:"",disableClosable:"",enableSlideable:"",disableSlideable:"",enableResizable:"",disableResizable:"",swapPanes:"swapPanes",swap:"swapPanes",move:"swapPanes",removePane:"removePane",remove:"removePane",createChildLayout:"",resizeChildLayout:"",resizeAll:"resizeAll",resizeLayout:"resizeAll"};for(v in s)f.bind("layoutpane"+v.toLowerCase()+"."+$,ea[s[v]||v]);I(e,!1);u||(h=i.size=V(e,r.size),u=V(e,r.minSize)||1,v=V(e,r.maxSize)||1e5,0<h&&(h=b(c(h,v),u)),i.isClosed=!1,i.isSliding=!1,i.isResizing=!1,i.isHidden=!1,i.pins||(i.pins=[]));i.tagName=f[0].tagName;i.edge=e;i.noRoom=!1;i.isVisible=!0;switch(e){case"north":a.top=U.insetTop;a.left=U.insetLeft;a.right=U.insetRight;break;case"south":a.bottom=U.insetBottom;a.left=U.insetLeft;a.right=U.insetRight;break;case"west":a.left=U.insetLeft;break;case"east":a.right=U.insetRight}"horz"===o?a.height=t(f,h):"vert"===o&&(a.width=x(f,h));f.css(a);"horz"!=o&&Na(e,!0);r.initClosed&&r.closable&&!r.initHidden?sa(e,!0,!0):r.initHidden||r.initClosed?Va(e):i.noRoom||f.css("display","block");f.css("visibility","visible");r.showOverflowOnHover&&f.hover(d,l);A.initialized&&(ua(e),W(e),Pa(),i.isVisible&&(r.triggerEventsOnLoad?H("onresize_end",e):Za(e)),r.initChildLayout&&r.childOptions&&ha(e))}else O[e]=!1}},ua=function(e){e=e?e.split(","):p.borderPanes;f.each(e,function(e,t){var n=O[t];ja[t]=!1;ga[t]=!1;if(n){var n=B[t],r=A[t],i=n.resizerClass,s=n.togglerClass;p[t].side.toLowerCase();var o="-"+t,u=ea[t],a=u.resizer=ja[t]=f("<div></div>"),u=u.toggler=n.closable?ga[t]=f("<div></div>"):!1;!r.isVisible&&n.slidable&&a.attr("title",n.sliderTip).css("cursor",n.sliderCursor);a.attr("id","#"==n.paneSelector.substr(0,1)?n.paneSelector.substr(1)+"-resizer":"").data({parentLayout:ea,layoutPane:ea[t],layoutEdge:t,layoutRole:"resizer"}).css(p.resizers.cssReq).css("zIndex",B.zIndexes.resizer_normal).css(n.applyDemoStyles?p.resizers.cssDemo:{}).addClass(i+" "+i+o).hover(G,N).hover(L,P).appendTo(T);u&&(u.attr("id","#"==n.paneSelector.substr(0,1)?n.paneSelector.substr(1)+"-toggler":"").data({parentLayout:ea,layoutPane:ea[t],layoutEdge:t,layoutRole:"toggler"}).css(p.togglers.cssReq).css(n.applyDemoStyles?p.togglers.cssDemo:{}).addClass(s+" "+s+o).hover(G,N).bind("mouseenter",L).appendTo(a),n.togglerContent_open&&f("<span>"+n.togglerContent_open+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).data("layoutRole","togglerContent").data("layoutEdge",t).addClass("content content-open").css("display","none").appendTo(u),n.togglerContent_closed&&f("<span>"+n.togglerContent_closed+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).addClass("content content-closed").css("display","none").appendTo(u),rb(t));fa(t);r.isVisible?ra(t):(Da(t),Ja(t,!0))}});Ia()},I=function(e,t){if(C()){var n=B[e],r=n.contentSelector,i=ea[e],s=O[e],o;r&&(o=i.content=Ca[e]=n.findNestedContent?s.find(r).eq(0):s.children(r).eq(0));o&&o.length?(o.data("layoutRole","content"),o.data("layoutCSS")||o.data("layoutCSS",y(o,"height")),o.css(p.content.cssReq),n.applyDemoStyles&&(o.css(p.content.cssDemo),s.css(p.content.cssDemoPane)),A[e].content={},!1!==t&&Ba(e)):i.content=Ca[e]=!1}},fa=function(e){var t=f.layout.plugins.draggable,e=e?e.split(","):p.borderPanes;f.each(e,function(e,r){var i=B[r];if(!t||!O[r]||!i.resizable)return i.resizable=!1,!0;var s=A[r],o=B.zIndexes,u=p[r],a="horz"==u.dir?"top":"left",l=r+",center,"+p.oppositeEdge[r]+("horz"==u.dir?",west,east":""),h=ja[r],d=i.resizerClass,v=0,m,g,y=d+"-drag",w=d+"-"+r+"-drag",E=d+"-dragging",S=d+"-"+r+"-dragging",x=d+"-dragging-limit",N=d+"-"+r+"-dragging-limit",C=!1;s.isClosed||h.attr("title",i.resizerTip).css("cursor",i.resizerCursor);h.draggable({containment:T[0],axis:"horz"==u.dir?"y":"x",delay:0,distance:1,grid:i.resizingGrid,helper:"clone",opacity:i.resizerDragOpacity,addClasses:!1,zIndex:o.resizer_drag,start:function(e,t){i=B[r];s=A[r];g=i.livePaneResizing;if(!1===H("ondrag_start",r))return!1;s.isResizing=!0;M.clear(r+"_closeSlider");D(r);m=s.resizerPosition;v=t.position[a];h.addClass(y+" "+w);C=!1;f("body").disableSelection();la(l)},drag:function(e,t){C||(t.helper.addClass(E+" "+S).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),C=!0,s.isSliding&&O[r].css("zIndex",o.pane_sliding));var u=0;t.position[a]<m.min?(t.position[a]=m.min,u=-1):t.position[a]>m.max&&(t.position[a]=m.max,u=1);u?(t.helper.addClass(x+" "+N),window.defaultStatus=0<u&&r.match(/north|west/)||0>u&&r.match(/south|east/)?q.maxSizeWarning:q.minSizeWarning):(t.helper.removeClass(x+" "+N),window.defaultStatus="");g&&Math.abs(t.position[a]-v)>=i.liveResizingTolerance&&(v=t.position[a],n(e,t,r))},stop:function(e,t){f("body").enableSelection();window.defaultStatus="";h.removeClass(y+" "+w);s.isResizing=!1;n(e,t,r,!0,l)}})});var n=function(e,t,n,r,i){var s=t.position,o=p[n],e=B[n],t=A[n],u;switch(n){case"north":u=s.top;break;case"west":u=s.left;break;case"south":u=U.offsetHeight-s.top-e.spacing_open;break;case"east":u=U.offsetWidth-s.left-e.spacing_open}u-=U["inset"+o.side];r?(!1!==H("ondrag_end",n)&&ma(n,u,!1,!0),ya(),t.isSliding&&i&&la(i,!0)):Math.abs(u-t.size)<e.liveResizingTolerance||(ma(n,u,!1,!0),Ga.each(ta))}},ta=function(){var e=f(this),t=e.data("layoutMask"),t=A[t];"IFRAME"==t.tagName&&t.isVisible&&e.css({top:t.offsetTop,left:t.offsetLeft,width:t.outerWidth,height:t.outerHeight})},la=function(e,t){var n=e?e.split(","):f.layout.config.allPanes,r=B.zIndexes,i,s;f.each(n,function(e,n){s=A[n];i=B[n];s.isVisible&&(!t&&i.maskContents||i.maskObjects)&&La(n).each(function(){ta.call(this);this.style.zIndex=s.isSliding?r.pane_sliding+1:r.pane_normal+1;this.style.display="block"})})},ya=function(){var e;f.each(f.layout.config.borderPanes,function(t,n){if(A[n].isResizing)return e=!0,!1});e||Ga.hide()},La=function(e){for(var t=f([]),n,r=0,i=Ga.length;r<i;r++)n=Ga.eq(r),n.data("layoutMask")===e&&(t=t.add(n));if(t.length)return t;t=O[e];n=A[e];var r=B[e],i=B.zIndexes,s=f([]),o,u,a,l,c;if(r.maskContents||r.maskObjects)for(c=0;c<(r.maskObjects?2:1);c++)o=r.maskObjects&&0==c,u=document.createElement(o?"iframe":"div"),a=f(u).data("layoutMask",e),u.className="ui-layout-mask ui-layout-mask-"+e,l=u.style,l.display="block",l.position="absolute",o&&(u.frameborder=0,u.src="about:blank",l.opacity=0,l.filter="Alpha(Opacity='0')",l.border=0),"IFRAME"==n.tagName?(l.zIndex=i.pane_normal+1,T.append(u)):(a.addClass("ui-layout-mask-inside-pane"),l.zIndex=r.maskZindex||i.content_mask,l.top=0,l.left=0,l.width="100%",l.height="100%",t.append(u)),s=s.add(u),Ga=Ga.add(u);return s},Oa=function(e,t,n,r){if(C()){var e=z.call(this,e),i=O[e],s=Ca[e],o=ja[e],u=ga[e];i&&f.isEmptyObject(i.data())&&(i=!1);s&&f.isEmptyObject(s.data())&&(s=!1);o&&f.isEmptyObject(o.data())&&(o=!1);u&&f.isEmptyObject(u.data())&&(u=!1);i&&i.stop(!0,!0);var a=B[e],l=F[e]||(i?i.data("layout"):0)||(s?s.data("layout"):0)||null;(void 0!==r?r:a.destroyChildLayout)&&l&&!l.destroyed&&(l.destroy(!0),l.destroyed&&(l=null));i&&t&&!l?i.remove():i&&i[0]&&(t=a.paneClass,r=t+"-"+e,t=[t,t+"-open",t+"-closed",t+"-sliding",r,r+"-open",r+"-closed",r+"-sliding"],f.merge(t,J(i,!0)),i.removeClass(t.join(" ")).removeData("parentLayout").removeData("layoutPane").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+$),s&&s.data("layout")?(s.width(s.width()),l.resizeAll()):s&&s.css(s.data("layoutCSS")).removeData("layoutCSS").removeData("layoutRole"),i.data("layout")||i.css(i.data("layoutCSS")).removeData("layoutCSS"));u&&u.remove();o&&o.remove();ea[e]=O[e]=Ca[e]=ja[e]=ga[e]=F[e]=!1;n||Pa()}},wa=function(e){var t=O[e],n=t[0].style;B[e].useOffscreenClose?(t.data(p.offscreenReset)||t.data(p.offscreenReset,{left:n.left,right:n.right}),t.css(p.offscreenCSS)):t.hide().removeData(p.offscreenReset)},oa=function(e){var t=O[e],e=B[e],n=p.offscreenCSS,r=t.data(p.offscreenReset),i=t[0].style;t.show().removeData(p.offscreenReset);e.useOffscreenClose&&r&&(i.left==n.left&&(i.left=r.left),i.right==n.right)&&(i.right=r.right)},Va=function(e,t){if(C()){var n=z.call(this,e),r=B[n],i=A[n],s=ja[n];O[n]&&!i.isHidden&&(!A.initialized||!1!==H("onhide_start",n))&&(i.isSliding=!1,s&&s.hide(),!A.initialized||i.isClosed?(i.isClosed=!0,i.isHidden=!0,i.isVisible=!1,A.initialized||wa(n),Na("horz"===p[n].dir?"":"center"),(A.initialized||r.triggerEventsOnLoad)&&H("onhide_end",n)):(i.isHiding=!0,sa(n,!1,t)))}},na=function(e,t,n,r){if(C()){var e=z.call(this,e),i=A[e];O[e]&&i.isHidden&&!1!==H("onshow_start",e)&&(i.isSliding=!1,i.isShowing=!0,!1===t?sa(e,!0):da(e,!1,n,r))}},Qa=function(e,t){if(C()){var n=u(e),r=z.call(this,e),i=A[r];n&&n.stopImmediatePropagation();i.isHidden?na(r):i.isClosed?da(r,!!t):sa(r)}},Xa=function(e){var t=A[e];wa(e);t.isClosed=!0;t.isVisible=!1},sa=function(e,t,n,r){function i(){a.isMoving=!1;Ja(s,!0);var e=p.oppositeEdge[s];A[e].noRoom&&(D(e),Ea(e));ya();!r&&(A.initialized||u.triggerEventsOnLoad)&&(c||H("onclose_end",s),c&&H("onshow_end",s),h&&H("onhide_end",s))}var s=z.call(this,e);if(!A.initialized&&O[s])Xa(s);else if(C()){var o=O[s],u=B[s],a=A[s],f=p[s],l,c,h;T.queue(function(e){if(!o||!u.closable&&!a.isShowing&&!a.isHiding||!t&&a.isClosed&&!a.isShowing)return e();var r=!a.isShowing&&!1===H("onclose_start",s);c=a.isShowing;h=a.isHiding;delete a.isShowing;delete a.isHiding;if(r)return e();l=!n&&!a.isClosed&&"none"!=u.fxName_close;a.isMoving=!0;a.isClosed=!0;a.isVisible=!1;h?a.isHidden=!0:c&&(a.isHidden=!1);a.isSliding?Ra(s,!1):Na("horz"===p[s].dir?"":"center",!1);Da(s);l?(la("center"+("horz"==f.dir?",west,east":""),!0),za(s,!0),o.hide(u.fxName_close,u.fxSettings_close,u.fxSpeed_close,function(){za(s,!1);a.isClosed&&i();e()})):(wa(s),i(),e())})}},Da=function(e){var t=ja[e],n=ga[e],r=B[e],i=p[e].side.toLowerCase(),s=r.resizerClass,o=r.togglerClass,u="-"+e;t.css(i,U["inset"+p[e].side]).removeClass(s+"-open "+s+u+"-open").removeClass(s+"-sliding "+s+u+"-sliding").addClass(s+"-closed "+s+u+"-closed").unbind("dblclick."+$);r.resizable&&f.layout.plugins.draggable&&t.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title","");n&&(n.removeClass(o+"-open "+o+u+"-open").addClass(o+"-closed "+o+u+"-closed").attr("title",r.togglerTip_closed),n.children(".content-open").hide(),n.children(".content-closed").css("display","block"));Sa(e,!1);A.initialized&&Ia()},da=function(e,t,n,r){function i(){a.isMoving=!1;R(s);a.isSliding||(ya(),Na("vert"==p[s].dir?"center":"",!1));ra(s)}if(C()){var s=z.call(this,e),o=O[s],u=B[s],a=A[s],f=p[s],l,c;T.queue(function(e){if(!o||!u.resizable&&!u.closable&&!
a.isShowing||a.isVisible&&!a.isSliding)return e();if(a.isHidden&&!a.isShowing)e(),na(s,!0);else{u.autoResize&&a.size!=u.size?Ma(s,u.size,!0,!0,!0):D(s,t);var h=H("onopen_start",s);if("abort"===h)return e();"NC"!==h&&D(s,t);if(a.minSize>a.maxSize)return Sa(s,!1),!r&&u.noRoomToOpenTip&&alert(u.noRoomToOpenTip),e();t?Ra(s,!0):a.isSliding?Ra(s,!1):u.slidable&&Ja(s,!1);a.noRoom=!1;Ea(s);c=a.isShowing;delete a.isShowing;l=!n&&a.isClosed&&"none"!=u.fxName_open;a.isMoving=!0;a.isVisible=!0;a.isClosed=!1;c&&(a.isHidden=!1);l?(h="center"+("horz"==f.dir?",west,east":""),a.isSliding&&(h+=","+p.oppositeEdge[s]),la(h,!0),za(s,!0),o.show(u.fxName_open,u.fxSettings_open,u.fxSpeed_open,function(){za(s,!1);a.isVisible&&i();e()})):(oa(s),i(),e())}})}},ra=function(e,t){var n=O[e],r=ja[e],i=ga[e],s=B[e],o=A[e],u=p[e].side.toLowerCase(),a=s.resizerClass,l=s.togglerClass,c="-"+e;r.css(u,U["inset"+p[e].side]+Z(e)).removeClass(a+"-closed "+a+c+"-closed").addClass(a+"-open "+a+c+"-open");o.isSliding?r.addClass(a+"-sliding "+a+c+"-sliding"):r.removeClass(a+"-sliding "+a+c+"-sliding");s.resizerDblClickToggle&&r.bind("dblclick",Qa);N(0,r);s.resizable&&f.layout.plugins.draggable?r.draggable("enable").css("cursor",s.resizerCursor).attr("title",s.resizerTip):o.isSliding||r.css("cursor","default");i&&(i.removeClass(l+"-closed "+l+c+"-closed").addClass(l+"-open "+l+c+"-open").attr("title",s.togglerTip_open),N(0,i),i.children(".content-closed").hide(),i.children(".content-open").css("display","block"));Sa(e,!o.isSliding);f.extend(o,v(n));A.initialized&&(Ia(),Ba(e,!0));!t&&(A.initialized||s.triggerEventsOnLoad)&&n.is(":visible")&&(H("onopen_end",e),o.isShowing&&H("onshow_end",e),A.initialized&&H("onresize_end",e))},db=function(e){function t(){i.isClosed?i.isMoving||da(r,!0):Ra(r,!0)}if(C()){var n=u(e),r=z.call(this,e),i=A[r],e=B[r].slideDelay_open;n&&n.stopImmediatePropagation();i.isClosed&&n&&"mouseenter"===n.type&&0<e?M.set(r+"_openSlider",t,e):t()}},xa=function(e){function t(){i.isClosed?Ra(r,!1):i.isMoving||sa(r)}if(C()){var n=u(e),r=z.call(this,e),e=B[r],i=A[r],s=i.isMoving?1e3:300;!i.isClosed&&!i.isResizing&&("click"===e.slideTrigger_close?t():e.preventQuickSlideClose&&i.isMoving||e.preventPrematureSlideClose&&n&&f.layout.isMouseOverElem(n,O[r])||(n?M.set(r+"_closeSlider",t,b(e.slideDelay_close,s)):t()))}},za=function(e,t){var n=O[e],r=A[e],i=B[e],s=B.zIndexes;t?(n.css({zIndex:s.pane_animate}),"south"==e?n.css({top:U.insetTop+U.innerHeight-n.outerHeight()}):"east"==e&&n.css({left:U.insetLeft+U.innerWidth-n.outerWidth()})):(n.css({zIndex:r.isSliding?s.pane_sliding:s.pane_normal}),"south"==e?n.css({top:"auto"}):"east"==e&&!n.css("left").match(/\-99999/)&&n.css({left:"auto"}),o.msie&&i.fxOpacityFix&&"slide"!=i.fxName_open&&n.css("filter")&&1==n.css("opacity")&&n[0].style.removeAttribute("filter"))},Ja=function(e,t){var n=B[e],r=ja[e],i=n.slideTrigger_open.toLowerCase();r&&(!t||n.slidable)&&(i.match(/mouseover/)?i=n.slideTrigger_open="mouseenter":i.match(/click|dblclick|mouseenter/)||(i=n.slideTrigger_open="click"),r[t?"bind":"unbind"](i+"."+$,db).css("cursor",t?n.sliderCursor:"default").attr("title",t?n.sliderTip:""))},Ra=function(e,t){function n(t){M.clear(e+"_closeSlider");t.stopPropagation()}var r=B[e],i=A[e],s=B.zIndexes,o=r.slideTrigger_close.toLowerCase(),u=t?"bind":"unbind",a=O[e],f=ja[e];i.isSliding=t;M.clear(e+"_closeSlider");t&&Ja(e,!1);a.css("zIndex",t?s.pane_sliding:s.pane_normal);f.css("zIndex",t?s.pane_sliding+2:s.resizer_normal);o.match(/click|mouseleave/)||(o=r.slideTrigger_close="mouseleave");f[u](o,xa);"mouseleave"===o&&(a[u]("mouseleave."+$,xa),f[u]("mouseenter."+$,n),a[u]("mouseenter."+$,n));t?"click"===o&&!r.resizable&&(f.css("cursor",t?r.sliderCursor:"default"),f.attr("title",t?r.togglerTip_open:"")):M.clear(e+"_closeSlider")},Ea=function(e,t,n,r){var t=B[e],i=A[e],s=p[e],o=O[e],u=ja[e],a="vert"===s.dir,l=!1;if("center"===e||a&&i.noVerticalRoom)(l=0<=i.maxHeight)&&i.noRoom?(oa(e),u&&u.show(),i.isVisible=!0,i.noRoom=!1,a&&(i.noVerticalRoom=!1),R(e)):!l&&!i.noRoom&&(wa(e),u&&u.hide(),i.isVisible=!1,i.noRoom=!0);if("center"!==e)if(i.minSize<=i.maxSize){if(i.size>i.maxSize?Ma(e,i.maxSize,n,r,!0):i.size<i.minSize?Ma(e,i.minSize,n,r,!0):u&&i.isVisible&&o.is(":visible")&&(n=s.side.toLowerCase(),r=i.size+U["inset"+s.side],f.layout.cssNum(u,n)!=r&&u.css(n,r)),i.noRoom)i.wasOpen&&t.closable?t.autoReopen?da(e,!1,!0,!0):i.noRoom=!1:na(e,i.wasOpen,!0,!0)}else i.noRoom||(i.noRoom=!0,i.wasOpen=!i.isClosed&&!i.isSliding,i.isClosed||(t.closable?sa(e,!0,!0):Va(e,!0)))},ma=function(e,t,n,r){if(C()){var e=z.call(this,e),i=B[e],s=A[e],s=i.livePaneResizing&&!s.isResizing;i.autoResize=!1;Ma(e,t,n,s,r)}},Ma=function(e,n,r,i,s){function o(){for(var e="width"===g?h.outerWidth():h.outerHeight(),e=[{pane:u,count:1,target:n,actual:e,correct:n===e,attempt:n,cssSize:N}],s=e[0],o="Inaccurate size after resizing the "+u+"-pane.";!s.correct;){thisTry={pane:u,count:s.count+1,target:n};thisTry.attempt=s.actual>n?b(0,s.attempt-(s.actual-n)):b(0,s.attempt+(n-s.actual));thisTry.cssSize=("horz"==p[u].dir?t:x)(O[u],thisTry.attempt);h.css(g,thisTry.cssSize);thisTry.actual="width"==g?h.outerWidth():h.outerHeight();thisTry.correct=n===thisTry.actual;B.showDebugMessages&&(1===e.length&&(K(o,!1),K(s,!1)),K(thisTry,!1));if(3<e.length)break;e.push(thisTry);s=e[e.length-1]}l.size=n;f.extend(l,v(h));l.isVisible&&h.is(":visible")&&(d&&d.css(m,n+U[y]),Ba(u));!r&&!w&&A.initialized&&l.isVisible&&H("onresize_end",u);r||(l.isSliding||Na("horz"==p[u].dir?"":"center",w,i),Ia());s=p.oppositeEdge[u];n<S&&A[s].noRoom&&(D(s),Ea(s,!1,r));B.showDebugMessages&&1<e.length&&K(o+"\nSee the Error Console for details.",!0)}if(C()){var u=z.call(this,e),a=B[u],l=A[u],h=O[u],d=ja[u],m=p[u].side.toLowerCase(),g=p[u].sizeType.toLowerCase(),y="inset"+p[u].side,w=l.isResizing&&!a.triggerEventsDuringLiveResize,E=!0!==s&&a.animatePaneSizing,S,N;T.queue(function(e){D(u);S=l.size;n=V(u,n);n=b(n,V(u,a.minSize));n=c(n,l.maxSize);if(n<l.minSize)e(),Ea(u,!1,r);else{if(!i&&n===S)return e();!r&&A.initialized&&l.isVisible&&H("onresize_start",u);N=("horz"==p[u].dir?t:x)(O[u],n);if(E&&h.is(":visible")){var s=f.layout.effects.size[u]||f.layout.effects.size.all,s=a.fxSettings_size.easing||s.easing,d=B.zIndexes,m={};m[g]=N+"px";l.isMoving=!0;h.css({zIndex:d.pane_animate}).show().animate(m,a.fxSpeed_size,s,function(){h.css({zIndex:l.isSliding?d.pane_sliding:d.pane_normal});l.isMoving=!1;o();e()})}else h.css(g,N),h.is(":visible")?o():(l.size=n,f.extend(l,v(h))),e()}})}},Na=function(e,n,r){e=(e?e:"east,west,center").split(",");f.each(e,function(e,i){if(O[i]){var s=B[i],o=A[i],u=O[i],a=!0,l={},a={top:Z("north",!0),bottom:Z("south",!0),left:Z("west",!0),right:Z("east",!0),width:0,height:0};a.width=U.innerWidth-a.left-a.right;a.height=U.innerHeight-a.bottom-a.top;a.top+=U.insetTop;a.bottom+=U.insetBottom;a.left+=U.insetLeft;a.right+=U.insetRight;f.extend(o,v(u));if("center"===i){if(!r&&o.isVisible&&a.width===o.outerWidth&&a.height===o.outerHeight)return!0;f.extend(o,E(i),{maxWidth:a.width,maxHeight:a.height});l=a;l.width=x(u,l.width);l.height=t(u,l.height);a=0<=l.width&&0<=l.height;if(!A.initialized&&s.minWidth>o.outerWidth){var s=s.minWidth-o.outerWidth,h=B.east.minSize||0,p=B.west.minSize||0,m=A.east.size,g=A.west.size,y=m,w=g;0<s&&A.east.isVisible&&m>h&&(y=b(m-h,m-s),s-=m-y);0<s&&A.west.isVisible&&g>p&&(w=b(g-p,g-s),s-=g-w);if(0===s){m!=h&&Ma("east",y,!0,r,!0);g!=p&&Ma("west",w,!0,r,!0);Na("center",n,r);return}}}else{o.isVisible&&!o.noVerticalRoom&&f.extend(o,v(u),E(i));if(!r&&!o.noVerticalRoom&&a.height===o.outerHeight)return!0;l.top=a.top;l.bottom=a.bottom;l.height=t(u,a.height);o.maxHeight=l.height;a=0<=o.maxHeight;a||(o.noVerticalRoom=!0)}a?(!n&&A.initialized&&H("onresize_start",i),u.css(l),Ia(i),o.noRoom&&!o.isClosed&&!o.isHidden&&Ea(i),o.isVisible&&(f.extend(o,v(u)),A.initialized&&Ba(i))):!o.noRoom&&o.isVisible&&Ea(i);if(!o.isVisible)return!0;"center"===i&&(o=f.layout.browser,o=o.isIE6||o.msie&&!f.support.boxModel,O.north&&(o||"IFRAME"==A.north.tagName)&&O.north.css("width",x(O.north,U.innerWidth)),O.south&&(o||"IFRAME"==A.south.tagName)&&O.south.css("width",x(O.south,U.innerWidth)));!n&&A.initialized&&H("onresize_end",i)}})},Pa=function(){if(A.initialized){if(T.is(":visible:")&&(f.extend(A.container,v(T)),U.outerHeight)){if(!1===H("onresizeall_start"))return!1;var e,t,n;f.each(["south","north","east","west"],function(e,r){O[r]&&(n=A[r],t=B[r],t.autoResize&&n.size!=t.size?Ma(r,t.size,!0,!0,!0):(D(r),Ea(r,!1,!0,!0)))});Na("",!0,!0);Ia();t=B;f.each(p.allPanes,function(t,n){(e=O[n])&&A[n].isVisible&&H("onresize_end",n)});H("onresizeall_end")}}else Y()},Za=function(e){e=z.call(this,e);if(B[e].resizeChildLayout){var t=O[e],n=Ca[e],r=ea[e],i=F[e];r.child&&!i&&(i=r.child.container,i=F[e]=(i?i.data("layout"):0)||null);i&&i.destroyed&&(i=F[e]=null);i||(i=F[e]=t.data("layout")||(n?n.data("layout"):0)||null);r.child=F[e];i&&i.resizeAll()}},Ba=function(e,t){if(C()){var n=z.call(this,e),n=n?n.split(","):p.allPanes;f.each(n,function(e,n){function r(e){return b(a.css.paddingBottom,parseInt(e.css("marginBottom"),10)||0)}function i(){var e=B[n].contentIgnoreSelector,e=o.nextAll().not(e||":lt(0)"),t=e.filter(":visible"),i=t.filter(":last");f={top:o[0].offsetTop,height:o.outerHeight(),numFooters:e.length,hiddenFooters:e.length-t.length,spaceBelow:0};f.spaceAbove=f.top;f.bottom=f.top+f.height;f.spaceBelow=i.length?i[0].offsetTop+i.outerHeight()-f.bottom+r(i):r(o)}var s=O[n],o=Ca[n],u=B[n],a=A[n],f=a.content;if(!s||!o||!s.is(":visible"))return!0;if(!o.length&&(I(n,!1),!o))return;if(!1!==H("onsizecontent_start",n)){if(!a.isMoving&&!a.isResizing||u.liveContentResizing||t||void 0==f.top)i(),0<f.hiddenFooters&&"hidden"===s.css("overflow")&&(s.css("overflow","visible"),i(),s.css("overflow","hidden"));s=a.innerHeight-(f.spaceAbove-a.css.paddingTop)-(f.spaceBelow-a.css.paddingBottom);if(!o.is(":visible")||f.height!=s)aa(o,s,!0),f.height=s;A.initialized&&H("onsizecontent_end",n)}})}},Ia=function(e){e=(e=z.call(this,e))?e.split(","):p.borderPanes;f.each(e,function(e,n){var r=B[n],i=A[n],s=O[n],o=ja[n],u=ga[n],l;if(s&&o){var c=p[n].dir,h=i.isClosed?"_closed":"_open",d=r["spacing"+h],v=r["togglerAlign"+h],h=r["togglerLength"+h],m;if(0===d)o.hide();else{!i.noRoom&&!i.isHidden&&o.show();"horz"===c?(m=U.innerWidth,i.resizerLength=m,s=f.layout.cssNum(s,"left"),o.css({width:x(o,m),height:t(o,d),left:-9999<s?s:U.insetLeft})):(m=s.outerHeight(),i.resizerLength=m,o.css({height:t(o,m),width:x(o,d),top:U.insetTop+Z("north",!0)}));N(r,o);if(u){if(0===h||i.isSliding&&r.hideTogglerOnSlide){u.hide();return}u.show();if(!(0<h)||"100%"===h||h>m)h=m,v=0;else if(a(v))switch(v){case"top":case"left":v=0;break;case"bottom":case"right":v=m-h;break;default:v=k((m-h)/2)}else s=parseInt(v,10),v=0<=v?s:m-h+s;if("horz"===c){var g=x(u,h);u.css({width:g,height:t(u,d),left:v,top:0});u.children(".content").each(function(){l=f(this);l.css("marginLeft",k((g-l.outerWidth())/2))})}else{var y=t(u,h);u.css({height:y,width:x(u,d),top:v,left:0});u.children(".content").each(function(){l=f(this);l.css("marginTop",k((y-l.outerHeight())/2))})}N(0,u)}!A.initialized&&(r.initHidden||i.noRoom)&&(o.hide(),u&&u.hide())}}})},rb=function(e){if(C()){var t=z.call(this,e),e=ga[t],n=B[t];e&&(n.closable=!0,e.bind("click."+$,function(e){e.stopPropagation();Qa(t)}).css("visibility","visible").css("cursor","pointer").attr("title",A[t].isClosed?n.togglerTip_closed:n.togglerTip_open).show())}},Sa=function(e,t){f.layout.plugins.buttons&&f.each(A[e].pins,function(n,r){f.layout.buttons.setPinState(ea,f(r),e,t)})},T=f(this).eq(0);if(!T.length)return B.showErrorMessages&&K(q.errContainerMissing,!0),null;if(T.data("layoutContainer")&&T.data("layout"))return T.data("layout");var O={},Ca={},ja={},ga={},Ga=f([]),U=A.container,$=A.id,ea={options:B,state:A,container:T,panes:O,contents:Ca,resizers:ja,togglers:ga,hide:Va,show:na,toggle:Qa,open:da,close:sa,slideOpen:db,slideClose:xa,slideToggle:function(e){e=z.call(this,e);Qa(e,!0)},setSizeLimits:D,_sizePane:Ma,sizePane:ma,sizeContent:Ba,swapPanes:function(e,t){function n(e){var t=O[e],n=Ca[e];return t?{pane:e,P:t?t[0]:!1,C:n?n[0]:!1,state:f.extend(!0,{},A[e]),options:f.extend(!0,{},B[e])}:!1}function r(e,t){if(e){var n=e.P,r=e.C,i=e.pane,s=p[t],o=s.side.toLowerCase(),a="inset"+s.side,c=f.extend({},A[t]),h=B[t],d={resizerCursor:h.resizerCursor};f.each(["fxName","fxSpeed","fxSettings"],function(e,t){d[t+"_open"]=h[t+"_open"];d[t+"_close"]=h[t+"_close"];d[t+"_size"]=h[t+"_size"]});O[t]=f(n).data({layoutPane:ea[t],layoutEdge:t}).css(p.hidden).css(s.cssReq);Ca[t]=r?f(r):!1;B[t]=f.extend({},e.options,d);A[t]=f.extend({},e.state);n.className=n.className.replace(RegExp(h.paneClass+"-"+i,"g"),h.paneClass+"-"+t);ua(t);s.dir!=p[i].dir?(n=u[t]||0,D(t),n=b(n,A[t].minSize),ma(t,n,!0,!0)):ja[t].css(o,U[a]+(A[t].isVisible?Z(t):0));e.state.isVisible&&!c.isVisible?ra(t,!0):(Da(t),Ja(t,!0));e=null}}if(C()){var i=z.call(this,e);A[i].edge=t;A[t].edge=i;if(!1===H("onswap_start",i)||!1===H("onswap_start",t))A[i].edge=i,A[t].edge=t;else{var s=n(i),o=n(t),u={};u[i]=s?s.state.size:0;u[t]=o?o.state.size:0;O[i]=!1;O[t]=!1;A[i]={};A[t]={};ga[i]&&ga[i].remove();ga[t]&&ga[t].remove();ja[i]&&ja[i].remove();ja[t]&&ja[t].remove();ja[i]=ja[t]=ga[i]=ga[t]=!1;r(s,t);r(o,i);s=o=u=null;O[i]&&O[i].css(p.visible);O[t]&&O[t].css(p.visible);Pa();H("onswap_end",i);H("onswap_end",t)}}},initContent:I,addPane:qa,removePane:Oa,createChildLayout:ha,enableClosable:rb,disableClosable:function(e,t){if(C()){var n=z.call(this,e),r=ga[n];r&&(B[n].closable=!1,A[n].isClosed&&da(n,!1,!0),r.unbind("."+$).css("visibility",t?"hidden":"visible").css("cursor","default").attr("title",""))}},enableSlidable:function(e){if(C()){var e=z.call(this,e),t=ja[e];t&&t.data("draggable")&&(B[e].slidable=!0,s.isClosed&&Ja(e,!0))}},disableSlidable:function(e){if(C()){var e=z.call(this,e),t=ja[e];t&&(B[e].slidable=!1,A[e].isSliding?sa(e,!1,!0):(Ja(e,!1),t.css("cursor","default").attr("title",""),N(null,t[0])))}},enableResizable:function(e){if(C()){var e=z.call(this,e),t=ja[e],n=B[e];t&&t.data("draggable")&&(n.resizable=!0,t.draggable("enable"),A[e].isClosed||t.css("cursor",n.resizerCursor).attr("title",n.resizerTip))}},disableResizable:function(e){if(C()){var e=z.call(this,e),t=ja[e];t&&t.data("draggable")&&(B[e].resizable=!1,t.draggable("disable").css("cursor","default").attr("title",""),N(null,t[0]))}},allowOverflow:d,resetOverflow:l,destroy:function(t){f(window).unbind("."+$);f(document).unbind("."+$);T.clearQueue().removeData("layout").removeData("layoutContainer").removeClass(B.containerClass).unbind("."+$);Ga.remove();f.each(p.allPanes,function(e,n){Oa(n,!1,!0,t)});T.data("layoutCSS")&&!T.data("layoutRole")&&T.css(T.data("layoutCSS")).removeData("layoutCSS");"BODY"===U.tagName&&(T=f("html")).data("layoutCSS")&&T.css(T.data("layoutCSS")).removeData("layoutCSS");e(ea,f.layout.onDestroy);S();for(n in ea)n.match(/^(container|options)$/)||delete ea[n];ea.destroyed=!0;return ea},initPanes:C,resizeAll:Pa,runCallbacks:H,hasParentLayout:!1,children:F,north:!1,south:!1,west:!1,east:!1,center:!1};return"cancel"===function(){ka();var t=B;A.creatingLayout=!0;e(ea,f.layout.onCreate);if(!1===H("onload_start"))return"cancel";var n=T[0],r=U.tagName=n.tagName,i=U.id=n.id,s=U.className=n.className,n=B,o=n.name,u="BODY"===r,a={},l=T.data("parentLayout"),c=T.data("layoutEdge"),h=l&&c;U.selector=T.selector.split(".slice")[0];U.ref=(n.name?n.name+" layout / ":"")+r+(i?"#"+i:s?".["+s+"]":"");T.data({layout:ea,layoutContainer:$}).addClass(n.containerClass);r={destroy:"",initPanes:"",resizeAll:"resizeAll",resize:"resizeAll"};for(o in r)T.bind("layout"+o.toLowerCase()+"."+$,ea[r[o]||o]);h&&(ea.hasParentLayout=!0,l[c].child=l.children[c]=T.data("layout"));T.data("layoutCSS")||(u?(a=f.extend(y(T,"overflow,position,margin,padding,border"),{height:T.css("height"),overflow:T.css("overflow"),overflowX:T.css("overflowX"),overflowY:T.css("overflowY")}),r=f("html"),r.data("layoutCSS",{height:"auto",overflow:r.css("overflow"),overflowX:r.css("overflowX"),overflowY:r.css("overflowY")})):a=y(T,"overflow,position,margin,padding,border,top,bottom,left,right,width,height,overflow,overflowX,overflowY"),T.data("layoutCSS",a));try{if(u)f("html").css({height:"100%",overflow:"hidden",overflowX:"hidden",overflowY:"hidden"}),f("body").css({position:"relative",height:"100%",overflow:"hidden",overflowX:"hidden",overflowY:"hidden",margin:0,padding:0,border:"none"}),f.extend(U,v(T));else{var a={overflow:"hidden",overflowX:"hidden",overflowY:"hidden"},p=T.css("position");T.css("height");!h&&(!p||!p.match(/fixed|absolute|relative/))&&(a.position="relative");T.css(a);T.is(":visible")&&(f.extend(U,v(T)),n.showErrorMessages&&1>U.innerHeight&&K(q.errContainerHeight.replace(/CONTAINER/,U.ref),!0))}}catch(d){}W();f(window).bind("unload."+$,S);e(ea,f.layout.onLoad);t.initPanes&&Y();delete A.creatingLayout;return A.initialized}()?null:ea};f.ui||(f.ui={});f.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(e){for(var t=document.cookie,t=t?t.split(";"):[],n,r=0,i=t.length;r<i;r++){n=f.trim(t[r]).split("=");if(n[0]==e)return decodeURIComponent(n[1])}return null},write:function(e,t,n){var r="",i="",s=!1,n=n||{},o=n.expires;if(o&&o.toUTCString)i=o;else if(o===null||typeof o=="number"){i=new Date;if(o>0)i.setDate(i.getDate()+o);else{i.setFullYear(1970);s=!0}}i&&(r+=";expires="+i.toUTCString());n.path&&(r+=";path="+n.path);n.domain&&(r+=";domain="+n.domain);n.secure&&(r+=";secure");document.cookie=e+"="+(s?"":encodeURIComponent(t))+r},clear:function(e){f.ui.cookie.write(e,"",{expires:-1})}};f.cookie||(f.cookie=function(e,t,n){var r=f.ui.cookie;if(t===null)r.clear(e);else{if(t===void 0)return r.read(e);r.write(e,t,n)}});f.layout.plugins.stateManagement=!0;f.layout.config.optionRootKeys.push("stateManagement");f.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}};f.layout.optionsMap.layout.push("stateManagement");f.layout.state={saveCookie:function(e,t,n){var r=e.options,i=r.stateManagement,n=f.extend(!0,{},i.cookie,n||null),e=e.state.stateData=e.readState(t||i.stateKeys);f.ui.cookie.write(n.name||r.name||"Layout",f.layout.state.encodeJSON(e),n);return f.extend(!0,{},e)},deleteCookie:function(e){e=e.options;f.ui.cookie.clear(e.stateManagement.cookie.name||e.name||"Layout")},readCookie:function(e){e=e.options;return(e=f.ui.cookie.read(e.stateManagement.cookie.name||e.name||"Layout"))?f.layout.state.decodeJSON(e):{}},loadCookie:function(e){var t=f.layout.state.readCookie(e);if(t){e.state.stateData=f.extend(!0,{},t);e.loadState(t)}return t},loadState:function(e,t,n){t=f.layout.transformData(t);if(!f.isEmptyObject(t)){f.extend(!0,e.options,t);if(e.state.initialized){var r,i,s,o,u,a=n===!1;f.each(f.layout.config.borderPanes,function(n,f){state=e.state[f];i=t[f];if(typeof i=="object"){s=i.size;u=i.initClosed;o=i.initHidden;(r=state.isVisible)||e.sizePane(f,s,!1,!1);o===!0?e.hide(f,a):u===!1?e.open(f,!1,a):u===!0?e.close(f,!1,a):o===!1&&e.show(f,!1,a);r&&e.sizePane(f,s,!1,a)}})}}},readState:function(e,t){var n={},r={isClosed:"initClosed",isHidden:"initHidden"},i=e.state,s=f.layout.config.allPanes,o,u,a;t||(t=e.options.stateManagement.stateKeys);f.isArray(t)&&(t=t.join(","));for(var t=t.replace(/__/g,".").split(","),l=0,c=t.length;l<c;l++){o=t[l].split(".");u=o[0];o=o[1];if(!(f.inArray(u,s)<0)){a=i[u][o];if(a!=void 0){o=="isClosed"&&i[u].isSliding&&(a=!0);(n[u]||(n[u]={}))[r[o]?r[o]:o]=a}}}return n},encodeJSON:function(e){function t(e){var n=[],r=0,i,s,o;for(i in e){s=e[i];o=typeof s;o=="string"?s='"'+s+'"':o=="object"&&(s=t(s));n[r++]='"'+i+'":'+s}return"{"+n.join(",")+"}"}return t(e)},decodeJSON:function(e){try{return f.parseJSON?f.parseJSON(e):window.eval("("+e+")")||{}}catch(t){return{}}},_create:function(e){var t=f.layout.state;f.extend(e,{readCookie:function(){return t.readCookie(e)},deleteCookie:function(){t.deleteCookie(e)},saveCookie:function(n,r){return t.saveCookie(e,n,r)},loadCookie:function(){return t.loadCookie(e)},loadState:function(n,r){t.loadState(e,n,r)},readState:function(n){return t.readState(e,n)},encodeJSON:t.encodeJSON,decodeJSON:t.decodeJSON});e.state.stateData={};var n=e.options.stateManagement;n.enabled&&(n.autoLoad?e.loadCookie():e.state.stateData=e.readCookie())},_unload:function(e){var t=e.options.stateManagement;t.enabled&&(t.autoSave?e.saveCookie():e.state.stateData=e.readState())}};f.layout.onCreate.push(f.layout.state._create);f.layout.onUnload.push(f.layout.state._unload);f.layout.plugins.buttons=!0;f.layout.defaults.autoBindCustomButtons=!1;f.layout.optionsMap.layout.push("autoBindCustomButtons");l=f.layout.language;f.layout.buttons={init:function(e){var t=e.options.name||"",n;f.each(["toggle","open","close","pin","toggle-slide","open-slide"],function(r,i){f.each(f.layout.config.borderPanes,function(r,s){f(".ui-layout-button-"+i+"-"+s).each(function(){n=f(this).data("layoutName")||f(this).attr("layoutName");(n==void 0||n===t)&&e.bindButton(this,i,s)})})})},get:function(e,t,n,r){var i=f(t),e=e.options,s=e.showErrorMessages;if(i.length)if(f.inArray(n,f.layout.config.borderPanes)<0){s&&f.layout.msg(l.errButton+l.pane+": "+n,!0);i=f("")}else{t=e[n].buttonClass+"-"+r;i.addClass(t+" "+t+"-"+n).data("layoutName",e.name)}else s&&f.layout.msg(l.errButton+l.selector+": "+t,!0);return i},bind:function(e,t,n,r){var i=f.layout.buttons;switch(n.toLowerCase()){case"toggle":i.addToggle(e,t,r);break;case"open":i.addOpen(e,t,r);break;case"close":i.addClose(e,t,r);break;case"pin":i.addPin(e,t,r);break;case"toggle-slide":i.addToggle(e,t,r,!0);break;case"open-slide":i.addOpen(e,t,r,!0)}return e},addToggle:function(e,t,n,r){f.layout.buttons.get(e,t,n,"toggle").click(function(t){e.toggle(n,!!r);t.stopPropagation()});return e},addOpen:function(e,t,n,r){f.layout.buttons.get(e,t,n,"open").attr("title",l.Open).click(function(t){e.open(n,!!r);t.stopPropagation()});return e},addClose:function(e,t,n){f.layout.buttons.get(e,t,n,"close").attr("title",l.Close).click(function(t){e.close(n);t.stopPropagation()});return e},addPin:function(e,t,n){var r=f.layout.buttons,i=r.get(e,t,n,"pin");if(i.length){var s=e.state[n];i.click(function(t){r.setPinState(e,f(this),n,s.isSliding||s.isClosed);s.isSliding||s.isClosed?e.open(n):e.close(n);t.stopPropagation()});r.setPinState(e,i,n,!s.isClosed&&!s.isSliding);s.pins.push(t)}return e},setPinState:function(e,t,n,r){var i=t.attr("pin");if(!i||r!==(i=="down")){e=e.options[n].buttonClass+"-pin";i=e+"-"+n;n=e+"-up "+i+"-up";e=e+"-down "+i+"-down";t.attr("pin",r?"down":"up").attr("title",r?l.Unpin:l.Pin).removeClass(r?n:e).addClass(r?e:n)}},syncPinBtns:function(e,t,n){f.each(state[t].pins,function(r,i){f.layout.buttons.setPinState(e,f(i),t,n)})},_load:function(e){var t=f.layout.buttons;f.extend(e,{bindButton:function(n,r,i){return t.bind(e,n,r,i)},addToggleBtn:function(n,r,i){return t.addToggle(e,n,r,i)},addOpenBtn:function(n,r,i){return t.addOpen(e,n,r,i)},addCloseBtn:function(n,r){return t.addClose(e,n,r)},addPinBtn:function(n,r){return t.addPin(e,n,r)}});for(var n=0;n<4;n++)e.state[f.layout.config.borderPanes[n]].pins=[];e.options.autoBindCustomButtons&&t.init(e)},_unload:function(){}};f.layout.onLoad.push(f.layout.buttons._load);f.layout.plugins.browserZoom=!0;f.layout.defaults.browserZoomCheckInterval=1e3;f.layout.optionsMap.layout.push("browserZoomCheckInterval");f.layout.browserZoom={_init:function(e){f.layout.browserZoom.ratio()!==!1&&f.layout.browserZoom._setTimer(e)},_setTimer:function(e){if(!e.destroyed){var t=e.options,n=e.state,r=e.hasParentLayout?5e3:Math.max(t.browserZoomCheckInterval,100);setTimeout(function(){if(!e.destroyed&&t.resizeWithWindow){var r=f.layout.browserZoom.ratio();if(r!==n.browserZoom){n.browserZoom=r;e.resizeAll()}f.layout.browserZoom._setTimer(e)}},r)}},ratio:function(){function e(e,t){return(parseInt(e,10)/parseInt(t,10)*100).toFixed()}var t=window,n=screen,r=document,i=r.documentElement||r.body,s=f.layout.browser,o=s.version,u,a,l;return s.msie&&o>8||!s.msie?!1:n.deviceXDPI?e(n.deviceXDPI,n.systemXDPI):s.webkit&&(u=r.body.getBoundingClientRect)?e(u.left-u.right,r.body.offsetWidth):s.webkit&&(a=t.outerWidth)?e(a,t.innerWidth):(a=n.width)&&(l=i.clientWidth)?e(a,l):!1}};f.layout.onReady.push(f.layout.browserZoom._init)})(k)});define("RepositoryBrowser",["Class","jquery","PubSub","repository-browser-i18n-"+(window&&window.__DEPS__&&window.__DEPS__.lang||"en"),"jstree","jqgrid","jquery-layout"],function(e,t,n,r){function i(e){e.each(function(){t(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).each(function(){this.onselectstart=function(){return!1}})})}var s=[],o=0,u=(new Date).getTime(),a={repositoryManager:null,repositoryFilter:[],objectTypeFilter:[],renditionFilter:["cmis:none"],filter:["url"],element:null,isFloating:!1,verticalPadding:100,horizontalPadding:50,maxHeight:1e3,minHeight:400,minWidth:400,maxWidth:1200,treeWidth:300,listWidth:"auto",pageSize:8,rootPath:"",rootFolderId:"aloha",columns:{icon:{title:"",width:30,sortable:!1,resizable:!1},name:{title:"Name",width:200,sorttype:"text"},url:{title:"URL",width:220,sorttype:"text"},preview:{title:"Preview",width:150,sorttype:"text"}},i18n:{Browsing:"Browsing",Close:"Close","in":"in","Input search text...":"Input search text...",numerous:"numerous",of:"of","Repository Browser":"Repository Browser",Search:"Search","Searching for":"Searching for",Viewing:"Viewing"}};return e.extend({_cachedRepositoryObjects:{},_searchQuery:null,_orderBy:null,$_grid:null,$_tree:null,$_list:null,_isOpened:!0,_constructor:function(){this.init.apply(this,arguments)},init:function(e){e=t.extend({},a,e,{i18n:r});if(!e.element||0===e.element.length)e.isFloating=!0,e.element=this._createOverlay();e.maxWidth<e.minWidth&&(e.maxWidth=e.minWidth);t.extend(this,e);this._cachedRepositoryObjects={};this._pagingCount=this._orderBy=this._searchQuery=null;this._pagingOffset=0;this._pagingBtns={first:null,end:null,next:null,prev:null};this._initializeUI();s.push(this);n.pub("repository-browser.initialized",{data:this})},_i18n:function(e){return this.i18n[e]||e},_initializeUI:function(){this.element.attr("data-repository-browser",++u);this.element.width(this.maxWidth);this.$_grid=this._createGrid(this.element).resize();this._setIntialHeight();this.$_tree=this._createTree(this.$_grid.find(".ui-layout-west"));this.$_list=this._createList(this.$_grid.find(".ui-layout-center"));var e=this,n=this.treeWidth/5;this.$_grid.layout({enableCursorHotkey:!1,west__size:this.treeWidth-1,west__minSize:this.treeWidth-n,west__maxSize:this.treeWidth+n,center__size:"auto",paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",onresize:function(t,n){"center"===t&&e.$_list.setGridWidth(n.width())}}).sizePane("west",this.treeWidth);i(this.$_grid);this._preloadImages();t(function(){t(window).resize(function(){e._onWindowResized()})});this.element.mousedown(function(){t.each(s,function(e){this.element.css("z-index",99999+e)});t(this).css("z-index",99999+s.length+1)});t(".repository-browser-grid").css("width",this.maxWidth);this.close()},_setIntialHeight:function(){var e=this.maxHeight-t(window).height()+this.verticalPadding;this.$_grid.height(0<e?Math.max(this.minHeight,this.maxHeight-e):this.maxHeight)},_onWindowResized:function(){var e=this.maxWidth-t(window).width()+this.horizontalPadding,e=0<e?Math.max(this.minWidth,this.maxWidth-e):this.maxWidth;this.element.width(e);this.$_grid.width(e)},_preloadImages:function(){for(var e=this.rootPath+"img/",t="arrow-000-medium.png arrow-180.png arrow-315-medium.png arrow-stop-180.png arrow-stop.png arrow.png control-stop-square-small.png folder-horizontal-open.png folder-open.png magnifier-left.png page.png picture.png sort-alphabet-descending.png sort-alphabet.png".split(" "),n=t.length;n;)document.createElement("img").src=e+t[--n]},_processRepoResponse:function(e,t,n){var r=[],i;"function"==typeof t&&(n=t,t=void 0);for(i=0;i<e.length;i++)r.push(this._harvestRepoObject(e[i]));n(r,t)},_harvestRepoObject:function(e){++u;this._cachedRepositoryObjects[u]=t.extend(e,{uid:u,loaded:!1});var e=this._cachedRepositoryObjects[u],n;switch(e.baseType){case"folder":n="folder";break;case"document":n="document"}return{data:{title:e.name,attr:{"data-repo-obj":e.uid},icon:n||""},attr:e.type?{rel:e.type}:void 0,state:e.hasMoreItems||"folder"===e.baseType?"closed":null,resource:e}},_fetchRepoRoot:function(e){this.repositoryManager&&this.getRepoChildren({inFolderId:this.rootFolderId,repositoryFilter:this.repositoryFilter},e)},_getObjectFromCache:function(e){return e&&e.length?this._cachedRepositoryObjects[e.find("a:first").attr("data-repo-obj")]:null},_onTreeNodeSelected:function(e,t){if(!t.args[0].context){var n=this._getObjectFromCache(t.rslt.obj);n&&(this._pagingOffset=0,this._searchQuery=null,this._currentFolder=n,this._fetchItems(n))}},_createTree:function(e){var n=t('<div class="repository-browser-tree">'),r=t('<div class="repository-browser-tree-header repository-browser-grab-handle">'+this._i18n("Repository Browser")+"</div>");e.append(r,n);n.height(this.$_grid.height()-r.outerHeight(!0));n.bind("loaded.jstree",function(){t(this).find(">ul>li:first").css("padding-top",5);n.jstree("open_node",'li[rel="repository"]')});var i=this;n.bind("select_node.jstree",function(e,t){i._onTreeNodeSelected(e,t)});n.jstree({types:this.types,rootFolderId:this.rootFolderId,plugins:["themes","json_data","ui","types"],core:{animation:250},themes:{url:this.rootPath+"css/jstree.css",dots:!0,icons:!0,theme:"browser"},json_data:{data:function(e,t){i.repositoryManager?(i.jstree_callback=t,i._fetchSubnodes(e,t)):t()},correct_state:!0},ui:{select_limit:1}});return n},_createGrid:function(e){var n=t('<div class="repository-browser-grid				             repository-browser-shadow							 repository-browser-rounded-top">					<div class="ui-layout-west"></div>					<div class="ui-layout-center"></div>				</div>');e.append(n);return n},_createList:function(e){var n=t('<table id="repository-browser-list-'+ ++u+'" class="repository-browser-list"></table>'),r=[{name:"id",sorttype:"int",firstsortorder:"asc",hidden:!0}],i=[""];t.each(this.columns,function(e,t){i.push(t.title||"&nbsp;");r.push({name:e,width:t.width,sortable:t.sortable,sorttype:t.sorttype,resizable:t.resizable,fixed:t.fixed})});var s="repository-browser-list-page-"+ ++u;e.append(n,t('<div id="'+s+'">'));n.jqGrid({datatype:"local",width:e.width(),shrinkToFit:!0,colNames:i,colModel:r,caption:"&nbsp;",altRows:!0,altclass:"repository-browser-list-altrow",resizeclass:"repository-browser-list-resizable",pager:"#"+s,viewrecords:!0,onPaging:function(){},loadError:function(){},ondblClickRow:function(){},gridComplete:function(){},loadComplete:function(){}});e.find(".ui-jqgrid-bdiv").height(this.$_grid.height()-(e.find(".ui-jqgrid-titlebar").height()+e.find(".ui-jqgrid-hdiv").height()+e.find(".ui-jqgrid-pager").height()));var o=this;n.click(function(){o.rowClicked.apply(o,arguments)});e.find(".ui-pg-button").unbind().find(">span.ui-icon").each(function(){var e=this.className.match(/ui\-icon\-seek\-([a-z]+)/)[1];o._pagingBtns[e]=t(this).parent().addClass("ui-state-disabled").click(function(){t(this).hasClass("ui-state-disabled")||o._doPaging(e)})});e.find(".ui-pg-input").parent().hide();e.find(".ui-separator").parent().css("opacity",0).first().hide();this._createTitlebar(e);var a=n[0].p;e.find(".ui-jqgrid-view tr:first th div").each(function(e){!1!==a.colModel[e].sortable&&(t(this).css("cursor","pointer"),t(this).unbind().click(function(t){t.stopPropagation();o._sortList(a.colModel[e],this)}))});return n},_createTitlebar:function(e){var e=e.find(".ui-jqgrid-titlebar"),n=t('<div class="repository-browser-btns">					<input type="text" class="repository-browser-search-field" />					<span class="repositroy-browser-btn repository-browser-search-btn">						<span class="repository-browser-search-icon"></span>					</span>					<span class="repository-browser-btn repository-browser-close-btn">'+this._i18n("Close")+'</span>					<div class="repository-browser-clear"></div>				</div>'),r=this;e.addClass("repository-browser-grab-handle").append(n);e.find(".repository-browser-search-btn").html(this._i18n("Search")).click(function(){r._triggerSearch()});var i=this._i18n("Input search text..."),n=e.find(".repository-browser-search-field");n.val(i).addClass("repository-browser-search-field-empty");n.keypress(function(e){13===e.keyCode&&r._triggerSearch()});n.focus(function(){t(this).val()===i&&t(this).val("").removeClass("repository-browser-search-field-empty")});n.blur(function(){""===t(this).val()&&
t(this).val(i).addClass("repository-browser-search-field-empty")});e.find(".repository-browser-close-btn").click(function(){r.close()});e.find(".repository-browser-btn").mousedown(function(){t(this).addClass("repository-browser-pressed")}).mouseup(function(){t(this).removeClass("repository-browser-pressed")})},_triggerSearch:function(){var e=this.$_grid.find("input.repository-browser-search-field"),n=e.val();if(t(e).hasClass("aloha-browser-search-field-empty")||""==n.val())n=null;this._pagingOffset=0;this._searchQuery=n;this._fetchItems(this._currentFolder)},_sortList:function(e,n){this.$_grid.find("span.ui-grid-ico-sort").addClass("ui-state-disabled");e.sortorder="asc"===e.sortorder?"desc":"asc";t(n).find("span.s-ico").show().find(".ui-icon-"+e.sortorder).removeClass("ui-state-disabled");this._setSortOrder(e.name,e.sortorder);this._fetchItems(this._currentFolder)},_doPaging:function(e){switch(e){case"first":this._pagingOffset=0;break;case"end":this._pagingOffset=0===this._pagingCount%this.pageSize?this._pagingCount-this.pageSize:this._pagingCount-this._pagingCount%this.pageSize;break;case"next":this._pagingOffset+=this.pageSize;break;case"prev":this._pagingOffset-=this.pageSize}this._fetchItems(this._currentFolder)},_setSortOrder:function(e,t){var n={},r=!1,i=this._orderBy||[],s,o,u;n[e]=t||"asc";for(u=0;u<i.length;++u){s=i[u];for(o in s)if(s.hasOwnProperty(o)&&o===e){i.splice(u,1);i.unshift(n);r=!0;break}if(r)break}r&&i.unshift(n);this._orderBy=i},_listItems:function(e){var n=this.$_list.clearGridData(),r,i;for(r=0;r<e.length;r++)i=e[r].resource,n.addRowData(i.uid,t.extend({id:i.id},this.renderRowCols(i)))},_processItems:function(e,n){this._pagingCount=n&&t.isNumeric(n.numItems)?n.numItems:null;this.$_grid.find(".loading").hide();this.$_list.show();this._listItems(e);var r=this._pagingBtns;0>=this._pagingOffset?r.first.add(r.prev).addClass("ui-state-disabled"):r.first.add(r.prev).removeClass("ui-state-disabled");t.isNumeric(this._pagingCount)?(r.end.addClass("ui-state-disabled"),e.length<this.pageSize?r.next.addClass("ui-state-disabled"):r.next.removeClass("ui-state-disabled")):this._pagingOffset+this.pageSize>=this._pagingCount?r.end.add(r.next).addClass("ui-state-disabled"):r.end.add(r.next).removeClass("ui-state-disabled");var i;0===e.length&&0===this._pagingOffset?i=r=0:(r=this._pagingOffset+1,i=r+e.length-1);this.$_grid.find(".ui-paging-info").html(this._i18n("Viewing")+" "+r+" - "+i+" "+this._i18n("of")+" "+(t.isNumeric(this._pagingCount)?this._pageingCount:this._i18n("numerous")))},_createOverlay:function(){0===t(".repository-browser-modal-overlay").length&&t("body").append('<div class="repository-browser-modal-overlay" style="top: -99999px; z-index: 99999;"></div>');var e=this;t(".repository-browser-modal-overlay").click(function(){e.close()});var n=t('<div class="repository-browser-modal-window" style="top: -99999px; z-index: 99999;">');t("body").append(n);return n},_fetchSubnodes:function(e,t){if(-1===e)this._fetchRepoRoot(t);else{var n;for(n=0;n<e.length;n++){var r=this._getObjectFromCache(e.eq(n));r&&this.fetchChildren(r,t)}}},getRepoChildren:function(e,t){if(this.repositoryManager){var n=this;this.repositoryManager.getChildren(e,function(e){n._processRepoResponse(e,t)})}},queryRepository:function(e,t){if(this.repositoryManager){var n=this;this.repositoryManager.query(e,function(e){n._processRepoResponse(0<e.results?e.items:[],{numItems:e.numItems,hasMoreItems:e.hasMoreItems},t)})}},renderRowCols:function(e){var n={};t.each(this.columns,function(t){switch(t){case"icon":n.icon='<div class="repository-browser-icon repository-browser-icon-'+e.type+'"></div>';break;default:n[t]=e[t]||"--"}});return n},onSelect:function(){},fetchChildren:function(e,t){if((!0===e.hasMoreItems||"folder"===e.baseType)&&!1===e.loaded){var n=this;this.getRepoChildren({inFolderId:e.id,repositoryId:e.repositoryId},function(r){n._cachedRepositoryObjects[e.uid].loaded=!0;"function"==typeof t&&t(r)})}},rowClicked:function(e){e=t(e.target).parent("tr");return e.length?(e=this._cachedRepositoryObjects[e.attr("id")],this.onSelect(e),e):null},getFieldOfHeader:function(e){return e.find("div.ui-jqgrid-sortable").attr("id").replace("jqgh_","")},_fetchItems:function(e){if(e){var t="string"==typeof this._searchQuery;this.$_list.setCaption("string"==typeof this._searchQuery?this._i18n("Searching for")+' "'+this._searchQuery+'" '+this._i18n("in")+" "+e.name:this._i18n("Browsing")+": "+e.name);this.$_list.hide();this.$_grid.find(".loading").show();var n=this;this.queryRepository({repositoryId:e.repositoryId,inFolderId:e.id,queryString:this._searchQuery,orderBy:this._orderBy,skipCount:this._pagingOffset,maxItems:this.pageSize,objectTypeFilter:this.objectTypeFilter,renditionFilter:this.renditionFilter,filter:this.filter,recursive:t},function(e,t){n._processItems(e,t)})}},setObjectTypeFilter:function(e){this.objectTypeFilter="string"==typeof e?[e]:e},getObjectTypeFilter:function(){return this.objectTypeFilter},show:function(){this.open()},open:function(){if(!this._isOpened){this._isOpened=!0;var e=this.element;if(this.isFloating){t(".repository-browser-modal-overlay").stop().css({top:0,left:0}).show();e.stop().show();var n=t(window);e.css({left:(n.width()-e.width())/2-30,top:(n.height()-e.height())/3+10}).draggable({handle:e.find(".repository-browser-grab-handle")});this.$_grid.css({marginTop:0,opacity:0}).animate({marginTop:0,opacity:1},1500,"easeOutExpo",function(){t.browser.msie&&t(this).add(e).css("filter","progid:DXImageTransform.Microsoft.gradient(enabled=false)")})}else e.stop().show().css({opacity:1,filter:"progid:DXImageTransform.Microsoft.gradient(enabled=false)"});this._onWindowResized();++o}},close:function(){this._isOpened&&(this._isOpened=!1,this.element.fadeOut(250,function(){t(this).css("top",0).hide();(0===o||0===--o)&&t(".repository-browser-modal-overlay").hide()}))},refresh:function(){this._currentFolder&&this._fetchItems(this._currentFolder)}})});define("repository-browser-i18n-de",[],function(){return{Browsing:"Browsing",Close:"Schließn","in":"in","Input search text...":"Suchtext einfü.gen...",numerous:"zahlreich",of:"von","Repository Browser":"Repository Browser",Search:"Süchen","Searching for":"Suche nach",Viewing:"Anzeige","button.switch-metaview.tooltip":"Zwischen Metaansicht und normaler Ansicht umschalten"}});define("repository-browser-i18n-en",[],function(){return{Browsing:"Browsing",Close:"Close","in":"in","Input search text...":"Input search text...",numerous:"numerous",of:"of","Repository Browser":"Repository Browser",Search:"Search","Searching for":"Searching for",Viewing:"Viewing","button.switch-metaview.tooltip":"Switch between meta and normal view"}});define("linkbrowser/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link","button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link"},de:!0,fr:!0,pl:!0,ru:!0});define("linkbrowser/linkbrowser-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/button link/link-plugin RepositoryBrowser i18n!linkbrowser/nls/i18n i18n!aloha/nls/i18n".split(" "),function(e,t,n,r,i,s,o,u,a){var f=u.extend({init:function(t){this._super(t);var n=this;this._linkBrowserButton=i.adopt("linkBrowser",s,{tooltip:a.t("button.addlink.tooltip"),icon:"aloha-icon-tree",scope:"Aloha.continuoustext",click:function(){n.show()}});this._linkBrowserButton.hide();this.url=e.getAlohaUrl()+"/../plugins/extra/linkbrowser/";e.bind("aloha-link-selected",function(){n._linkBrowserButton.show()});e.bind("aloha-link-unselected",function(){n._linkBrowserButton.hide()})},onSelect:function(t){o.hrefField.setItem(t);var n=e.Selection.getRangeObject(),r=n.startContainer=n.endContainer,i=n.startOffset=n.endOffset;n.select();n.startContainer=n.endContainer=r;n.startOffset=n.endOffset=i;n.select();e.trigger("aloha-link-selected-in-linkbrowser",t);this.close()},renderRowCols:function(e){var n={},r=this.url;e.id.match(/(\d+)\./);t.each(this.columns,function(t){switch(t){case"icon":n.icon='<div class="aloha-browser-icon						aloha-browser-icon-__page__"></div>';break;case"translations":if(!e.renditions)break;for(var t=e.renditions,i=t.length,s=[],o;i>0;--i){o=t[i];o.kind=="translation"&&s.push('<img src="'+r+"img/flags/"+o.language+'.png"									  alt="'+o.language+'"									  title="'+o.filename+'" />')}n.translations=s.join("");break;case"language":n.language=e.language;break;default:n[t]=e[t]||"--"}});return n}});return n.create("linkbrowser",{dependencies:["link"],browser:null,init:function(){this.browser=new f({repositoryManager:e.RepositoryManager,repositoryFilter:[],objectTypeFilter:["website","file","image","language"],renditionFilter:["*"],filter:["language"],columns:{icon:{title:"",width:30,sortable:!1,resizable:!1},name:{title:"Name",width:320,sorttype:"text"},language:{title:"",width:30,sorttype:"text"},translations:{title:"",width:350,sorttype:"text"}},rootPath:e.settings.baseUrl+"/vendor/repository-browser/"})}})});define("imagebrowser/nls/i18n",{root:{"button.addimage.tooltip":"Insert Image","button.removeimage.tooltip":"Remove Image","newimage.defaulttext":"New Image","floatingmenu.tab.img":"Image"}});define("imagebrowser/imagebrowser-plugin","aloha jquery aloha/plugin aloha/pluginmanager ui/ui ui/button image/image-plugin RepositoryBrowser i18n!imagebrowser/nls/i18n i18n!aloha/nls/i18n".split(" "),function(e,t,n,r,i,s,o,u,a){var f=u.extend({init:function(t){this._super(t);var n=this;this._imageBrowserButton=i.adopt("imageBrowser",s,{tooltip:a.t("button.addimage.tooltip"),icon:"aloha-icon-tree",scope:"Aloha.continuoustext","class":"aloha-imagebrowser-button",click:function(){n.open()}});this._imageBrowserButton.show(!1);this.url=e.getAlohaUrl()+"/../plugins/extra/imagebrowser/";e.bind("aloha-image-selected",function(){n._imageBrowserButton.show(!0)});e.bind("aloha-image-unselected",function(){n._imageBrowserButton.show(!1)})},onSelect:function(e){if(e.type.match("image")!==null){o.ui.imgSrcField.setItem(e);o.resetSize();this.close()}},listItems:function(e){var n=this,r=this.list.clearGridData();t.each(e,function(){var e=this.resource;e.type.match("image")!==null&&r.addRowData(e.uid,t.extend({id:e.id},n.renderRowCols(e)))})},renderRowCols:function(e){var n={};e.id.match(/(\d+)\./);t.each(this.columns,function(t){switch(t){case"icon":if(!e.renditions)break;e.renditions.length===1&&e.renditions[0].kind==="thumbnail"&&(n.icon='<img width="'+e.renditions[0].width+'" height="'+e.renditions[0].height+' " src="'+e.renditions[0].url+'"/>');break;default:n[t]=e[t]||"--"}});return n}});return n.create("imagebrowser",{dependencies:["image"],browser:null,init:function(){this.browser=new f({repositoryManager:e.RepositoryManager,repositoryFilter:[],objectTypeFilter:["image"],renditionFilter:["*"],filter:["language"],columns:{icon:{title:"",width:75,sortable:!1,resizable:!1},name:{title:"Name",width:320,sorttype:"text"}},rootPath:e.settings.baseUrl+"/vendor/repository-browser/"})}})});define("ui/menuButton",["jquery","ui/component","ui/utils","jqueryui"],function(e,t,n){function r(t,s){var o=[];e.each(s,function(s,u){var f=e("<li>");f.append(e("<a>",{href:"javascript:void 0",html:n.makeButtonLabelWithIcon(u)}));u.click&&f.data("aloha-ui-menubutton-select",function(){t();u.click()});if(u.menu){var l=e("<ul>").appendTo(f);l.append(r(i(l,t),u.menu))}o.push(f[0])});return o}function i(t,n){n=n||e.noop;return function(){t.blur().hide();t.parent().removeClass("aloha-ui-menubutton-pressed");n()}}function s(e,t){var n=t.item.data("aloha-ui-menubutton-select");n&&n(e,t);e.preventDefault()}var o=t.extend({init:function(){this.element=o.makeMenuButton(this)}});o.makeMenuButton=function(t){function o(e){e.hide().parent().removeClass("aloha-ui-menubutton-pressed")}var u=e("<div>",{"class":"aloha-ui-menubutton-container"}),f=n.makeButtonElement({"class":"aloha-ui-menubutton-expand"}),l=e("<ul>",{"class":"aloha-ui-menubutton-menu"}),h=null,p=null;e.browser.msie&&u.addClass("aloha-ui-menubutton-iehack");t.click?(h=n.makeButton(n.makeButtonElement({"class":"aloha-ui-menubutton-action"}),t).click(t.click),n.makeButton(f,{},!0),p=e("<div>").buttonset().append(h).append(f)):n.makeButton(f,t,!0).addClass("aloha-ui-menubutton-single");if(!t.menu)return u.append(h);f.click(function(){u.addClass("aloha-ui-menubutton-pressed");t.siblingContainer&&t.siblingContainer.find(".aloha-ui-menubutton-menu").each(function(){this!==l[0]&&o(e(this))});if(!l.is(":visible")){l.show().position({my:"left top",at:"left bottom",of:h||f});e(document).bind("click",function(t){e(this).unbind(t);l.hide();u.removeClass("aloha-ui-menubutton-pressed")});return!1}o(l)});u.append(p||f).append(l);l.append(r(i(l),t.menu));l.hide().menu({select:s});return u};return o});define("ribbon/ribbon-plugin",["jquery","aloha/plugin","ui/menuButton","ui/utils","jqueryui"],function(e,t,n,r){return t.create("ribbon",{init:function(){if(this.settings.enable||"undefined"==typeof this.settings.enable){var t=this;this._visible=!1;this._toolbar=e("<div>",{"class":"aloha-ribbon-toolbar ui-menubar ui-widget-header ui-helper-clearfix"});var n=r.makeButtonElement({"class":"aloha-ribbon-in"}).button().hide().click(function(){t._toolbar.animate({left:0});e("body").animate({paddingTop:30});n.hide()}).appendTo(this._toolbar);r.makeButtonElement({"class":"aloha-ribbon-out"}).button().click(function(){t._toolbar.animate({left:-t._toolbar.outerWidth()+n.outerWidth()+10});e("body").animate({paddingTop:0});n.show()}).appendTo(this._toolbar);var i=e("<div>",{"class":"aloha aloha-ribbon"}).appendTo("body");this._icon=e("<div>").prependTo(this._toolbar);this.setIcon("");this._toolbar.appendTo(i);e("body").css({position:"relative",paddingTop:30})}},setIcon:function(e){this._icon&&this._icon.attr("class","aloha-ribbon-icon "+e)},addButton:function(t){this._toolbar&&(t=e.extend({},t,{siblingContainer:this._toolbar}),this._toolbar.append(n.makeMenuButton(t)))},hide:function(){this._toolbar&&(this._toolbar.hide(),this._visible=!1)},show:function(){this._toolbar&&(this._toolbar.show(),this._visible=!0)},isVisible:function(){return this._visible}})});define("wai-lang/nls/i18n",{root:{"floatingmenu.tab.wai-lang":"Language annotation","button.add-wai-lang-remove.tooltip":"Remove language annotation","button.add-wai-lang.tooltip":"Add language annotation",insertAnnotation:"ctrl+shift+l"},de:!0,en:!0});define("wai-lang/languages",["aloha","jquery","flag-icons/flag-icons-plugin","aloha/console","wai-lang/wai-lang-plugin"],function(e,t,n,r){var i=t.Deferred();return new(e.AbstractRepository.extend({languageCodes:[],locale:"de",iso:"iso639-1",flags:!1,_constructor:function(){this._super("wai-languages")},init:function(){var t=this,n=e.require("wai-lang/wai-lang-plugin"),r=n.iso639;"de"!==e.settings.locale&&(this.locale="en");"iso639-1"!==r&&(this.iso="iso639-2");this.flags=n.flags;this.repositoryName="WaiLanguages";e.require(["wai-lang/"+this.iso+"-"+this.locale],function(e){t.storeLanguageCodes(e);i.resolve()})},markObject:function(){},errorHandler:function(e){r.log("error",this,"Error while loading languages. "+e)},storeLanguageCodes:function(r){var i=this,s=e.getPluginUrl("wai-lang");t.each(r,function(t,r){r.id=t;r.repositoryId=i.repositoryId;r.type="language";i.flags&&(r.url=r.flag?n.path+"/img/flags/"+r.flag+".png":s+"/img/button.png");i.languageCodes.push(new e.RepositoryDocument(r))})},_searchInLanguageCodes:function(e,n){var r=RegExp("^"+e.queryString,"i"),i,s=[],o,u,a;for(i=0;i<this.languageCodes.length;++i)a=this.languageCodes[i],o=!e.queryString||a.name.match(r),u=!e.objectTypeFilter||!e.objectTypeFilter.length||-1<t.inArray(a.type,e.objectTypeFilter),o&&u&&s.push(a);n.call(this,s)},query:function(e,t){var n=this;i.done(function(){n._searchInLanguageCodes(e,t)})},getObjectById:function(e,t){var n,r;for(n=0;n<this.languageCodes.length;++n)if(r=this.languageCodes[n],r.id===e){t.call(this,[r]);break}}}))});define("wai-lang/wai-lang-plugin","aloha jquery aloha/plugin ui/ui ui/scopes ui/button ui/toggleButton ui/port-helper-attribute-field i18n!wai-lang/nls/i18n i18n!aloha/nls/i18n wai-lang/languages".split(" "),function(e,t,n,r,i,s,o,u,a){var f=window.GENTICS,l;return n.create("wai-lang",{languages:["en","de"],config:["span"],iso639:"iso639-1",flags:!1,objectTypeFilter:["language"],hotKey:{insertAnnotation:a.t("insertAnnotation","ctrl+shift+l")},init:function(){this.settings.objectTypeFilter&&(this.objectTypeFilter=this.settings.objectTypeFilter);this.settings.hotKey&&t.extend(!0,this.hotKey,this.settings.hotKey);this.flags=this.settings.flags==="true"||this.settings.flags===!0||this.settings.flags==="1"||this.settings.flags===1?!0:!1;this.settings.iso639&&(this.iso639=this.settings.iso639);this.createButtons();this.subscribeEvents();this.bindInteractions()},subscribeEvents:function(){var n=this;e.bind("aloha-editable-activated",function(){var r;r=n.getEditableConfig(e.activeEditable.obj);t.inArray("span",r)!==-1?n._wailangButton.show():n._wailangButton.hide()});e.bind("aloha-selection-changed",function(e,t){var r=n._foundLangMarkupAtSelection=n.findLangMarkup(t);if(r){n._wailangButton.setState(!0);i.setScope("wai-lang");l.setTargetObject(r,"lang")}else{n._wailangButton.setState(!1);n._foundLangMarkupAtSelection=!1;l.setTargetObject(null)}})},createButtons:function(){var e=this;this._wailangButton=r.adopt("wailang",o,{tooltip:a.t("button.add-wai-lang.tooltip"),icon:"aloha-icon aloha-icon-wai-lang",scope:"Aloha.continuoustext",click:function(){e.addRemoveMarkupToSelection()}});i.createScope("wai-lang","Aloha.continuoustext");l=u({name:"wailangfield",width:320,valueField:"id",minChars:1,scope:"wai-lang"});this.flags?l.setTemplate('<div class="aloha-wai-lang-img-item"><img class="aloha-wai-lang-img" src="{url}" /><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>'):l.setTemplate('<div class="aloha-wai-lang-img-item"><div class="aloha-wai-lang-label-item">{name} ({id})</div></div>');l.setObjectTypeFilter(this.objectTypeFilter);this._removewailangButton=r.adopt("removewailang",s,{tooltip:a.t("button.add-wai-lang-remove.tooltip"),icon:"aloha-icon aloha-icon-wai-lang-remove",scope:"wai-lang",click:function(){e.removeLangMarkup()}})},findLangMarkup:function(n){n=n||e.Selection.getRangeObject();return e.activeEditable?n.findMarkup(function(){return t(this).hasClass("aloha-wai-lang")||t(this).is("[lang]")},e.activeEditable.obj):null},findLanguageMarkup:function(t){t=t||e.Selection.getRangeObject();return e.activeEditable?t.findMarkup(function(){return this.nodeName==="SPAN"},e.activeEditable.obj):null},removeLangMarkup:function(){var t=e.Selection.getRangeObject(),n=this.findLangMarkup(t);if(n){f.Utils.Dom.removeFromDOM(n,t,!0);t.select();i.setScope("Aloha.continuoustext");l.setTargetObject(null)}},bindInteractions:function(){function t(e){e.obj.bind("keydown",n.hotKey.insertAnnotation,function(){n.insertLanguageAnnotation()});e.obj.find("span[lang]").each(function(){n.makeVisible(this)})}var n=this;l.addListener("blur",function(){this.getValue()||n.removeMarkup()});e.bind("aloha-editable-created",function(e,n){t(n)})},insertLanguageAnnotation:function(){if(typeof this.findLangMarkup=="function"){if(this.findLangMarkup()){l.foreground();l.focus()}else this.addMarkupToSelection();return!1}},makeVisible:function(e){e=t(e);e.addClass("aloha-wai-lang");e.attr("data-gentics-aloha-repository","wai-languages");e.attr("data-gentics-aloha-object-id",e.attr("lang"))},formatLanguageSpan:function(){e.activeEditable&&(this.findLanguageMarkup(e.Selection.getRangeObject())?this.removeMarkup():this.insertMarkup())},addRemoveMarkupToSelection:function(){this._foundLangMarkupAtSelection?this.removeLangMarkup():this.addMarkupToSelection(!1)},addMarkupToSelection:function(){var n=e.Selection.getRangeObject();if(!this.findLangMarkup(n)){l.foreground();i.setScope("wai-lang");n.isCollapsed()&&f.Utils.Dom.extendToWord(n);n.isCollapsed()||f.Utils.Dom.addMarkup(n,t('<span class="aloha-wai-lang"></span>'),!1);n.select();l.focus()}},removeMarkup:function(){var t=this.findLangMarkup(),n;if(t){n=e.Selection.getRangeObject();f.Utils.Dom.removeFromDOM(t,n,!0);n.select()}},makeClean:function(e){e.find("span[lang]").each(function(){t(this).removeClass("aloha-wai-lang");t(this).removeAttr("data-gentics-aloha-repository");t(this).removeAttr("data-gentics-aloha-object-id");t(this).attr("xml:lang",t(this).attr("lang"))})}})});define("headerids/nls/i18n",{root:{"headerids.label.target":"Target","headerids.button.reset":"Reset","headerids.button.set":"Set",internal_hyperlink:"Internal Hyperlink"},de:!0,en:!0});define("headerids/headerids-plugin",["jquery","aloha/plugin","i18n!headerids/nls/i18n","i18n!aloha/nls/i18n"],function(e,t,n){function r(){var t=[],n=u;s.each(arguments,function(){t.push("."+(""==this?n:n+"-"+this))});return e.trim(t.join(" "))}function i(){var t=[],n=u;s.each(arguments,function(){t.push(""==this?n:n+"-"+this)});return e.trim(t.join(" "))}var s=e,o=window.Aloha,u="aloha-headerids";return t.create("headerids",{_constructor:function(){this._super("headerids")},config:["true"],init:function(){var e=this;o.bind("aloha-editable-activated",function(t,n){e.check(n.editable.obj)});o.bind("aloha-editable-deactivated",function(t,n){e.check(n.editable.obj)});o.bind("aloha-ready",function(){e.initSidebar(o.Sidebar.right)})},check:function(t){var n=this,r=n.getEditableConfig(t);if(-1===e.inArray("true",r))return!1;e(t).find("h1, h2, h3, h4, h5, h6").not(".aloha-customized").each(function(){n.processH(this)})},processH:function(t){e(t).attr("id",this.sanitize(e(t).text()))},sanitize:function(e){return e.replace(/[^a-z0-9]+/gi,"_")},initSidebar:function(t){var s=this;s.sidebar=t;t.addPanel({id:i("sidebar-panel"),title:n.t("internal_hyperlink"),content:"",expanded:!0,activeOn:"h1, h2, h3, h4, h5, h6",onInit:function(){var t=this,o=this.setContent('<label class="'+i("label")+'" for="'+i("input")+'">'+n.t("headerids.label.target")+'</label><input id="'+i("input")+'" class="'+i("input")+'" type="text" name="value"/> <button class="'+i("reset-button")+'">'+n.t("headerids.button.reset")+'</button><button class="'+i("set-button")+'">'+n.t("headerids.button.set")+"</button>").content;o.find(r("set-button")).click(function(){e(t.effective).attr("id",e(r("input")).val());e(t.effective).addClass("aloha-customized")});o.find(r("reset-button")).click(function(){s.processH(t.effective);e(t.effective).removeClass("aloha-customized");t.content.find(r("input")).val(t.effective.attr("id"))})},onActivate:function(e){this.effective=e;this.content.find(r("input")).val(e.attr("id"))}});t.show()},makeClean:function(e){this.check(e)}})});define("metaview/nls/i18n",{root:{"button.switch-metaview.tooltip":"Switch between meta and normal view"},de:!0,en:!0});define("metaview/metaview-plugin","aloha/plugin ui/ui ui/toggleButton flag-icons/flag-icons-plugin i18n!metaview/nls/i18n i18n!aloha/nls/i18n jquery".split(" "),function(e,t,n,r,i,s,o){var u=window.Aloha;return e.create("metaview",{_constructor:function(){this._super("metaview")},config:["metaview"],languages:["en","de"],init:function(){var e=this;this.createButtons();u.bind("aloha-editable-activated",function(){var t;t=e.getEditableConfig(u.activeEditable.obj);if(o.type(t)==="array"&&o.inArray("metaview",t)!==-1){e._toggleMetaViewButton.show(!0);o(u.activeEditable.obj).hasClass("aloha-metaview")?e._toggleMetaViewButton.setState(!0):e._toggleMetaViewButton.setState(!1)}else e._toggleMetaViewButton.show(!1)})},buttonClick:function(){if(o(u.activeEditable.obj).hasClass("aloha-metaview")){o(u.activeEditable.obj).removeClass("aloha-metaview");this._toggleMetaViewButton.setState(!1)}else{o(u.activeEditable.obj).addClass("aloha-metaview");this._toggleMetaViewButton.setState(!0)}},createButtons:function(){var e=this;this._toggleMetaViewButton=t.adopt("toggleMetaView",n,{tooltip:i.t("button.switch-metaview.tooltip"),icon:"aloha-icon aloha-icon-metaview",scope:"Aloha.continuoustext",click:function(){e.buttonClick()}})}})});define("listenforcer/listenforcer-plugin",["aloha","jquery","aloha/plugin","aloha/console"],function(e,t,n,r){function i(e,n){if(-1!==t.inArray(e[0],s)){e.find(".aloha-end-br").remove();var r=!1;e.find("li").each(function(){if(""!==t.trim(t(this).text()))return r=!0,!1});r||e.html(n);var i=e.find(">ul,>ol"),o=i.length,u;if(1<o){var a=t(i[0]);for(u=1;u<o;++u)a.append(t(i[u]).find(">li")),t(i[u]).remove()}e.find(">*:not(ul,ol)").remove()}}var s=[];return n.create("listenforcer",{languages:["en","de"],_constructor:function(){this._super("listenforcer")},init:function(){var n=this.settings.editables||[],s,o,u=n.length;for(o=0;o<u;o++)s=n[o],"string"==typeof s||s.nodeName||s instanceof t?this.addEditableToEnforcementList(t(s)[0]):r.warn("Aloha List Enforcer Plugin",'Object "'+s.toString()+'" can not be used as a jQuery selector with which to register an editable to be list enforced.');e.bind("aloha-editable-activated",function(e,t){i(t.editable.obj,'<ul><li><br class="aloha-end-br" /></li></ul>')});e.bind("aloha-editable-deactivated",function(e,t){i(t.editable.obj,"")});e.bind("aloha-smart-content-changed",function(e,t){i(t.editable.obj,'<ul><li><br class="aloha-end-br" /></li></ul>')})},addEditableToEnforcementList:function(e){e&&s.push(e)}})});Aloha._load&&Aloha._load()})();